//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package redactor ;import (_a "errors";_e "fmt";_be "github.com/unidoc/unipdf/v3/common";_ad "github.com/unidoc/unipdf/v3/contentstream";_c "github.com/unidoc/unipdf/v3/core";_da "github.com/unidoc/unipdf/v3/creator";_f "github.com/unidoc/unipdf/v3/extractor";
_ee "github.com/unidoc/unipdf/v3/model";_ec "io";_g "regexp";_b "sort";_dg "strings";);func _eb (_fabd string ,_feg *_ee .PdfFont )[]byte {_afc ,_bef :=_feg .StringToCharcodeBytes (_fabd );if _bef !=0{_be .Log .Debug ("\u0057\u0041\u0052\u004e\u003a\u0020\u0073\u006fm\u0065\u0020\u0072un\u0065\u0073\u0020\u0063\u006f\u0075l\u0064\u0020\u006e\u006f\u0074\u0020\u0062\u0065\u0020\u0065\u006e\u0063\u006f\u0064\u0065d\u002e\u000a\u0009\u0025\u0073\u0020\u002d\u003e \u0025\u0076",_fabd ,_afc );
};return _afc ;};func _fc (_ea *_f .TextMarkArray )(_c .PdfObject ,int ){var _aac _c .PdfObject ;_bf :=-1;for _bfc ,_eeg :=range _ea .Elements (){_aac =_eeg .DirectObject ;_bf =_bfc ;if _aac !=nil {break ;};};return _aac ,_bf ;};func _eafc (_bde []*matchedIndex ,_eag [][]int )[]*matchedIndex {_cdff :=[]*matchedIndex {};
for _ ,_adfg :=range _bde {_gdgf ,_accfe :=_feda (_adfg ,_eag );if _gdgf {_bgae :=_cdd (_adfg ,_accfe );_cdff =append (_cdff ,_bgae ...);}else {_cdff =append (_cdff ,_adfg );};};return _cdff ;};

// Redact executes the redact operation on a pdf file and updates the content streams of all pages of the file.
func (_fde *Redactor )Redact ()error {_bcga ,_abc :=_fde ._fgab .GetNumPages ();if _abc !=nil {return _e .Errorf ("\u0066\u0061\u0069\u006c\u0065\u0064 \u0074\u006f\u0020\u0067\u0065\u0074\u0020\u0074\u0068\u0065\u0020\u006e\u0075m\u0062\u0065\u0072\u0020\u006f\u0066\u0020P\u0061\u0067\u0065\u0073");
};_beg :=_fde ._aede .FillColor ;_bgfe :=_fde ._aede .BorderWidth ;_faeb :=_fde ._aede .FillOpacity ;for _bgg :=1;_bgg <=_bcga ;_bgg ++{_gbag ,_bdb :=_fde ._fgab .GetPage (_bgg );if _bdb !=nil {return _bdb ;};_efdf ,_bdb :=_f .New (_gbag );if _bdb !=nil {return _bdb ;
};_fge ,_ ,_ ,_bdb :=_efdf .ExtractPageText ();if _bdb !=nil {return _bdb ;};_adda :=_fge .GetContentStreamOps ();_fbdg ,_fgde ,_bdb :=_fde .redactPage (_adda ,_gbag .Resources );if _fgde ==nil {_be .Log .Info ("N\u006f\u0020\u006d\u0061\u0074\u0063\u0068\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0066\u006f\u0072\u0020t\u0068\u0065\u0020\u0070\u0072\u006f\u0076\u0069\u0064\u0065d \u0070\u0061\u0074t\u0061r\u006e\u002e");
_fgde =_adda ;};_bbc :=_ad .ContentStreamOperation {Operand :"\u006e"};*_fgde =append (*_fgde ,&_bbc );_gbag .SetContentStreams ([]string {_fgde .String ()},_c .NewFlateEncoder ());if _bdb !=nil {return _bdb ;};_cef ,_bdb :=_gbag .GetMediaBox ();if _bdb !=nil {return _bdb ;
};if _gbag .MediaBox ==nil {_gbag .MediaBox =_cef ;};if _gdfg :=_fde ._gagf .AddPage (_gbag );_gdfg !=nil {return _gdfg ;};_b .Slice (_fbdg ,func (_bfce ,_cbe int )bool {return _fbdg [_bfce ]._bcf < _fbdg [_cbe ]._bcf });_cafa :=_cef .Ury ;for _ ,_adde :=range _fbdg {_aaf :=_adde ._eca ;
_gggc :=_fde ._gagf .NewRectangle (_aaf .Llx ,_cafa -_aaf .Lly ,_aaf .Urx -_aaf .Llx ,-(_aaf .Ury -_aaf .Lly ));_gggc .SetFillColor (_beg );_gggc .SetBorderWidth (_bgfe );_gggc .SetFillOpacity (_faeb );if _eacg :=_fde ._gagf .Draw (_gggc );_eacg !=nil {return nil ;
};};};_fde ._gagf .SetOutlineTree (_fde ._fgab .GetOutlineTree ());return nil ;};func (_gga *Redactor )redactPage (_cded *_ad .ContentStreamOperations ,_dgd *_ee .PdfPageResources )([]matchedBBox ,*_ad .ContentStreamOperations ,error ){_bgga ,_cab :=_f .NewFromContents (_cded .String (),_dgd );
if _cab !=nil {return nil ,nil ,_cab ;};_fegc ,_ ,_ ,_cab :=_bgga .ExtractPageText ();if _cab !=nil {return nil ,nil ,_cab ;};_cded =_fegc .GetContentStreamOps ();_gab :=_fegc .Marks ();_dee :=_fegc .Text ();_dee ,_ggbc :=_edg (_dee );_cebb :=[]matchedBBox {};
_eefg :=make (map[_c .PdfObject ][]localSpanMarks );_gdg :=[]*targetMap {};for _ ,_acfc :=range _gga ._cdea .Terms {_ded ,_gcea :=_dggd (_acfc );if _gcea !=nil {return nil ,nil ,_gcea ;};_eeeb ,_gcea :=_ded .match (_dee );if _gcea !=nil {return nil ,nil ,_gcea ;
};_eeeb =_eafc (_eeeb ,_ggbc );_gbgg :=_ccbb (_eeeb );_gdg =append (_gdg ,_gbgg ...);};_bbce (_gdg );for _ ,_ade :=range _gdg {_fdc :=_ade ._gcb ;_dde :=_ade ._degef ;_cee :=[]matchedBBox {};for _ ,_fdee :=range _dde {_cgge ,_ffg ,_gdd :=_dcefb (_fdee ,_gab ,_fdc );
if _gdd !=nil {return nil ,nil ,_gdd ;};_gbggc :=_bfac (_cgge );for _aaa ,_aab :=range _gbggc {_fbg :=localSpanMarks {_fbea :_aab ,_fedg :_aaa ,_ecf :_fdc };_bdd ,_ :=_fc (_aab );if _gfgc ,_acae :=_eefg [_bdd ];_acae {_eefg [_bdd ]=append (_gfgc ,_fbg );
}else {_eefg [_bdd ]=[]localSpanMarks {_fbg };};};_cee =append (_cee ,_ffg );};_cebb =append (_cebb ,_cee ...);};_cab =_dag (_cded ,_eefg );if _cab !=nil {return nil ,nil ,_cab ;};return _cebb ,_cded ,nil ;};func _ccd (_gec string ,_cdf []replacement ,_dec *_ee .PdfFont )[]_c .PdfObject {_ccg :=[]_c .PdfObject {};
_acca :=0;_efe :=_gec ;for _ebd ,_ggc :=range _cdf {_bgd :=_ggc ._ac ;_bgaf :=_ggc ._fb ;_age :=_ggc ._dgf ;_cea :=_c .MakeFloat (_bgaf );if _acca > _bgd ||_bgd ==-1{continue ;};_bbbe :=_gec [_acca :_bgd ];_fafg :=_eb (_bbbe ,_dec );_bffa :=_c .MakeStringFromBytes (_fafg );
_ccg =append (_ccg ,_bffa );_ccg =append (_ccg ,_cea );_ega :=_bgd +len (_age );_efe =_gec [_ega :];_acca =_ega ;if _ebd ==len (_cdf )-1{_fafg =_eb (_efe ,_dec );_bffa =_c .MakeStringFromBytes (_fafg );_ccg =append (_ccg ,_bffa );};};return _ccg ;};

// Write writes the content of `re.creator` to writer of type io.Writer interface.
func (_fec *Redactor )Write (writer _ec .Writer )error {return _fec ._gagf .Write (writer )};func _dcefb (_ccb []int ,_dbad *_f .TextMarkArray ,_eace string )(*_f .TextMarkArray ,matchedBBox ,error ){_aebd :=matchedBBox {};_beeg :=_ccb [0];_adf :=_ccb [1];
_gbeg :=len (_eace )-len (_dg .TrimLeft (_eace ,"\u0020"));_geac :=len (_eace )-len (_dg .TrimRight (_eace ,"\u0020\u000a"));_beeg =_beeg +_gbeg ;_adf =_adf -_geac ;_eace =_dg .Trim (_eace ,"\u0020\u000a");_edee ,_faea :=_dbad .RangeOffset (_beeg ,_adf );
if _faea !=nil {return nil ,_aebd ,_faea ;};_accf ,_cfdf :=_edee .BBox ();if !_cfdf {return nil ,_aebd ,_e .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_edee );
};_aebd =matchedBBox {_bcf :_eace ,_eca :_accf };return _edee ,_aebd ,nil ;};func _efd (_gbff *_f .TextMarkArray )string {_abb :="";for _ ,_afa :=range _gbff .Elements (){_abb +=_afa .Text ;};return _abb ;};func _aebf (_edbg ,_dbg string )[]int {if len (_dbg )==0{return nil ;
};var _fdf []int ;for _cgbc :=0;_cgbc < len (_edbg );{_aee :=_dg .Index (_edbg [_cgbc :],_dbg );if _aee < 0{return _fdf ;};_fdf =append (_fdf ,_cgbc +_aee );_cgbc +=_aee +len (_dbg );};return _fdf ;};

// Redactor represents a Redactor object.
type Redactor struct{_fgab *_ee .PdfReader ;_cdea *RedactionOptions ;_gagf *_da .Creator ;_aede *RectangleProps ;};func _dag (_gc *_ad .ContentStreamOperations ,_ab map[_c .PdfObject ][]localSpanMarks )error {for _gb ,_acf :=range _ab {if _gb ==nil {continue ;
};_dgc ,_ca ,_gd :=_cgd (_gc ,_gb );if !_gd {_be .Log .Debug ("Pd\u0066\u004fb\u006a\u0065\u0063\u0074\u0020\u0025\u0073\u006e\u006ft\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0069\u006e\u0020\u0073\u0069\u0064\u0065\u0020\u0074\u0068\u0065\u0020\u0063\u006f\u006e\u0074\u0065\u006e\u0074\u0073\u0074r\u0065a\u006d\u0020\u006f\u0070\u0065\u0072\u0061\u0074i\u006fn\u0020\u0025s",_gb ,_gc );
return nil ;};if _dgc .Operand =="\u0054\u006a"{_de :=_bce (_dgc ,_gb ,_acf );if _de !=nil {return _de ;};}else if _dgc .Operand =="\u0054\u004a"{_faec :=_eaf (_dgc ,_gb ,_acf );if _faec !=nil {return _faec ;};}else if _dgc .Operand =="\u0027"||_dgc .Operand =="\u0022"{_ag :=_ecd (_gc ,_dgc .Operand ,_ca );
if _ag !=nil {return _ag ;};_ag =_bce (_dgc ,_gb ,_acf );if _ag !=nil {return _ag ;};};};return nil ;};type matchedBBox struct{_eca _ee .PdfRectangle ;_bcf string ;};func _ccbb (_abde []*matchedIndex )[]*targetMap {_cdbf :=make (map[string ][][]int );_dfc :=[]*targetMap {};
for _ ,_fbee :=range _abde {_bcea :=_fbee ._cfg ;_cfgf :=[]int {_fbee ._fbf ,_fbee ._gaaa };if _dcd ,_ddb :=_cdbf [_bcea ];_ddb {_cdbf [_bcea ]=append (_dcd ,_cfgf );}else {_cdbf [_bcea ]=[][]int {_cfgf };};};for _cfa ,_fcb :=range _cdbf {_aeca :=&targetMap {_gcb :_cfa ,_degef :_fcb };
_dfc =append (_dfc ,_aeca );};return _dfc ;};func _ece (_gea int ,_gaga []int )bool {for _ ,_acaf :=range _gaga {if _acaf ==_gea {return true ;};};return false ;};

// RedactionTerm holds the regexp pattern and the replacement string for the redaction process.
type RedactionTerm struct{Pattern *_g .Regexp ;};func _cdfb (_ffc ,_befdd ,_gba float64 )float64 {_gba =_gba /100;_fac :=(-1000*_ffc )/(_befdd *_gba );return _fac ;};func _dba (_ge *_f .TextMarkArray )*_ee .PdfFont {_ ,_ff :=_fc (_ge );_bgbc :=_ge .Elements ()[_ff ];
_fd :=_bgbc .Font ;return _fd ;};func _cba (_gfgb *_f .TextMarkArray ,_fegcb int ,_fbfe int )int {_bcd :=_gfgb .Elements ();_cad :=_fegcb -1;_gdda :=_fegcb +1;_decg :=-1;if _cad >=0{_edba :=_bcd [_cad ];_eeeg :=_edba .ObjString ;_eea :=len (_eeeg );_facb :=_edba .Index ;
if _facb +1< _eea {_decg =_cad ;return _decg ;};};if _gdda < len (_bcd ){_fff :=_bcd [_gdda ];_cebe :=_fff .ObjString ;if _cebe [0]!=_fff .Text {_decg =_gdda ;return _decg ;};};return _decg ;};type matchedIndex struct{_fbf int ;_gaaa int ;_cfg string ;
};type regexMatcher struct{_egge RedactionTerm };func _gfec (_fgc localSpanMarks ,_agab *_f .TextMarkArray ,_bda *_ee .PdfFont ,_befd ,_fcf string )([]_c .PdfObject ,error ){_bgbcf :=_efd (_agab );Tj ,_efc :=_eacd (_agab );if _efc !=nil {return nil ,_efc ;
};_cdeg :=len (_befd );_bab :=len (_bgbcf );_bcc :=-1;_fabf :=_c .MakeFloat (Tj );if _bgbcf !=_fcf {_ffac :=_fgc ._fedg ;if _ffac ==0{_bcc =_dg .LastIndex (_befd ,_bgbcf );}else {_bcc =_dg .Index (_befd ,_bgbcf );};}else {_bcc =_dg .Index (_befd ,_bgbcf );
};_fgce :=_bcc +_bab ;_gcf :=[]_c .PdfObject {};if _bcc ==0&&_fgce ==_cdeg {_gcf =append (_gcf ,_fabf );}else if _bcc ==0&&_fgce < _cdeg {_abdf :=_eb (_befd [_fgce :],_bda );_cbg :=_c .MakeStringFromBytes (_abdf );_gcf =append (_gcf ,_fabf ,_cbg );}else if _bcc > 0&&_fgce >=_cdeg {_gaa :=_eb (_befd [:_bcc ],_bda );
_cdg :=_c .MakeStringFromBytes (_gaa );_gcf =append (_gcf ,_cdg ,_fabf );}else if _bcc > 0&&_fgce < _cdeg {_fed :=_eb (_befd [:_bcc ],_bda );_caf :=_eb (_befd [_fgce :],_bda );_fcfc :=_c .MakeStringFromBytes (_fed );_gbf :=_c .MakeString (string (_caf ));
_gcf =append (_gcf ,_fcfc ,_fabf ,_gbf );};return _gcf ,nil ;};func _edg (_egbc string )(string ,[][]int ){_bccf :=_g .MustCompile ("\u005c\u006e");_aaab :=_bccf .FindAllStringIndex (_egbc ,-1);_fdfb :=_bccf .ReplaceAllString (_egbc ,"\u0020");return _fdfb ,_aaab ;
};type targetMap struct{_gcb string ;_degef [][]int ;};func _eacd (_cdfg *_f .TextMarkArray )(float64 ,error ){_ggd ,_gbc :=_cdfg .BBox ();if !_gbc {return 0.0,_e .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_cdfg );
};_edff :=_gf (_cdfg );_baf :=0.0;_ ,_dab :=_fc (_cdfg );_ffb :=_cdfg .Elements ()[_dab ];_abgc :=_ffb .Font ;if _edff > 0{_baf =_aec (_abgc ,_ffb );};_gaade :=(_ggd .Urx -_ggd .Llx );_gaade =_gaade +_baf *float64 (_edff );Tj :=_cdfb (_gaade ,_ffb .FontSize ,_ffb .Th );
return Tj ,nil ;};type placeHolders struct{_fa []int ;_ae string ;_fae float64 ;};type replacement struct{_dgf string ;_fb float64 ;_ac int ;};func _bbce (_gae []*targetMap ){for _deda ,_fdgf :=range _gae {for _dce ,_cgfb :=range _gae {if _deda !=_dce {_caebb ,_dgg :=_gbgb (*_fdgf ,*_cgfb );
if _caebb {_dcef (_cgfb ,_dgg );};};};};};func _cgd (_efb *_ad .ContentStreamOperations ,PdfObj _c .PdfObject )(*_ad .ContentStreamOperation ,int ,bool ){for _gdc ,_ecb :=range *_efb {_fga :=_ecb .Operand ;if _fga =="\u0054\u006a"{_cdb :=_c .TraceToDirectObject (_ecb .Params [0]);
if _cdb ==PdfObj {return _ecb ,_gdc ,true ;};}else if _fga =="\u0054\u004a"{_gcfd ,_cbf :=_c .GetArray (_ecb .Params [0]);if !_cbf {return nil ,_gdc ,_cbf ;};for _ ,_cafc :=range _gcfd .Elements (){if _cafc ==PdfObj {return _ecb ,_gdc ,true ;};};}else if _fga =="\u0022"{_efec :=_c .TraceToDirectObject (_ecb .Params [2]);
if _efec ==PdfObj {return _ecb ,_gdc ,true ;};}else if _fga =="\u0027"{_bbd :=_c .TraceToDirectObject (_ecb .Params [0]);if _bbd ==PdfObj {return _ecb ,_gdc ,true ;};};};return nil ,-1,false ;};func _cgfe (_dbbb _c .PdfObject ,_def *_ee .PdfFont )(string ,error ){_ceb ,_ccce :=_c .GetStringBytes (_dbbb );
if !_ccce {return "",_c .ErrTypeError ;};_gbg :=_def .BytesToCharcodes (_ceb );_ecdg ,_ecgb ,_fag :=_def .CharcodesToStrings (_gbg );if _fag > 0{_be .Log .Debug ("\u0072\u0065nd\u0065\u0072\u0054e\u0078\u0074\u003a\u0020num\u0043ha\u0072\u0073\u003d\u0025\u0064\u0020\u006eum\u004d\u0069\u0073\u0073\u0065\u0073\u003d%\u0064",_ecgb ,_fag );
};_daac :=_dg .Join (_ecdg ,"");return _daac ,nil ;};func _gbgb (_dbfb ,_cggf targetMap )(bool ,[]int ){_bca :=_dg .Contains (_dbfb ._gcb ,_cggf ._gcb );var _afd []int ;for _ ,_ced :=range _dbfb ._degef {for _bcgf ,_dfb :=range _cggf ._degef {if _dfb [0]>=_ced [0]&&_dfb [1]<=_ced [1]{_afd =append (_afd ,_bcgf );
};};};return _bca ,_afd ;};

// RedactRectanglePropsNew return a new pointer to a default RectangleProps object.
func RedactRectanglePropsNew ()*RectangleProps {return &RectangleProps {FillColor :_da .ColorBlack ,BorderWidth :0.0,FillOpacity :1.0};};func _eaf (_ed *_ad .ContentStreamOperation ,_gccd _c .PdfObject ,_fbe []localSpanMarks )error {_cgc ,_agd :=_c .GetArray (_ed .Params [0]);
_dac :=[]_c .PdfObject {};if !_agd {_be .Log .Debug ("\u0045\u0052\u0052OR\u003a\u0020\u0054\u004a\u0020\u006f\u0070\u003d\u0025s\u0020G\u0065t\u0041r\u0072\u0061\u0079\u0056\u0061\u006c\u0020\u0066\u0061\u0069\u006c\u0065\u0064",_ed );return _e .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_ed );
};_fbd ,_bag :=_deg (_fbe );if len (_bag )==1{_cf :=_bag [0];_bfe :=_fbd [_cf ];if len (_bfe )==1{_gfe :=_bfe [0];_faf :=_gfe ._fbea ;_bee :=_dba (_faf );_dc ,_bb :=_cgfe (_gccd ,_bee );if _bb !=nil {return _bb ;};_faff ,_bb :=_gfec (_gfe ,_faf ,_bee ,_dc ,_cf );
if _bb !=nil {return _bb ;};for _ ,_bg :=range _cgc .Elements (){if _bg ==_gccd {_dac =append (_dac ,_faff ...);}else {_dac =append (_dac ,_bg );};};}else {_bfa :=_bfe [0]._fbea ;_aga :=_dba (_bfa );_bec ,_fgd :=_cgfe (_gccd ,_aga );if _fgd !=nil {return _fgd ;
};_aca ,_fgd :=_bae (_bec ,_bfe );if _fgd !=nil {return _fgd ;};_gg :=_agge (_aca );_eg :=_ccd (_bec ,_gg ,_aga );for _ ,_cfd :=range _cgc .Elements (){if _cfd ==_gccd {_dac =append (_dac ,_eg ...);}else {_dac =append (_dac ,_cfd );};};};_ed .Params [0]=_c .MakeArray (_dac ...);
}else if len (_bag )> 1{_af :=_fbe [0];_cc :=_af ._fbea ;_ ,_bd :=_fc (_cc );_ede :=_cc .Elements ()[_bd ];_bfd :=_ede .Font ;_ggg ,_ccc :=_cgfe (_gccd ,_bfd );if _ccc !=nil {return _ccc ;};_fad ,_ccc :=_bae (_ggg ,_fbe );if _ccc !=nil {return _ccc ;};
_bc :=_agge (_fad );_ef :=_ccd (_ggg ,_bc ,_bfd );for _ ,_ecda :=range _cgc .Elements (){if _ecda ==_gccd {_dac =append (_dac ,_ef ...);}else {_dac =append (_dac ,_ecda );};};_ed .Params [0]=_c .MakeArray (_dac ...);};return nil ;};func _dcef (_becf *targetMap ,_gbe []int ){var _fdcc [][]int ;
for _ecc ,_eege :=range _becf ._degef {if _ece (_ecc ,_gbe ){continue ;};_fdcc =append (_fdcc ,_eege );};_becf ._degef =_fdcc ;};func _bae (_aed string ,_eda []localSpanMarks )([]placeHolders ,error ){_egc :="";_bga :=[]placeHolders {};for _eec ,_dga :=range _eda {_bbg :=_dga ._fbea ;
_aeb :=_dga ._ecf ;_agdd :=_efd (_bbg );_gfg ,_abg :=_eacd (_bbg );if _abg !=nil {return nil ,_abg ;};if _agdd !=_egc {var _fdg []int ;if _eec ==0&&_aeb !=_agdd {_dcg :=_dg .Index (_aed ,_agdd );_fdg =[]int {_dcg };}else if _eec ==len (_eda )-1{_gdf :=_dg .LastIndex (_aed ,_agdd );
_fdg =[]int {_gdf };}else {_fdg =_aebf (_aed ,_agdd );};_gcd :=placeHolders {_fa :_fdg ,_ae :_agdd ,_fae :_gfg };_bga =append (_bga ,_gcd );};_egc =_agdd ;};return _bga ,nil ;};

// New instantiates a Redactor object with given PdfReader and `regex` pattern.
func New (reader *_ee .PdfReader ,opts *RedactionOptions ,rectProps *RectangleProps )*Redactor {if rectProps ==nil {rectProps =RedactRectanglePropsNew ();};return &Redactor {_fgab :reader ,_cdea :opts ,_gagf :_da .New (),_aede :rectProps };};

// RedactionOptions is a collection of RedactionTerm objects.
type RedactionOptions struct{Terms []RedactionTerm ;};func _dggd (_bbaa RedactionTerm )(*regexMatcher ,error ){return &regexMatcher {_egge :_bbaa },nil };func _bce (_edb *_ad .ContentStreamOperation ,_agb _c .PdfObject ,_ce []localSpanMarks )error {var _cb *_c .PdfObjectArray ;
_cgf ,_ggb :=_deg (_ce );if len (_ggb )==1{_cd :=_ggb [0];_add :=_cgf [_cd ];if len (_add )==1{_agc :=_add [0];_cgg :=_agc ._fbea ;_aeae :=_dba (_cgg );_dbe ,_ffa :=_cgfe (_agb ,_aeae );if _ffa !=nil {return _ffa ;};_gag ,_ffa :=_gfec (_agc ,_cgg ,_aeae ,_dbe ,_cd );
if _ffa !=nil {return _ffa ;};_cb =_c .MakeArray (_gag ...);}else {_cfb :=_add [0]._fbea ;_eac :=_dba (_cfb );_egf ,_fabda :=_cgfe (_agb ,_eac );if _fabda !=nil {return _fabda ;};_eeb ,_fabda :=_bae (_egf ,_add );if _fabda !=nil {return _fabda ;};_fea :=_agge (_eeb );
_dd :=_ccd (_egf ,_fea ,_eac );_cb =_c .MakeArray (_dd ...);};}else if len (_ggb )> 1{_cfdg :=_ce [0];_dege :=_cfdg ._fbea ;_ ,_bgf :=_fc (_dege );_bcb :=_dege .Elements ()[_bgf ];_fgb :=_bcb .Font ;_cde ,_cec :=_cgfe (_agb ,_fgb );if _cec !=nil {return _cec ;
};_cgb ,_cec :=_bae (_cde ,_ce );if _cec !=nil {return _cec ;};_ecg :=_agge (_cgb );_bff :=_ccd (_cde ,_ecg ,_fgb );_cb =_c .MakeArray (_bff ...);};_edb .Params [0]=_cb ;_edb .Operand ="\u0054\u004a";return nil ;};func _bfac (_ffaf *_f .TextMarkArray )[]*_f .TextMarkArray {_abba :=_ffaf .Elements ();
_ffe :=len (_abba );var _bac _c .PdfObject ;_gde :=[]*_f .TextMarkArray {};_bba :=&_f .TextMarkArray {};_fbge :=-1;for _dfbe ,_cac :=range _abba {_abda :=_cac .DirectObject ;_fbge =_cac .Index ;if _abda ==nil {_dea :=_cba (_ffaf ,_dfbe ,_fbge );if _bac !=nil {if _dea ==-1||_dea > _dfbe {_gde =append (_gde ,_bba );
_bba =&_f .TextMarkArray {};};};}else if _abda !=nil &&_bac ==nil {if _fbge ==0&&_dfbe > 0{_gde =append (_gde ,_bba );_bba =&_f .TextMarkArray {};};}else if _abda !=nil &&_bac !=nil {if _abda !=_bac {_gde =append (_gde ,_bba );_bba =&_f .TextMarkArray {};
};};_bac =_abda ;_bba .Append (_cac );if _dfbe ==(_ffe -1){_gde =append (_gde ,_bba );};};return _gde ;};func (_dfaa *regexMatcher )match (_bfed string )([]*matchedIndex ,error ){_ddee :=_dfaa ._egge .Pattern ;if _ddee ==nil {return nil ,_a .New ("\u006e\u006f\u0020\u0070at\u0074\u0065\u0072\u006e\u0020\u0063\u006f\u006d\u0070\u0069\u006c\u0065\u0064");
};var (_cbgd =_ddee .FindAllStringIndex (_bfed ,-1);_ffafg []*matchedIndex ;);for _ ,_ffec :=range _cbgd {_ffafg =append (_ffafg ,&matchedIndex {_fbf :_ffec [0],_gaaa :_ffec [1],_cfg :_bfed [_ffec [0]:_ffec [1]]});};return _ffafg ,nil ;};func _feda (_abgcg *matchedIndex ,_gabd [][]int )(bool ,[][]int ){_faa :=[][]int {};
for _ ,_gcfe :=range _gabd {if _abgcg ._fbf < _gcfe [0]&&_abgcg ._gaaa > _gcfe [1]{_faa =append (_faa ,_gcfe );};};return len (_faa )> 0,_faa ;};func _ecd (_cg *_ad .ContentStreamOperations ,_dgca string ,_ba int )error {_fab :=_ad .ContentStreamOperations {};
var _gcc _ad .ContentStreamOperation ;for _fe ,_abf :=range *_cg {if _fe ==_ba {if _dgca =="\u0027"{_db :=_ad .ContentStreamOperation {Operand :"\u0054\u002a"};_fab =append (_fab ,&_db );_gcc .Params =_abf .Params ;_gcc .Operand ="\u0054\u006a";_fab =append (_fab ,&_gcc );
}else if _dgca =="\u0022"{_fg :=_abf .Params [:2];Tc ,Tw :=_fg [0],_fg [1];_aa :=_ad .ContentStreamOperation {Params :[]_c .PdfObject {Tc },Operand :"\u0054\u0063"};_fab =append (_fab ,&_aa );_aa =_ad .ContentStreamOperation {Params :[]_c .PdfObject {Tw },Operand :"\u0054\u0077"};
_fab =append (_fab ,&_aa );_gcc .Params =[]_c .PdfObject {_abf .Params [2]};_gcc .Operand ="\u0054\u006a";_fab =append (_fab ,&_gcc );};};_fab =append (_fab ,_abf );};*_cg =_fab ;return nil ;};func _agge (_edf []placeHolders )[]replacement {_dcc :=[]replacement {};
for _ ,_gbd :=range _edf {_ead :=_gbd ._fa ;_daa :=_gbd ._ae ;_gaad :=_gbd ._fae ;for _ ,_bge :=range _ead {_fabb :=replacement {_dgf :_daa ,_fb :_gaad ,_ac :_bge };_dcc =append (_dcc ,_fabb );};};_b .Slice (_dcc ,func (_bbgc ,_bbb int )bool {return _dcc [_bbgc ]._ac < _dcc [_bbb ]._ac });
return _dcc ;};type localSpanMarks struct{_fbea *_f .TextMarkArray ;_fedg int ;_ecf string ;};

// RectangleProps defines properties of the redaction rectangle to be drawn.
type RectangleProps struct{FillColor _da .Color ;BorderWidth float64 ;FillOpacity float64 ;};func _aec (_agg *_ee .PdfFont ,_dgce _f .TextMark )float64 {_dgcg :=0.001;_df :=_dgce .Th /100;if _agg .Subtype ()=="\u0054\u0079\u0070e\u0033"{_dgcg =1;};_fba ,_cce :=_agg .GetRuneMetrics (' ');
if !_cce {_fba ,_cce =_agg .GetCharMetrics (32);};if !_cce {_fba ,_ =_ee .DefaultFont ().GetRuneMetrics (' ');};_dbf :=_dgcg *((_fba .Wx *_dgce .FontSize +_dgce .Tc +_dgce .Tw )/_df );return _dbf ;};

// WriteToFile writes the redacted document to file specified by `outputPath`.
func (_ccbc *Redactor )WriteToFile (outputPath string )error {if _deea :=_ccbc ._gagf .WriteToFile (outputPath );_deea !=nil {return _e .Errorf ("\u0066\u0061\u0069l\u0065\u0064\u0020\u0074o\u0020\u0077\u0072\u0069\u0074\u0065\u0020t\u0068\u0065\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0066\u0069\u006c\u0065");
};return nil ;};func _gf (_gca *_f .TextMarkArray )int {_aea :=0;_abd :=_gca .Elements ();if _abd [0].Text =="\u0020"{_aea ++;};if _abd [_gca .Len ()-1].Text =="\u0020"{_aea ++;};return _aea ;};func _deg (_bcg []localSpanMarks )(map[string ][]localSpanMarks ,[]string ){_dbb :=make (map[string ][]localSpanMarks );
_ga :=[]string {};for _ ,_gce :=range _bcg {_dacd :=_gce ._ecf ;if _baa ,_cae :=_dbb [_dacd ];_cae {_dbb [_dacd ]=append (_baa ,_gce );}else {_dbb [_dacd ]=[]localSpanMarks {_gce };_ga =append (_ga ,_dacd );};};return _dbb ,_ga ;};func _cdd (_eeag *matchedIndex ,_defc [][]int )[]*matchedIndex {_fgaf :=[]*matchedIndex {};
_gecg :=_eeag ._fbf ;_bdc :=_gecg ;_ecdb :=_eeag ._cfg ;_gbee :=0;for _ ,_daf :=range _defc {_fca :=_daf [0]-_gecg ;if _gbee >=_fca {continue ;};_fbac :=_ecdb [_gbee :_fca ];_gaee :=&matchedIndex {_cfg :_fbac ,_fbf :_bdc ,_gaaa :_daf [0]};if len (_dg .TrimSpace (_fbac ))!=0{_fgaf =append (_fgaf ,_gaee );
};_gbee =_daf [1]-_gecg ;_bdc =_gecg +_gbee ;};_agcf :=_ecdb [_gbee :];_cead :=&matchedIndex {_cfg :_agcf ,_fbf :_bdc ,_gaaa :_eeag ._gaaa };if len (_dg .TrimSpace (_agcf ))!=0{_fgaf =append (_fgaf ,_cead );};return _fgaf ;};