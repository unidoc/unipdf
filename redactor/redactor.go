//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package redactor ;import (_f "errors";_a "fmt";_ea "github.com/unidoc/unipdf/v4/common";_da "github.com/unidoc/unipdf/v4/contentstream";_aa "github.com/unidoc/unipdf/v4/core";_ab "github.com/unidoc/unipdf/v4/creator";_dg "github.com/unidoc/unipdf/v4/extractor";
_bd "github.com/unidoc/unipdf/v4/model";_b "io";_ac "regexp";_c "slices";_d "sort";_bf "strings";);func _cgdaa (_gae []*matchedIndex )[]*targetMap {_bagc :=make (map[string ][][]int );_egdg :=[]*targetMap {};for _ ,_ccfb :=range _gae {_egeg :=_ccfb ._agaa ;
_geb :=[]int {_ccfb ._bccd ,_ccfb ._dab };if _dede ,_agcf :=_bagc [_egeg ];_agcf {_bagc [_egeg ]=append (_dede ,_geb );}else {_bagc [_egeg ]=[][]int {_geb };};};for _agcg ,_feg :=range _bagc {_febg :=&targetMap {_bfgb :_agcg ,_bge :_feg };_egdg =append (_egdg ,_febg );
};return _egdg ;};func _dbad (_ggb string ,_bbcb []localSpanMarks )([]placeHolders ,error ){_ge :="";_dega :=[]placeHolders {};for _afd ,_aed :=range _bbcb {_cfd :=_aed ._gcde ;_afgd :=_aed ._ccf ;_fgd :=_dgda (_cfd );_bcb ,_bdcb :=_dcge (_cfd );if _bdcb !=nil {return nil ,_bdcb ;
};if _fgd !=_ge {var _egg []int ;if _afd ==0&&_afgd !=_fgd {_bead :=_bf .Index (_ggb ,_fgd );_egg =[]int {_bead };}else if _afd ==len (_bbcb )-1{_dbb :=_bf .LastIndex (_ggb ,_fgd );_egg =[]int {_dbb };}else {_egg =_bbfa (_ggb ,_fgd );};_cgd :=placeHolders {_dc :_egg ,_cf :_fgd ,_ad :_bcb };
_dega =append (_dega ,_cgd );};_ge =_fgd ;};return _dega ,nil ;};type matchedBBox struct{_fcb _bd .PdfRectangle ;_baae string ;};func _eg (_abc *_da .ContentStreamOperation ,_eaa _aa .PdfObject ,_cbd []localSpanMarks )error {_dfg ,_gf :=_aa .GetArray (_abc .Params [0]);
_bde :=[]_aa .PdfObject {};if !_gf {_ea .Log .Debug ("\u0045\u0052\u0052OR\u003a\u0020\u0054\u004a\u0020\u006f\u0070\u003d\u0025s\u0020G\u0065t\u0041r\u0072\u0061\u0079\u0056\u0061\u006c\u0020\u0066\u0061\u0069\u006c\u0065\u0064",_abc );return _a .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_abc );
};_ce ,_abb :=_cfg (_cbd );if len (_abb )==1{_gd :=_abb [0];_fda :=_ce [_gd ];if len (_fda )==1{_agf :=_fda [0];_dcg :=_agf ._gcde ;_aca :=_eea (_dcg );_ege ,_cbe :=_eabf (_eaa ,_aca );if _cbe !=nil {return _cbe ;};_cgc ,_cbe :=_gfa (_agf ,_dcg ,_aca ,_ege ,_gd );
if _cbe !=nil {return _cbe ;};for _ ,_gg :=range _dfg .Elements (){if _gg ==_eaa {_bde =append (_bde ,_cgc ...);}else {_bde =append (_bde ,_gg );};};}else {_gdd :=_fda [0]._gcde ;_ff :=_eea (_gdd );_ead ,_bab :=_eabf (_eaa ,_ff );if _bab !=nil {return _bab ;
};_egb ,_bab :=_dbad (_ead ,_fda );if _bab !=nil {return _bab ;};_gfd :=_add (_egb );_eadf :=_eaed (_ead ,_gfd ,_ff );for _ ,_ca :=range _dfg .Elements (){if _ca ==_eaa {_bde =append (_bde ,_eadf ...);}else {_bde =append (_bde ,_ca );};};};_abc .Params [0]=_aa .MakeArray (_bde ...);
}else if len (_abb )> 1{_bff :=_cbd [0];_bg :=_bff ._gcde ;_ ,_dcd :=_ef (_bg );_gfe :=_bg .Elements ()[_dcd ];_bdb :=_gfe .Font ;_acac ,_dgd :=_eabf (_eaa ,_bdb );if _dgd !=nil {return _dgd ;};_egbg ,_dgd :=_dbad (_acac ,_cbd );if _dgd !=nil {return _dgd ;
};_bdc :=_add (_egbg );_ecc :=_eaed (_acac ,_bdc ,_bdb );for _ ,_egf :=range _dfg .Elements (){if _egf ==_eaa {_bde =append (_bde ,_ecc ...);}else {_bde =append (_bde ,_egf );};};_abc .Params [0]=_aa .MakeArray (_bde ...);};return nil ;};var StandardRegexPatterns =[]string {RegexSSN ,RegexCreditCard ,RegexEmail ,RegexPhone ,RegexIPv4 ,RegexIPv6 ,RegexPassport ,RegexDriversLicense ,RegexDate ,RegexPostalCode ,RegexMAC ,RegexBankRouting ,RegexIBAN ,RegexAWSAccessKeyID ,RegexAWSSecretAccessKey ,RegexGoogleAPIKey ,RegexJWT ,RegexCardExpirationDate ,RegexSWIFTCode ,RegexStripeAPIKey };
func _dda (_ddc *_bd .PdfFont ,_dgf _dg .TextMark )float64 {_cgg :=0.001;_cee :=_dgf .Th /100;if _ddc .Subtype ()=="\u0054\u0079\u0070e\u0033"{_cgg =1;};_fb ,_de :=_ddc .GetRuneMetrics (' ');if !_de {_fb ,_de =_ddc .GetCharMetrics (32);};if !_de {_fb ,_ =_bd .DefaultFont ().GetRuneMetrics (' ');
};_dbc :=_cgg *((_fb .Wx *_dgf .FontSize +_dgf .Tc +_dgf .Tw )/_cee );return _dbc ;};func _afee (_cdab []*targetMap ){for _aedg ,_aaa :=range _cdab {for _bdbf ,_cfgg :=range _cdab {if _aedg !=_bdbf {_cgda ,_ggba :=_gab (*_aaa ,*_cfgg );if _cgda {_fga (_cfgg ,_ggba );
};};};};};func _ffac (_gddd *_dg .TextMarkArray ,_fdeb int )int {_fba :=_gddd .Elements ();_gbd :=_fdeb -1;_agd :=_fdeb +1;_faa :=-1;if _gbd >=0{_ccfe :=_fba [_gbd ];_fdfg :=_ccfe .ObjString ;_ggeb :=len (_fdfg );_babg :=_ccfe .Index ;if _babg +1< _ggeb {_faa =_gbd ;
return _faa ;};};if _agd < len (_fba ){_dace :=_fba [_agd ];_ebbe :=_dace .ObjString ;if _ebbe [0]!=_dace .Text {_faa =_agd ;return _faa ;};};return _faa ;};

// Redactor represents a Redactor object.
type Redactor struct{_ebab *_bd .PdfReader ;_dgc *RedactionOptions ;_bege *_ab .Creator ;_egbgg *RectangleProps ;_ddeb []RedactionTerm ;};func _cfe (_gad string ,_fc *_bd .PdfFont )[]byte {_aad ,_cc :=_fc .StringToCharcodeBytes (_gad );if _cc !=0{_ea .Log .Debug ("\u0057\u0041\u0052\u004e\u003a\u0020\u0073\u006fm\u0065\u0020\u0072un\u0065\u0073\u0020\u0063\u006f\u0075l\u0064\u0020\u006e\u006f\u0074\u0020\u0062\u0065\u0020\u0065\u006e\u0063\u006f\u0064\u0065d\u002e\u000a\u0009\u0025\u0073\u0020\u002d\u003e \u0025\u0076",_gad ,_aad );
};return _aad ;};func _eea (_acc *_dg .TextMarkArray )*_bd .PdfFont {_ ,_afe :=_ef (_acc );_baaa :=_acc .Elements ()[_afe ];_bc :=_baaa .Font ;return _bc ;};func _bfd (_dce *_da .ContentStreamOperations ,_eed string ,_ae int )error {_dcf :=_da .ContentStreamOperations {};
var _g _da .ContentStreamOperation ;for _af ,_ag :=range *_dce {if _af ==_ae {if _eed =="\u0027"{_dad :=_da .ContentStreamOperation {Operand :"\u0054\u002a"};_dcf =append (_dcf ,&_dad );_g .Params =_ag .Params ;_g .Operand ="\u0054\u006a";_dcf =append (_dcf ,&_g );
}else if _eed =="\u0022"{_bb :=_ag .Params [:2];Tc ,Tw :=_bb [0],_bb [1];_abde :=_da .ContentStreamOperation {Params :[]_aa .PdfObject {Tc },Operand :"\u0054\u0063"};_dcf =append (_dcf ,&_abde );_abde =_da .ContentStreamOperation {Params :[]_aa .PdfObject {Tw },Operand :"\u0054\u0077"};
_dcf =append (_dcf ,&_abde );_g .Params =[]_aa .PdfObject {_ag .Params [2]};_g .Operand ="\u0054\u006a";_dcf =append (_dcf ,&_g );};};_dcf =append (_dcf ,_ag );};*_dce =_dcf ;return nil ;};func _ed (_cb *_dg .TextMarkArray )int {_db :=0;_dde :=_cb .Elements ();
if _dde [0].Text =="\u0020"{_db ++;};if _dde [_cb .Len ()-1].Text =="\u0020"{_db ++;};return _db ;};type matchedIndex struct{_bccd int ;_dab int ;_agaa string ;};func _gab (_dae ,_efee targetMap )(bool ,[]int ){_cde :=_bf .Contains (_dae ._bfgb ,_efee ._bfgb );
var _eafe []int ;for _ ,_aaec :=range _dae ._bge {for _fbgdd ,_daf :=range _efee ._bge {if _daf [0]>=_aaec [0]&&_daf [1]<=_aaec [1]{_eafe =append (_eafe ,_fbgdd );};};};return _cde ,_eafe ;};func _ef (_dbe *_dg .TextMarkArray )(_aa .PdfObject ,int ){var _baa _aa .PdfObject ;
_agc :=-1;for _aef ,_bbc :=range _dbe .Elements (){_baa =_bbc .DirectObject ;_agc =_aef ;if _baa !=nil {break ;};};return _baa ,_agc ;};func _gbg (_cecg RedactionTerm )(*regexMatcher ,error ){return &regexMatcher {_efbd :_cecg },nil };func _eabf (_bdbg _aa .PdfObject ,_ffda *_bd .PdfFont )(string ,error ){_cac ,_acae :=_aa .GetStringBytes (_bdbg );
if !_acae {return "",_aa .ErrTypeError ;};_bfe :=_ffda .BytesToCharcodes (_cac );_gcg ,_gda ,_gge :=_ffda .CharcodesToStrings (_bfe ,"");if _gge > 0{_ea .Log .Debug ("\u0072\u0065nd\u0065\u0072\u0054e\u0078\u0074\u003a\u0020num\u0043ha\u0072\u0073\u003d\u0025\u0064\u0020\u006eum\u004d\u0069\u0073\u0073\u0065\u0073\u003d%\u0064",_gda ,_gge );
};_bbg :=_bf .Join (_gcg ,"");return _bbg ,nil ;};

// RedactionTerm holds the regexp pattern and the replacement string for the redaction process.
type RedactionTerm struct{Pattern *_ac .Regexp ;};func _ffc (_bdcg *matchedIndex ,_cbff [][]int )[]*matchedIndex {_egcc :=[]*matchedIndex {};_egfc :=_bdcg ._bccd ;_gdf :=_egfc ;_efb :=_bdcg ._agaa ;_gbe :=0;for _ ,_dgde :=range _cbff {_fef :=_dgde [0]-_egfc ;
if _gbe >=_fef {continue ;};_aee :=_efb [_gbe :_fef ];_bccdd :=&matchedIndex {_agaa :_aee ,_bccd :_gdf ,_dab :_dgde [0]};if len (_bf .TrimSpace (_aee ))!=0{_egcc =append (_egcc ,_bccdd );};_gbe =_dgde [1]-_egfc ;_gdf =_egfc +_gbe ;};_dgfb :=_efb [_gbe :];
_dbg :=&matchedIndex {_agaa :_dgfb ,_bccd :_gdf ,_dab :_bdcg ._dab };if len (_bf .TrimSpace (_dgfb ))!=0{_egcc =append (_egcc ,_dbg );};return _egcc ;};func _add (_dadg []placeHolders )[]replacement {_bae :=[]replacement {};for _ ,_edd :=range _dadg {_aeac :=_edd ._dc ;
_bdfa :=_edd ._cf ;_fgg :=_edd ._ad ;for _ ,_abfc :=range _aeac {_cdfe :=replacement {_bdf :_bdfa ,_abd :_fgg ,_be :_abfc };_bae =append (_bae ,_cdfe );};};_d .Slice (_bae ,func (_aff ,_ddf int )bool {return _bae [_aff ]._be < _bae [_ddf ]._be });return _bae ;
};

// Redact executes the redact operation on a pdf file and updates the content streams of all pages of the file.
func (_gcgb *Redactor )Redact ()error {_ebfg ,_gee :=_gcgb ._ebab .GetNumPages ();if _gee !=nil {return _a .Errorf ("\u0066\u0061\u0069\u006c\u0065\u0064 \u0074\u006f\u0020\u0067\u0065\u0074\u0020\u0074\u0068\u0065\u0020\u006e\u0075m\u0062\u0065\u0072\u0020\u006f\u0066\u0020P\u0061\u0067\u0065\u0073");
};if _gcgb ._dgc .UseStandardPatterns {for _ ,_cdga :=range StandardRegexPatterns {_daba ,_bdca :=_ac .Compile (_cdga );if _bdca !=nil {return _bdca ;};_gcgb ._ddeb =append (_gcgb ._ddeb ,RedactionTerm {Pattern :_daba });};};_fdd :=_gcgb ._egbgg .FillColor ;
_bba :=_gcgb ._egbgg .BorderWidth ;_bdcag :=_gcgb ._egbgg .FillOpacity ;for _gdaa :=1;_gdaa <=_ebfg ;_gdaa ++{_ged ,_bgdg :=_gcgb ._ebab .GetPage (_gdaa );if _bgdg !=nil {return _bgdg ;};_egc ,_bgdg :=_dg .New (_ged );if _bgdg !=nil {return _bgdg ;};_gdca ,_ ,_ ,_bgdg :=_egc .ExtractPageText ();
if _bgdg !=nil {return _bgdg ;};_ada :=_gdca .GetContentStreamOps ();_eggg ,_fa ,_bgdg :=_gcgb .redactPage (_ada ,_ged .Resources );if _fa ==nil {_ea .Log .Info ("N\u006f\u0020\u006d\u0061\u0074\u0063\u0068\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0066\u006f\u0072\u0020t\u0068\u0065\u0020\u0070\u0072\u006f\u0076\u0069\u0064\u0065d \u0070\u0061\u0074t\u0061r\u006e\u002e");
_fa =_ada ;};_cbge :=_da .ContentStreamOperation {Operand :"\u006e"};*_fa =append (*_fa ,&_cbge );_ged .SetContentStreams ([]string {_fa .String ()},_aa .NewFlateEncoder ());if _bgdg !=nil {return _bgdg ;};_fae ,_bgdg :=_ged .GetMediaBox ();if _bgdg !=nil {return _bgdg ;
};if _ged .MediaBox ==nil {_ged .MediaBox =_fae ;};if _gedd :=_gcgb ._bege .AddPage (_ged );_gedd !=nil {return _gedd ;};_d .Slice (_eggg ,func (_adf ,_cdb int )bool {return _eggg [_adf ]._baae < _eggg [_cdb ]._baae });_dgbb :=_fae .Ury ;for _ ,_dbcg :=range _eggg {_fdc :=_dbcg ._fcb ;
_afa :=_gcgb ._bege .NewRectangle (_fdc .Llx ,_dgbb -_fdc .Lly ,_fdc .Urx -_fdc .Llx ,-(_fdc .Ury -_fdc .Lly ));_afa .SetFillColor (_fdd );_afa .SetBorderWidth (_bba );_afa .SetFillOpacity (_bdcag );if _aaf :=_gcgb ._bege .Draw (_afa );_aaf !=nil {return nil ;
};};};_gcgb ._bege .SetOutlineTree (_gcgb ._ebab .GetOutlineTree ());return nil ;};func _dgda (_cecf *_dg .TextMarkArray )string {_gca :="";for _ ,_fbgd :=range _cecf .Elements (){_gca +=_fbgd .Text ;};return _gca ;};func _dcge (_aae *_dg .TextMarkArray )(float64 ,error ){_cccd ,_ebb :=_aae .BBox ();
if !_ebb {return 0.0,_a .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_aae );
};_ffg :=_ed (_aae );_bbcd :=0.0;_ ,_dfd :=_ef (_aae );_dff :=_aae .Elements ()[_dfd ];_dbd :=_dff .Font ;if _ffg > 0{_bbcd =_dda (_dbd ,_dff );};_ffgc :=(_cccd .Urx -_cccd .Llx );_ffgc =_ffgc +_bbcd *float64 (_ffg );Tj :=_dea (_ffgc ,_dff .FontSize ,_dff .Th );
return Tj ,nil ;};func _gfa (_gfeb localSpanMarks ,_ced *_dg .TextMarkArray ,_dfga *_bd .PdfFont ,_gcd ,_ddcb string )([]_aa .PdfObject ,error ){_cgb :=_dgda (_ced );Tj ,_ebd :=_dcge (_ced );if _ebd !=nil {return nil ,_ebd ;};_bgfa :=len (_gcd );_dgb :=len (_cgb );
_afg :=-1;_ece :=_aa .MakeFloat (Tj );if _cgb !=_ddcb {_fbg :=_gfeb ._abe ;if _fbg ==0{_afg =_bf .LastIndex (_gcd ,_cgb );}else {_afg =_bf .Index (_gcd ,_cgb );};}else {_afg =_bf .Index (_gcd ,_cgb );};_bdce :=_afg +_dgb ;_gff :=[]_aa .PdfObject {};if _afg ==0&&_bdce ==_bgfa {_gff =append (_gff ,_ece );
}else if _afg ==0&&_bdce < _bgfa {_deg :=_cfe (_gcd [_bdce :],_dfga );_eedc :=_aa .MakeStringFromBytes (_deg );_gff =append (_gff ,_ece ,_eedc );}else if _afg > 0&&_bdce >=_bgfa {_aga :=_cfe (_gcd [:_afg ],_dfga );_aab :=_aa .MakeStringFromBytes (_aga );
_gff =append (_gff ,_aab ,_ece );}else if _afg > 0&&_bdce < _bgfa {_fg :=_cfe (_gcd [:_afg ],_dfga );_cdf :=_cfe (_gcd [_bdce :],_dfga );_ccc :=_aa .MakeStringFromBytes (_fg );_cbf :=_aa .MakeString (string (_cdf ));_gff =append (_gff ,_ccc ,_ece ,_cbf );
};return _gff ,nil ;};type localSpanMarks struct{_gcde *_dg .TextMarkArray ;_abe int ;_ccf string ;};func _ffb (_ecf *_da .ContentStreamOperation ,_gc _aa .PdfObject ,_ebf []localSpanMarks )error {var _bgf *_aa .PdfObjectArray ;_cbac ,_bdbb :=_cfg (_ebf );
if len (_bdbb )==1{_ded :=_bdbb [0];_babe :=_cbac [_ded ];if len (_babe )==1{_edc :=_babe [0];_aefa :=_edc ._gcde ;_aea :=_eea (_aefa );_cec ,_fdf :=_eabf (_gc ,_aea );if _fdf !=nil {return _fdf ;};_eae ,_fdf :=_gfa (_edc ,_aefa ,_aea ,_cec ,_ded );if _fdf !=nil {return _fdf ;
};_bgf =_aa .MakeArray (_eae ...);}else {_cfef :=_babe [0]._gcde ;_efe :=_eea (_cfef );_bea ,_fdaa :=_eabf (_gc ,_efe );if _fdaa !=nil {return _fdaa ;};_bag ,_fdaa :=_dbad (_bea ,_babe );if _fdaa !=nil {return _fdaa ;};_aba :=_add (_bag );_gac :=_eaed (_bea ,_aba ,_efe );
_bgf =_aa .MakeArray (_gac ...);};}else if len (_bdbb )> 1{_gdc :=_ebf [0];_fbc :=_gdc ._gcde ;_ ,_adb :=_ef (_fbc );_ddb :=_fbc .Elements ()[_adb ];_aag :=_ddb .Font ;_bfg ,_fcc :=_eabf (_gc ,_aag );if _fcc !=nil {return _fcc ;};_bbe ,_fcc :=_dbad (_bfg ,_ebf );
if _fcc !=nil {return _fcc ;};_cbg :=_add (_bbe );_dbf :=_eaed (_bfg ,_cbg ,_aag );_bgf =_aa .MakeArray (_dbf ...);};_ecf .Params [0]=_bgf ;_ecf .Operand ="\u0054\u004a";return nil ;};func _cfg (_egd []localSpanMarks )(map[string ][]localSpanMarks ,[]string ){_dba :=make (map[string ][]localSpanMarks );
_cba :=[]string {};for _ ,_bdg :=range _egd {_cd :=_bdg ._ccf ;if _bgd ,_eb :=_dba [_cd ];_eb {_dba [_cd ]=append (_bgd ,_bdg );}else {_dba [_cd ]=[]localSpanMarks {_bdg };_cba =append (_cba ,_cd );};};return _dba ,_cba ;};func _bbfa (_aaea ,_bed string )[]int {if len (_bed )==0{return nil ;
};var _cgf []int ;for _dca :=0;_dca < len (_aaea );{_fbd :=_bf .Index (_aaea [_dca :],_bed );if _fbd < 0{return _cgf ;};_cgf =append (_cgf ,_dca +_fbd );_dca +=_fbd +len (_bed );};return _cgf ;};

// RedactRectanglePropsNew return a new pointer to a default RectangleProps object.
func RedactRectanglePropsNew ()*RectangleProps {return &RectangleProps {FillColor :_ab .ColorBlack ,BorderWidth :0.0,FillOpacity :1.0};};type regexMatcher struct{_efbd RedactionTerm };func _abca (_ebg []int ,_ddeg *_dg .TextMarkArray ,_ccb string )(*_dg .TextMarkArray ,matchedBBox ,error ){_eede :=matchedBBox {};
_afgde :=_ebg [0];_cdgc :=_ebg [1];_dade :=len (_ccb )-len (_bf .TrimLeft (_ccb ,"\u0020"));_gec :=len (_ccb )-len (_bf .TrimRight (_ccb ,"\u0020\u000a"));_afgde =_afgde +_dade ;_cdgc =_cdgc -_gec ;_ccb =_bf .Trim (_ccb ,"\u0020\u000a");_fgdc ,_eec :=_ddeg .RangeOffset (_afgde ,_cdgc );
if _eec !=nil {return nil ,_eede ,_eec ;};_fbge ,_adg :=_fgdc .BBox ();if !_adg {return nil ,_eede ,_a .Errorf ("\u0073\u0070\u0061\u006e\u004d\u0061\u0072\u006bs\u002e\u0042\u0042ox\u0020\u0068\u0061\u0073\u0020\u006eo\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062\u006f\u0078\u002e\u0020s\u0070\u0061\u006e\u004d\u0061\u0072\u006b\u0073=\u0025\u0073",_fgdc );
};_eede =matchedBBox {_baae :_ccb ,_fcb :_fbge };return _fgdc ,_eede ,nil ;};

// Write writes the content of `re.creator` to writer of type io.Writer interface.
func (_dcdg *Redactor )Write (writer _b .Writer )error {return _dcdg ._bege .Write (writer )};type targetMap struct{_bfgb string ;_bge [][]int ;};

// RectangleProps defines properties of the redaction rectangle to be drawn.
type RectangleProps struct{FillColor _ab .Color ;BorderWidth float64 ;FillOpacity float64 ;};func _eaed (_beaa string ,_ceef []replacement ,_fde *_bd .PdfFont )[]_aa .PdfObject {_gbf :=[]_aa .PdfObject {};_cfff :=0;_fbca :=_beaa ;for _bcc ,_bbf :=range _ceef {_bef :=_bbf ._be ;
_ffd :=_bbf ._abd ;_ceg :=_bbf ._bdf ;_ddd :=_aa .MakeFloat (_ffd );if _cfff > _bef ||_bef ==-1{continue ;};_befe :=_beaa [_cfff :_bef ];_cfb :=_cfe (_befe ,_fde );_ebfb :=_aa .MakeStringFromBytes (_cfb );_gbf =append (_gbf ,_ebfb );_gbf =append (_gbf ,_ddd );
_dbea :=_bef +len (_ceg );_fbca =_beaa [_dbea :];_cfff =_dbea ;if _bcc ==len (_ceef )-1{_cfb =_cfe (_fbca ,_fde );_ebfb =_aa .MakeStringFromBytes (_cfb );_gbf =append (_gbf ,_ebfb );};};return _gbf ;};type placeHolders struct{_dc []int ;_cf string ;_ad float64 ;
};func _fga (_gfc *targetMap ,_cdaf []int ){var _dac [][]int ;for _cecd ,_bec :=range _gfc ._bge {if _c .Contains (_cdaf ,_cecd ){continue ;};_dac =append (_dac ,_bec );};_gfc ._bge =_dac ;};

// WriteToFile writes the redacted document to file specified by `outputPath`.
func (_ffgg *Redactor )WriteToFile (outputPath string )error {if _dabf :=_ffgg ._bege .WriteToFile (outputPath );_dabf !=nil {return _a .Errorf ("\u0066\u0061\u0069l\u0065\u0064\u0020\u0074o\u0020\u0077\u0072\u0069\u0074\u0065\u0020t\u0068\u0065\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0066\u0069\u006c\u0065");
};return nil ;};func _gfbc (_gdgd *_dg .TextMarkArray )[]*_dg .TextMarkArray {_gaad :=_gdgd .Elements ();_abaf :=len (_gaad );var _deaf _aa .PdfObject ;_cgca :=[]*_dg .TextMarkArray {};_gafe :=&_dg .TextMarkArray {};_agb :=-1;for _gddc ,_aagd :=range _gaad {_ffad :=_aagd .DirectObject ;
_agb =_aagd .Index ;if _ffad ==nil {_eeca :=_ffac (_gdgd ,_gddc );if _deaf !=nil {if _eeca ==-1||_eeca > _gddc {_cgca =append (_cgca ,_gafe );_gafe =&_dg .TextMarkArray {};};};}else if _deaf ==nil {if _agb ==0&&_gddc > 0{_cgca =append (_cgca ,_gafe );_gafe =&_dg .TextMarkArray {};
};}else {if _ffad !=_deaf {_cgca =append (_cgca ,_gafe );_gafe =&_dg .TextMarkArray {};};};_deaf =_ffad ;_gafe .Append (_aagd );if _gddc ==(_abaf -1){_cgca =append (_cgca ,_gafe );};};return _cgca ;};func _dd (_ec *_da .ContentStreamOperations ,_abf map[_aa .PdfObject ][]localSpanMarks )error {for _ba ,_eab :=range _abf {if _ba ==nil {continue ;
};_df ,_cg ,_eaf :=_dfa (_ec ,_ba );if !_eaf {_ea .Log .Debug ("Pd\u0066\u004fb\u006a\u0065\u0063\u0074\u0020\u0025\u0073\u006e\u006ft\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0069\u006e\u0020\u0073\u0069\u0064\u0065\u0020\u0074\u0068\u0065\u0020\u0063\u006f\u006e\u0074\u0065\u006e\u0074\u0073\u0074r\u0065a\u006d\u0020\u006f\u0070\u0065\u0072\u0061\u0074i\u006fn\u0020\u0025s",_ba ,_ec );
return nil ;};if _df .Operand =="\u0054\u006a"{_fd :=_ffb (_df ,_ba ,_eab );if _fd !=nil {return _fd ;};}else if _df .Operand =="\u0054\u004a"{_cff :=_eg (_df ,_ba ,_eab );if _cff !=nil {return _cff ;};}else if _df .Operand =="\u0027"||_df .Operand =="\u0022"{_ee :=_bfd (_ec ,_df .Operand ,_cg );
if _ee !=nil {return _ee ;};_ee =_ffb (_df ,_ba ,_eab );if _ee !=nil {return _ee ;};};};return nil ;};

// RedactionOptions is a collection of RedactionTerm objects.
type RedactionOptions struct{Terms []RedactionTerm ;UseStandardPatterns bool ;};func _aeag (_dge []*matchedIndex ,_fdg [][]int )[]*matchedIndex {_gdad :=[]*matchedIndex {};for _ ,_cbfe :=range _dge {_ccd ,_abbg :=_cdc (_cbfe ,_fdg );if _ccd {_bagb :=_ffc (_cbfe ,_abbg );
_gdad =append (_gdad ,_bagb ...);}else {_gdad =append (_gdad ,_cbfe );};};return _gdad ;};

// New instantiates a Redactor object with given PdfReader and `regex` pattern.
func New (reader *_bd .PdfReader ,opts *RedactionOptions ,rectProps *RectangleProps )*Redactor {if rectProps ==nil {rectProps =RedactRectanglePropsNew ();};return &Redactor {_ebab :reader ,_dgc :opts ,_bege :_ab .New (),_egbgg :rectProps };};type replacement struct{_bdf string ;
_abd float64 ;_be int ;};func _addc (_cdfg string )(string ,[][]int ){_ega :=_ac .MustCompile ("\u005c\u006e");_edb :=_ega .FindAllStringIndex (_cdfg ,-1);_aadb :=_ega .ReplaceAllString (_cdfg ,"\u0020");return _aadb ,_edb ;};func (_gcf *regexMatcher )match (_bcbe string )([]*matchedIndex ,error ){_adc :=_gcf ._efbd .Pattern ;
if _adc ==nil {return nil ,_f .New ("\u006e\u006f\u0020\u0070at\u0074\u0065\u0072\u006e\u0020\u0063\u006f\u006d\u0070\u0069\u006c\u0065\u0064");};var (_def =_adc .FindAllStringIndex (_bcbe ,-1);_ccfd []*matchedIndex ;);for _ ,_gdgf :=range _def {_ccfd =append (_ccfd ,&matchedIndex {_bccd :_gdgf [0],_dab :_gdgf [1],_agaa :_bcbe [_gdgf [0]:_gdgf [1]]});
};return _ccfd ,nil ;};const (RegexSSN ="\u0028?\u0069\u0029\u005c\u0062\\\u0064\u007b\u0033\u007d\u002d\\\u0064{\u0032}\u002d\u005c\u0064\u007b\u0034\u007d\u005cb";RegexCreditCard ="\u005c\u0062\u0028?:\u005c\u0064\u005b\u0020\u002d\u005d\u002a\u003f\u0029\u007b\u0031\u0033\u002c\u0031\u0036\u007d\u005c\u0062";
RegexEmail ="\u005c\u0062\u005b\u0041\u002d\u005a\u0061\u002d\u007a\u0030\u002d\u0039\u002e\u005f\u0025\u002b\u002d\u005d+\u0040\u005b\u0041\u002d\u005a\u0061\u002dz\u0030\u002d\u0039\u002e\u002d\u005d\u002b\u005c\u002e\u005b\u0041-\u005a\u0061\u002d\u007a\u005d\u007b\u0032\u002c\u007d\u005c\u0062";
RegexPhone ="\u0028\u003f\u003a\u005c\u002b\u0031\u005b\u002d\u002e\u005c\u0073\u005d\u003f\u0029\u003f\u005c\u0028\u003f\\\u0064\u007b\u0033\u007d\u005c\u0029\u003f[\u002d\u002e\u005c\u0073\u005d\u003f\u005c\u0064\u007b\u0033\u007d[\u002d\u002e\u005c\u0073\u005d\u003f\u005c\u0064\u007b\u0034\u007d";
RegexIPv4 ="\u005c\u0062\u0028\u003f\u003a\u0028\u003f\u003a\u0032\u0035\u005b\u0030\u002d5\u005d\u007c\u0032\u005b\u0030\u002d\u0034\u005d\u005cd\u007c\u0031\u005c\u0064\u007b\u0032\u007d\u007c\u005b\u0031\u002d\u0039\u005d\u003f\\\u0064\u0029\u005c\u002e\u0029\u007b\u0033\u007d\u0028\u003f\u003a\u0032\u0035\u005b\u0030\u002d\u0035\u005d\u007c\u0032\u005b\u0030\u002d\u0034\u005d\u005c\u0064\u007c\u0031\u005cd\u007b\u0032\u007d\u007c\u005b\u0031\u002d\u0039\u005d?\u005c\u0064)\u005c\u0062";
RegexIPv6 ="\u005c\u0062\u0028[\u0030\u002d\u0039\u0061\u002d\u0066\u0041\u002d\u0046\u005d\u007b\u0031\u002c\u0034\u007d\u003a\u0029\u007b\u0037\u007d\u005b\u0030\u002d\u0039\u0061\u002d\u0066\u0041\u002dF\u005d\u007b\u0031\u002c\u0034\u007d\u005c\u0062";
RegexPassport ="\u005c\u0062\u005b\u0041\u002d\u005a\u0030\u002d\u0039\u005d\u007b\u0036,\u0039\u007d\u005c\u0062";RegexDriversLicense ="\u005cb\u005bA\u002d\u005a\u0030\u002d\u0039]\u007b\u0035,\u0031\u0035\u007d\u005c\u0062";RegexDate ="\u005cb\u0028\u003f\u003a\u005c\u0064\u007b\u0031,2\u007d\u005b\u002f\u002e\u002d\u005d\u005c\u0064\u007b\u0031\u002c\u0032\u007d\u005b/\u002e\u002d]\u005c\u0064\u007b2\u002c\u0034\u007d\u007c\u005c\u0064\u007b\u0034\u007d\u005b\u002d\u002f\u005d\u005c\u0064\u007b2\u007d\u005b-/\u005d\u005c\u0064{\u0032\u007d\u0029\u005c\u0062";
RegexPostalCode ="\\\u0062\\\u0064\u007b\u0035\u007d\u0028\u003f\u003a\u002d\\\u0064\u007b\u0034\u007d)?\u005c\u0062";RegexMAC ="\u005c\u0062\u0028\u003f\u003a\u005b\u0030-\u0039\u0041\u002dF\u0061\u002d\u0066\u005d{\u0032\u007d\u005b\u003a\u002d\u005d\u0029\u007b\u0035\u007d\u005b\u0030\u002d\u0039\u0041\u002d\u0046\u0061\u002d\u0066\u005d\u007b\u0032\u007d\u005c\u0062";
RegexBankRouting ="\u005cb\u005c\u0064\u007b\u0039\u007d\u005cb";RegexIBAN ="\u005c\u0062\u005b\u0041\u002d\u005a\u005d\u007b\u0032\u007d\u005c\u0064\u007b\u0032\u007d[\u0041-\u005a\u0030\u002d\u0039\u005d\u007b\u0031\u0031\u002c\u0033\u0030\u007d\u005c\u0062";
RegexAWSAccessKeyID ="\\\u0062A\u004b\u0049\u0041\u005b\u0030\u002d\u0039\u0041-\u005a\u005d\u007b\u00316}\u005c\u0062";RegexAWSSecretAccessKey ="\\\u0062\u005b\u0030\u002d9a\u002dz\u0041\u002d\u005a\u002f\u002b]\u007b\u0034\u0030\u007d\u005c\u0062";RegexGoogleAPIKey ="\u005c\u0062\u0041\u0049\u007a\u0061\u005b\u0030\u002d\u0039\u0041-\u005a\u0061\u002d\u007a\u005c\u002d\u005f\u005d\u007b\u00335\u007d\u005c\u0062";
RegexJWT ="\\b\u0065\u0079J\u005b\u0041\u002d\u005a\u0061\u002d\u007a\u0030\u002d9\u005f\u005c\u002d\u005d\u002b\u005c\u002e\u0065\u0079\u004a\u005b\u0041\u002d\u005a\u0061\u002d\u007a\u0030\u002d\u0039\u005f\u005c\u002d\u005d\u002b\u005c\u002e\u003f[\u0041-\u005a\u0061\u002d\u007a\u0030\u002d\u0039\u005f\\\u002d]\u002a\u005cb";
RegexCardExpirationDate ="\\\u0062\u0028\u0030\u005b\u0031\u002d9\u005d\u007c\u0031\u005b\u0030\u002d2\u005d\u0029\u002f\u0028\u003f\u003a\u005cd\u007b\u0032\u007d\u007c\u005c\u0064\u007b\u0034\u007d\u0029\\\u0062";RegexSWIFTCode ="\u005cb\u005b\u0041-\u005a\u005d\u007b4\u007d\u005b\u0041\u002d\u005a\u005d\u007b2\u007d\u005b\u0041\u002d\u005a\u0030-\u0039\u005d\u007b\u0032\u007d\u0028\u005b\u0041\u002d\u005a\u0030-\u0039\u005d\u007b\u0033\u007d\u0029\u003f\u005c\u0062";
RegexStripeAPIKey ="\u0073\u006b\u005fli\u0076\u0065\u005f\u005b\u0030\u002d\u0039\u0061\u002d\u007a\u0041\u002d\u005a\u005d\u007b\u0032\u0034\u007d";);func _dea (_fccg ,_bga ,_feb float64 )float64 {_feb =_feb /100;_ggg :=(-1000*_fccg )/(_bga *_feb );return _ggg ;
};func _dfa (_bfgg *_da .ContentStreamOperations ,PdfObj _aa .PdfObject )(*_da .ContentStreamOperation ,int ,bool ){for _eba ,_bac :=range *_bfgg {_cdfc :=_bac .Operand ;if _cdfc =="\u0054\u006a"{_bce :=_aa .TraceToDirectObject (_bac .Params [0]);if _bce ==PdfObj {return _bac ,_eba ,true ;
};}else if _cdfc =="\u0054\u004a"{_eff ,_efd :=_aa .GetArray (_bac .Params [0]);if !_efd {return nil ,_eba ,_efd ;};for _ ,_beg :=range _eff .Elements (){if _beg ==PdfObj {return _bac ,_eba ,true ;};};}else if _cdfc =="\u0022"{_gfb :=_aa .TraceToDirectObject (_bac .Params [2]);
if _gfb ==PdfObj {return _bac ,_eba ,true ;};}else if _cdfc =="\u0027"{_gdb :=_aa .TraceToDirectObject (_bac .Params [0]);if _gdb ==PdfObj {return _bac ,_eba ,true ;};};};return nil ,-1,false ;};func (_eade *Redactor )redactPage (_bdd *_da .ContentStreamOperations ,_dfe *_bd .PdfPageResources )([]matchedBBox ,*_da .ContentStreamOperations ,error ){_aadd ,_aafd :=_dg .NewFromContents (_bdd .String (),_dfe );
if _aafd !=nil {return nil ,nil ,_aafd ;};_eee ,_ ,_ ,_aafd :=_aadd .ExtractPageText ();if _aafd !=nil {return nil ,nil ,_aafd ;};_bdd =_eee .GetContentStreamOps ();_bbaf :=_eee .Marks ();_bdge :=_eee .Text ();_bdge ,_dgg :=_addc (_bdge );_geg :=[]matchedBBox {};
_fdff :=make (map[_aa .PdfObject ][]localSpanMarks );_dec :=[]*targetMap {};_eedca :=_eade ._dgc .Terms ;if _eade ._dgc .UseStandardPatterns {_eedca =append (_eedca ,_eade ._ddeb ...);};for _ ,_ecef :=range _eedca {_acacc ,_agaaa :=_gbg (_ecef );if _agaaa !=nil {return nil ,nil ,_agaaa ;
};_gaf ,_agaaa :=_acacc .match (_bdge );if _agaaa !=nil {return nil ,nil ,_agaaa ;};_gaf =_aeag (_gaf ,_dgg );_bacc :=_cgdaa (_gaf );_dec =append (_dec ,_bacc ...);};_afee (_dec );for _ ,_bfa :=range _dec {_effe :=_bfa ._bfgb ;_bega :=_bfa ._bge ;_acd :=[]matchedBBox {};
for _ ,_cgde :=range _bega {_fff ,_dfc ,_cgdb :=_abca (_cgde ,_bbaf ,_effe );if _cgdb !=nil {return nil ,nil ,_cgdb ;};_ccg :=_gfbc (_fff );for _dedd ,_aada :=range _ccg {_abae :=localSpanMarks {_gcde :_aada ,_abe :_dedd ,_ccf :_effe };_afga ,_ :=_ef (_aada );
if _bddf ,_cda :=_fdff [_afga ];_cda {_fdff [_afga ]=append (_bddf ,_abae );}else {_fdff [_afga ]=[]localSpanMarks {_abae };};};_acd =append (_acd ,_dfc );};_geg =append (_geg ,_acd ...);};_aafd =_dd (_bdd ,_fdff );if _aafd !=nil {return nil ,nil ,_aafd ;
};return _geg ,_bdd ,nil ;};func _cdc (_dee *matchedIndex ,_dgfc [][]int )(bool ,[][]int ){_ddg :=[][]int {};for _ ,_abbf :=range _dgfc {if _dee ._bccd < _abbf [0]&&_dee ._dab > _abbf [1]{_ddg =append (_ddg ,_abbf );};};return len (_ddg )> 0,_ddg ;};