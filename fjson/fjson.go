//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

// Package fjson provides support for loading PDF form field data from JSON data/files.
package fjson ;import (_c "encoding/json";_fd "github.com/unidoc/unipdf/v4/common";_ca "github.com/unidoc/unipdf/v4/core";_d "github.com/unidoc/unipdf/v4/model";_b "io";_ce "os";);

// FieldImageValues implements model.FieldImageProvider interface.
func (_ge *FieldData )FieldImageValues ()(map[string ]*_d .Image ,error ){_gc :=make (map[string ]*_d .Image );for _ ,_ab :=range _ge ._a {if _ab .ImageValue !=nil {_gc [_ab .Name ]=_ab .ImageValue ;};};return _gc ,nil ;};

// JSON returns the field data as a string in JSON format.
func (_fcc FieldData )JSON ()(string ,error ){_cbe ,_cfa :=_c .MarshalIndent (_fcc ._a ,"","\u0020\u0020\u0020\u0020");return string (_cbe ),_cfa ;};

// LoadFromPDF loads form field data from a PDF.
func LoadFromPDF (rs _b .ReadSeeker )(*FieldData ,error ){_cf ,_fda :=_d .NewPdfReader (rs );if _fda !=nil {return nil ,_fda ;};if _cf .AcroForm ==nil {return nil ,nil ;};var _de []fieldValue ;_af :=_cf .AcroForm .AllFields ();for _ ,_cc :=range _af {var _cfe []string ;
_e :=make (map[string ]struct{});_dd ,_eb :=_cc .FullName ();if _eb !=nil {return nil ,_eb ;};if _fg ,_g :=_cc .V .(*_ca .PdfObjectString );_g {_de =append (_de ,fieldValue {Name :_dd ,Value :_fg .Decoded ()});continue ;};var _ga string ;for _ ,_fb :=range _cc .Annotations {_cgc ,_ag :=_ca .GetName (_fb .AS );
if _ag {_ga =_cgc .String ();};_dce ,_bg :=_ca .GetDict (_fb .AP );if !_bg {continue ;};_gaf ,_ :=_ca .GetDict (_dce .Get ("\u004e"));for _ ,_be :=range _gaf .Keys (){_afc :=_be .String ();if _ ,_cb :=_e [_afc ];!_cb {_cfe =append (_cfe ,_afc );_e [_afc ]=struct{}{};
};};_afg ,_ :=_ca .GetDict (_dce .Get ("\u0044"));for _ ,_gab :=range _afg .Keys (){_fa :=_gab .String ();if _ ,_ddb :=_e [_fa ];!_ddb {_cfe =append (_cfe ,_fa );_e [_fa ]=struct{}{};};};};_fdd :=fieldValue {Name :_dd ,Value :_ga ,Options :_cfe };_de =append (_de ,_fdd );
};_fac :=FieldData {_a :_de };return &_fac ,nil ;};type fieldValue struct{Name string `json:"name"`;Value string `json:"value"`;ImageValue *_d .Image `json:"-"`;

// Options lists allowed values if present.
Options []string `json:"options,omitempty"`;};

// SetImageFromFile assign image file to a specific field identified by fieldName.
func (_df *FieldData )SetImageFromFile (fieldName string ,imagePath string ,opt []string )error {_bec ,_afb :=_ce .Open (imagePath );if _afb !=nil {return _afb ;};defer _bec .Close ();_caf ,_afb :=_d .ImageHandling .Read (_bec );if _afb !=nil {_fd .Log .Error ("\u0045\u0072\u0072or\u0020\u006c\u006f\u0061\u0064\u0069\u006e\u0067\u0020\u0069\u006d\u0061\u0067\u0065\u003a\u0020\u0025\u0073",_afb );
return _afb ;};return _df .SetImage (fieldName ,_caf ,opt );};

// LoadFromJSONFile loads form field data from a JSON file.
func LoadFromJSONFile (filePath string )(*FieldData ,error ){_dg ,_dgc :=_ce .Open (filePath );if _dgc !=nil {return nil ,_dgc ;};defer _dg .Close ();return LoadFromJSON (_dg );};

// SetImage assign model.Image to a specific field identified by fieldName.
func (_ed *FieldData )SetImage (fieldName string ,img *_d .Image ,opt []string )error {_ea :=fieldValue {Name :fieldName ,ImageValue :img ,Options :opt };_ed ._a =append (_ed ._a ,_ea );return nil ;};

// LoadFromJSON loads JSON form data from `r`.
func LoadFromJSON (r _b .Reader )(*FieldData ,error ){var _ff FieldData ;_cac :=_c .NewDecoder (r ).Decode (&_ff ._a );if _cac !=nil {return nil ,_cac ;};return &_ff ,nil ;};

// FieldData represents form field data loaded from JSON file.
type FieldData struct{_a []fieldValue };

// LoadFromPDFFile loads form field data from a PDF file.
func LoadFromPDFFile (filePath string )(*FieldData ,error ){_fe ,_aa :=_ce .Open (filePath );if _aa !=nil {return nil ,_aa ;};defer _fe .Close ();return LoadFromPDF (_fe );};

// FieldValues implements model.FieldValueProvider interface.
func (_db *FieldData )FieldValues ()(map[string ]_ca .PdfObject ,error ){_fga :=make (map[string ]_ca .PdfObject );for _ ,_dda :=range _db ._a {if len (_dda .Value )> 0{_fga [_dda .Name ]=_ca .MakeString (_dda .Value );};};return _fga ,nil ;};