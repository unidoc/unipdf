//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package docutil ;import (_c "errors";_cf "fmt";_e "github.com/unidoc/unipdf/v4/common";_f "github.com/unidoc/unipdf/v4/core";);func _abb (_eee _f .PdfObject )(_f .PdfObjectName ,error ){var _fgdf *_f .PdfObjectName ;var _ac *_f .PdfObjectArray ;if _ceg ,_fge :=_eee .(*_f .PdfIndirectObject );
_fge {if _bed ,_bcd :=_ceg .PdfObject .(*_f .PdfObjectArray );_bcd {_ac =_bed ;}else if _fbf ,_ccf :=_ceg .PdfObject .(*_f .PdfObjectName );_ccf {_fgdf =_fbf ;};}else if _ffe ,_cde :=_eee .(*_f .PdfObjectArray );_cde {_ac =_ffe ;}else if _edd ,_cac :=_eee .(*_f .PdfObjectName );
_cac {_fgdf =_edd ;};if _fgdf !=nil {switch *_fgdf {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":return *_fgdf ,nil ;case "\u0050a\u0074\u0074\u0065\u0072\u006e":return *_fgdf ,nil ;
};};if _ac !=nil &&_ac .Len ()> 0{if _bag ,_cef :=_ac .Get (0).(*_f .PdfObjectName );_cef {switch *_bag {case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079","\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B","\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":if _ac .Len ()==1{return *_bag ,nil ;
};case "\u0043a\u006c\u0047\u0072\u0061\u0079","\u0043\u0061\u006c\u0052\u0047\u0042","\u004c\u0061\u0062":return *_bag ,nil ;case "\u0049\u0043\u0043\u0042\u0061\u0073\u0065\u0064","\u0050a\u0074\u0074\u0065\u0072\u006e","\u0049n\u0064\u0065\u0078\u0065\u0064":return *_bag ,nil ;
case "\u0053\u0065\u0070\u0061\u0072\u0061\u0074\u0069\u006f\u006e","\u0044e\u0076\u0069\u0063\u0065\u004e":return *_bag ,nil ;};};};return "",nil ;};func (_ecg Content )GetData ()([]byte ,error ){_fbd ,_dgfb :=_f .NewEncoderFromStream (_ecg .Stream );
if _dgfb !=nil {return nil ,_dgfb ;};_fde ,_dgfb :=_fbd .DecodeStream (_ecg .Stream );if _dgfb !=nil {return nil ,_dgfb ;};return _fde ,nil ;};func (_bea Page )GetContents ()([]Content ,bool ){_cff ,_ea :=_f .GetArray (_bea .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));
if !_ea {_gag ,_gbc :=_f .GetStream (_bea .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_gbc {return nil ,false ;};return []Content {{Stream :_gag ,_dgb :_bea ,_dgfa :0}},true ;};_efb :=make ([]Content ,_cff .Len ());for _dcf ,_dg :=range _cff .Elements (){_dgf ,_gaa :=_f .GetStream (_dg );
if !_gaa {continue ;};_efb [_dcf ]=Content {Stream :_dgf ,_dgb :_bea ,_dgfa :_dcf };};return _efb ,true ;};func (_fab *Document )AddIndirectObject (indirect *_f .PdfIndirectObject ){for _ ,_ccb :=range _fab .Objects {if _ccb ==indirect {return ;};};_fab .Objects =append (_fab .Objects ,indirect );
};type Content struct{Stream *_f .PdfObjectStream ;_dgfa int ;_dgb Page ;};func (_cg *Catalog )SetVersion (){_cg .Object .Set ("\u0056e\u0072\u0073\u0069\u006f\u006e",_f .MakeName (_cf .Sprintf ("\u0025\u0064\u002e%\u0064",_cg ._bg .Version .Major ,_cg ._bg .Version .Minor )));
};func (_fd *OutputIntents )Add (oi _f .PdfObject )error {_gfa ,_gde :=oi .(*_f .PdfObjectDictionary );if !_gde {return _c .New ("\u0069\u006e\u0070\u0075\u0074\u0020\u006f\u0075\u0074\u0070\u0075\u0074\u0020\u0069\u006e\u0074\u0065\u006et\u0020\u0073\u0068\u006f\u0075\u006c\u0064 \u0062\u0065\u0020\u0061\u006e\u0020\u006f\u0062\u006a\u0065\u0063t\u0020\u0064\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079");
};if _ad ,_ce :=_f .GetStream (_gfa .Get ("\u0044\u0065\u0073\u0074\u004f\u0075\u0074\u0070\u0075\u0074\u0050\u0072o\u0066\u0069\u006c\u0065"));_ce {_fd ._gc .Objects =append (_fd ._gc .Objects ,_ad );};_ab ,_eeg :=oi .(*_f .PdfIndirectObject );if !_eeg {_ab =_f .MakeIndirectObject (oi );
};if _fd ._ffb ==nil {_fd ._ffb =_f .MakeArray (_ab );}else {_fd ._ffb .Append (_ab );};_fd ._gc .Objects =append (_fd ._gc .Objects ,_ab );return nil ;};type OutputIntents struct{_ffb *_f .PdfObjectArray ;_gc *Document ;_ffa *_f .PdfIndirectObject ;};
func (_gbg Page )GetResourcesXObject ()(*_f .PdfObjectDictionary ,bool ){_cae ,_fdf :=_gbg .GetResources ();if !_fdf {return nil ,false ;};return _f .GetDict (_cae .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));};func (_ee *OutputIntents )Len ()int {return _ee ._ffb .Len ()};
func (_fgd *Document )GetPages ()([]Page ,bool ){_afa ,_fc :=_fgd .FindCatalog ();if !_fc {return nil ,false ;};return _afa .GetPages ();};func (_af *Catalog )GetMetadata ()(*_f .PdfObjectStream ,bool ){return _f .GetStream (_af .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));
};type Document struct{ID [2]string ;Version _f .Version ;Objects []_f .PdfObject ;Info _f .PdfObject ;Crypt *_f .PdfCrypt ;UseHashBasedID bool ;};func (_be *Catalog )HasMetadata ()bool {_g :=_be .Object .Get ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061");
return _g !=nil ;};func (_aa *Catalog )GetMarkInfo ()(*_f .PdfObjectDictionary ,bool ){_cd ,_dd :=_f .GetDict (_aa .Object .Get ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f"));return _cd ,_dd ;};func (_geb Page )FindXObjectForms ()[]*_f .PdfObjectStream {_aee ,_db :=_geb .GetResourcesXObject ();
if !_db {return nil ;};_aed :=map[*_f .PdfObjectStream ]struct{}{};var _aac func (_def *_f .PdfObjectDictionary ,_ebg map[*_f .PdfObjectStream ]struct{});_aac =func (_ddgc *_f .PdfObjectDictionary ,_bgad map[*_f .PdfObjectStream ]struct{}){for _ ,_cce :=range _ddgc .Keys (){_afb ,_gec :=_f .GetStream (_ddgc .Get (_cce ));
if !_gec {continue ;};if _ ,_dcb :=_bgad [_afb ];_dcb {continue ;};_cb ,_eg :=_f .GetName (_afb .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));if !_eg ||_cb .String ()!="\u0046\u006f\u0072\u006d"{continue ;};_bgad [_afb ]=struct{}{};_dgfg ,_eg :=_f .GetDict (_afb .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));
if !_eg {continue ;};_acf ,_cgb :=_f .GetDict (_dgfg .Get ("\u0058O\u0062\u006a\u0065\u0063\u0074"));if _cgb {_aac (_acf ,_bgad );};};};_aac (_aee ,_aed );var _fcd []*_f .PdfObjectStream ;for _eag :=range _aed {_fcd =append (_fcd ,_eag );};return _fcd ;
};type Page struct{_ae int ;Object *_f .PdfObjectDictionary ;_ffg *Document ;};func (_bd *Catalog )SetMetadata (data []byte )error {_fea ,_afc :=_f .MakeStream (data ,nil );if _afc !=nil {return _afc ;};_fea .Set ("\u0054\u0079\u0070\u0065",_f .MakeName ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061"));
_fea .Set ("\u0053u\u0062\u0074\u0079\u0070\u0065",_f .MakeName ("\u0058\u004d\u004c"));_bd .Object .Set ("\u004d\u0065\u0074\u0061\u0064\u0061\u0074\u0061",_fea );_bd ._bg .Objects =append (_bd ._bg .Objects ,_fea );return nil ;};func (_ga *Catalog )GetOutputIntents ()(*OutputIntents ,bool ){_eb :=_ga .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
if _eb ==nil {return nil ,false ;};_gd ,_bge :=_f .GetIndirect (_eb );if !_bge {return nil ,false ;};_df ,_cc :=_f .GetArray (_gd .PdfObject );if !_cc {return nil ,false ;};return &OutputIntents {_ffa :_gd ,_ffb :_df ,_gc :_ga ._bg },true ;};func (_cgd *Page )Number ()int {return _cgd ._ae };
func (_ba *Catalog )GetPages ()([]Page ,bool ){_fa ,_cgf :=_f .GetDict (_ba .Object .Get ("\u0050\u0061\u0067e\u0073"));if !_cgf {return nil ,false ;};_ed ,_bf :=_f .GetArray (_fa .Get ("\u004b\u0069\u0064\u0073"));if !_bf {return nil ,false ;};_fe :=make ([]Page ,_ed .Len ());
for _a ,_bc :=range _ed .Elements (){_fac ,_d :=_f .GetDict (_bc );if !_d {continue ;};_fe [_a ]=Page {Object :_fac ,_ae :_a +1,_ffg :_ba ._bg };};return _fe ,true ;};type ImageSMask struct{Image *Image ;Stream *_f .PdfObjectStream ;};func (_fb *Document )AddStream (stream *_f .PdfObjectStream ){for _ ,_gff :=range _fb .Objects {if _gff ==stream {return ;
};};_fb .Objects =append (_fb .Objects ,stream );};func (_ff *Catalog )SetStructTreeRoot (structTreeRoot _f .PdfObject ){if structTreeRoot ==nil {_ff .Object .Remove ("\u0053\u0074\u0072\u0075\u0063\u0074\u0054\u0072\u0065e\u0052\u006f\u006f\u0074");return ;
};_afg :=_f .MakeIndirectObject (structTreeRoot );_ff .Object .Set ("\u0053\u0074\u0072\u0075\u0063\u0074\u0054\u0072\u0065e\u0052\u006f\u006f\u0074",_afg );_ff ._bg .Objects =append (_ff ._bg .Objects ,_afg );};type Image struct{Name string ;Width int ;
Height int ;Colorspace _f .PdfObjectName ;ColorComponents int ;BitsPerComponent int ;SMask *ImageSMask ;Stream *_f .PdfObjectStream ;};type OutputIntent struct{Object *_f .PdfObjectDictionary ;};func (_ge *Catalog )NewOutputIntents ()*OutputIntents {return &OutputIntents {_gc :_ge ._bg }};
func (_aag Page )GetResources ()(*_f .PdfObjectDictionary ,bool ){return _f .GetDict (_aag .Object .Get ("\u0052e\u0073\u006f\u0075\u0072\u0063\u0065s"));};type Catalog struct{Object *_f .PdfObjectDictionary ;_bg *Document ;};func (_ffca *Content )SetData (data []byte )error {_fcg ,_caeb :=_f .MakeStream (data ,_f .NewFlateEncoder ());
if _caeb !=nil {return _caeb ;};_cfe ,_bgg :=_f .GetArray (_ffca ._dgb .Object .Get ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073"));if !_bgg &&_ffca ._dgfa ==0{_ffca ._dgb .Object .Set ("\u0043\u006f\u006e\u0074\u0065\u006e\u0074\u0073",_fcg );}else {if _caeb =_cfe .Set (_ffca ._dgfa ,_fcg );
_caeb !=nil {return _caeb ;};};_ffca ._dgb ._ffg .Objects =append (_ffca ._dgb ._ffg .Objects ,_fcg );return nil ;};func (_gce *OutputIntents )Get (i int )(OutputIntent ,bool ){if _gce ._ffb ==nil {return OutputIntent {},false ;};if i >=_gce ._ffb .Len (){return OutputIntent {},false ;
};_gb :=_gce ._ffb .Get (i );_da ,_ede :=_f .GetIndirect (_gb );if !_ede {_faa ,_dcd :=_f .GetDict (_gb );return OutputIntent {Object :_faa },_dcd ;};_edb ,_aad :=_f .GetDict (_da .PdfObject );return OutputIntent {Object :_edb },_aad ;};func (_ddg *Catalog )SetOutputIntents (outputIntents *OutputIntents ){if _bcf :=_ddg .Object .Get ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073");
_bcf !=nil {for _ggb ,_gf :=range _ddg ._bg .Objects {if _gf ==_bcf {if outputIntents ._ffa ==_bcf {return ;};_ddg ._bg .Objects =append (_ddg ._bg .Objects [:_ggb ],_ddg ._bg .Objects [_ggb +1:]...);break ;};};};_ag :=outputIntents ._ffa ;if _ag ==nil {_ag =_f .MakeIndirectObject (outputIntents ._ffb );
};_ddg .Object .Set ("\u004f\u0075\u0074\u0070\u0075\u0074\u0049\u006e\u0074\u0065\u006e\u0074\u0073",_ag );_ddg ._bg .Objects =append (_ddg ._bg .Objects ,_ag );};func (_ccg *Document )FindCatalog ()(*Catalog ,bool ){var _eec *_f .PdfObjectDictionary ;
for _ ,_ef :=range _ccg .Objects {_ebf ,_ffc :=_f .GetDict (_ef );if !_ffc {continue ;};if _ca ,_ebd :=_f .GetName (_ebf .Get ("\u0054\u0079\u0070\u0065"));_ebd &&*_ca =="\u0043a\u0074\u0061\u006c\u006f\u0067"{_eec =_ebf ;break ;};};if _eec ==nil {return nil ,false ;
};return &Catalog {Object :_eec ,_bg :_ccg },true ;};func (_gg *Catalog )SetMarkInfo (mi _f .PdfObject ){if mi ==nil {_gg .Object .Remove ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f");return ;};_dc :=_f .MakeIndirectObject (mi );_gg .Object .Set ("\u004d\u0061\u0072\u006b\u0049\u006e\u0066\u006f",_dc );
_gg ._bg .Objects =append (_gg ._bg .Objects ,_dc );};func (_ggg Page )FindXObjectImages ()([]*Image ,error ){_cge ,_aff :=_ggg .GetResourcesXObject ();if !_aff {return nil ,nil ;};var _bfe []*Image ;var _aeb error ;_bb :=map[*_f .PdfObjectStream ]int {};
_dde :=map[*_f .PdfObjectStream ]struct{}{};var _dac int ;for _ ,_beb :=range _cge .Keys (){_gcec ,_feg :=_f .GetStream (_cge .Get (_beb ));if !_feg {continue ;};if _ ,_cca :=_bb [_gcec ];_cca {continue ;};_gbe ,_beda :=_f .GetName (_gcec .Get ("\u0053u\u0062\u0074\u0079\u0070\u0065"));
if !_beda ||_gbe .String ()!="\u0049\u006d\u0061g\u0065"{continue ;};_fcb :=Image {BitsPerComponent :8,Stream :_gcec ,Name :string (_beb )};if _fcb .Colorspace ,_aeb =_abb (_gcec .Get ("\u0043\u006f\u006c\u006f\u0072\u0053\u0070\u0061\u0063\u0065"));_aeb !=nil {_e .Log .Error ("\u0045\u0072\u0072\u006f\u0072\u0020\u0064\u0065\u0074\u0065r\u006d\u0069\u006e\u0065\u0020\u0063\u006fl\u006f\u0072\u0020\u0073\u0070\u0061\u0063\u0065\u0020\u0025\u0073",_aeb );
continue ;};if _daf ,_ced :=_f .GetIntVal (_gcec .Get ("\u0042\u0069t\u0073\u0050\u0065r\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074"));_ced {_fcb .BitsPerComponent =_daf ;};if _feae ,_ec :=_f .GetIntVal (_gcec .Get ("\u0057\u0069\u0064t\u0068"));
_ec {_fcb .Width =_feae ;};if _eba ,_eed :=_f .GetIntVal (_gcec .Get ("\u0048\u0065\u0069\u0067\u0068\u0074"));_eed {_fcb .Height =_eba ;};if _afd ,_abg :=_f .GetStream (_gcec .Get ("\u0053\u004d\u0061s\u006b"));_abg {_fcb .SMask =&ImageSMask {Image :&_fcb ,Stream :_afd };
_dde [_afd ]=struct{}{};};switch _fcb .Colorspace {case "\u0044e\u0076\u0069\u0063\u0065\u0052\u0047B":_fcb .ColorComponents =3;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079":_fcb .ColorComponents =1;case "\u0044\u0065\u0076\u0069\u0063\u0065\u0043\u004d\u0059\u004b":_fcb .ColorComponents =4;
default:_fcb .ColorComponents =-1;};_bb [_gcec ]=_dac ;_bfe =append (_bfe ,&_fcb );_dac ++;};var _bbg []int ;for _ ,_gcef :=range _bfe {if _gcef .SMask !=nil {_efg ,_bga :=_bb [_gcef .SMask .Stream ];if _bga {_bbg =append (_bbg ,_efg );};};};_bdd :=make ([]*Image ,len (_bfe )-len (_bbg ));
_dac =0;_cec :for _ade ,_gaab :=range _bfe {for _ ,_caf :=range _bbg {if _ade ==_caf {continue _cec ;};};_bdd [_dac ]=_gaab ;_dac ++;};return _bfe ,nil ;};func (_fg *Catalog )GetStructTreeRoot ()(*_f .PdfObjectDictionary ,bool ){return _f .GetDict (_fg .Object .Get ("\u0053\u0074\u0072\u0075\u0063\u0074\u0054\u0072\u0065e\u0052\u006f\u006f\u0074"));
};