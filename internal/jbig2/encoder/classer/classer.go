//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package classer ;import (_da "github.com/unidoc/unipdf/v4/common";_c "github.com/unidoc/unipdf/v4/internal/jbig2/basic";_b "github.com/unidoc/unipdf/v4/internal/jbig2/bitmap";_df "github.com/unidoc/unipdf/v4/internal/jbig2/errors";_d "image";_dc "math";
);func (_ddgb *Classer )classifyRankHaus (_cde *_b .Boxes ,_aab *_b .Bitmaps ,_ace int )error {const _ae ="\u0063\u006ca\u0073\u0073\u0069f\u0079\u0052\u0061\u006e\u006b\u0048\u0061\u0075\u0073";if _cde ==nil {return _df .Error (_ae ,"\u0062\u006fx\u0061\u0020\u006eo\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};if _aab ==nil {return _df .Error (_ae ,"\u0070\u0069x\u0061\u0020\u006eo\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};_cfaf :=len (_aab .Values );if _cfaf ==0{return _df .Error (_ae ,"e\u006dp\u0074\u0079\u0020\u006e\u0065\u0077\u0020\u0063o\u006d\u0070\u006f\u006een\u0074\u0073");
};_ccbg :=_aab .CountPixels ();_gcb :=_ddgb .Settings .SizeHaus ;_adc :=_b .SelCreateBrick (_gcb ,_gcb ,_gcb /2,_gcb /2,_b .SelHit );_fga :=&_b .Bitmaps {Values :make ([]*_b .Bitmap ,_cfaf )};_gcba :=&_b .Bitmaps {Values :make ([]*_b .Bitmap ,_cfaf )};
var (_cbc ,_fb ,_daf *_b .Bitmap ;_bfe error ;);for _babe :=0;_babe < _cfaf ;_babe ++{_cbc ,_bfe =_aab .GetBitmap (_babe );if _bfe !=nil {return _df .Wrap (_bfe ,_ae ,"");};_fb ,_bfe =_cbc .AddBorderGeneral (JbAddedPixels ,JbAddedPixels ,JbAddedPixels ,JbAddedPixels ,0);
if _bfe !=nil {return _df .Wrap (_bfe ,_ae ,"");};_daf ,_bfe =_b .Dilate (nil ,_fb ,_adc );if _bfe !=nil {return _df .Wrap (_bfe ,_ae ,"");};_fga .Values [_cfaf ]=_fb ;_gcba .Values [_cfaf ]=_daf ;};_cad ,_bfe :=_b .Centroids (_fga .Values );if _bfe !=nil {return _df .Wrap (_bfe ,_ae ,"");
};if _bfe =_cad .Add (_ddgb .CentroidPoints );_bfe !=nil {_da .Log .Trace ("\u004e\u006f\u0020\u0063en\u0074\u0072\u006f\u0069\u0064\u0073\u0020\u0074\u006f\u0020\u0061\u0064\u0064");};if _ddgb .Settings .RankHaus ==1.0{_bfe =_ddgb .classifyRankHouseOne (_cde ,_aab ,_fga ,_gcba ,_cad ,_ace );
}else {_bfe =_ddgb .classifyRankHouseNonOne (_cde ,_aab ,_fga ,_gcba ,_cad ,_ccbg ,_ace );};if _bfe !=nil {return _df .Wrap (_bfe ,_ae ,"");};return nil ;};const (RankHaus Method =iota ;Correlation ;);func _dde (_ccg *_b .Bitmap ,_ged ,_cg ,_gd ,_cfd int ,_ffd *_b .Bitmap )(_efa _d .Point ,_eaf error ){const _cca ="\u0066i\u006e\u0061\u006c\u0041l\u0069\u0067\u006e\u006d\u0065n\u0074P\u006fs\u0069\u0074\u0069\u006f\u006e\u0069\u006eg";
if _ccg ==nil {return _efa ,_df .Error (_cca ,"\u0073\u006f\u0075\u0072ce\u0020\u006e\u006f\u0074\u0020\u0070\u0072\u006f\u0076\u0069\u0064\u0065\u0064");};if _ffd ==nil {return _efa ,_df .Error (_cca ,"t\u0065\u006d\u0070\u006cat\u0065 \u006e\u006f\u0074\u0020\u0070r\u006f\u0076\u0069\u0064\u0065\u0064");
};_ccgb ,_ced :=_ffd .Width ,_ffd .Height ;_efd ,_baa :=_ged -_gd -JbAddedPixels ,_cg -_cfd -JbAddedPixels ;_da .Log .Trace ("\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u002c\u0020\u0079\u003a\u0020\u0027\u0025\u0064'\u002c\u0020\u0077\u003a\u0020\u0027\u0025\u0064\u0027\u002c\u0020\u0068\u003a \u0027\u0025\u0064\u0027\u002c\u0020\u0062\u0078\u003a\u0020\u0027\u0025d'\u002c\u0020\u0062\u0079\u003a\u0020\u0027\u0025\u0064\u0027",_ged ,_cg ,_ccgb ,_ced ,_efd ,_baa );
_fded ,_eaf :=_b .Rect (_efd ,_baa ,_ccgb ,_ced );if _eaf !=nil {return _efa ,_df .Wrap (_eaf ,_cca ,"");};_ccaa ,_ ,_eaf :=_ccg .ClipRectangle (_fded );if _eaf !=nil {_da .Log .Error ("\u0043a\u006e\u0027\u0074\u0020\u0063\u006c\u0069\u0070\u0020\u0072\u0065c\u0074\u0061\u006e\u0067\u006c\u0065\u003a\u0020\u0025\u0076",_fded );
return _efa ,_df .Wrap (_eaf ,_cca ,"");};_ddg :=_b .New (_ccaa .Width ,_ccaa .Height );_fa :=_dc .MaxInt32 ;var _daa ,_caf ,_eb ,_af ,_fdf int ;for _daa =-1;_daa <=1;_daa ++{for _caf =-1;_caf <=1;_caf ++{if _ ,_eaf =_b .Copy (_ddg ,_ccaa );_eaf !=nil {return _efa ,_df .Wrap (_eaf ,_cca ,"");
};if _eaf =_ddg .RasterOperation (_caf ,_daa ,_ccgb ,_ced ,_b .PixSrcXorDst ,_ffd ,0,0);_eaf !=nil {return _efa ,_df .Wrap (_eaf ,_cca ,"");};_eb =_ddg .CountPixels ();if _eb < _fa {_af =_caf ;_fdf =_daa ;_fa =_eb ;};};};_efa .X =_af ;_efa .Y =_fdf ;return _efa ,nil ;
};func (_efag *Classer )classifyRankHouseOne (_cga *_b .Boxes ,_cgg ,_abd ,_ggd *_b .Bitmaps ,_eae *_b .Points ,_gcg int )(_ddc error ){const _adca ="\u0043\u006c\u0061\u0073s\u0065\u0072\u002e\u0063\u006c\u0061\u0073\u0073\u0069\u0066y\u0052a\u006e\u006b\u0048\u006f\u0075\u0073\u0065O\u006e\u0065";
var (_ec ,_fbd ,_ag ,_abf float32 ;_baag int ;_cff ,_cede ,_ddd ,_gca ,_bdc *_b .Bitmap ;_dcfb ,_eafg bool ;);for _cfbg :=0;_cfbg < len (_cgg .Values );_cfbg ++{_cede =_abd .Values [_cfbg ];_ddd =_ggd .Values [_cfbg ];_ec ,_fbd ,_ddc =_eae .GetGeometry (_cfbg );
if _ddc !=nil {return _df .Wrapf (_ddc ,_adca ,"\u0066\u0069\u0072\u0073\u0074\u0020\u0067\u0065\u006fm\u0065\u0074\u0072\u0079");};_edc :=len (_efag .UndilatedTemplates .Values );_dcfb =false ;_ccbc :=_abcg (_efag ,_cede );for _baag =_ccbc .Next ();_baag > -1;
{_gca ,_ddc =_efag .UndilatedTemplates .GetBitmap (_baag );if _ddc !=nil {return _df .Wrap (_ddc ,_adca ,"\u0062\u006d\u0033");};_bdc ,_ddc =_efag .DilatedTemplates .GetBitmap (_baag );if _ddc !=nil {return _df .Wrap (_ddc ,_adca ,"\u0062\u006d\u0034");
};_ag ,_abf ,_ddc =_efag .CentroidPointsTemplates .GetGeometry (_baag );if _ddc !=nil {return _df .Wrap (_ddc ,_adca ,"\u0043\u0065\u006e\u0074\u0072\u006f\u0069\u0064\u0054\u0065\u006d\u0070l\u0061\u0074\u0065\u0073");};_eafg ,_ddc =_b .HausTest (_cede ,_ddd ,_gca ,_bdc ,_ec -_ag ,_fbd -_abf ,MaxDiffWidth ,MaxDiffHeight );
if _ddc !=nil {return _df .Wrap (_ddc ,_adca ,"");};if _eafg {_dcfb =true ;if _ddc =_efag .ClassIDs .Add (_baag );_ddc !=nil {return _df .Wrap (_ddc ,_adca ,"");};if _ddc =_efag .ComponentPageNumbers .Add (_gcg );_ddc !=nil {return _df .Wrap (_ddc ,_adca ,"");
};if _efag .Settings .KeepClassInstances {_ddf ,_ddeb :=_efag .ClassInstances .GetBitmaps (_baag );if _ddeb !=nil {return _df .Wrap (_ddeb ,_adca ,"\u004be\u0065\u0070\u0050\u0069\u0078\u0061a");};_cff ,_ddeb =_cgg .GetBitmap (_cfbg );if _ddeb !=nil {return _df .Wrap (_ddeb ,_adca ,"\u004be\u0065\u0070\u0050\u0069\u0078\u0061a");
};_ddf .AddBitmap (_cff );_aba ,_ddeb :=_cga .Get (_cfbg );if _ddeb !=nil {return _df .Wrap (_ddeb ,_adca ,"\u004be\u0065\u0070\u0050\u0069\u0078\u0061a");};_ddf .AddBox (_aba );};break ;};};if !_dcfb {if _ddc =_efag .ClassIDs .Add (_edc );_ddc !=nil {return _df .Wrap (_ddc ,_adca ,"");
};if _ddc =_efag .ComponentPageNumbers .Add (_gcg );_ddc !=nil {return _df .Wrap (_ddc ,_adca ,"");};_dfc :=&_b .Bitmaps {};_cff ,_ddc =_cgg .GetBitmap (_cfbg );if _ddc !=nil {return _df .Wrap (_ddc ,_adca ,"\u0021\u0066\u006f\u0075\u006e\u0064");};_dfc .Values =append (_dfc .Values ,_cff );
_eaec ,_cccf :=_cff .Width ,_cff .Height ;_efag .TemplatesSize .Add (uint64 (_cccf )*uint64 (_eaec ),_edc );_cafb ,_ggfb :=_cga .Get (_cfbg );if _ggfb !=nil {return _df .Wrap (_ggfb ,_adca ,"\u0021\u0066\u006f\u0075\u006e\u0064");};_dfc .AddBox (_cafb );
_efag .ClassInstances .AddBitmaps (_dfc );_efag .CentroidPointsTemplates .AddPoint (_ec ,_fbd );_efag .UndilatedTemplates .AddBitmap (_cede );_efag .DilatedTemplates .AddBitmap (_ddd );};};return nil ;};type Method int ;func (_fg *Classer )verifyMethod (_cccb Method )error {if _cccb !=RankHaus &&_cccb !=Correlation {return _df .Error ("\u0076\u0065\u0072i\u0066\u0079\u004d\u0065\u0074\u0068\u006f\u0064","\u0069\u006e\u0076\u0061li\u0064\u0020\u0063\u006c\u0061\u0073\u0073\u0065\u0072\u0020\u006d\u0065\u0074\u0068o\u0064");
};return nil ;};var TwoByTwoWalk =[]int {0,0,0,1,-1,0,0,-1,1,0,-1,1,1,1,-1,-1,1,-1,0,-2,2,0,0,2,-2,0,-1,-2,1,-2,2,-1,2,1,1,2,-1,2,-2,1,-2,-1,-2,-2,2,-2,2,2,-2,2};func (_cd *Classer )addPageComponents (_dca *_b .Bitmap ,_dff *_b .Boxes ,_bfb *_b .Bitmaps ,_fd int ,_bbb Method )error {const _cfg ="\u0043l\u0061\u0073\u0073\u0065r\u002e\u0041\u0064\u0064\u0050a\u0067e\u0043o\u006d\u0070\u006f\u006e\u0065\u006e\u0074s";
if _dca ==nil {return _df .Error (_cfg ,"\u006e\u0069\u006c\u0020\u0069\u006e\u0070\u0075\u0074 \u0070\u0061\u0067\u0065");};if _dff ==nil ||_bfb ==nil ||len (*_dff )==0{_da .Log .Trace ("\u0041\u0064\u0064P\u0061\u0067\u0065\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074\u0073\u003a\u0020\u0025\u0073\u002e\u0020\u004e\u006f\u0020\u0063\u006f\u006d\u0070\u006f\u006e\u0065n\u0074\u0073\u0020\u0066\u006f\u0075\u006e\u0064",_dca );
return nil ;};var _cc error ;switch _bbb {case RankHaus :_cc =_cd .classifyRankHaus (_dff ,_bfb ,_fd );case Correlation :_cc =_cd .classifyCorrelation (_dff ,_bfb ,_fd );default:_da .Log .Debug ("\u0055\u006ek\u006e\u006f\u0077\u006e\u0020\u0063\u006c\u0061\u0073\u0073\u0069\u0066\u0079\u0020\u006d\u0065\u0074\u0068\u006f\u0064\u003a\u0020'%\u0076\u0027",_bbb );
return _df .Error (_cfg ,"\u0075\u006e\u006bno\u0077\u006e\u0020\u0063\u006c\u0061\u0073\u0073\u0069\u0066\u0079\u0020\u006d\u0065\u0074\u0068\u006f\u0064");};if _cc !=nil {return _df .Wrap (_cc ,_cfg ,"");};if _cc =_cd .getULCorners (_dca ,_dff );_cc !=nil {return _df .Wrap (_cc ,_cfg ,"");
};_bg :=len (*_dff );_cd .BaseIndex +=_bg ;if _cc =_cd .ComponentsNumber .Add (_bg );_cc !=nil {return _df .Wrap (_cc ,_cfg ,"");};return nil ;};func (_db *Classer )ComputeLLCorners ()(_ba error ){const _e ="\u0043l\u0061\u0073\u0073\u0065\u0072\u002e\u0043\u006f\u006d\u0070\u0075t\u0065\u004c\u004c\u0043\u006f\u0072\u006e\u0065\u0072\u0073";
if _db .PtaUL ==nil {return _df .Error (_e ,"\u0055\u004c\u0020\u0043or\u006e\u0065\u0072\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006ee\u0064");};_cf :=len (*_db .PtaUL );_db .PtaLL =&_b .Points {};var (_gg ,_dad float32 ;_ad ,_aa int ;
_dac *_b .Bitmap ;);for _fe :=0;_fe < _cf ;_fe ++{_gg ,_dad ,_ba =_db .PtaUL .GetGeometry (_fe );if _ba !=nil {_da .Log .Debug ("\u0047e\u0074\u0074\u0069\u006e\u0067\u0020\u0050\u0074\u0061\u0055\u004c \u0066\u0061\u0069\u006c\u0065\u0064\u003a\u0020\u0025\u0076",_ba );
return _df .Wrap (_ba ,_e ,"\u0050\u0074\u0061\u0055\u004c\u0020\u0047\u0065\u006fm\u0065\u0074\u0072\u0079");};_ad ,_ba =_db .ClassIDs .Get (_fe );if _ba !=nil {_da .Log .Debug ("\u0047\u0065\u0074\u0074\u0069\u006e\u0067\u0020\u0043\u006c\u0061s\u0073\u0049\u0044\u0020\u0066\u0061\u0069\u006c\u0065\u0064:\u0020\u0025\u0076",_ba );
return _df .Wrap (_ba ,_e ,"\u0043l\u0061\u0073\u0073\u0049\u0044");};_dac ,_ba =_db .UndilatedTemplates .GetBitmap (_ad );if _ba !=nil {_da .Log .Debug ("\u0047\u0065t\u0074\u0069\u006e\u0067 \u0055\u006ed\u0069\u006c\u0061\u0074\u0065\u0064\u0054\u0065m\u0070\u006c\u0061\u0074\u0065\u0073\u0020\u0066\u0061\u0069\u006c\u0065d\u003a\u0020\u0025\u0076",_ba );
return _df .Wrap (_ba ,_e ,"\u0055\u006e\u0064\u0069la\u0074\u0065\u0064\u0020\u0054\u0065\u006d\u0070\u006c\u0061\u0074\u0065\u0073");};_aa =_dac .Height ;_db .PtaLL .AddPoint (_gg ,_dad +float32 (_aa ));};return nil ;};func _abcg (_edf *Classer ,_gbd *_b .Bitmap )*similarTemplatesFinder {return &similarTemplatesFinder {Width :_gbd .Width ,Height :_gbd .Height ,Classer :_edf };
};var _gea bool ;func (_bcd Settings )Validate ()error {const _aggg ="\u0053\u0065\u0074\u0074\u0069\u006e\u0067\u0073\u002e\u0056\u0061\u006ci\u0064\u0061\u0074\u0065";if _bcd .Thresh < 0.4||_bcd .Thresh > 0.98{return _df .Error (_aggg ,"\u006a\u0062i\u0067\u0032\u0020\u0065\u006e\u0063\u006f\u0064\u0065\u0072\u0020\u0074\u0068\u0072\u0065\u0073\u0068\u0020\u006e\u006f\u0074\u0020\u0069\u006e\u0020\u0072\u0061\u006e\u0067\u0065\u0020\u005b\u0030\u002e\u0034\u0020\u002d\u0020\u0030\u002e\u0039\u0038\u005d");
};if _bcd .WeightFactor < 0.0||_bcd .WeightFactor > 1.0{return _df .Error (_aggg ,"\u006a\u0062i\u0067\u0032\u0020\u0065\u006ec\u006f\u0064\u0065\u0072\u0020w\u0065\u0069\u0067\u0068\u0074\u0020\u0066\u0061\u0063\u0074\u006f\u0072\u0020\u006e\u006f\u0074\u0020\u0069\u006e\u0020\u0072\u0061\u006e\u0067\u0065\u0020\u005b\u0030\u002e\u0030\u0020\u002d\u0020\u0031\u002e\u0030\u005d");
};if _bcd .RankHaus < 0.5||_bcd .RankHaus > 1.0{return _df .Error (_aggg ,"\u006a\u0062\u0069\u0067\u0032\u0020\u0065\u006e\u0063\u006f\u0064\u0065\u0072\u0020\u0072a\u006e\u006b\u0020\u0068\u0061\u0075\u0073\u0020\u0076\u0061\u006c\u0075\u0065 \u006e\u006f\u0074\u0020\u0069\u006e\u0020\u0072\u0061\u006e\u0067\u0065 [\u0030\u002e\u0035\u0020\u002d\u0020\u0031\u002e\u0030\u005d");
};if _bcd .SizeHaus < 1||_bcd .SizeHaus > 10{return _df .Error (_aggg ,"\u006a\u0062\u0069\u0067\u0032 \u0065\u006e\u0063\u006f\u0064\u0065\u0072\u0020\u0073\u0069\u007a\u0065\u0020h\u0061\u0075\u0073\u0020\u0076\u0061\u006c\u0075\u0065\u0020\u006e\u006f\u0074\u0020\u0069\u006e\u0020\u0072\u0061\u006e\u0067\u0065\u0020\u005b\u0031\u0020\u002d\u0020\u0031\u0030]");
};switch _bcd .Components {case _b .ComponentConn ,_b .ComponentCharacters ,_b .ComponentWords :default:return _df .Error (_aggg ,"\u0069n\u0076\u0061\u006c\u0069d\u0020\u0063\u006c\u0061\u0073s\u0065r\u0020c\u006f\u006d\u0070\u006f\u006e\u0065\u006et");
};return nil ;};const (MaxDiffWidth =2;MaxDiffHeight =2;);func (_eba *Classer )classifyCorrelation (_bgd *_b .Boxes ,_cea *_b .Bitmaps ,_geac int )error {const _afa ="\u0063\u006c\u0061\u0073si\u0066\u0079\u0043\u006f\u0072\u0072\u0065\u006c\u0061\u0074\u0069\u006f\u006e";
if _bgd ==nil {return _df .Error (_afa ,"\u006e\u0065\u0077\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074\u0073\u0020\u0062\u006f\u0075\u006e\u0064\u0069\u006e\u0067\u0020\u0062o\u0078\u0065\u0073\u0020\u006eo\u0074\u0020f\u006f\u0075\u006e\u0064");
};if _cea ==nil {return _df .Error (_afa ,"\u006e\u0065wC\u006f\u006d\u0070o\u006e\u0065\u006e\u0074s b\u0069tm\u0061\u0070\u0020\u0061\u0072\u0072\u0061y \u006e\u006f\u0074\u0020\u0066\u006f\u0075n\u0064");};_gc :=len (_cea .Values );if _gc ==0{_da .Log .Debug ("\u0063l\u0061\u0073s\u0069\u0066\u0079C\u006f\u0072\u0072\u0065\u006c\u0061\u0074i\u006f\u006e\u0020\u002d\u0020\u0070r\u006f\u0076\u0069\u0064\u0065\u0064\u0020\u0070\u0069\u0078\u0061s\u0020\u0069\u0073\u0020\u0065\u006d\u0070\u0074\u0079");
return nil ;};var (_ddgg ,_ggf *_b .Bitmap ;_dcf error ;);_gedd :=&_b .Bitmaps {Values :make ([]*_b .Bitmap ,_gc )};for _cdc ,_ga :=range _cea .Values {_ggf ,_dcf =_ga .AddBorderGeneral (JbAddedPixels ,JbAddedPixels ,JbAddedPixels ,JbAddedPixels ,0);if _dcf !=nil {return _df .Wrap (_dcf ,_afa ,"");
};_gedd .Values [_cdc ]=_ggf ;};_gbb :=_eba .FgTemplates ;_gec :=_b .MakePixelSumTab8 ();_feg :=_b .MakePixelCentroidTab8 ();_bab :=make ([]int ,_gc );_ffg :=make ([][]int ,_gc );_dbe :=_b .Points (make ([]_b .Point ,_gc ));_cee :=&_dbe ;var (_dfg ,_ccb int ;
_geb ,_dg ,_dga int ;_bde ,_gaf int ;_abc byte ;);for _bed ,_fc :=range _gedd .Values {_ffg [_bed ]=make ([]int ,_fc .Height );_dfg =0;_ccb =0;_dg =(_fc .Height -1)*_fc .RowStride ;_geb =0;for _gaf =_fc .Height -1;_gaf >=0;_gaf ,_dg =_gaf -1,_dg -_fc .RowStride {_ffg [_bed ][_gaf ]=_geb ;
_dga =0;for _bde =0;_bde < _fc .RowStride ;_bde ++{_abc =_fc .Data [_dg +_bde ];_dga +=_gec [_abc ];_dfg +=_feg [_abc ]+_bde *8*_gec [_abc ];};_geb +=_dga ;_ccb +=_dga *_gaf ;};_bab [_bed ]=_geb ;if _geb > 0{(*_cee )[_bed ]=_b .Point {X :float32 (_dfg )/float32 (_geb ),Y :float32 (_ccb )/float32 (_geb )};
}else {(*_cee )[_bed ]=_b .Point {X :float32 (_fc .Width )/float32 (2),Y :float32 (_fc .Height )/float32 (2)};};};if _dcf =_eba .CentroidPoints .Add (_cee );_dcf !=nil {return _df .Wrap (_dcf ,_afa ,"\u0063\u0065\u006et\u0072\u006f\u0069\u0064\u0020\u0061\u0064\u0064");
};var (_dgc ,_dcfc ,_dgd int ;_fca float64 ;_cfc ,_geddg ,_cbf ,_cfa float32 ;_dag ,_dbf _b .Point ;_gdd bool ;_ceea *similarTemplatesFinder ;_gge int ;_cab *_b .Bitmap ;_bdb *_d .Rectangle ;_gdb *_b .Bitmaps ;);for _gge ,_ggf =range _gedd .Values {_dcfc =_bab [_gge ];
if _cfc ,_geddg ,_dcf =_cee .GetGeometry (_gge );_dcf !=nil {return _df .Wrap (_dcf ,_afa ,"\u0070t\u0061\u0020\u002d\u0020\u0069");};_gdd =false ;_dcc :=len (_eba .UndilatedTemplates .Values );_ceea =_abcg (_eba ,_ggf );for _bgg :=_ceea .Next ();_bgg > -1;
{if _cab ,_dcf =_eba .UndilatedTemplates .GetBitmap (_bgg );_dcf !=nil {return _df .Wrap (_dcf ,_afa ,"\u0075\u006e\u0069dl\u0061\u0074\u0065\u0064\u005b\u0069\u0063\u006c\u0061\u0073\u0073\u005d\u0020\u003d\u0020\u0062\u006d\u0032");};if _dgd ,_dcf =_gbb .GetInt (_bgg );
_dcf !=nil {_da .Log .Trace ("\u0046\u0047\u0020T\u0065\u006d\u0070\u006ca\u0074\u0065\u0020\u005b\u0069\u0063\u006ca\u0073\u0073\u005d\u0020\u0066\u0061\u0069\u006c\u0065\u0064\u003a\u0020\u0025\u0076",_dcf );};if _cbf ,_cfa ,_dcf =_eba .CentroidPointsTemplates .GetGeometry (_bgg );
_dcf !=nil {return _df .Wrap (_dcf ,_afa ,"\u0043\u0065\u006e\u0074\u0072\u006f\u0069\u0064\u0050\u006f\u0069\u006e\u0074T\u0065\u006d\u0070\u006c\u0061\u0074e\u0073\u005b\u0069\u0063\u006c\u0061\u0073\u0073\u005d\u0020\u003d\u0020\u00782\u002c\u0079\u0032\u0020");
};if _eba .Settings .WeightFactor > 0.0{if _dgc ,_dcf =_eba .TemplateAreas .Get (_bgg );_dcf !=nil {_da .Log .Trace ("\u0054\u0065\u006dp\u006c\u0061\u0074\u0065A\u0072\u0065\u0061\u0073\u005b\u0069\u0063l\u0061\u0073\u0073\u005d\u0020\u003d\u0020\u0061\u0072\u0065\u0061\u0020\u0025\u0076",_dcf );
};_fca =_eba .Settings .Thresh +(1.0-_eba .Settings .Thresh )*_eba .Settings .WeightFactor *float64 (_dgd )/float64 (_dgc );}else {_fca =_eba .Settings .Thresh ;};_cfb ,_gba :=_b .CorrelationScoreThresholded (_ggf ,_cab ,_dcfc ,_dgd ,_dag .X -_dbf .X ,_dag .Y -_dbf .Y ,MaxDiffWidth ,MaxDiffHeight ,_gec ,_ffg [_gge ],float32 (_fca ));
if _gba !=nil {return _df .Wrap (_gba ,_afa ,"");};if _gea {var (_dfgg ,_badc float64 ;_fgb ,_eac int ;);_dfgg ,_gba =_b .CorrelationScore (_ggf ,_cab ,_dcfc ,_dgd ,_cfc -_cbf ,_geddg -_cfa ,MaxDiffWidth ,MaxDiffHeight ,_gec );if _gba !=nil {return _df .Wrap (_gba ,_afa ,"d\u0065\u0062\u0075\u0067Co\u0072r\u0065\u006c\u0061\u0074\u0069o\u006e\u0053\u0063\u006f\u0072\u0065");
};_badc ,_gba =_b .CorrelationScoreSimple (_ggf ,_cab ,_dcfc ,_dgd ,_cfc -_cbf ,_geddg -_cfa ,MaxDiffWidth ,MaxDiffHeight ,_gec );if _gba !=nil {return _df .Wrap (_gba ,_afa ,"d\u0065\u0062\u0075\u0067Co\u0072r\u0065\u006c\u0061\u0074\u0069o\u006e\u0053\u0063\u006f\u0072\u0065");
};_fgb =int (_dc .Sqrt (_dfgg *float64 (_dcfc )*float64 (_dgd )));_eac =int (_dc .Sqrt (_badc *float64 (_dcfc )*float64 (_dgd )));if (_dfgg >=_fca )!=(_badc >=_fca ){return _df .Errorf (_afa ,"\u0064\u0065\u0062\u0075\u0067\u0020\u0043\u006f\u0072r\u0065\u006c\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0063\u006f\u0072\u0065\u0020\u006d\u0069\u0073\u006d\u0061\u0074\u0063\u0068\u0020-\u0020\u0025d\u0028\u00250\u002e\u0034\u0066\u002c\u0020\u0025\u0076\u0029\u0020\u0076\u0073\u0020\u0025d(\u0025\u0030\u002e\u0034\u0066\u002c\u0020\u0025\u0076)\u0020\u0025\u0030\u002e\u0034\u0066",_fgb ,_dfgg ,_dfgg >=_fca ,_eac ,_badc ,_badc >=_fca ,_dfgg -_badc );
};if _dfgg >=_fca !=_cfb {return _df .Errorf (_afa ,"\u0064\u0065\u0062\u0075\u0067\u0020\u0043o\u0072\u0072\u0065\u006c\u0061\u0074\u0069\u006f\u006e \u0073\u0063\u006f\u0072\u0065 \u004d\u0069\u0073\u006d\u0061t\u0063\u0068 \u0062\u0065\u0074w\u0065\u0065\u006e\u0020\u0063\u006frr\u0065\u006c\u0061\u0074\u0069\u006f\u006e\u0020/\u0020\u0074\u0068\u0072\u0065s\u0068\u006f\u006c\u0064\u002e\u0020\u0043\u006f\u006dpa\u0072\u0069\u0073\u006f\u006e:\u0020\u0025\u0030\u002e\u0034\u0066\u0028\u0025\u0030\u002e\u0034\u0066\u002c\u0020\u0025\u0064\u0029\u0020\u003e\u003d\u0020\u00250\u002e\u0034\u0066\u0028\u0025\u0030\u002e\u0034\u0066\u0029\u0020\u0076\u0073\u0020\u0025\u0076",_dfgg ,_dfgg *float64 (_dcfc )*float64 (_dgd ),_fgb ,_fca ,float32 (_fca )*float32 (_dcfc )*float32 (_dgd ),_cfb );
};};if _cfb {_gdd =true ;if _gba =_eba .ClassIDs .Add (_bgg );_gba !=nil {return _df .Wrap (_gba ,_afa ,"\u006f\u0076\u0065\u0072\u0054\u0068\u0072\u0065\u0073\u0068\u006f\u006c\u0064");};if _gba =_eba .ComponentPageNumbers .Add (_geac );_gba !=nil {return _df .Wrap (_gba ,_afa ,"\u006f\u0076\u0065\u0072\u0054\u0068\u0072\u0065\u0073\u0068\u006f\u006c\u0064");
};if _eba .Settings .KeepClassInstances {if _ddgg ,_gba =_cea .GetBitmap (_gge );_gba !=nil {return _df .Wrap (_gba ,_afa ,"\u004b\u0065\u0065\u0070Cl\u0061\u0073\u0073\u0049\u006e\u0073\u0074\u0061\u006e\u0063\u0065\u0073\u0020\u002d \u0069");};if _gdb ,_gba =_eba .ClassInstances .GetBitmaps (_bgg );
_gba !=nil {return _df .Wrap (_gba ,_afa ,"K\u0065\u0065\u0070\u0043\u006c\u0061s\u0073\u0049\u006e\u0073\u0074\u0061\u006e\u0063\u0065s\u0020\u002d\u0020i\u0043l\u0061\u0073\u0073");};_gdb .AddBitmap (_ddgg );if _bdb ,_gba =_bgd .Get (_gge );_gba !=nil {return _df .Wrap (_gba ,_afa ,"\u004be\u0065p\u0043\u006c\u0061\u0073\u0073I\u006e\u0073t\u0061\u006e\u0063\u0065\u0073");
};_gdb .AddBox (_bdb );};break ;};};if !_gdd {if _dcf =_eba .ClassIDs .Add (_dcc );_dcf !=nil {return _df .Wrap (_dcf ,_afa ,"\u0021\u0066\u006f\u0075\u006e\u0064");};if _dcf =_eba .ComponentPageNumbers .Add (_geac );_dcf !=nil {return _df .Wrap (_dcf ,_afa ,"\u0021\u0066\u006f\u0075\u006e\u0064");
};_gdb =&_b .Bitmaps {};if _ddgg ,_dcf =_cea .GetBitmap (_gge );_dcf !=nil {return _df .Wrap (_dcf ,_afa ,"\u0021\u0066\u006f\u0075\u006e\u0064");};_gdb .AddBitmap (_ddgg );_fda ,_cec :=_ddgg .Width ,_ddgg .Height ;_acf :=uint64 (_cec )*uint64 (_fda );
_eba .TemplatesSize .Add (_acf ,_dcc );if _bdb ,_dcf =_bgd .Get (_gge );_dcf !=nil {return _df .Wrap (_dcf ,_afa ,"\u0021\u0066\u006f\u0075\u006e\u0064");};_gdb .AddBox (_bdb );_eba .ClassInstances .AddBitmaps (_gdb );_eba .CentroidPointsTemplates .AddPoint (_cfc ,_geddg );
_eba .FgTemplates .AddInt (_dcfc );_eba .UndilatedTemplates .AddBitmap (_ddgg );_dgc =(_ggf .Width -2*JbAddedPixels )*(_ggf .Height -2*JbAddedPixels );if _dcf =_eba .TemplateAreas .Add (_dgc );_dcf !=nil {return _df .Wrap (_dcf ,_afa ,"\u0021\u0066\u006f\u0075\u006e\u0064");
};};};_eba .NumberOfClasses =len (_eba .UndilatedTemplates .Values );return nil ;};func DefaultSettings ()Settings {_dgef :=&Settings {};_dgef .SetDefault ();return *_dgef };func (_dd *Classer )AddPage (inputPage *_b .Bitmap ,pageNumber int ,method Method )(_ddb error ){const _dfa ="\u0043l\u0061s\u0073\u0065\u0072\u002e\u0041\u0064\u0064\u0050\u0061\u0067\u0065";
_dd .Widths [pageNumber ]=inputPage .Width ;_dd .Heights [pageNumber ]=inputPage .Height ;if _ddb =_dd .verifyMethod (method );_ddb !=nil {return _df .Wrap (_ddb ,_dfa ,"");};_bf ,_a ,_ddb :=inputPage .GetComponents (_dd .Settings .Components ,_dd .Settings .MaxCompWidth ,_dd .Settings .MaxCompHeight );
if _ddb !=nil {return _df .Wrap (_ddb ,_dfa ,"");};_da .Log .Debug ("\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074s\u003a\u0020\u0025\u0076",_bf );if _ddb =_dd .addPageComponents (inputPage ,_a ,_bf ,pageNumber ,method );_ddb !=nil {return _df .Wrap (_ddb ,_dfa ,"");
};return nil ;};func (_eeg *Classer )classifyRankHouseNonOne (_gf *_b .Boxes ,_ebd ,_abdf ,_bgc *_b .Bitmaps ,_eea *_b .Points ,_aac *_c .NumSlice ,_bfa int )(_ddge error ){const _bbg ="\u0043\u006c\u0061\u0073s\u0065\u0072\u002e\u0063\u006c\u0061\u0073\u0073\u0069\u0066y\u0052a\u006e\u006b\u0048\u006f\u0075\u0073\u0065O\u006e\u0065";
var (_agg ,_bee ,_eff ,_acd float32 ;_cdcd ,_cbfd ,_ceda int ;_cce ,_age ,_fec ,_dge ,_eaece *_b .Bitmap ;_gaa ,_eg bool ;);_de :=_b .MakePixelSumTab8 ();for _edg :=0;_edg < len (_ebd .Values );_edg ++{if _age ,_ddge =_abdf .GetBitmap (_edg );_ddge !=nil {return _df .Wrap (_ddge ,_bbg ,"b\u006d\u0073\u0031\u002e\u0047\u0065\u0074\u0028\u0069\u0029");
};if _cdcd ,_ddge =_aac .GetInt (_edg );_ddge !=nil {_da .Log .Trace ("\u0047\u0065t\u0074\u0069\u006e\u0067 \u0046\u0047T\u0065\u006d\u0070\u006c\u0061\u0074\u0065\u0073 \u0061\u0074\u003a\u0020\u0025\u0064\u0020\u0066\u0061\u0069\u006c\u0065d\u003a\u0020\u0025\u0076",_edg ,_ddge );
};if _fec ,_ddge =_bgc .GetBitmap (_edg );_ddge !=nil {return _df .Wrap (_ddge ,_bbg ,"b\u006d\u0073\u0032\u002e\u0047\u0065\u0074\u0028\u0069\u0029");};if _agg ,_bee ,_ddge =_eea .GetGeometry (_edg );_ddge !=nil {return _df .Wrapf (_ddge ,_bbg ,"\u0070t\u0061[\u0069\u005d\u002e\u0047\u0065\u006f\u006d\u0065\u0074\u0072\u0079");
};_gaad :=len (_eeg .UndilatedTemplates .Values );_gaa =false ;_dcaa :=_abcg (_eeg ,_age );for _ceda =_dcaa .Next ();_ceda > -1;{if _dge ,_ddge =_eeg .UndilatedTemplates .GetBitmap (_ceda );_ddge !=nil {return _df .Wrap (_ddge ,_bbg ,"\u0070\u0069\u0078\u0061\u0074\u002e\u005b\u0069\u0043l\u0061\u0073\u0073\u005d");
};if _cbfd ,_ddge =_eeg .FgTemplates .GetInt (_ceda );_ddge !=nil {_da .Log .Trace ("\u0047\u0065\u0074\u0074\u0069\u006eg\u0020\u0046\u0047\u0054\u0065\u006d\u0070\u006c\u0061\u0074\u0065\u005b\u0025d\u005d\u0020\u0066\u0061\u0069\u006c\u0065d\u003a\u0020\u0025\u0076",_ceda ,_ddge );
};if _eaece ,_ddge =_eeg .DilatedTemplates .GetBitmap (_ceda );_ddge !=nil {return _df .Wrap (_ddge ,_bbg ,"\u0070\u0069\u0078\u0061\u0074\u0064\u005b\u0069\u0043l\u0061\u0073\u0073\u005d");};if _eff ,_acd ,_ddge =_eeg .CentroidPointsTemplates .GetGeometry (_ceda );
_ddge !=nil {return _df .Wrap (_ddge ,_bbg ,"\u0043\u0065\u006et\u0072\u006f\u0069\u0064P\u006f\u0069\u006e\u0074\u0073\u0054\u0065m\u0070\u006c\u0061\u0074\u0065\u0073\u005b\u0069\u0043\u006c\u0061\u0073\u0073\u005d");};_eg ,_ddge =_b .RankHausTest (_age ,_fec ,_dge ,_eaece ,_agg -_eff ,_bee -_acd ,MaxDiffWidth ,MaxDiffHeight ,_cdcd ,_cbfd ,float32 (_eeg .Settings .RankHaus ),_de );
if _ddge !=nil {return _df .Wrap (_ddge ,_bbg ,"");};if _eg {_gaa =true ;if _ddge =_eeg .ClassIDs .Add (_ceda );_ddge !=nil {return _df .Wrap (_ddge ,_bbg ,"");};if _ddge =_eeg .ComponentPageNumbers .Add (_bfa );_ddge !=nil {return _df .Wrap (_ddge ,_bbg ,"");
};if _eeg .Settings .KeepClassInstances {_bef ,_egf :=_eeg .ClassInstances .GetBitmaps (_ceda );if _egf !=nil {return _df .Wrap (_egf ,_bbg ,"\u0063\u002e\u0050\u0069\u0078\u0061\u0061\u002e\u0047\u0065\u0074B\u0069\u0074\u006d\u0061\u0070\u0073\u0028\u0069\u0043\u006ca\u0073\u0073\u0029");
};if _cce ,_egf =_ebd .GetBitmap (_edg );_egf !=nil {return _df .Wrap (_egf ,_bbg ,"\u0070i\u0078\u0061\u005b\u0069\u005d");};_bef .Values =append (_bef .Values ,_cce );_def ,_egf :=_gf .Get (_edg );if _egf !=nil {return _df .Wrap (_egf ,_bbg ,"b\u006f\u0078\u0061\u002e\u0047\u0065\u0074\u0028\u0069\u0029");
};_bef .Boxes =append (_bef .Boxes ,_def );};break ;};};if !_gaa {if _ddge =_eeg .ClassIDs .Add (_gaad );_ddge !=nil {return _df .Wrap (_ddge ,_bbg ,"\u0021\u0066\u006f\u0075\u006e\u0064");};if _ddge =_eeg .ComponentPageNumbers .Add (_bfa );_ddge !=nil {return _df .Wrap (_ddge ,_bbg ,"\u0021\u0066\u006f\u0075\u006e\u0064");
};_ege :=&_b .Bitmaps {};_cce =_ebd .Values [_edg ];_ege .AddBitmap (_cce );_aff ,_gee :=_cce .Width ,_cce .Height ;_eeg .TemplatesSize .Add (uint64 (_aff )*uint64 (_gee ),_gaad );_fab ,_bdg :=_gf .Get (_edg );if _bdg !=nil {return _df .Wrap (_bdg ,_bbg ,"\u0021\u0066\u006f\u0075\u006e\u0064");
};_ege .AddBox (_fab );_eeg .ClassInstances .AddBitmaps (_ege );_eeg .CentroidPointsTemplates .AddPoint (_agg ,_bee );_eeg .UndilatedTemplates .AddBitmap (_age );_eeg .DilatedTemplates .AddBitmap (_fec );_eeg .FgTemplates .AddInt (_cdcd );};};_eeg .NumberOfClasses =len (_eeg .UndilatedTemplates .Values );
return nil ;};func (_bc *Settings )SetDefault (){if _bc .MaxCompWidth ==0{switch _bc .Components {case _b .ComponentConn :_bc .MaxCompWidth =MaxConnCompWidth ;case _b .ComponentCharacters :_bc .MaxCompWidth =MaxCharCompWidth ;case _b .ComponentWords :_bc .MaxCompWidth =MaxWordCompWidth ;
};};if _bc .MaxCompHeight ==0{_bc .MaxCompHeight =MaxCompHeight ;};if _bc .Thresh ==0.0{_bc .Thresh =0.9;};if _bc .WeightFactor ==0.0{_bc .WeightFactor =0.75;};if _bc .RankHaus ==0.0{_bc .RankHaus =0.97;};if _bc .SizeHaus ==0{_bc .SizeHaus =2;};};const (MaxConnCompWidth =350;
MaxCharCompWidth =350;MaxWordCompWidth =1000;MaxCompHeight =120;);func (_afaf *similarTemplatesFinder )Next ()int {var (_fef ,_cgf ,_ecc ,_afg int ;_adf bool ;_gbab *_b .Bitmap ;_dcd error ;);for {if _afaf .Index >=25{return -1;};_cgf =_afaf .Width +TwoByTwoWalk [2*_afaf .Index ];
_fef =_afaf .Height +TwoByTwoWalk [2*_afaf .Index +1];if _fef < 1||_cgf < 1{_afaf .Index ++;continue ;};if len (_afaf .CurrentNumbers )==0{_afaf .CurrentNumbers ,_adf =_afaf .Classer .TemplatesSize .GetSlice (uint64 (_cgf )*uint64 (_fef ));if !_adf {_afaf .Index ++;
continue ;};_afaf .N =0;};_ecc =len (_afaf .CurrentNumbers );for ;_afaf .N < _ecc ;_afaf .N ++{_afg =_afaf .CurrentNumbers [_afaf .N ];_gbab ,_dcd =_afaf .Classer .DilatedTemplates .GetBitmap (_afg );if _dcd !=nil {_da .Log .Debug ("\u0046\u0069\u006e\u0064\u004e\u0065\u0078\u0074\u0054\u0065\u006d\u0070\u006c\u0061\u0074\u0065\u003a\u0020\u0074\u0065\u006d\u0070\u006c\u0061t\u0065\u0020\u006e\u006f\u0074 \u0066\u006fu\u006e\u0064\u003a\u0020");
return 0;};if _gbab .Width -2*JbAddedPixels ==_cgf &&_gbab .Height -2*JbAddedPixels ==_fef {return _afg ;};};_afaf .Index ++;_afaf .CurrentNumbers =nil ;};};type similarTemplatesFinder struct{Classer *Classer ;Width int ;Height int ;Index int ;CurrentNumbers []int ;
N int ;};const JbAddedPixels =6;func Init (settings Settings )(*Classer ,error ){const _dcb ="\u0063\u006c\u0061s\u0073\u0065\u0072\u002e\u0049\u006e\u0069\u0074";_bb :=&Classer {Settings :settings ,Widths :map[int ]int {},Heights :map[int ]int {},TemplatesSize :_c .IntsMap {},TemplateAreas :&_c .IntSlice {},ComponentPageNumbers :&_c .IntSlice {},ClassIDs :&_c .IntSlice {},ComponentsNumber :&_c .IntSlice {},CentroidPoints :&_b .Points {},CentroidPointsTemplates :&_b .Points {},UndilatedTemplates :&_b .Bitmaps {},DilatedTemplates :&_b .Bitmaps {},ClassInstances :&_b .BitmapsArray {},FgTemplates :&_c .NumSlice {}};
if _g :=_bb .Settings .Validate ();_g !=nil {return nil ,_df .Wrap (_g ,_dcb ,"");};return _bb ,nil ;};type Classer struct{BaseIndex int ;Settings Settings ;ComponentsNumber *_c .IntSlice ;TemplateAreas *_c .IntSlice ;Widths map[int ]int ;Heights map[int ]int ;
NumberOfClasses int ;ClassInstances *_b .BitmapsArray ;UndilatedTemplates *_b .Bitmaps ;DilatedTemplates *_b .Bitmaps ;TemplatesSize _c .IntsMap ;FgTemplates *_c .NumSlice ;CentroidPoints *_b .Points ;CentroidPointsTemplates *_b .Points ;ClassIDs *_c .IntSlice ;
ComponentPageNumbers *_c .IntSlice ;PtaUL *_b .Points ;PtaLL *_b .Points ;};type Settings struct{MaxCompWidth int ;MaxCompHeight int ;SizeHaus int ;RankHaus float64 ;Thresh float64 ;WeightFactor float64 ;KeepClassInstances bool ;Components _b .Component ;
Method Method ;};func (_ge *Classer )getULCorners (_ce *_b .Bitmap ,_ee *_b .Boxes )error {const _dfd ="\u0067\u0065\u0074U\u004c\u0043\u006f\u0072\u006e\u0065\u0072\u0073";if _ce ==nil {return _df .Error (_dfd ,"\u006e\u0069l\u0020\u0069\u006da\u0067\u0065\u0020\u0062\u0069\u0074\u006d\u0061\u0070");
};if _ee ==nil {return _df .Error (_dfd ,"\u006e\u0069\u006c\u0020\u0062\u006f\u0075\u006e\u0064\u0073");};if _ge .PtaUL ==nil {_ge .PtaUL =&_b .Points {};};_gb :=len (*_ee );var (_ab ,_fde ,_bfc ,_ccc int ;_cb ,_bbf ,_bd ,_ca float32 ;_ea error ;_ef *_d .Rectangle ;
_ac *_b .Bitmap ;_dcg _d .Point ;);for _bad :=0;_bad < _gb ;_bad ++{_ab =_ge .BaseIndex +_bad ;if _cb ,_bbf ,_ea =_ge .CentroidPoints .GetGeometry (_ab );_ea !=nil {return _df .Wrap (_ea ,_dfd ,"\u0043\u0065\u006e\u0074\u0072\u006f\u0069\u0064\u0050o\u0069\u006e\u0074\u0073");
};if _fde ,_ea =_ge .ClassIDs .Get (_ab );_ea !=nil {return _df .Wrap (_ea ,_dfd ,"\u0043\u006c\u0061s\u0073\u0049\u0044\u0073\u002e\u0047\u0065\u0074");};if _bd ,_ca ,_ea =_ge .CentroidPointsTemplates .GetGeometry (_fde );_ea !=nil {return _df .Wrap (_ea ,_dfd ,"\u0043\u0065\u006etr\u006f\u0069\u0064\u0050\u006f\u0069\u006e\u0074\u0073\u0054\u0065\u006d\u0070\u006c\u0061\u0074\u0065\u0073");
};_dce :=_bd -_cb ;_eee :=_ca -_bbf ;if _dce >=0{_bfc =int (_dce +0.5);}else {_bfc =int (_dce -0.5);};if _eee >=0{_ccc =int (_eee +0.5);}else {_ccc =int (_eee -0.5);};if _ef ,_ea =_ee .Get (_bad );_ea !=nil {return _df .Wrap (_ea ,_dfd ,"");};_cda ,_ff :=_ef .Min .X ,_ef .Min .Y ;
_ac ,_ea =_ge .UndilatedTemplates .GetBitmap (_fde );if _ea !=nil {return _df .Wrap (_ea ,_dfd ,"\u0055\u006e\u0064\u0069\u006c\u0061\u0074\u0065\u0064\u0054e\u006d\u0070\u006c\u0061\u0074\u0065\u0073.\u0047\u0065\u0074\u0028\u0069\u0043\u006c\u0061\u0073\u0073\u0029");
};_dcg ,_ea =_dde (_ce ,_cda ,_ff ,_bfc ,_ccc ,_ac );if _ea !=nil {return _df .Wrap (_ea ,_dfd ,"");};_ge .PtaUL .AddPoint (float32 (_cda -_bfc +_dcg .X ),float32 (_ff -_ccc +_dcg .Y ));};return nil ;};