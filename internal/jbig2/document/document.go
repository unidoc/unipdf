//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package document ;import (_f "encoding/binary";_d "fmt";_bc "github.com/unidoc/unipdf/v4/common";_e "github.com/unidoc/unipdf/v4/internal/bitwise";_c "github.com/unidoc/unipdf/v4/internal/jbig2/basic";_fd "github.com/unidoc/unipdf/v4/internal/jbig2/bitmap";
_gb "github.com/unidoc/unipdf/v4/internal/jbig2/document/segments";_bcf "github.com/unidoc/unipdf/v4/internal/jbig2/encoder/classer";_gd "github.com/unidoc/unipdf/v4/internal/jbig2/errors";_g "io";_fa "math";_be "runtime/debug";);func (_eedb *Globals )GetSymbolDictionary ()(*_gb .Header ,error ){const _cbd ="G\u006c\u006f\u0062\u0061\u006c\u0073.\u0047\u0065\u0074\u0053\u0079\u006d\u0062\u006f\u006cD\u0069\u0063\u0074i\u006fn\u0061\u0072\u0079";
if _eedb ==nil {return nil ,_gd .Error (_cbd ,"\u0067\u006c\u006f\u0062al\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if len (_eedb .Segments )==0{return nil ,_gd .Error (_cbd ,"\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u0020\u0061\u0072\u0065\u0020e\u006d\u0070\u0074\u0079");
};for _ ,_bbaf :=range _eedb .Segments {if _bbaf .Type ==_gb .TSymbolDictionary {return _bbaf ,nil ;};};return nil ,_gd .Error (_cbd ,"\u0067\u006c\u006fba\u006c\u0020\u0073\u0079\u006d\u0062\u006f\u006c\u0020d\u0069c\u0074i\u006fn\u0061\u0072\u0079\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064");
};func DecodeDocument (input *_e .Reader ,globals *Globals )(*Document ,error ){return _geg (input ,globals );};func (_bee *Page )getWidth ()(int ,error ){const _bffa ="\u0067\u0065\u0074\u0057\u0069\u0064\u0074\u0068";if _bee .FinalWidth !=0{return _bee .FinalWidth ,nil ;
};_fae :=_bee .getPageInformationSegment ();if _fae ==nil {return 0,_gd .Error (_bffa ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");};_gedg ,_eacd :=_fae .GetSegmentData ();if _eacd !=nil {return 0,_gd .Wrap (_eacd ,_bffa ,"");
};_gbab ,_ddg :=_gedg .(*_gb .PageInformationSegment );if !_ddg {return 0,_gd .Errorf (_bffa ,"\u0070\u0061\u0067\u0065\u0020\u0069n\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073 \u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070e\u003a \u0027\u0025\u0054\u0027",_gedg );
};_bee .FinalWidth =_gbab .PageBMWidth ;return _bee .FinalWidth ,nil ;};func (_cdg *Document )Encode ()(_fbf []byte ,_eed error ){const _fg ="\u0044o\u0063u\u006d\u0065\u006e\u0074\u002e\u0045\u006e\u0063\u006f\u0064\u0065";var _ce ,_dcf int ;if _cdg .FullHeaders {if _ce ,_eed =_cdg .encodeFileHeader (_cdg ._de );
_eed !=nil {return nil ,_gd .Wrap (_eed ,_fg ,"");};};var (_dac bool ;_dgg *_gb .Header ;_fff *Page ;);if _eed =_cdg .completeClassifiedPages ();_eed !=nil {return nil ,_gd .Wrap (_eed ,_fg ,"");};if _eed =_cdg .produceClassifiedPages ();_eed !=nil {return nil ,_gd .Wrap (_eed ,_fg ,"");
};if _cdg .GlobalSegments !=nil {for _ ,_dgg =range _cdg .GlobalSegments .Segments {if _eed =_cdg .encodeSegment (_dgg ,&_ce );_eed !=nil {return nil ,_gd .Wrap (_eed ,_fg ,"");};};};for _egc :=1;_egc <=int (_cdg .NumberOfPages );_egc ++{if _fff ,_dac =_cdg .Pages [_egc ];
!_dac {return nil ,_gd .Errorf (_fg ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_egc );};for _ ,_dgg =range _fff .Segments {if _eed =_cdg .encodeSegment (_dgg ,&_ce );_eed !=nil {return nil ,_gd .Wrap (_eed ,_fg ,"");
};};};if _cdg .FullHeaders {if _dcf ,_eed =_cdg .encodeEOFHeader (_cdg ._de );_eed !=nil {return nil ,_gd .Wrap (_eed ,_fg ,"");};_ce +=_dcf ;};_fbf =_cdg ._de .Data ();if len (_fbf )!=_ce {_bc .Log .Debug ("\u0042\u0079\u0074\u0065\u0073 \u0077\u0072\u0069\u0074\u0074\u0065\u006e \u0028\u006e\u0029\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u0065\u0071\u0075\u0061\u006c\u0020\u0074\u006f\u0020\u0074\u0068\u0065\u0020\u006c\u0065\u006e\u0067\u0074\u0068\u0020\u006f\u0066\u0020t\u0068\u0065\u0020\u0064\u0061\u0074\u0061\u0020\u0065\u006e\u0063\u006fd\u0065\u0064\u003a\u0020\u0027\u0025d\u0027",_ce ,len (_fbf ));
};return _fbf ,nil ;};func (_fbe *Page )clearSegmentData (){for _gda :=range _fbe .Segments {_fbe .Segments [_gda ].CleanSegmentData ();};};func (_baed *Document )nextSegmentNumber ()uint32 {_df :=_baed .CurrentSegmentNumber ;_baed .CurrentSegmentNumber ++;
return _df ;};func (_ffe *Page )GetHeight ()(int ,error ){return _ffe .getHeight ()};func (_gca *Document )produceClassifiedPages ()(_fca error ){const _bag ="\u0070\u0072\u006f\u0064uc\u0065\u0043\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064\u0050\u0061\u0067e\u0073";
if _gca .Classer ==nil {return nil ;};var (_eeg *Page ;_ecf bool ;_ccf *_gb .Header ;);for _bca :=1;_bca <=int (_gca .NumberOfPages );_bca ++{if _eeg ,_ecf =_gca .Pages [_bca ];!_ecf {return _gd .Errorf (_bag ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_bca );
};if _eeg .EncodingMethod ==GenericEM {continue ;};if _ccf ==nil {if _ccf ,_fca =_gca .GlobalSegments .GetSymbolDictionary ();_fca !=nil {return _gd .Wrap (_fca ,_bag ,"");};};if _fca =_gca .produceClassifiedPage (_eeg ,_ccf );_fca !=nil {return _gd .Wrapf (_fca ,_bag ,"\u0070\u0061\u0067\u0065\u003a\u0020\u0027\u0025\u0064\u0027",_bca );
};};return nil ;};func (_cee *Document )GetNumberOfPages ()(uint32 ,error ){if _cee .NumberOfPagesUnknown ||_cee .NumberOfPages ==0{if len (_cee .Pages )==0{if _bba :=_cee .mapData ();_bba !=nil {return 0,_gd .Wrap (_bba ,"\u0044o\u0063\u0075\u006d\u0065n\u0074\u002e\u0047\u0065\u0074N\u0075m\u0062e\u0072\u004f\u0066\u0050\u0061\u0067\u0065s","");
};};return uint32 (len (_cee .Pages )),nil ;};return _cee .NumberOfPages ,nil ;};func (_bab *Document )addSymbolDictionary (_ecb int ,_gg *_fd .Bitmaps ,_fb []int ,_gbe map[int ]int ,_cde bool )(*_gb .Header ,error ){const _ag ="\u0061\u0064\u0064\u0053ym\u0062\u006f\u006c\u0044\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079";
_gcf :=&_gb .SymbolDictionary {};if _ecc :=_gcf .InitEncode (_gg ,_fb ,_gbe ,_cde );_ecc !=nil {return nil ,_ecc ;};_gcc :=&_gb .Header {Type :_gb .TSymbolDictionary ,PageAssociation :_ecb ,SegmentData :_gcf };if _ecb ==0{if _bab .GlobalSegments ==nil {_bab .GlobalSegments =&Globals {};
};_bab .GlobalSegments .AddSegment (_gcc );return _gcc ,nil ;};_debe ,_ggd :=_bab .Pages [_ecb ];if !_ggd {return nil ,_gd .Errorf (_ag ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_ecb );};var (_ged int ;
_ed *_gb .Header ;);for _ged ,_ed =range _debe .Segments {if _ed .Type ==_gb .TPageInformation {break ;};};_ged ++;_debe .Segments =append (_debe .Segments ,nil );copy (_debe .Segments [_ged +1:],_debe .Segments [_ged :]);_debe .Segments [_ged ]=_gcc ;
return _gcc ,nil ;};func (_eedd *Document )determineRandomDataOffsets (_ece []*_gb .Header ,_afe uint64 ){if _eedd .OrganizationType !=_gb .ORandom {return ;};for _ ,_bdd :=range _ece {_bdd .SegmentDataStartOffset =_afe ;_afe +=_bdd .SegmentDataLength ;
};};func (_fcgg *Globals )GetSegmentByIndex (index int )(*_gb .Header ,error ){const _fge ="\u0047l\u006f\u0062\u0061\u006cs\u002e\u0047\u0065\u0074\u0053e\u0067m\u0065n\u0074\u0042\u0079\u0049\u006e\u0064\u0065x";if _fcgg ==nil {return nil ,_gd .Error (_fge ,"\u0067\u006c\u006f\u0062al\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};if len (_fcgg .Segments )==0{return nil ,_gd .Error (_fge ,"\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u0020\u0061\u0072\u0065\u0020e\u006d\u0070\u0074\u0079");};if index > len (_fcgg .Segments )-1{return nil ,_gd .Error (_fge ,"\u0069n\u0064e\u0078\u0020\u006f\u0075\u0074 \u006f\u0066 \u0072\u0061\u006e\u0067\u0065");
};return _fcgg .Segments [index ],nil ;};func InitEncodeDocument (fullHeaders bool )*Document {return &Document {FullHeaders :fullHeaders ,_de :_e .BufferedMSB (),Pages :map[int ]*Page {},_eg :map[int ][]int {},_ee :map[int ]int {},_cd :map[int ][]int {}};
};func (_afff *Page )GetWidth ()(int ,error ){return _afff .getWidth ()};func (_ebb *Page )GetSegment (number int )(*_gb .Header ,error ){const _ada ="\u0050a\u0067e\u002e\u0047\u0065\u0074\u0053\u0065\u0067\u006d\u0065\u006e\u0074";for _ ,_cag :=range _ebb .Segments {if _cag .SegmentNumber ==uint32 (number ){return _cag ,nil ;
};};_affc :=make ([]uint32 ,len (_ebb .Segments ));for _bcd ,_bgc :=range _ebb .Segments {_affc [_bcd ]=_bgc .SegmentNumber ;};return nil ,_gd .Errorf (_ada ,"\u0073e\u0067\u006d\u0065n\u0074\u0020\u0077i\u0074h \u006e\u0075\u006d\u0062\u0065\u0072\u003a \u0027\u0025\u0064\u0027\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0069\u006e\u0020\u0074\u0068\u0065\u0020\u0070\u0061\u0067\u0065\u003a\u0020'%\u0064'\u002e\u0020\u004b\u006e\u006f\u0077n\u0020\u0073\u0065\u0067\u006de\u006e\u0074\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u0073\u003a \u0025\u0076",number ,_ebb .PageNumber ,_affc );
};func (_acf *Document )GetPage (pageNumber int )(_gb .Pager ,error ){const _ffcg ="\u0044\u006fc\u0075\u006d\u0065n\u0074\u002e\u0047\u0065\u0074\u0050\u0061\u0067\u0065";if pageNumber < 0{_bc .Log .Debug ("\u004a\u0042\u0049\u00472\u0020\u0050\u0061\u0067\u0065\u0020\u002d\u0020\u0047e\u0074\u0050\u0061\u0067\u0065\u003a\u0020\u0025\u0064\u002e\u0020\u0050\u0061\u0067\u0065\u0020\u0063\u0061n\u006e\u006f\u0074\u0020\u0062e\u0020\u006c\u006f\u0077\u0065\u0072\u0020\u0074\u0068\u0061\u006e\u0020\u0030\u002e\u0020\u0025\u0073",pageNumber ,_be .Stack ());
return nil ,_gd .Errorf (_ffcg ,"\u0069\u006e\u0076\u0061l\u0069\u0064\u0020\u006a\u0062\u0069\u0067\u0032\u0020d\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u0020\u002d\u0020\u0070\u0072\u006f\u0076\u0069\u0064\u0065\u0064 \u0069\u006e\u0076\u0061\u006ci\u0064\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u003a\u0020\u0025\u0064",pageNumber );
};if pageNumber > len (_acf .Pages ){_bc .Log .Debug ("\u0050\u0061\u0067\u0065 n\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u003a\u0020\u0025\u0064\u002e\u0020%\u0073",pageNumber ,_be .Stack ());return nil ,_gd .Error (_ffcg ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006a\u0062\u0069\u0067\u0032 \u0064\u006f\u0063\u0075\u006d\u0065n\u0074\u0020\u002d\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064");
};_aa ,_ebg :=_acf .Pages [pageNumber ];if !_ebg {_bc .Log .Debug ("\u0050\u0061\u0067\u0065 n\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u003a\u0020\u0025\u0064\u002e\u0020%\u0073",pageNumber ,_be .Stack ());return nil ,_gd .Errorf (_ffcg ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006a\u0062\u0069\u0067\u0032 \u0064\u006f\u0063\u0075\u006d\u0065n\u0074\u0020\u002d\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064");
};return _aa ,nil ;};func (_beb *Document )produceClassifiedPage (_cf *Page ,_fe *_gb .Header )(_da error ){const _ab ="p\u0072\u006f\u0064\u0075ce\u0043l\u0061\u0073\u0073\u0069\u0066i\u0065\u0064\u0050\u0061\u0067\u0065";var _eea map[int ]int ;_eb :=_beb ._a ;
_bad :=[]*_gb .Header {_fe };if len (_beb ._eg [_cf .PageNumber ])> 0{_eea =map[int ]int {};_bea ,_dc :=_beb .addSymbolDictionary (_cf .PageNumber ,_beb .Classer .UndilatedTemplates ,_beb ._eg [_cf .PageNumber ],_eea ,false );if _dc !=nil {return _gd .Wrap (_dc ,_ab ,"");
};_bad =append (_bad ,_bea );_eb +=len (_beb ._eg [_cf .PageNumber ]);};_cfa :=_beb ._cd [_cf .PageNumber ];_bc .Log .Debug ("P\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020c\u006f\u006d\u0070\u0073: \u0025\u0076",_cf .PageNumber ,_cfa );_cf .addTextRegionSegment (_bad ,_beb ._ee ,_eea ,_beb ._cd [_cf .PageNumber ],_beb .Classer .PtaLL ,_beb .Classer .UndilatedTemplates ,_beb .Classer .ClassIDs ,nil ,_db (_eb ),len (_beb ._cd [_cf .PageNumber ]));
return nil ;};func _geg (_aeg *_e .Reader ,_gcac *Globals )(*Document ,error ){_aee :=&Document {Pages :make (map[int ]*Page ),InputStream :_aeg ,OrganizationType :_gb .OSequential ,NumberOfPagesUnknown :true ,GlobalSegments :_gcac ,_bd :9};if _aee .GlobalSegments ==nil {_aee .GlobalSegments =&Globals {};
};if _fagc :=_aee .mapData ();_fagc !=nil {return nil ,_fagc ;};return _aee ,nil ;};func (_ccfd *Document )encodeEOFHeader (_dae _e .BinaryWriter )(_aga int ,_eac error ){_fea :=&_gb .Header {SegmentNumber :_ccfd .nextSegmentNumber (),Type :_gb .TEndOfFile };
if _aga ,_eac =_fea .Encode (_dae );_eac !=nil {return 0,_gd .Wrap (_eac ,"\u0065n\u0063o\u0064\u0065\u0045\u004f\u0046\u0048\u0065\u0061\u0064\u0065\u0072","");};return _aga ,nil ;};func (_dbc *Document )encodeFileHeader (_eedf _e .BinaryWriter )(_dca int ,_gec error ){const _gecd ="\u0065\u006ec\u006f\u0064\u0065F\u0069\u006c\u0065\u0048\u0065\u0061\u0064\u0065\u0072";
_dca ,_gec =_eedf .Write (_gc );if _gec !=nil {return _dca ,_gd .Wrap (_gec ,_gecd ,"\u0069\u0064");};if _gec =_eedf .WriteByte (0x01);_gec !=nil {return _dca ,_gd .Wrap (_gec ,_gecd ,"\u0066\u006c\u0061g\u0073");};_dca ++;_gcea :=make ([]byte ,4);_f .BigEndian .PutUint32 (_gcea ,_dbc .NumberOfPages );
_gcg ,_gec :=_eedf .Write (_gcea );if _gec !=nil {return _gcg ,_gd .Wrap (_gec ,_gecd ,"p\u0061\u0067\u0065\u0020\u006e\u0075\u006d\u0062\u0065\u0072");};_dca +=_gcg ;return _dca ,nil ;};func (_egbe *Page )getPageInformationSegment ()*_gb .Header {for _ ,_efb :=range _egbe .Segments {if _efb .Type ==_gb .TPageInformation {return _efb ;
};};_bc .Log .Debug ("\u0050\u0061\u0067\u0065\u0020\u0069\u006e\u0066o\u0072\u006d\u0061ti\u006f\u006e\u0020\u0073\u0065\u0067m\u0065\u006e\u0074\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0066o\u0072\u0020\u0070\u0061\u0067\u0065\u003a\u0020%\u0073\u002e",_egbe );
return nil ;};type Page struct{Segments []*_gb .Header ;PageNumber int ;Bitmap *_fd .Bitmap ;FinalHeight int ;FinalWidth int ;ResolutionX int ;ResolutionY int ;IsLossless bool ;Document *Document ;FirstSegmentNumber int ;EncodingMethod EncodingMethod ;
BlackIsOne bool ;};func (_aeb *Document )GetGlobalSegment (i int )(*_gb .Header ,error ){_ccga ,_ded :=_aeb .GlobalSegments .GetSegment (i );if _ded !=nil {return nil ,_gd .Wrap (_ded ,"\u0047\u0065t\u0047\u006c\u006fb\u0061\u006c\u0053\u0065\u0067\u006d\u0065\u006e\u0074","");
};return _ccga ,nil ;};func (_gdcd *Page )GetResolutionY ()(int ,error ){return _gdcd .getResolutionY ()};func (_fdf *Page )Encode (w _e .BinaryWriter )(_bede int ,_agg error ){const _ffac ="P\u0061\u0067\u0065\u002e\u0045\u006e\u0063\u006f\u0064\u0065";
var _ffb int ;for _ ,_aea :=range _fdf .Segments {if _ffb ,_agg =_aea .Encode (w );_agg !=nil {return _bede ,_gd .Wrap (_agg ,_ffac ,"");};_bede +=_ffb ;};return _bede ,nil ;};func (_ebeg *Page )AddEndOfPageSegment (){_cgf :=&_gb .Header {Type :_gb .TEndOfPage ,PageAssociation :_ebeg .PageNumber };
_ebeg .Segments =append (_ebeg .Segments ,_cgf );};func (_acc *Document )mapData ()error {const _cea ="\u006da\u0070\u0044\u0061\u0074\u0061";var (_bbe []*_gb .Header ;_fcg int64 ;_gcgf _gb .Type ;);_afg ,_dedc :=_acc .isFileHeaderPresent ();if _dedc !=nil {return _gd .Wrap (_dedc ,_cea ,"");
};if _afg {if _dedc =_acc .parseFileHeader ();_dedc !=nil {return _gd .Wrap (_dedc ,_cea ,"");};_fcg +=int64 (_acc ._bd );_acc .FullHeaders =true ;};var (_gba *Page ;_eba bool ;);for _gcgf !=51&&!_eba {_afeb ,_fec :=_gb .NewHeader (_acc ,_acc .InputStream ,_fcg ,_acc .OrganizationType );
if _fec !=nil {return _gd .Wrap (_fec ,_cea ,"");};_bc .Log .Trace ("\u0044\u0065c\u006f\u0064\u0069\u006eg\u0020\u0073e\u0067\u006d\u0065\u006e\u0074\u0020\u006e\u0075m\u0062\u0065\u0072\u003a\u0020\u0025\u0064\u002c\u0020\u0054\u0079\u0070e\u003a\u0020\u0025\u0073",_afeb .SegmentNumber ,_afeb .Type );
_gcgf =_afeb .Type ;if _gcgf !=_gb .TEndOfFile {if _afeb .PageAssociation !=0{_gba =_acc .Pages [_afeb .PageAssociation ];if _gba ==nil {_gba =_bcdc (_acc ,_afeb .PageAssociation );_acc .Pages [_afeb .PageAssociation ]=_gba ;if _acc .NumberOfPagesUnknown {_acc .NumberOfPages ++;
};};_gba .Segments =append (_gba .Segments ,_afeb );}else {_acc .GlobalSegments .AddSegment (_afeb );};};_bbe =append (_bbe ,_afeb );_fcg =_acc .InputStream .AbsolutePosition ();if _acc .OrganizationType ==_gb .OSequential {_fcg +=int64 (_afeb .SegmentDataLength );
};_eba ,_fec =_acc .reachedEOF (_fcg );if _fec !=nil {_bc .Log .Debug ("\u006a\u0062\u0069\u0067\u0032 \u0064\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u0020\u0072\u0065\u0061\u0063h\u0065\u0064\u0020\u0045\u004f\u0046\u0020\u0077\u0069\u0074\u0068\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0076",_fec );
return _gd .Wrap (_fec ,_cea ,"");};};_acc .determineRandomDataOffsets (_bbe ,uint64 (_fcg ));return nil ;};func (_afdf *Page )nextSegmentNumber ()uint32 {return _afdf .Document .nextSegmentNumber ()};func (_edce *Page )getResolutionX ()(int ,error ){const _ecg ="\u0067\u0065\u0074\u0052\u0065\u0073\u006f\u006c\u0075t\u0069\u006f\u006e\u0058";
if _edce .ResolutionX !=0{return _edce .ResolutionX ,nil ;};_cga :=_edce .getPageInformationSegment ();if _cga ==nil {return 0,_gd .Error (_ecg ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");};_eae ,_dda :=_cga .GetSegmentData ();
if _dda !=nil {return 0,_gd .Wrap (_dda ,_ecg ,"");};_afga ,_eaaf :=_eae .(*_gb .PageInformationSegment );if !_eaaf {return 0,_gd .Errorf (_ecg ,"\u0070\u0061\u0067\u0065\u0020\u0069n\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073 \u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070e\u003a \u0027\u0025\u0054\u0027",_eae );
};_edce .ResolutionX =_afga .ResolutionX ;return _edce .ResolutionX ,nil ;};func _bcdc (_cfe *Document ,_ecee int )*Page {return &Page {Document :_cfe ,PageNumber :_ecee ,Segments :[]*_gb .Header {}};};func (_ae *Document )AddClassifiedPage (bm *_fd .Bitmap ,method _bcf .Method )(_gcb error ){const _cb ="\u0044\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u002e\u0041\u0064d\u0043\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064P\u0061\u0067\u0065";
if !_ae .FullHeaders &&_ae .NumberOfPages !=0{return _gd .Error (_cb ,"\u0064\u006f\u0063\u0075\u006de\u006e\u0074\u0020\u0061\u006c\u0072\u0065a\u0064\u0079\u0020\u0063\u006f\u006e\u0074\u0061\u0069\u006e\u0073\u0020\u0070\u0061\u0067\u0065\u002e\u0020\u0046\u0069\u006c\u0065\u004d\u006f\u0064\u0065\u0020\u0064\u0069\u0073\u0061\u006c\u006c\u006f\u0077\u0073\u0020\u0061\u0064\u0064i\u006e\u0067\u0020\u006d\u006f\u0072\u0065\u0020\u0074\u0068\u0061\u006e \u006f\u006e\u0065\u0020\u0070\u0061g\u0065");
};if _ae .Classer ==nil {if _ae .Classer ,_gcb =_bcf .Init (_bcf .DefaultSettings ());_gcb !=nil {return _gd .Wrap (_gcb ,_cb ,"");};};_ec :=int (_ae .nextPageNumber ());_gf :=&Page {Segments :[]*_gb .Header {},Bitmap :bm ,Document :_ae ,FinalHeight :bm .Height ,FinalWidth :bm .Width ,PageNumber :_ec };
_ae .Pages [_ec ]=_gf ;switch method {case _bcf .RankHaus :_gf .EncodingMethod =RankHausEM ;case _bcf .Correlation :_gf .EncodingMethod =CorrelationEM ;};_gf .AddPageInformationSegment ();if _gcb =_ae .Classer .AddPage (bm ,_ec ,method );_gcb !=nil {return _gd .Wrap (_gcb ,_cb ,"");
};if _ae .FullHeaders {_gf .AddEndOfPageSegment ();};return nil ;};func _db (_ea int )int {_dad :=0;_dcg :=(_ea &(_ea -1))==0;_ea >>=1;for ;_ea !=0;_ea >>=1{_dad ++;};if _dcg {return _dad ;};return _dad +1;};func (_bae *Document )encodeSegment (_ecff *_gb .Header ,_gedd *int )error {const _ffc ="\u0065\u006e\u0063\u006f\u0064\u0065\u0053\u0065\u0067\u006d\u0065\u006e\u0074";
_ecff .SegmentNumber =_bae .nextSegmentNumber ();_abd ,_fda :=_ecff .Encode (_bae ._de );if _fda !=nil {return _gd .Wrapf (_fda ,_ffc ,"\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u003a\u0020\u0027\u0025\u0064\u0027",_ecff .SegmentNumber );};*_gedd +=_abd ;
return nil ;};func (_bg *Document )AddGenericPage (bm *_fd .Bitmap ,duplicateLineRemoval bool )(_ge error ){const _cc ="\u0044\u006f\u0063um\u0065\u006e\u0074\u002e\u0041\u0064\u0064\u0047\u0065\u006e\u0065\u0072\u0069\u0063\u0050\u0061\u0067\u0065";if !_bg .FullHeaders &&_bg .NumberOfPages !=0{return _gd .Error (_cc ,"\u0064\u006f\u0063\u0075\u006de\u006e\u0074\u0020\u0061\u006c\u0072\u0065a\u0064\u0079\u0020\u0063\u006f\u006e\u0074\u0061\u0069\u006e\u0073\u0020\u0070\u0061\u0067\u0065\u002e\u0020\u0046\u0069\u006c\u0065\u004d\u006f\u0064\u0065\u0020\u0064\u0069\u0073\u0061\u006c\u006c\u006f\u0077\u0073\u0020\u0061\u0064\u0064i\u006e\u0067\u0020\u006d\u006f\u0072\u0065\u0020\u0074\u0068\u0061\u006e \u006f\u006e\u0065\u0020\u0070\u0061g\u0065");
};_gbf :=&Page {Segments :[]*_gb .Header {},Bitmap :bm ,Document :_bg ,FinalHeight :bm .Height ,FinalWidth :bm .Width ,IsLossless :true ,BlackIsOne :bm .Color ==_fd .Chocolate };_gbf .PageNumber =int (_bg .nextPageNumber ());_bg .Pages [_gbf .PageNumber ]=_gbf ;
bm .InverseData ();_gbf .AddPageInformationSegment ();if _ge =_gbf .AddGenericRegion (bm ,0,0,0,_gb .TImmediateGenericRegion ,duplicateLineRemoval );_ge !=nil {return _gd .Wrap (_ge ,_cc ,"");};if _bg .FullHeaders {_gbf .AddEndOfPageSegment ();};return nil ;
};func (_eag *Page )getResolutionY ()(int ,error ){const _beg ="\u0067\u0065\u0074\u0052\u0065\u0073\u006f\u006c\u0075t\u0069\u006f\u006e\u0059";if _eag .ResolutionY !=0{return _eag .ResolutionY ,nil ;};_cad :=_eag .getPageInformationSegment ();if _cad ==nil {return 0,_gd .Error (_beg ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");
};_fbg ,_cab :=_cad .GetSegmentData ();if _cab !=nil {return 0,_gd .Wrap (_cab ,_beg ,"");};_fdfd ,_fcfa :=_fbg .(*_gb .PageInformationSegment );if !_fcfa {return 0,_gd .Errorf (_beg ,"\u0070\u0061\u0067\u0065\u0020\u0069\u006e\u0066o\u0072\u006d\u0061ti\u006f\u006e\u0020\u0073\u0065\u0067m\u0065\u006e\u0074\u0020\u0069\u0073\u0020\u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006ci\u0064\u0020\u0074\u0079\u0070\u0065\u003a\u0027%\u0054\u0027",_fbg );
};_eag .ResolutionY =_fdfd .ResolutionY ;return _eag .ResolutionY ,nil ;};func (_ced *Page )createNormalPage (_bdf *_gb .PageInformationSegment )error {const _eebd ="\u0063\u0072e\u0061\u0074\u0065N\u006f\u0072\u006d\u0061\u006c\u0050\u0061\u0067\u0065";
_ced .Bitmap =_fd .New (_bdf .PageBMWidth ,_bdf .PageBMHeight );if _bdf .DefaultPixelValue !=0{_ced .Bitmap .SetDefaultPixel ();};for _ ,_geb :=range _ced .Segments {switch _geb .Type {case 6,7,22,23,38,39,42,43:_bc .Log .Trace ("\u0047\u0065\u0074\u0074in\u0067\u0020\u0053\u0065\u0067\u006d\u0065\u006e\u0074\u003a\u0020\u0025\u0064",_geb .SegmentNumber );
_efeb ,_gfc :=_geb .GetSegmentData ();if _gfc !=nil {return _gfc ;};_baf ,_bafg :=_efeb .(_gb .Regioner );if !_bafg {_bc .Log .Debug ("\u0053\u0065g\u006d\u0065\u006e\u0074\u003a\u0020\u0025\u0054\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u0061\u0020\u0052\u0065\u0067\u0069on\u0065\u0072",_efeb );
return _gd .Errorf (_eebd ,"i\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006a\u0062i\u0067\u0032\u0020\u0073\u0065\u0067\u006den\u0074\u0020\u0074\u0079p\u0065\u0020\u002d\u0020\u006e\u006f\u0074\u0020\u0061 R\u0065\u0067i\u006f\u006e\u0065\u0072\u003a\u0020\u0025\u0054",_efeb );
};_gbfa ,_gfc :=_baf .GetRegionBitmap ();if _gfc !=nil {return _gd .Wrap (_gfc ,_eebd ,"");};if _ced .fitsPage (_bdf ,_gbfa ){_ced .Bitmap =_gbfa ;}else {_feg :=_baf .GetRegionInfo ();_fgb :=_ced .getCombinationOperator (_bdf ,_feg .CombinaionOperator );
_gfc =_fd .Blit (_gbfa ,_ced .Bitmap ,int (_feg .XLocation ),int (_feg .YLocation ),_fgb );if _gfc !=nil {return _gd .Wrap (_gfc ,_eebd ,"");};};};};return nil ;};type Document struct{Pages map[int ]*Page ;NumberOfPagesUnknown bool ;NumberOfPages uint32 ;
GBUseExtTemplate bool ;InputStream *_e .Reader ;GlobalSegments *Globals ;OrganizationType _gb .OrganizationType ;Classer *_bcf .Classer ;XRes ,YRes int ;FullHeaders bool ;CurrentSegmentNumber uint32 ;AverageTemplates *_fd .Bitmaps ;BaseIndexes []int ;Refinement bool ;
RefineLevel int ;_bd uint8 ;_de *_e .BufferedWriter ;EncodeGlobals bool ;_a int ;_eg map[int ][]int ;_cd map[int ][]int ;_ba []int ;_ee map[int ]int ;};func (_dge *Page )AddGenericRegion (bm *_fd .Bitmap ,xloc ,yloc ,template int ,tp _gb .Type ,duplicateLineRemoval bool )error {const _bed ="P\u0061\u0067\u0065\u002eAd\u0064G\u0065\u006e\u0065\u0072\u0069c\u0052\u0065\u0067\u0069\u006f\u006e";
_gfg :=&_gb .GenericRegion {};if _cec :=_gfg .InitEncode (bm ,xloc ,yloc ,template ,duplicateLineRemoval );_cec !=nil {return _gd .Wrap (_cec ,_bed ,"");};_fcf :=&_gb .Header {Type :_gb .TImmediateGenericRegion ,PageAssociation :_dge .PageNumber ,SegmentData :_gfg };
_dge .Segments =append (_dge .Segments ,_fcf );return nil ;};type Globals struct{Segments []*_gb .Header ;};func (_gag *Globals )AddSegment (segment *_gb .Header ){_gag .Segments =append (_gag .Segments ,segment )};func (_eaf *Page )addTextRegionSegment (_aegg []*_gb .Header ,_dfc ,_edd map[int ]int ,_eeb []int ,_cfd *_fd .Points ,_dde *_fd .Bitmaps ,_gede *_c .IntSlice ,_fgg *_fd .Boxes ,_gfb ,_baa int ){_feff :=&_gb .TextRegion {NumberOfSymbols :uint32 (_baa )};
_feff .InitEncode (_dfc ,_edd ,_eeb ,_cfd ,_dde ,_gede ,_fgg ,_eaf .FinalWidth ,_eaf .FinalHeight ,_gfb );_ace :=&_gb .Header {RTSegments :_aegg ,SegmentData :_feff ,PageAssociation :_eaf .PageNumber ,Type :_gb .TImmediateTextRegion };_gcce :=_gb .TPageInformation ;
if _edd !=nil {_gcce =_gb .TSymbolDictionary ;};var _gfd int ;for ;_gfd < len (_eaf .Segments );_gfd ++{if _eaf .Segments [_gfd ].Type ==_gcce {_gfd ++;break ;};};_eaf .Segments =append (_eaf .Segments ,nil );copy (_eaf .Segments [_gfd +1:],_eaf .Segments [_gfd :]);
_eaf .Segments [_gfd ]=_ace ;};func (_eaeb *Page )lastSegmentNumber ()(_bega uint32 ,_dce error ){const _gdab ="\u006c\u0061\u0073\u0074\u0053\u0065\u0067\u006d\u0065\u006e\u0074\u004eu\u006d\u0062\u0065\u0072";if len (_eaeb .Segments )==0{return _bega ,_gd .Errorf (_gdab ,"\u006e\u006f\u0020se\u0067\u006d\u0065\u006e\u0074\u0073\u0020\u0066\u006fu\u006ed\u0020i\u006e \u0074\u0068\u0065\u0020\u0070\u0061\u0067\u0065\u0020\u0027\u0025\u0064\u0027",_eaeb .PageNumber );
};return _eaeb .Segments [len (_eaeb .Segments )-1].SegmentNumber ,nil ;};func (_afc *Page )getHeight ()(int ,error ){const _dgb ="\u0067e\u0074\u0048\u0065\u0069\u0067\u0068t";if _afc .FinalHeight !=0{return _afc .FinalHeight ,nil ;};_cdd :=_afc .getPageInformationSegment ();
if _cdd ==nil {return 0,_gd .Error (_dgb ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");};_fdeg ,_fbb :=_cdd .GetSegmentData ();if _fbb !=nil {return 0,_gd .Wrap (_fbb ,_dgb ,"");};_badc ,_gedc :=_fdeg .(*_gb .PageInformationSegment );
if !_gedc {return 0,_gd .Errorf (_dgb ,"\u0070\u0061\u0067\u0065\u0020\u0069n\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073 \u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070e\u003a \u0027\u0025\u0054\u0027",_fdeg );
};if _badc .PageBMHeight ==_fa .MaxInt32 {_ ,_fbb =_afc .GetBitmap ();if _fbb !=nil {return 0,_gd .Wrap (_fbb ,_dgb ,"");};}else {_afc .FinalHeight =_badc .PageBMHeight ;};return _afc .FinalHeight ,nil ;};func (_aff *Document )parseFileHeader ()error {const _aaa ="\u0070a\u0072s\u0065\u0046\u0069\u006c\u0065\u0048\u0065\u0061\u0064\u0065\u0072";
_ ,_bcaf :=_aff .InputStream .Seek (8,_g .SeekStart );if _bcaf !=nil {return _gd .Wrap (_bcaf ,_aaa ,"\u0069\u0064");};_ ,_bcaf =_aff .InputStream .ReadBits (5);if _bcaf !=nil {return _gd .Wrap (_bcaf ,_aaa ,"\u0072\u0065\u0073\u0065\u0072\u0076\u0065\u0064\u0020\u0062\u0069\u0074\u0073");
};_deab ,_bcaf :=_aff .InputStream .ReadBit ();if _bcaf !=nil {return _gd .Wrap (_bcaf ,_aaa ,"\u0065x\u0074e\u006e\u0064\u0065\u0064\u0020t\u0065\u006dp\u006c\u0061\u0074\u0065\u0073");};if _deab ==1{_aff .GBUseExtTemplate =true ;};_deab ,_bcaf =_aff .InputStream .ReadBit ();
if _bcaf !=nil {return _gd .Wrap (_bcaf ,_aaa ,"\u0075\u006e\u006b\u006eow\u006e\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u0075\u006d\u0062\u0065\u0072");};if _deab !=1{_aff .NumberOfPagesUnknown =false ;};_deab ,_bcaf =_aff .InputStream .ReadBit ();if _bcaf !=nil {return _gd .Wrap (_bcaf ,_aaa ,"\u006f\u0072\u0067\u0061\u006e\u0069\u007a\u0061\u0074\u0069\u006f\u006e \u0074\u0079\u0070\u0065");
};_aff .OrganizationType =_gb .OrganizationType (_deab );if !_aff .NumberOfPagesUnknown {_aff .NumberOfPages ,_bcaf =_aff .InputStream .ReadUint32 ();if _bcaf !=nil {return _gd .Wrap (_bcaf ,_aaa ,"\u006eu\u006db\u0065\u0072\u0020\u006f\u0066\u0020\u0070\u0061\u0067\u0065\u0073");
};_aff ._bd =13;};return nil ;};func (_dgea *Page )composePageBitmap ()error {const _dgf ="\u0063\u006f\u006d\u0070\u006f\u0073\u0065\u0050\u0061\u0067\u0065\u0042i\u0074\u006d\u0061\u0070";if _dgea .PageNumber ==0{return nil ;};_efe :=_dgea .getPageInformationSegment ();
if _efe ==nil {return _gd .Error (_dgf ,"\u0070\u0061\u0067e \u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069o\u006e \u0073e\u0067m\u0065\u006e\u0074\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064");};_ggg ,_gaa :=_efe .GetSegmentData ();
if _gaa !=nil {return _gaa ;};_ggc ,_ega :=_ggg .(*_gb .PageInformationSegment );if !_ega {return _gd .Error (_dgf ,"\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006da\u0074\u0069\u006f\u006e \u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073\u0020\u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070\u0065");
};if _gaa =_dgea .createPage (_ggc );_gaa !=nil {return _gd .Wrap (_gaa ,_dgf ,"");};_dgea .clearSegmentData ();return nil ;};func (_fcb *Document )completeSymbols ()(_ccg error ){const _ecd ="\u0063o\u006dp\u006c\u0065\u0074\u0065\u0053\u0079\u006d\u0062\u006f\u006c\u0073";
if _fcb .Classer ==nil {return nil ;};if _fcb .Classer .UndilatedTemplates ==nil {return _gd .Error (_ecd ,"\u006e\u006f t\u0065\u006d\u0070l\u0061\u0074\u0065\u0073 de\u0066in\u0065\u0064\u0020\u0066\u006f\u0072\u0020th\u0065\u0020\u0063\u006c\u0061\u0073\u0073e\u0072");
};_fde :=len (_fcb .Pages )==1;_adg :=make ([]int ,_fcb .Classer .UndilatedTemplates .Size ());var _dg int ;for _ef :=0;_ef < _fcb .Classer .ClassIDs .Size ();_ef ++{_dg ,_ccg =_fcb .Classer .ClassIDs .Get (_ef );if _ccg !=nil {return _gd .Wrap (_ccg ,_ecd ,"\u0063\u006c\u0061\u0073\u0073\u0020\u0049\u0044\u0027\u0073");
};_adg [_dg ]++;};var _gce []int ;for _gfe :=0;_gfe < _fcb .Classer .UndilatedTemplates .Size ();_gfe ++{if _adg [_gfe ]==0{return _gd .Error (_ecd ,"\u006eo\u0020\u0073y\u006d\u0062\u006f\u006cs\u0020\u0069\u006es\u0074\u0061\u006e\u0063\u0065\u0073\u0020\u0066\u006fun\u0064\u0020\u0066o\u0072\u0020g\u0069\u0076\u0065\u006e\u0020\u0063l\u0061\u0073s\u003f\u0020");
};if _adg [_gfe ]> 1||_fde {_gce =append (_gce ,_gfe );};};_fcb ._a =len (_gce );var _bf ,_cgg int ;for _edc :=0;_edc < _fcb .Classer .ComponentPageNumbers .Size ();_edc ++{_bf ,_ccg =_fcb .Classer .ComponentPageNumbers .Get (_edc );if _ccg !=nil {return _gd .Wrapf (_ccg ,_ecd ,"p\u0061\u0067\u0065\u003a\u0020\u0027\u0025\u0064\u0027 \u006e\u006f\u0074\u0020\u0066\u006f\u0075nd\u0020\u0069\u006e\u0020t\u0068\u0065\u0020\u0063\u006c\u0061\u0073\u0073\u0065r \u0070\u0061g\u0065\u006e\u0075\u006d\u0062\u0065\u0072\u0073",_edc );
};_cgg ,_ccg =_fcb .Classer .ClassIDs .Get (_edc );if _ccg !=nil {return _gd .Wrapf (_ccg ,_ecd ,"\u0063\u0061\u006e\u0027\u0074\u0020\u0067e\u0074\u0020\u0073y\u006d\u0062\u006f\u006c \u0066\u006f\u0072\u0020\u0070\u0061\u0067\u0065\u0020\u0027\u0025\u0064\u0027\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u006c\u0061\u0073\u0073\u0065\u0072",_bf );
};if _adg [_cgg ]==1&&!_fde {_fcb ._eg [_bf ]=append (_fcb ._eg [_bf ],_cgg );};};if _ccg =_fcb .Classer .ComputeLLCorners ();_ccg !=nil {return _gd .Wrap (_ccg ,_ecd ,"");};return nil ;};const (GenericEM EncodingMethod =iota ;CorrelationEM ;RankHausEM ;
);type EncodingMethod int ;func (_efd *Page )createStripedPage (_fdad *_gb .PageInformationSegment )error {const _feb ="\u0063\u0072\u0065\u0061\u0074\u0065\u0053\u0074\u0072\u0069\u0070\u0065d\u0050\u0061\u0067\u0065";_ddfd ,_agab :=_efd .collectPageStripes ();
if _agab !=nil {return _gd .Wrap (_agab ,_feb ,"");};var _gab int ;for _ ,_dbg :=range _ddfd {if _egdg ,_bff :=_dbg .(*_gb .EndOfStripe );_bff {_gab =_egdg .LineNumber ()+1;}else {_eaa :=_dbg .(_gb .Regioner );_dcad :=_eaa .GetRegionInfo ();_aad :=_efd .getCombinationOperator (_fdad ,_dcad .CombinaionOperator );
_dege ,_add :=_eaa .GetRegionBitmap ();if _add !=nil {return _gd .Wrap (_add ,_feb ,"");};_add =_fd .Blit (_dege ,_efd .Bitmap ,int (_dcad .XLocation ),_gab ,_aad );if _add !=nil {return _gd .Wrap (_add ,_feb ,"");};};};return nil ;};func (_dea *Document )isFileHeaderPresent ()(bool ,error ){_dea .InputStream .Mark ();
for _ ,_ffa :=range _gc {_bbb ,_bbae :=_dea .InputStream .ReadByte ();if _bbae !=nil {return false ,_bbae ;};if _ffa !=_bbb {_dea .InputStream .Reset ();return false ,nil ;};};_dea .InputStream .Reset ();return true ,nil ;};func (_gbb *Page )createPage (_bef *_gb .PageInformationSegment )error {var _bfcc error ;
if !_bef .IsStripe ||_bef .PageBMHeight !=-1{_bfcc =_gbb .createNormalPage (_bef );}else {_bfcc =_gbb .createStripedPage (_bef );};return _bfcc ;};func (_ebe *Globals )GetSegment (segmentNumber int )(*_gb .Header ,error ){const _egce ="\u0047l\u006fb\u0061\u006c\u0073\u002e\u0047e\u0074\u0053e\u0067\u006d\u0065\u006e\u0074";
if _ebe ==nil {return nil ,_gd .Error (_egce ,"\u0067\u006c\u006f\u0062al\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if len (_ebe .Segments )==0{return nil ,_gd .Error (_egce ,"\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u0020\u0061\u0072\u0065\u0020e\u006d\u0070\u0074\u0079");
};var _cfb *_gb .Header ;for _ ,_cfb =range _ebe .Segments {if _cfb .SegmentNumber ==uint32 (segmentNumber ){break ;};};if _cfb ==nil {return nil ,_gd .Error (_egce ,"\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064");
};return _cfb ,nil ;};func (_ceg *Page )AddPageInformationSegment (){_abb :=&_gb .PageInformationSegment {PageBMWidth :_ceg .FinalWidth ,PageBMHeight :_ceg .FinalHeight ,ResolutionX :_ceg .ResolutionX ,ResolutionY :_ceg .ResolutionY ,IsLossless :_ceg .IsLossless };
if _ceg .BlackIsOne {_abb .DefaultPixelValue =uint8 (0x1);};_cfab :=&_gb .Header {PageAssociation :_ceg .PageNumber ,SegmentDataLength :uint64 (_abb .Size ()),SegmentData :_abb ,Type :_gb .TPageInformation };_ceg .Segments =append (_ceg .Segments ,_cfab );
};func (_dfg *Document )reachedEOF (_edf int64 )(bool ,error ){const _ga ="\u0072\u0065\u0061\u0063\u0068\u0065\u0064\u0045\u004f\u0046";_ ,_bgg :=_dfg .InputStream .Seek (_edf ,_g .SeekStart );if _bgg !=nil {_bc .Log .Debug ("\u0072\u0065\u0061c\u0068\u0065\u0064\u0045\u004f\u0046\u0020\u002d\u0020\u0064\u002e\u0049\u006e\u0070\u0075\u0074\u0053\u0074\u0072\u0065\u0061\u006d\u002e\u0053\u0065\u0065\u006b\u0020\u0066a\u0069\u006c\u0065\u0064\u003a\u0020\u0025\u0076",_bgg );
return false ,_gd .Wrap (_bgg ,_ga ,"\u0069n\u0070\u0075\u0074\u0020\u0073\u0074\u0072\u0065\u0061\u006d\u0020s\u0065\u0065\u006b\u0020\u0066\u0061\u0069\u006c\u0065\u0064");};_ ,_bgg =_dfg .InputStream .ReadBits (32);if _bgg ==_g .EOF {return true ,nil ;
}else if _bgg !=nil {return false ,_gd .Wrap (_bgg ,_ga ,"");};return false ,nil ;};func (_ddf *Page )GetResolutionX ()(int ,error ){return _ddf .getResolutionX ()};func (_gfa *Document )nextPageNumber ()uint32 {_gfa .NumberOfPages ++;return _gfa .NumberOfPages };
func (_eec *Document )completeClassifiedPages ()(_fc error ){const _ad ="\u0063\u006f\u006dpl\u0065\u0074\u0065\u0043\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064\u0050\u0061\u0067\u0065\u0073";if _eec .Classer ==nil {return nil ;};_eec ._ba =make ([]int ,_eec .Classer .UndilatedTemplates .Size ());
for _ac :=0;_ac < _eec .Classer .ClassIDs .Size ();_ac ++{_fag ,_gdc :=_eec .Classer .ClassIDs .Get (_ac );if _gdc !=nil {return _gd .Wrapf (_gdc ,_ad ,"\u0063\u006c\u0061\u0073s \u0077\u0069\u0074\u0068\u0020\u0069\u0064\u003a\u0020\u0027\u0025\u0064\u0027",_ac );
};_eec ._ba [_fag ]++;};var _af []int ;for _deb :=0;_deb < _eec .Classer .UndilatedTemplates .Size ();_deb ++{if _eec .NumberOfPages ==1||_eec ._ba [_deb ]> 1{_af =append (_af ,_deb );};};var (_bec *Page ;_afd bool ;);for _cg ,_ff :=range *_eec .Classer .ComponentPageNumbers {if _bec ,_afd =_eec .Pages [_ff ];
!_afd {return _gd .Errorf (_ad ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_cg );};if _bec .EncodingMethod ==GenericEM {_bc .Log .Error ("\u0047\u0065\u006e\u0065\u0072\u0069c\u0020\u0070\u0061g\u0065\u0020\u0077i\u0074\u0068\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u003a \u0027\u0025\u0064\u0027\u0020ma\u0070\u0070\u0065\u0064\u0020\u0061\u0073\u0020\u0063\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064\u0020\u0070\u0061\u0067\u0065",_cg );
continue ;};_eec ._cd [_ff ]=append (_eec ._cd [_ff ],_cg );_ade ,_bb :=_eec .Classer .ClassIDs .Get (_cg );if _bb !=nil {return _gd .Wrapf (_bb ,_ad ,"\u006e\u006f\u0020\u0073uc\u0068\u0020\u0063\u006c\u0061\u0073\u0073\u0049\u0044\u003a\u0020\u0025\u0064",_cg );
};if _eec ._ba [_ade ]==1&&_eec .NumberOfPages !=1{_dd :=append (_eec ._eg [_ff ],_ade );_eec ._eg [_ff ]=_dd ;};};if _fc =_eec .Classer .ComputeLLCorners ();_fc !=nil {return _gd .Wrap (_fc ,_ad ,"");};if _ ,_fc =_eec .addSymbolDictionary (0,_eec .Classer .UndilatedTemplates ,_af ,_eec ._ee ,false );
_fc !=nil {return _gd .Wrap (_fc ,_ad ,"");};return nil ;};func (_baea *Page )countRegions ()int {var _aeaa int ;for _ ,_dcd :=range _baea .Segments {switch _dcd .Type {case 6,7,22,23,38,39,42,43:_aeaa ++;};};return _aeaa ;};var _gc =[]byte {0x97,0x4A,0x42,0x32,0x0D,0x0A,0x1A,0x0A};
func (_egaa *Page )collectPageStripes ()(_gegc []_gb .Segmenter ,_cfg error ){const _gcbc ="\u0063o\u006cl\u0065\u0063\u0074\u0050\u0061g\u0065\u0053t\u0072\u0069\u0070\u0065\u0073";var _fad _gb .Segmenter ;for _ ,_ebc :=range _egaa .Segments {switch _ebc .Type {case 6,7,22,23,38,39,42,43:_fad ,_cfg =_ebc .GetSegmentData ();
if _cfg !=nil {return nil ,_gd .Wrap (_cfg ,_gcbc ,"");};_gegc =append (_gegc ,_fad );case 50:_fad ,_cfg =_ebc .GetSegmentData ();if _cfg !=nil {return nil ,_cfg ;};_fgf ,_bbef :=_fad .(*_gb .EndOfStripe );if !_bbef {return nil ,_gd .Errorf (_gcbc ,"\u0045\u006e\u0064\u004f\u0066\u0053\u0074\u0072\u0069\u0070\u0065\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u006f\u0066\u0020\u0076\u0061l\u0069\u0064\u0020\u0074\u0079p\u0065\u003a \u0027\u0025\u0054\u0027",_fad );
};_gegc =append (_gegc ,_fgf );_egaa .FinalHeight =_fgf .LineNumber ();};};return _gegc ,nil ;};func (_egb *Page )String ()string {return _d .Sprintf ("\u0050\u0061\u0067\u0065\u0020\u0023\u0025\u0064",_egb .PageNumber );};func (_dfcb *Page )getCombinationOperator (_ceag *_gb .PageInformationSegment ,_bfg _fd .CombinationOperator )_fd .CombinationOperator {if _ceag .CombinationOperatorOverrideAllowed (){return _bfg ;
};return _ceag .CombinationOperator ();};func (_daag *Page )GetBitmap ()(_gdb *_fd .Bitmap ,_egdf error ){_bc .Log .Trace (_d .Sprintf ("\u005b\u0050\u0041G\u0045\u005d\u005b\u0023%\u0064\u005d\u0020\u0047\u0065\u0074\u0042i\u0074\u006d\u0061\u0070\u0020\u0062\u0065\u0067\u0069\u006e\u0073\u002e\u002e\u002e",_daag .PageNumber ));
defer func (){if _egdf !=nil {_bc .Log .Trace (_d .Sprintf ("\u005b\u0050\u0041\u0047\u0045\u005d\u005b\u0023\u0025\u0064\u005d\u0020\u0047\u0065\u0074B\u0069t\u006d\u0061\u0070\u0020\u0066\u0061\u0069\u006c\u0065\u0064\u002e\u0020\u0025\u0076",_daag .PageNumber ,_egdf ));
}else {_bc .Log .Trace (_d .Sprintf ("\u005b\u0050\u0041\u0047\u0045\u005d\u005b\u0023\u0025\u0064]\u0020\u0047\u0065\u0074\u0042\u0069\u0074m\u0061\u0070\u0020\u0066\u0069\u006e\u0069\u0073\u0068\u0065\u0064",_daag .PageNumber ));};}();if _daag .Bitmap !=nil {return _daag .Bitmap ,nil ;
};_egdf =_daag .composePageBitmap ();if _egdf !=nil {return nil ,_egdf ;};return _daag .Bitmap ,nil ;};func (_cdgd *Page )fitsPage (_aae *_gb .PageInformationSegment ,_bde *_fd .Bitmap )bool {return _cdgd .countRegions ()==1&&_aae .DefaultPixelValue ==0&&_aae .PageBMWidth ==_bde .Width &&_aae .PageBMHeight ==_bde .Height ;
};