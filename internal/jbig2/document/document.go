//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package document ;import (_de "encoding/binary";_a "fmt";_ba "github.com/unidoc/unipdf/v4/common";_be "github.com/unidoc/unipdf/v4/internal/bitwise";_f "github.com/unidoc/unipdf/v4/internal/jbig2/basic";_ge "github.com/unidoc/unipdf/v4/internal/jbig2/bitmap";
_dd "github.com/unidoc/unipdf/v4/internal/jbig2/document/segments";_dc "github.com/unidoc/unipdf/v4/internal/jbig2/encoder/classer";_aa "github.com/unidoc/unipdf/v4/internal/jbig2/errors";_b "io";_g "math";_c "runtime/debug";);var _ce =[]byte {0x97,0x4A,0x42,0x32,0x0D,0x0A,0x1A,0x0A};
func (_edf *Document )Encode ()(_ceb []byte ,_abf error ){const _deg ="\u0044o\u0063u\u006d\u0065\u006e\u0074\u002e\u0045\u006e\u0063\u006f\u0064\u0065";var _bddc ,_dfe int ;if _edf .FullHeaders {if _bddc ,_abf =_edf .encodeFileHeader (_edf ._fg );_abf !=nil {return nil ,_aa .Wrap (_abf ,_deg ,"");
};};var (_adabb bool ;_dad *_dd .Header ;_db *Page ;);if _abf =_edf .completeClassifiedPages ();_abf !=nil {return nil ,_aa .Wrap (_abf ,_deg ,"");};if _abf =_edf .produceClassifiedPages ();_abf !=nil {return nil ,_aa .Wrap (_abf ,_deg ,"");};if _edf .GlobalSegments !=nil {for _ ,_dad =range _edf .GlobalSegments .Segments {if _abf =_edf .encodeSegment (_dad ,&_bddc );
_abf !=nil {return nil ,_aa .Wrap (_abf ,_deg ,"");};};};for _gdf :=1;_gdf <=int (_edf .NumberOfPages );_gdf ++{if _db ,_adabb =_edf .Pages [_gdf ];!_adabb {return nil ,_aa .Errorf (_deg ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_gdf );
};for _ ,_dad =range _db .Segments {if _abf =_edf .encodeSegment (_dad ,&_bddc );_abf !=nil {return nil ,_aa .Wrap (_abf ,_deg ,"");};};};if _edf .FullHeaders {if _dfe ,_abf =_edf .encodeEOFHeader (_edf ._fg );_abf !=nil {return nil ,_aa .Wrap (_abf ,_deg ,"");
};_bddc +=_dfe ;};_ceb =_edf ._fg .Data ();if len (_ceb )!=_bddc {_ba .Log .Debug ("\u0042\u0079\u0074\u0065\u0073 \u0077\u0072\u0069\u0074\u0074\u0065\u006e \u0028\u006e\u0029\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u0065\u0071\u0075\u0061\u006c\u0020\u0074\u006f\u0020\u0074\u0068\u0065\u0020\u006c\u0065\u006e\u0067\u0074\u0068\u0020\u006f\u0066\u0020t\u0068\u0065\u0020\u0064\u0061\u0074\u0061\u0020\u0065\u006e\u0063\u006fd\u0065\u0064\u003a\u0020\u0027\u0025d\u0027",_bddc ,len (_ceb ));
};return _ceb ,nil ;};func (_ffg *Document )encodeFileHeader (_bce _be .BinaryWriter )(_eaa int ,_aeb error ){const _agd ="\u0065\u006ec\u006f\u0064\u0065F\u0069\u006c\u0065\u0048\u0065\u0061\u0064\u0065\u0072";_eaa ,_aeb =_bce .Write (_ce );if _aeb !=nil {return _eaa ,_aa .Wrap (_aeb ,_agd ,"\u0069\u0064");
};if _aeb =_bce .WriteByte (0x01);_aeb !=nil {return _eaa ,_aa .Wrap (_aeb ,_agd ,"\u0066\u006c\u0061g\u0073");};_eaa ++;_fga :=make ([]byte ,4);_de .BigEndian .PutUint32 (_fga ,_ffg .NumberOfPages );_fbe ,_aeb :=_bce .Write (_fga );if _aeb !=nil {return _fbe ,_aa .Wrap (_aeb ,_agd ,"p\u0061\u0067\u0065\u0020\u006e\u0075\u006d\u0062\u0065\u0072");
};_eaa +=_fbe ;return _eaa ,nil ;};func (_ca *Document )AddGenericPage (bm *_ge .Bitmap ,duplicateLineRemoval bool )(_cfb error ){const _gf ="\u0044\u006f\u0063um\u0065\u006e\u0074\u002e\u0041\u0064\u0064\u0047\u0065\u006e\u0065\u0072\u0069\u0063\u0050\u0061\u0067\u0065";
if !_ca .FullHeaders &&_ca .NumberOfPages !=0{return _aa .Error (_gf ,"\u0064\u006f\u0063\u0075\u006de\u006e\u0074\u0020\u0061\u006c\u0072\u0065a\u0064\u0079\u0020\u0063\u006f\u006e\u0074\u0061\u0069\u006e\u0073\u0020\u0070\u0061\u0067\u0065\u002e\u0020\u0046\u0069\u006c\u0065\u004d\u006f\u0064\u0065\u0020\u0064\u0069\u0073\u0061\u006c\u006c\u006f\u0077\u0073\u0020\u0061\u0064\u0064i\u006e\u0067\u0020\u006d\u006f\u0072\u0065\u0020\u0074\u0068\u0061\u006e \u006f\u006e\u0065\u0020\u0070\u0061g\u0065");
};_cc :=&Page {Segments :[]*_dd .Header {},Bitmap :bm ,Document :_ca ,FinalHeight :bm .Height ,FinalWidth :bm .Width ,IsLossless :true ,BlackIsOne :bm .Color ==_ge .Chocolate };_cc .PageNumber =int (_ca .nextPageNumber ());_ca .Pages [_cc .PageNumber ]=_cc ;
bm .InverseData ();_cc .AddPageInformationSegment ();if _cfb =_cc .AddGenericRegion (bm ,0,0,0,_dd .TImmediateGenericRegion ,duplicateLineRemoval );_cfb !=nil {return _aa .Wrap (_cfb ,_gf ,"");};if _ca .FullHeaders {_cc .AddEndOfPageSegment ();};return nil ;
};func _ccd (_ccf int )int {_gcd :=0;_gcb :=(_ccf &(_ccf -1))==0;_ccf >>=1;for ;_ccf !=0;_ccf >>=1{_gcd ++;};if _gcb {return _gcd ;};return _gcd +1;};func (_dea *Document )encodeEOFHeader (_cfg _be .BinaryWriter )(_cfgd int ,_ccc error ){_eca :=&_dd .Header {SegmentNumber :_dea .nextSegmentNumber (),Type :_dd .TEndOfFile };
if _cfgd ,_ccc =_eca .Encode (_cfg );_ccc !=nil {return 0,_aa .Wrap (_ccc ,"\u0065n\u0063o\u0064\u0065\u0045\u004f\u0046\u0048\u0065\u0061\u0064\u0065\u0072","");};return _cfgd ,nil ;};func (_ed *Document )produceClassifiedPage (_ecb *Page ,_fcg *_dd .Header )(_ecc error ){const _gc ="p\u0072\u006f\u0064\u0075ce\u0043l\u0061\u0073\u0073\u0069\u0066i\u0065\u0064\u0050\u0061\u0067\u0065";
var _ab map[int ]int ;_ee :=_ed ._ec ;_agg :=[]*_dd .Header {_fcg };if len (_ed ._cf [_ecb .PageNumber ])> 0{_ab =map[int ]int {};_ff ,_eb :=_ed .addSymbolDictionary (_ecb .PageNumber ,_ed .Classer .UndilatedTemplates ,_ed ._cf [_ecb .PageNumber ],_ab ,false );
if _eb !=nil {return _aa .Wrap (_eb ,_gc ,"");};_agg =append (_agg ,_ff );_ee +=len (_ed ._cf [_ecb .PageNumber ]);};_caea :=_ed ._bd [_ecb .PageNumber ];_ba .Log .Debug ("P\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020c\u006f\u006d\u0070\u0073: \u0025\u0076",_ecb .PageNumber ,_caea );
_ecb .addTextRegionSegment (_agg ,_ed ._df ,_ab ,_ed ._bd [_ecb .PageNumber ],_ed .Classer .PtaLL ,_ed .Classer .UndilatedTemplates ,_ed .Classer .ClassIDs ,nil ,_ccd (_ee ),len (_ed ._bd [_ecb .PageNumber ]));return nil ;};func (_dff *Page )GetWidth ()(int ,error ){return _dff .getWidth ()};
func (_bdgd *Page )Encode (w _be .BinaryWriter )(_ddfg int ,_caca error ){const _bfg ="P\u0061\u0067\u0065\u002e\u0045\u006e\u0063\u006f\u0064\u0065";var _fda int ;for _ ,_gddg :=range _bdgd .Segments {if _fda ,_caca =_gddg .Encode (w );_caca !=nil {return _ddfg ,_aa .Wrap (_caca ,_bfg ,"");
};_ddfg +=_fda ;};return _ddfg ,nil ;};func (_bfb *Page )GetResolutionX ()(int ,error ){return _bfb .getResolutionX ()};func (_gaf *Page )countRegions ()int {var _dfg int ;for _ ,_ebd :=range _gaf .Segments {switch _ebd .Type {case 6,7,22,23,38,39,42,43:_dfg ++;
};};return _dfg ;};func (_bdg *Document )nextPageNumber ()uint32 {_bdg .NumberOfPages ++;return _bdg .NumberOfPages };func (_ffc *Page )fitsPage (_ccaa *_dd .PageInformationSegment ,_bdgf *_ge .Bitmap )bool {return _ffc .countRegions ()==1&&_ccaa .DefaultPixelValue ==0&&_ccaa .PageBMWidth ==_bdgf .Width &&_ccaa .PageBMHeight ==_bdgf .Height ;
};func (_aaf *Page )createNormalPage (_deaa *_dd .PageInformationSegment )error {const _aeae ="\u0063\u0072e\u0061\u0074\u0065N\u006f\u0072\u006d\u0061\u006c\u0050\u0061\u0067\u0065";_aaf .Bitmap =_ge .New (_deaa .PageBMWidth ,_deaa .PageBMHeight );if _deaa .DefaultPixelValue !=0{_aaf .Bitmap .SetDefaultPixel ();
};for _ ,_abcfc :=range _aaf .Segments {switch _abcfc .Type {case 6,7,22,23,38,39,42,43:_ba .Log .Trace ("\u0047\u0065\u0074\u0074in\u0067\u0020\u0053\u0065\u0067\u006d\u0065\u006e\u0074\u003a\u0020\u0025\u0064",_abcfc .SegmentNumber );_aega ,_ffgc :=_abcfc .GetSegmentData ();
if _ffgc !=nil {return _ffgc ;};_fbb ,_dgdb :=_aega .(_dd .Regioner );if !_dgdb {_ba .Log .Debug ("\u0053\u0065g\u006d\u0065\u006e\u0074\u003a\u0020\u0025\u0054\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u0061\u0020\u0052\u0065\u0067\u0069on\u0065\u0072",_aega );
return _aa .Errorf (_aeae ,"i\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006a\u0062i\u0067\u0032\u0020\u0073\u0065\u0067\u006den\u0074\u0020\u0074\u0079p\u0065\u0020\u002d\u0020\u006e\u006f\u0074\u0020\u0061 R\u0065\u0067i\u006f\u006e\u0065\u0072\u003a\u0020\u0025\u0054",_aega );
};_cge ,_ffgc :=_fbb .GetRegionBitmap ();if _ffgc !=nil {return _aa .Wrap (_ffgc ,_aeae ,"");};if _aaf .fitsPage (_deaa ,_cge ){_aaf .Bitmap =_cge ;}else {_dfdg :=_fbb .GetRegionInfo ();_bec :=_aaf .getCombinationOperator (_deaa ,_dfdg .CombinaionOperator );
_ffgc =_ge .Blit (_cge ,_aaf .Bitmap ,int (_dfdg .XLocation ),int (_dfdg .YLocation ),_bec );if _ffgc !=nil {return _aa .Wrap (_ffgc ,_aeae ,"");};};};};return nil ;};func (_agea *Document )nextSegmentNumber ()uint32 {_ccb :=_agea .CurrentSegmentNumber ;
_agea .CurrentSegmentNumber ++;return _ccb ;};func (_dadb *Page )getPageInformationSegment ()*_dd .Header {for _ ,_befb :=range _dadb .Segments {if _befb .Type ==_dd .TPageInformation {return _befb ;};};_ba .Log .Debug ("\u0050\u0061\u0067\u0065\u0020\u0069\u006e\u0066o\u0072\u006d\u0061ti\u006f\u006e\u0020\u0073\u0065\u0067m\u0065\u006e\u0074\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0066o\u0072\u0020\u0070\u0061\u0067\u0065\u003a\u0020%\u0073\u002e",_dadb );
return nil ;};func (_aca *Globals )AddSegment (segment *_dd .Header ){_aca .Segments =append (_aca .Segments ,segment )};func (_bgf *Page )createStripedPage (_ebf *_dd .PageInformationSegment )error {const _agb ="\u0063\u0072\u0065\u0061\u0074\u0065\u0053\u0074\u0072\u0069\u0070\u0065d\u0050\u0061\u0067\u0065";
_bcb ,_ceg :=_bgf .collectPageStripes ();if _ceg !=nil {return _aa .Wrap (_ceg ,_agb ,"");};var _dgcc int ;for _ ,_ffef :=range _bcb {if _gfe ,_ecaf :=_ffef .(*_dd .EndOfStripe );_ecaf {_dgcc =_gfe .LineNumber ()+1;}else {_gag :=_ffef .(_dd .Regioner );
_dedg :=_gag .GetRegionInfo ();_bba :=_bgf .getCombinationOperator (_ebf ,_dedg .CombinaionOperator );_dgb ,_dcff :=_gag .GetRegionBitmap ();if _dcff !=nil {return _aa .Wrap (_dcff ,_agb ,"");};_dcff =_ge .Blit (_dgb ,_bgf .Bitmap ,int (_dedg .XLocation ),_dgcc ,_bba );
if _dcff !=nil {return _aa .Wrap (_dcff ,_agb ,"");};};};return nil ;};func (_fbd *Page )createPage (_dce *_dd .PageInformationSegment )error {var _dge error ;if !_dce .IsStripe ||_dce .PageBMHeight !=-1{_dge =_fbd .createNormalPage (_dce );}else {_dge =_fbd .createStripedPage (_dce );
};return _dge ;};func (_gb *Page )String ()string {return _a .Sprintf ("\u0050\u0061\u0067\u0065\u0020\u0023\u0025\u0064",_gb .PageNumber );};func (_ceef *Globals )GetSegmentByIndex (index int )(*_dd .Header ,error ){const _cef ="\u0047l\u006f\u0062\u0061\u006cs\u002e\u0047\u0065\u0074\u0053e\u0067m\u0065n\u0074\u0042\u0079\u0049\u006e\u0064\u0065x";
if _ceef ==nil {return nil ,_aa .Error (_cef ,"\u0067\u006c\u006f\u0062al\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if len (_ceef .Segments )==0{return nil ,_aa .Error (_cef ,"\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u0020\u0061\u0072\u0065\u0020e\u006d\u0070\u0074\u0079");
};if index > len (_ceef .Segments )-1{return nil ,_aa .Error (_cef ,"\u0069n\u0064e\u0078\u0020\u006f\u0075\u0074 \u006f\u0066 \u0072\u0061\u006e\u0067\u0065");};return _ceef .Segments [index ],nil ;};func (_eac *Document )completeClassifiedPages ()(_fd error ){const _ece ="\u0063\u006f\u006dpl\u0065\u0074\u0065\u0043\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064\u0050\u0061\u0067\u0065\u0073";
if _eac .Classer ==nil {return nil ;};_eac ._bf =make ([]int ,_eac .Classer .UndilatedTemplates .Size ());for _dcd :=0;_dcd < _eac .Classer .ClassIDs .Size ();_dcd ++{_cabb ,_dca :=_eac .Classer .ClassIDs .Get (_dcd );if _dca !=nil {return _aa .Wrapf (_dca ,_ece ,"\u0063\u006c\u0061\u0073s \u0077\u0069\u0074\u0068\u0020\u0069\u0064\u003a\u0020\u0027\u0025\u0064\u0027",_dcd );
};_eac ._bf [_cabb ]++;};var _cac []int ;for _ag :=0;_ag < _eac .Classer .UndilatedTemplates .Size ();_ag ++{if _eac .NumberOfPages ==1||_eac ._bf [_ag ]> 1{_cac =append (_cac ,_ag );};};var (_dcg *Page ;_cabd bool ;);for _dg ,_bb :=range *_eac .Classer .ComponentPageNumbers {if _dcg ,_cabd =_eac .Pages [_bb ];
!_cabd {return _aa .Errorf (_ece ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_dg );};if _dcg .EncodingMethod ==GenericEM {_ba .Log .Error ("\u0047\u0065\u006e\u0065\u0072\u0069c\u0020\u0070\u0061g\u0065\u0020\u0077i\u0074\u0068\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u003a \u0027\u0025\u0064\u0027\u0020ma\u0070\u0070\u0065\u0064\u0020\u0061\u0073\u0020\u0063\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064\u0020\u0070\u0061\u0067\u0065",_dg );
continue ;};_eac ._bd [_bb ]=append (_eac ._bd [_bb ],_dg );_bgg ,_ae :=_eac .Classer .ClassIDs .Get (_dg );if _ae !=nil {return _aa .Wrapf (_ae ,_ece ,"\u006e\u006f\u0020\u0073uc\u0068\u0020\u0063\u006c\u0061\u0073\u0073\u0049\u0044\u003a\u0020\u0025\u0064",_dg );
};if _eac ._bf [_bgg ]==1&&_eac .NumberOfPages !=1{_da :=append (_eac ._cf [_bb ],_bgg );_eac ._cf [_bb ]=_da ;};};if _fd =_eac .Classer .ComputeLLCorners ();_fd !=nil {return _aa .Wrap (_fd ,_ece ,"");};if _ ,_fd =_eac .addSymbolDictionary (0,_eac .Classer .UndilatedTemplates ,_cac ,_eac ._df ,false );
_fd !=nil {return _aa .Wrap (_fd ,_ece ,"");};return nil ;};func (_gcf *Page )AddGenericRegion (bm *_ge .Bitmap ,xloc ,yloc ,template int ,tp _dd .Type ,duplicateLineRemoval bool )error {const _gce ="P\u0061\u0067\u0065\u002eAd\u0064G\u0065\u006e\u0065\u0072\u0069c\u0052\u0065\u0067\u0069\u006f\u006e";
_cgf :=&_dd .GenericRegion {};if _dacd :=_cgf .InitEncode (bm ,xloc ,yloc ,template ,duplicateLineRemoval );_dacd !=nil {return _aa .Wrap (_dacd ,_gce ,"");};_ccg :=&_dd .Header {Type :_dd .TImmediateGenericRegion ,PageAssociation :_gcf .PageNumber ,SegmentData :_cgf };
_gcf .Segments =append (_gcf .Segments ,_ccg );return nil ;};type EncodingMethod int ;func (_bgc *Document )addSymbolDictionary (_abc int ,_geb *_ge .Bitmaps ,_ad []int ,_dec map[int ]int ,_aee bool )(*_dd .Header ,error ){const _bc ="\u0061\u0064\u0064\u0053ym\u0062\u006f\u006c\u0044\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079";
_dcab :=&_dd .SymbolDictionary {};if _bcg :=_dcab .InitEncode (_geb ,_ad ,_dec ,_aee );_bcg !=nil {return nil ,_bcg ;};_ef :=&_dd .Header {Type :_dd .TSymbolDictionary ,PageAssociation :_abc ,SegmentData :_dcab };if _abc ==0{if _bgc .GlobalSegments ==nil {_bgc .GlobalSegments =&Globals {};
};_bgc .GlobalSegments .AddSegment (_ef );return _ef ,nil ;};_fb ,_ada :=_bgc .Pages [_abc ];if !_ada {return nil ,_aa .Errorf (_bc ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_abc );};var (_cce int ;
_bad *_dd .Header ;);for _cce ,_bad =range _fb .Segments {if _bad .Type ==_dd .TPageInformation {break ;};};_cce ++;_fb .Segments =append (_fb .Segments ,nil );copy (_fb .Segments [_cce +1:],_fb .Segments [_cce :]);_fb .Segments [_cce ]=_ef ;return _ef ,nil ;
};func (_fcgc *Page )AddEndOfPageSegment (){_ebc :=&_dd .Header {Type :_dd .TEndOfPage ,PageAssociation :_fcgc .PageNumber };_fcgc .Segments =append (_fcgc .Segments ,_ebc );};func (_fec *Page )clearSegmentData (){for _abd :=range _fec .Segments {_fec .Segments [_abd ].CleanSegmentData ();
};};func (_dbe *Document )reachedEOF (_ebb int64 )(bool ,error ){const _ddf ="\u0072\u0065\u0061\u0063\u0068\u0065\u0064\u0045\u004f\u0046";_ ,_acf :=_dbe .InputStream .Seek (_ebb ,_b .SeekStart );if _acf !=nil {_ba .Log .Debug ("\u0072\u0065\u0061c\u0068\u0065\u0064\u0045\u004f\u0046\u0020\u002d\u0020\u0064\u002e\u0049\u006e\u0070\u0075\u0074\u0053\u0074\u0072\u0065\u0061\u006d\u002e\u0053\u0065\u0065\u006b\u0020\u0066a\u0069\u006c\u0065\u0064\u003a\u0020\u0025\u0076",_acf );
return false ,_aa .Wrap (_acf ,_ddf ,"\u0069n\u0070\u0075\u0074\u0020\u0073\u0074\u0072\u0065\u0061\u006d\u0020s\u0065\u0065\u006b\u0020\u0066\u0061\u0069\u006c\u0065\u0064");};_ ,_acf =_dbe .InputStream .ReadBits (32);if _acf ==_b .EOF {return true ,nil ;
}else if _acf !=nil {return false ,_aa .Wrap (_acf ,_ddf ,"");};return false ,nil ;};func (_fbdg *Page )getCombinationOperator (_bdgc *_dd .PageInformationSegment ,_abda _ge .CombinationOperator )_ge .CombinationOperator {if _bdgc .CombinationOperatorOverrideAllowed (){return _abda ;
};return _bdgc .CombinationOperator ();};func DecodeDocument (input *_be .Reader ,globals *Globals )(*Document ,error ){return _fdfe (input ,globals );};type Document struct{Pages map[int ]*Page ;NumberOfPagesUnknown bool ;NumberOfPages uint32 ;GBUseExtTemplate bool ;
InputStream *_be .Reader ;GlobalSegments *Globals ;OrganizationType _dd .OrganizationType ;Classer *_dc .Classer ;XRes ,YRes int ;FullHeaders bool ;CurrentSegmentNumber uint32 ;AverageTemplates *_ge .Bitmaps ;BaseIndexes []int ;Refinement bool ;RefineLevel int ;
_e uint8 ;_fg *_be .BufferedWriter ;EncodeGlobals bool ;_ec int ;_cf map[int ][]int ;_bd map[int ][]int ;_bf []int ;_df map[int ]int ;};func (_ggg *Page )AddPageInformationSegment (){_efcf :=&_dd .PageInformationSegment {PageBMWidth :_ggg .FinalWidth ,PageBMHeight :_ggg .FinalHeight ,ResolutionX :_ggg .ResolutionX ,ResolutionY :_ggg .ResolutionY ,IsLossless :_ggg .IsLossless };
if _ggg .BlackIsOne {_efcf .DefaultPixelValue =uint8 (0x1);};_cdg :=&_dd .Header {PageAssociation :_ggg .PageNumber ,SegmentDataLength :uint64 (_efcf .Size ()),SegmentData :_efcf ,Type :_dd .TPageInformation };_ggg .Segments =append (_ggg .Segments ,_cdg );
};func (_dceg *Page )getResolutionY ()(int ,error ){const _bcd ="\u0067\u0065\u0074\u0052\u0065\u0073\u006f\u006c\u0075t\u0069\u006f\u006e\u0059";if _dceg .ResolutionY !=0{return _dceg .ResolutionY ,nil ;};_agf :=_dceg .getPageInformationSegment ();if _agf ==nil {return 0,_aa .Error (_bcd ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");
};_ecbd ,_cafb :=_agf .GetSegmentData ();if _cafb !=nil {return 0,_aa .Wrap (_cafb ,_bcd ,"");};_dfdf ,_cbb :=_ecbd .(*_dd .PageInformationSegment );if !_cbb {return 0,_aa .Errorf (_bcd ,"\u0070\u0061\u0067\u0065\u0020\u0069\u006e\u0066o\u0072\u006d\u0061ti\u006f\u006e\u0020\u0073\u0065\u0067m\u0065\u006e\u0074\u0020\u0069\u0073\u0020\u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006ci\u0064\u0020\u0074\u0079\u0070\u0065\u003a\u0027%\u0054\u0027",_ecbd );
};_dceg .ResolutionY =_dfdf .ResolutionY ;return _dceg .ResolutionY ,nil ;};func (_ceaf *Document )isFileHeaderPresent ()(bool ,error ){_ceaf .InputStream .Mark ();for _ ,_efc :=range _ce {_fcf ,_bddcg :=_ceaf .InputStream .ReadByte ();if _bddcg !=nil {return false ,_bddcg ;
};if _efc !=_fcf {_ceaf .InputStream .Reset ();return false ,nil ;};};_ceaf .InputStream .Reset ();return true ,nil ;};func (_decc *Page )addTextRegionSegment (_agde []*_dd .Header ,_dgd ,_bfeb map[int ]int ,_eeg []int ,_faad *_ge .Points ,_egd *_ge .Bitmaps ,_gdg *_f .IntSlice ,_ega *_ge .Boxes ,_ccbc ,_fed int ){_ffe :=&_dd .TextRegion {NumberOfSymbols :uint32 (_fed )};
_ffe .InitEncode (_dgd ,_bfeb ,_eeg ,_faad ,_egd ,_gdg ,_ega ,_decc .FinalWidth ,_decc .FinalHeight ,_ccbc );_dag :=&_dd .Header {RTSegments :_agde ,SegmentData :_ffe ,PageAssociation :_decc .PageNumber ,Type :_dd .TImmediateTextRegion };_egb :=_dd .TPageInformation ;
if _bfeb !=nil {_egb =_dd .TSymbolDictionary ;};var _egad int ;for ;_egad < len (_decc .Segments );_egad ++{if _decc .Segments [_egad ].Type ==_egb {_egad ++;break ;};};_decc .Segments =append (_decc .Segments ,nil );copy (_decc .Segments [_egad +1:],_decc .Segments [_egad :]);
_decc .Segments [_egad ]=_dag ;};func (_bade *Document )determineRandomDataOffsets (_def []*_dd .Header ,_bcga uint64 ){if _bade .OrganizationType !=_dd .ORandom {return ;};for _ ,_bff :=range _def {_bff .SegmentDataStartOffset =_bcga ;_bcga +=_bff .SegmentDataLength ;
};};func (_cea *Document )GetGlobalSegment (i int )(*_dd .Header ,error ){_fcb ,_dcb :=_cea .GlobalSegments .GetSegment (i );if _dcb !=nil {return nil ,_aa .Wrap (_dcb ,"\u0047\u0065t\u0047\u006c\u006fb\u0061\u006c\u0053\u0065\u0067\u006d\u0065\u006e\u0074","");
};return _fcb ,nil ;};func (_cae *Document )produceClassifiedPages ()(_fc error ){const _gd ="\u0070\u0072\u006f\u0064uc\u0065\u0043\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064\u0050\u0061\u0067e\u0073";if _cae .Classer ==nil {return nil ;};var (_cd *Page ;
_gg bool ;_gdd *_dd .Header ;);for _bdd :=1;_bdd <=int (_cae .NumberOfPages );_bdd ++{if _cd ,_gg =_cae .Pages [_bdd ];!_gg {return _aa .Errorf (_gd ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_bdd );
};if _cd .EncodingMethod ==GenericEM {continue ;};if _gdd ==nil {if _gdd ,_fc =_cae .GlobalSegments .GetSymbolDictionary ();_fc !=nil {return _aa .Wrap (_fc ,_gd ,"");};};if _fc =_cae .produceClassifiedPage (_cd ,_gdd );_fc !=nil {return _aa .Wrapf (_fc ,_gd ,"\u0070\u0061\u0067\u0065\u003a\u0020\u0027\u0025\u0064\u0027",_bdd );
};};return nil ;};func (_cab *Document )AddClassifiedPage (bm *_ge .Bitmap ,method _dc .Method )(_ea error ){const _bg ="\u0044\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u002e\u0041\u0064d\u0043\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064P\u0061\u0067\u0065";
if !_cab .FullHeaders &&_cab .NumberOfPages !=0{return _aa .Error (_bg ,"\u0064\u006f\u0063\u0075\u006de\u006e\u0074\u0020\u0061\u006c\u0072\u0065a\u0064\u0079\u0020\u0063\u006f\u006e\u0074\u0061\u0069\u006e\u0073\u0020\u0070\u0061\u0067\u0065\u002e\u0020\u0046\u0069\u006c\u0065\u004d\u006f\u0064\u0065\u0020\u0064\u0069\u0073\u0061\u006c\u006c\u006f\u0077\u0073\u0020\u0061\u0064\u0064i\u006e\u0067\u0020\u006d\u006f\u0072\u0065\u0020\u0074\u0068\u0061\u006e \u006f\u006e\u0065\u0020\u0070\u0061g\u0065");
};if _cab .Classer ==nil {if _cab .Classer ,_ea =_dc .Init (_dc .DefaultSettings ());_ea !=nil {return _aa .Wrap (_ea ,_bg ,"");};};_ded :=int (_cab .nextPageNumber ());_fa :=&Page {Segments :[]*_dd .Header {},Bitmap :bm ,Document :_cab ,FinalHeight :bm .Height ,FinalWidth :bm .Width ,PageNumber :_ded };
_cab .Pages [_ded ]=_fa ;switch method {case _dc .RankHaus :_fa .EncodingMethod =RankHausEM ;case _dc .Correlation :_fa .EncodingMethod =CorrelationEM ;};_fa .AddPageInformationSegment ();if _ea =_cab .Classer .AddPage (bm ,_ded ,method );_ea !=nil {return _aa .Wrap (_ea ,_bg ,"");
};if _cab .FullHeaders {_fa .AddEndOfPageSegment ();};return nil ;};func (_ac *Document )GetNumberOfPages ()(uint32 ,error ){if _ac .NumberOfPagesUnknown ||_ac .NumberOfPages ==0{if len (_ac .Pages )==0{if _gea :=_ac .mapData ();_gea !=nil {return 0,_aa .Wrap (_gea ,"\u0044o\u0063\u0075\u006d\u0065n\u0074\u002e\u0047\u0065\u0074N\u0075m\u0062e\u0072\u004f\u0066\u0050\u0061\u0067\u0065s","");
};};return uint32 (len (_ac .Pages )),nil ;};return _ac .NumberOfPages ,nil ;};func (_badf *Document )completeSymbols ()(_dfa error ){const _faa ="\u0063o\u006dp\u006c\u0065\u0074\u0065\u0053\u0079\u006d\u0062\u006f\u006c\u0073";if _badf .Classer ==nil {return nil ;
};if _badf .Classer .UndilatedTemplates ==nil {return _aa .Error (_faa ,"\u006e\u006f t\u0065\u006d\u0070l\u0061\u0074\u0065\u0073 de\u0066in\u0065\u0064\u0020\u0066\u006f\u0072\u0020th\u0065\u0020\u0063\u006c\u0061\u0073\u0073e\u0072");};_cfa :=len (_badf .Pages )==1;
_ecf :=make ([]int ,_badf .Classer .UndilatedTemplates .Size ());var _fe int ;for _feb :=0;_feb < _badf .Classer .ClassIDs .Size ();_feb ++{_fe ,_dfa =_badf .Classer .ClassIDs .Get (_feb );if _dfa !=nil {return _aa .Wrap (_dfa ,_faa ,"\u0063\u006c\u0061\u0073\u0073\u0020\u0049\u0044\u0027\u0073");
};_ecf [_fe ]++;};var _efd []int ;for _cca :=0;_cca < _badf .Classer .UndilatedTemplates .Size ();_cca ++{if _ecf [_cca ]==0{return _aa .Error (_faa ,"\u006eo\u0020\u0073y\u006d\u0062\u006f\u006cs\u0020\u0069\u006es\u0074\u0061\u006e\u0063\u0065\u0073\u0020\u0066\u006fun\u0064\u0020\u0066o\u0072\u0020g\u0069\u0076\u0065\u006e\u0020\u0063l\u0061\u0073s\u003f\u0020");
};if _ecf [_cca ]> 1||_cfa {_efd =append (_efd ,_cca );};};_badf ._ec =len (_efd );var _fge ,_dcf int ;for _adab :=0;_adab < _badf .Classer .ComponentPageNumbers .Size ();_adab ++{_fge ,_dfa =_badf .Classer .ComponentPageNumbers .Get (_adab );if _dfa !=nil {return _aa .Wrapf (_dfa ,_faa ,"p\u0061\u0067\u0065\u003a\u0020\u0027\u0025\u0064\u0027 \u006e\u006f\u0074\u0020\u0066\u006f\u0075nd\u0020\u0069\u006e\u0020t\u0068\u0065\u0020\u0063\u006c\u0061\u0073\u0073\u0065r \u0070\u0061g\u0065\u006e\u0075\u006d\u0062\u0065\u0072\u0073",_adab );
};_dcf ,_dfa =_badf .Classer .ClassIDs .Get (_adab );if _dfa !=nil {return _aa .Wrapf (_dfa ,_faa ,"\u0063\u0061\u006e\u0027\u0074\u0020\u0067e\u0074\u0020\u0073y\u006d\u0062\u006f\u006c \u0066\u006f\u0072\u0020\u0070\u0061\u0067\u0065\u0020\u0027\u0025\u0064\u0027\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u006c\u0061\u0073\u0073\u0065\u0072",_fge );
};if _ecf [_dcf ]==1&&!_cfa {_badf ._cf [_fge ]=append (_badf ._cf [_fge ],_dcf );};};if _dfa =_badf .Classer .ComputeLLCorners ();_dfa !=nil {return _aa .Wrap (_dfa ,_faa ,"");};return nil ;};func (_bfa *Page )getResolutionX ()(int ,error ){const _ege ="\u0067\u0065\u0074\u0052\u0065\u0073\u006f\u006c\u0075t\u0069\u006f\u006e\u0058";
if _bfa .ResolutionX !=0{return _bfa .ResolutionX ,nil ;};_caf :=_bfa .getPageInformationSegment ();if _caf ==nil {return 0,_aa .Error (_ege ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");};_bgcd ,_cafc :=_caf .GetSegmentData ();
if _cafc !=nil {return 0,_aa .Wrap (_cafc ,_ege ,"");};_egcb ,_cdd :=_bgcd .(*_dd .PageInformationSegment );if !_cdd {return 0,_aa .Errorf (_ege ,"\u0070\u0061\u0067\u0065\u0020\u0069n\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073 \u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070e\u003a \u0027\u0025\u0054\u0027",_bgcd );
};_bfa .ResolutionX =_egcb .ResolutionX ;return _bfa .ResolutionX ,nil ;};func (_age *Document )GetPage (pageNumber int )(_dd .Pager ,error ){const _eg ="\u0044\u006fc\u0075\u006d\u0065n\u0074\u002e\u0047\u0065\u0074\u0050\u0061\u0067\u0065";if pageNumber < 0{_ba .Log .Debug ("\u004a\u0042\u0049\u00472\u0020\u0050\u0061\u0067\u0065\u0020\u002d\u0020\u0047e\u0074\u0050\u0061\u0067\u0065\u003a\u0020\u0025\u0064\u002e\u0020\u0050\u0061\u0067\u0065\u0020\u0063\u0061n\u006e\u006f\u0074\u0020\u0062e\u0020\u006c\u006f\u0077\u0065\u0072\u0020\u0074\u0068\u0061\u006e\u0020\u0030\u002e\u0020\u0025\u0073",pageNumber ,_c .Stack ());
return nil ,_aa .Errorf (_eg ,"\u0069\u006e\u0076\u0061l\u0069\u0064\u0020\u006a\u0062\u0069\u0067\u0032\u0020d\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u0020\u002d\u0020\u0070\u0072\u006f\u0076\u0069\u0064\u0065\u0064 \u0069\u006e\u0076\u0061\u006ci\u0064\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u003a\u0020\u0025\u0064",pageNumber );
};if pageNumber > len (_age .Pages ){_ba .Log .Debug ("\u0050\u0061\u0067\u0065 n\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u003a\u0020\u0025\u0064\u002e\u0020%\u0073",pageNumber ,_c .Stack ());return nil ,_aa .Error (_eg ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006a\u0062\u0069\u0067\u0032 \u0064\u006f\u0063\u0075\u006d\u0065n\u0074\u0020\u002d\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064");
};_bef ,_afa :=_age .Pages [pageNumber ];if !_afa {_ba .Log .Debug ("\u0050\u0061\u0067\u0065 n\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u003a\u0020\u0025\u0064\u002e\u0020%\u0073",pageNumber ,_c .Stack ());return nil ,_aa .Errorf (_eg ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006a\u0062\u0069\u0067\u0032 \u0064\u006f\u0063\u0075\u006d\u0065n\u0074\u0020\u002d\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064");
};return _bef ,nil ;};type Page struct{Segments []*_dd .Header ;PageNumber int ;Bitmap *_ge .Bitmap ;FinalHeight int ;FinalWidth int ;ResolutionX int ;ResolutionY int ;IsLossless bool ;Document *Document ;FirstSegmentNumber int ;EncodingMethod EncodingMethod ;
BlackIsOne bool ;};func (_gge *Page )nextSegmentNumber ()uint32 {return _gge .Document .nextSegmentNumber ()};func (_aaa *Page )GetResolutionY ()(int ,error ){return _aaa .getResolutionY ()};func (_ffa *Document )mapData ()error {const _bfc ="\u006da\u0070\u0044\u0061\u0074\u0061";
var (_ccfa []*_dd .Header ;_bfd int64 ;_aeg _dd .Type ;);_dbg ,_adg :=_ffa .isFileHeaderPresent ();if _adg !=nil {return _aa .Wrap (_adg ,_bfc ,"");};if _dbg {if _adg =_ffa .parseFileHeader ();_adg !=nil {return _aa .Wrap (_adg ,_bfc ,"");};_bfd +=int64 (_ffa ._e );
_ffa .FullHeaders =true ;};var (_dfd *Page ;_ebe bool ;);for _aeg !=51&&!_ebe {_aae ,_fef :=_dd .NewHeader (_ffa ,_ffa .InputStream ,_bfd ,_ffa .OrganizationType );if _fef !=nil {return _aa .Wrap (_fef ,_bfc ,"");};_ba .Log .Trace ("\u0044\u0065c\u006f\u0064\u0069\u006eg\u0020\u0073e\u0067\u006d\u0065\u006e\u0074\u0020\u006e\u0075m\u0062\u0065\u0072\u003a\u0020\u0025\u0064\u002c\u0020\u0054\u0079\u0070e\u003a\u0020\u0025\u0073",_aae .SegmentNumber ,_aae .Type );
_aeg =_aae .Type ;if _aeg !=_dd .TEndOfFile {if _aae .PageAssociation !=0{_dfd =_ffa .Pages [_aae .PageAssociation ];if _dfd ==nil {_dfd =_ggd (_ffa ,_aae .PageAssociation );_ffa .Pages [_aae .PageAssociation ]=_dfd ;if _ffa .NumberOfPagesUnknown {_ffa .NumberOfPages ++;
};};_dfd .Segments =append (_dfd .Segments ,_aae );}else {_ffa .GlobalSegments .AddSegment (_aae );};};_ccfa =append (_ccfa ,_aae );_bfd =_ffa .InputStream .AbsolutePosition ();if _ffa .OrganizationType ==_dd .OSequential {_bfd +=int64 (_aae .SegmentDataLength );
};_ebe ,_fef =_ffa .reachedEOF (_bfd );if _fef !=nil {_ba .Log .Debug ("\u006a\u0062\u0069\u0067\u0032 \u0064\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u0020\u0072\u0065\u0061\u0063h\u0065\u0064\u0020\u0045\u004f\u0046\u0020\u0077\u0069\u0074\u0068\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0076",_fef );
return _aa .Wrap (_fef ,_bfc ,"");};};_ffa .determineRandomDataOffsets (_ccfa ,uint64 (_bfd ));return nil ;};func _ggd (_dcabc *Document ,_daf int )*Page {return &Page {Document :_dcabc ,PageNumber :_daf ,Segments :[]*_dd .Header {}};};const (GenericEM EncodingMethod =iota ;
CorrelationEM ;RankHausEM ;);func (_faaf *Page )GetSegment (number int )(*_dd .Header ,error ){const _fbc ="\u0050a\u0067e\u002e\u0047\u0065\u0074\u0053\u0065\u0067\u006d\u0065\u006e\u0074";for _ ,_deb :=range _faaf .Segments {if _deb .SegmentNumber ==uint32 (number ){return _deb ,nil ;
};};_ffb :=make ([]uint32 ,len (_faaf .Segments ));for _gad ,_adc :=range _faaf .Segments {_ffb [_gad ]=_adc .SegmentNumber ;};return nil ,_aa .Errorf (_fbc ,"\u0073e\u0067\u006d\u0065n\u0074\u0020\u0077i\u0074h \u006e\u0075\u006d\u0062\u0065\u0072\u003a \u0027\u0025\u0064\u0027\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0069\u006e\u0020\u0074\u0068\u0065\u0020\u0070\u0061\u0067\u0065\u003a\u0020'%\u0064'\u002e\u0020\u004b\u006e\u006f\u0077n\u0020\u0073\u0065\u0067\u006de\u006e\u0074\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u0073\u003a \u0025\u0076",number ,_faaf .PageNumber ,_ffb );
};func (_dafe *Page )getWidth ()(int ,error ){const _cbf ="\u0067\u0065\u0074\u0057\u0069\u0064\u0074\u0068";if _dafe .FinalWidth !=0{return _dafe .FinalWidth ,nil ;};_cbc :=_dafe .getPageInformationSegment ();if _cbc ==nil {return 0,_aa .Error (_cbf ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");
};_dcffb ,_fdd :=_cbc .GetSegmentData ();if _fdd !=nil {return 0,_aa .Wrap (_fdd ,_cbf ,"");};_cfc ,_gae :=_dcffb .(*_dd .PageInformationSegment );if !_gae {return 0,_aa .Errorf (_cbf ,"\u0070\u0061\u0067\u0065\u0020\u0069n\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073 \u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070e\u003a \u0027\u0025\u0054\u0027",_dcffb );
};_dafe .FinalWidth =_cfc .PageBMWidth ;return _dafe .FinalWidth ,nil ;};func (_eda *Page )GetBitmap ()(_acab *_ge .Bitmap ,_gcfc error ){_ba .Log .Trace (_a .Sprintf ("\u005b\u0050\u0041G\u0045\u005d\u005b\u0023%\u0064\u005d\u0020\u0047\u0065\u0074\u0042i\u0074\u006d\u0061\u0070\u0020\u0062\u0065\u0067\u0069\u006e\u0073\u002e\u002e\u002e",_eda .PageNumber ));
defer func (){if _gcfc !=nil {_ba .Log .Trace (_a .Sprintf ("\u005b\u0050\u0041\u0047\u0045\u005d\u005b\u0023\u0025\u0064\u005d\u0020\u0047\u0065\u0074B\u0069t\u006d\u0061\u0070\u0020\u0066\u0061\u0069\u006c\u0065\u0064\u002e\u0020\u0025\u0076",_eda .PageNumber ,_gcfc ));
}else {_ba .Log .Trace (_a .Sprintf ("\u005b\u0050\u0041\u0047\u0045\u005d\u005b\u0023\u0025\u0064]\u0020\u0047\u0065\u0074\u0042\u0069\u0074m\u0061\u0070\u0020\u0066\u0069\u006e\u0069\u0073\u0068\u0065\u0064",_eda .PageNumber ));};}();if _eda .Bitmap !=nil {return _eda .Bitmap ,nil ;
};_gcfc =_eda .composePageBitmap ();if _gcfc !=nil {return nil ,_gcfc ;};return _eda .Bitmap ,nil ;};func (_abcg *Page )getHeight ()(int ,error ){const _fbce ="\u0067e\u0074\u0048\u0065\u0069\u0067\u0068t";if _abcg .FinalHeight !=0{return _abcg .FinalHeight ,nil ;
};_bcgaa :=_abcg .getPageInformationSegment ();if _bcgaa ==nil {return 0,_aa .Error (_fbce ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");};_egc ,_gdb :=_bcgaa .GetSegmentData ();if _gdb !=nil {return 0,_aa .Wrap (_gdb ,_fbce ,"");
};_bab ,_bbf :=_egc .(*_dd .PageInformationSegment );if !_bbf {return 0,_aa .Errorf (_fbce ,"\u0070\u0061\u0067\u0065\u0020\u0069n\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073 \u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070e\u003a \u0027\u0025\u0054\u0027",_egc );
};if _bab .PageBMHeight ==_g .MaxInt32 {_ ,_gdb =_abcg .GetBitmap ();if _gdb !=nil {return 0,_aa .Wrap (_gdb ,_fbce ,"");};}else {_abcg .FinalHeight =_bab .PageBMHeight ;};return _abcg .FinalHeight ,nil ;};type Globals struct{Segments []*_dd .Header ;};
func (_gff *Page )composePageBitmap ()error {const _dcfg ="\u0063\u006f\u006d\u0070\u006f\u0073\u0065\u0050\u0061\u0067\u0065\u0042i\u0074\u006d\u0061\u0070";if _gff .PageNumber ==0{return nil ;};_ddd :=_gff .getPageInformationSegment ();if _ddd ==nil {return _aa .Error (_dcfg ,"\u0070\u0061\u0067e \u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069o\u006e \u0073e\u0067m\u0065\u006e\u0074\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064");
};_gdc ,_ceec :=_ddd .GetSegmentData ();if _ceec !=nil {return _ceec ;};_cfe ,_fdfa :=_gdc .(*_dd .PageInformationSegment );if !_fdfa {return _aa .Error (_dcfg ,"\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006da\u0074\u0069\u006f\u006e \u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073\u0020\u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070\u0065");
};if _ceec =_gff .createPage (_cfe );_ceec !=nil {return _aa .Wrap (_ceec ,_dcfg ,"");};_gff .clearSegmentData ();return nil ;};func (_dbf *Globals )GetSymbolDictionary ()(*_dd .Header ,error ){const _bbc ="G\u006c\u006f\u0062\u0061\u006c\u0073.\u0047\u0065\u0074\u0053\u0079\u006d\u0062\u006f\u006cD\u0069\u0063\u0074i\u006fn\u0061\u0072\u0079";
if _dbf ==nil {return nil ,_aa .Error (_bbc ,"\u0067\u006c\u006f\u0062al\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if len (_dbf .Segments )==0{return nil ,_aa .Error (_bbc ,"\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u0020\u0061\u0072\u0065\u0020e\u006d\u0070\u0074\u0079");
};for _ ,_ccce :=range _dbf .Segments {if _ccce .Type ==_dd .TSymbolDictionary {return _ccce ,nil ;};};return nil ,_aa .Error (_bbc ,"\u0067\u006c\u006fba\u006c\u0020\u0073\u0079\u006d\u0062\u006f\u006c\u0020d\u0069c\u0074i\u006fn\u0061\u0072\u0079\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064");
};func (_eccc *Page )GetHeight ()(int ,error ){return _eccc .getHeight ()};func _fdfe (_dgc *_be .Reader ,_fdfeb *Globals )(*Document ,error ){_fgf :=&Document {Pages :make (map[int ]*Page ),InputStream :_dgc ,OrganizationType :_dd .OSequential ,NumberOfPagesUnknown :true ,GlobalSegments :_fdfeb ,_e :9};
if _fgf .GlobalSegments ==nil {_fgf .GlobalSegments =&Globals {};};if _bdfc :=_fgf .mapData ();_bdfc !=nil {return nil ,_bdfc ;};return _fgf ,nil ;};func InitEncodeDocument (fullHeaders bool )*Document {return &Document {FullHeaders :fullHeaders ,_fg :_be .BufferedMSB (),Pages :map[int ]*Page {},_cf :map[int ][]int {},_df :map[int ]int {},_bd :map[int ][]int {}};
};func (_daee *Page )lastSegmentNumber ()(_febf uint32 ,_cfd error ){const _bcgb ="\u006c\u0061\u0073\u0074\u0053\u0065\u0067\u006d\u0065\u006e\u0074\u004eu\u006d\u0062\u0065\u0072";if len (_daee .Segments )==0{return _febf ,_aa .Errorf (_bcgb ,"\u006e\u006f\u0020se\u0067\u006d\u0065\u006e\u0074\u0073\u0020\u0066\u006fu\u006ed\u0020i\u006e \u0074\u0068\u0065\u0020\u0070\u0061\u0067\u0065\u0020\u0027\u0025\u0064\u0027",_daee .PageNumber );
};return _daee .Segments [len (_daee .Segments )-1].SegmentNumber ,nil ;};func (_bdf *Document )parseFileHeader ()error {const _bca ="\u0070a\u0072s\u0065\u0046\u0069\u006c\u0065\u0048\u0065\u0061\u0064\u0065\u0072";_ ,_ead :=_bdf .InputStream .Seek (8,_b .SeekStart );
if _ead !=nil {return _aa .Wrap (_ead ,_bca ,"\u0069\u0064");};_ ,_ead =_bdf .InputStream .ReadBits (5);if _ead !=nil {return _aa .Wrap (_ead ,_bca ,"\u0072\u0065\u0073\u0065\u0072\u0076\u0065\u0064\u0020\u0062\u0069\u0074\u0073");};_cb ,_ead :=_bdf .InputStream .ReadBit ();
if _ead !=nil {return _aa .Wrap (_ead ,_bca ,"\u0065x\u0074e\u006e\u0064\u0065\u0064\u0020t\u0065\u006dp\u006c\u0061\u0074\u0065\u0073");};if _cb ==1{_bdf .GBUseExtTemplate =true ;};_cb ,_ead =_bdf .InputStream .ReadBit ();if _ead !=nil {return _aa .Wrap (_ead ,_bca ,"\u0075\u006e\u006b\u006eow\u006e\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u0075\u006d\u0062\u0065\u0072");
};if _cb !=1{_bdf .NumberOfPagesUnknown =false ;};_cb ,_ead =_bdf .InputStream .ReadBit ();if _ead !=nil {return _aa .Wrap (_ead ,_bca ,"\u006f\u0072\u0067\u0061\u006e\u0069\u007a\u0061\u0074\u0069\u006f\u006e \u0074\u0079\u0070\u0065");};_bdf .OrganizationType =_dd .OrganizationType (_cb );
if !_bdf .NumberOfPagesUnknown {_bdf .NumberOfPages ,_ead =_bdf .InputStream .ReadUint32 ();if _ead !=nil {return _aa .Wrap (_ead ,_bca ,"\u006eu\u006db\u0065\u0072\u0020\u006f\u0066\u0020\u0070\u0061\u0067\u0065\u0073");};_bdf ._e =13;};return nil ;};
func (_abcd *Document )encodeSegment (_bag *_dd .Header ,_af *int )error {const _cee ="\u0065\u006e\u0063\u006f\u0064\u0065\u0053\u0065\u0067\u006d\u0065\u006e\u0074";_bag .SegmentNumber =_abcd .nextSegmentNumber ();_fdf ,_dac :=_bag .Encode (_abcd ._fg );
if _dac !=nil {return _aa .Wrapf (_dac ,_cee ,"\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u003a\u0020\u0027\u0025\u0064\u0027",_bag .SegmentNumber );};*_af +=_fdf ;return nil ;};func (_aeaef *Page )collectPageStripes ()(_gcff []_dd .Segmenter ,_cba error ){const _dee ="\u0063o\u006cl\u0065\u0063\u0074\u0050\u0061g\u0065\u0053t\u0072\u0069\u0070\u0065\u0073";
var _baa _dd .Segmenter ;for _ ,_afd :=range _aeaef .Segments {switch _afd .Type {case 6,7,22,23,38,39,42,43:_baa ,_cba =_afd .GetSegmentData ();if _cba !=nil {return nil ,_aa .Wrap (_cba ,_dee ,"");};_gcff =append (_gcff ,_baa );case 50:_baa ,_cba =_afd .GetSegmentData ();
if _cba !=nil {return nil ,_cba ;};_aga ,_ageb :=_baa .(*_dd .EndOfStripe );if !_ageb {return nil ,_aa .Errorf (_dee ,"\u0045\u006e\u0064\u004f\u0066\u0053\u0074\u0072\u0069\u0070\u0065\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u006f\u0066\u0020\u0076\u0061l\u0069\u0064\u0020\u0074\u0079p\u0065\u003a \u0027\u0025\u0054\u0027",_baa );
};_gcff =append (_gcff ,_aga );_aeaef .FinalHeight =_aga .LineNumber ();};};return _gcff ,nil ;};func (_bge *Globals )GetSegment (segmentNumber int )(*_dd .Header ,error ){const _cfgb ="\u0047l\u006fb\u0061\u006c\u0073\u002e\u0047e\u0074\u0053e\u0067\u006d\u0065\u006e\u0074";
if _bge ==nil {return nil ,_aa .Error (_cfgb ,"\u0067\u006c\u006f\u0062al\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if len (_bge .Segments )==0{return nil ,_aa .Error (_cfgb ,"\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u0020\u0061\u0072\u0065\u0020e\u006d\u0070\u0074\u0079");
};var _ga *_dd .Header ;for _ ,_ga =range _bge .Segments {if _ga .SegmentNumber ==uint32 (segmentNumber ){break ;};};if _ga ==nil {return nil ,_aa .Error (_cfgb ,"\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064");
};return _ga ,nil ;};