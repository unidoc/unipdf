//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package document ;import (_d "encoding/binary";_g "fmt";_e "github.com/unidoc/unipdf/v4/common";_a "github.com/unidoc/unipdf/v4/internal/bitwise";_ffc "github.com/unidoc/unipdf/v4/internal/jbig2/basic";_ge "github.com/unidoc/unipdf/v4/internal/jbig2/bitmap";
_fa "github.com/unidoc/unipdf/v4/internal/jbig2/document/segments";_fdf "github.com/unidoc/unipdf/v4/internal/jbig2/encoder/classer";_fd "github.com/unidoc/unipdf/v4/internal/jbig2/errors";_ff "io";_dg "math";_c "runtime/debug";);type Document struct{Pages map[int ]*Page ;
NumberOfPagesUnknown bool ;NumberOfPages uint32 ;GBUseExtTemplate bool ;InputStream *_a .Reader ;GlobalSegments *Globals ;OrganizationType _fa .OrganizationType ;Classer *_fdf .Classer ;XRes ,YRes int ;FullHeaders bool ;CurrentSegmentNumber uint32 ;AverageTemplates *_ge .Bitmaps ;
BaseIndexes []int ;Refinement bool ;RefineLevel int ;_ab uint8 ;_b *_a .BufferedWriter ;EncodeGlobals bool ;_ba int ;_af map[int ][]int ;_de map[int ][]int ;_fe []int ;_bae map[int ]int ;};func (_gbg *Document )nextSegmentNumber ()uint32 {_afg :=_gbg .CurrentSegmentNumber ;
_gbg .CurrentSegmentNumber ++;return _afg ;};func (_gge *Page )AddEndOfPageSegment (){_fcf :=&_fa .Header {Type :_fa .TEndOfPage ,PageAssociation :_gge .PageNumber };_gge .Segments =append (_gge .Segments ,_fcf );};func (_ffcg *Document )completeSymbols ()(_cag error ){const _ffe ="\u0063o\u006dp\u006c\u0065\u0074\u0065\u0053\u0079\u006d\u0062\u006f\u006c\u0073";
if _ffcg .Classer ==nil {return nil ;};if _ffcg .Classer .UndilatedTemplates ==nil {return _fd .Error (_ffe ,"\u006e\u006f t\u0065\u006d\u0070l\u0061\u0074\u0065\u0073 de\u0066in\u0065\u0064\u0020\u0066\u006f\u0072\u0020th\u0065\u0020\u0063\u006c\u0061\u0073\u0073e\u0072");
};_cc :=len (_ffcg .Pages )==1;_dfdd :=make ([]int ,_ffcg .Classer .UndilatedTemplates .Size ());var _fad int ;for _bcb :=0;_bcb < _ffcg .Classer .ClassIDs .Size ();_bcb ++{_fad ,_cag =_ffcg .Classer .ClassIDs .Get (_bcb );if _cag !=nil {return _fd .Wrap (_cag ,_ffe ,"\u0063\u006c\u0061\u0073\u0073\u0020\u0049\u0044\u0027\u0073");
};_dfdd [_fad ]++;};var _fgf []int ;for _cce :=0;_cce < _ffcg .Classer .UndilatedTemplates .Size ();_cce ++{if _dfdd [_cce ]==0{return _fd .Error (_ffe ,"\u006eo\u0020\u0073y\u006d\u0062\u006f\u006cs\u0020\u0069\u006es\u0074\u0061\u006e\u0063\u0065\u0073\u0020\u0066\u006fun\u0064\u0020\u0066o\u0072\u0020g\u0069\u0076\u0065\u006e\u0020\u0063l\u0061\u0073s\u003f\u0020");
};if _dfdd [_cce ]> 1||_cc {_fgf =append (_fgf ,_cce );};};_ffcg ._ba =len (_fgf );var _eff ,_ddc int ;for _efc :=0;_efc < _ffcg .Classer .ComponentPageNumbers .Size ();_efc ++{_eff ,_cag =_ffcg .Classer .ComponentPageNumbers .Get (_efc );if _cag !=nil {return _fd .Wrapf (_cag ,_ffe ,"p\u0061\u0067\u0065\u003a\u0020\u0027\u0025\u0064\u0027 \u006e\u006f\u0074\u0020\u0066\u006f\u0075nd\u0020\u0069\u006e\u0020t\u0068\u0065\u0020\u0063\u006c\u0061\u0073\u0073\u0065r \u0070\u0061g\u0065\u006e\u0075\u006d\u0062\u0065\u0072\u0073",_efc );
};_ddc ,_cag =_ffcg .Classer .ClassIDs .Get (_efc );if _cag !=nil {return _fd .Wrapf (_cag ,_ffe ,"\u0063\u0061\u006e\u0027\u0074\u0020\u0067e\u0074\u0020\u0073y\u006d\u0062\u006f\u006c \u0066\u006f\u0072\u0020\u0070\u0061\u0067\u0065\u0020\u0027\u0025\u0064\u0027\u0020\u0066\u0072\u006f\u006d\u0020\u0063\u006c\u0061\u0073\u0073\u0065\u0072",_eff );
};if _dfdd [_ddc ]==1&&!_cc {_ffcg ._af [_eff ]=append (_ffcg ._af [_eff ],_ddc );};};if _cag =_ffcg .Classer .ComputeLLCorners ();_cag !=nil {return _fd .Wrap (_cag ,_ffe ,"");};return nil ;};type Page struct{Segments []*_fa .Header ;PageNumber int ;Bitmap *_ge .Bitmap ;
FinalHeight int ;FinalWidth int ;ResolutionX int ;ResolutionY int ;IsLossless bool ;Document *Document ;FirstSegmentNumber int ;EncodingMethod EncodingMethod ;BlackIsOne bool ;};func (_bbd *Document )Encode ()(_eb []byte ,_gfb error ){const _baac ="\u0044o\u0063u\u006d\u0065\u006e\u0074\u002e\u0045\u006e\u0063\u006f\u0064\u0065";
var _gag ,_cd int ;if _bbd .FullHeaders {if _gag ,_gfb =_bbd .encodeFileHeader (_bbd ._b );_gfb !=nil {return nil ,_fd .Wrap (_gfb ,_baac ,"");};};var (_fcb bool ;_abb *_fa .Header ;_cea *Page ;);if _gfb =_bbd .completeClassifiedPages ();_gfb !=nil {return nil ,_fd .Wrap (_gfb ,_baac ,"");
};if _gfb =_bbd .produceClassifiedPages ();_gfb !=nil {return nil ,_fd .Wrap (_gfb ,_baac ,"");};if _bbd .GlobalSegments !=nil {for _ ,_abb =range _bbd .GlobalSegments .Segments {if _gfb =_bbd .encodeSegment (_abb ,&_gag );_gfb !=nil {return nil ,_fd .Wrap (_gfb ,_baac ,"");
};};};for _dce :=1;_dce <=int (_bbd .NumberOfPages );_dce ++{if _cea ,_fcb =_bbd .Pages [_dce ];!_fcb {return nil ,_fd .Errorf (_baac ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_dce );};for _ ,_abb =range _cea .Segments {if _gfb =_bbd .encodeSegment (_abb ,&_gag );
_gfb !=nil {return nil ,_fd .Wrap (_gfb ,_baac ,"");};};};if _bbd .FullHeaders {if _cd ,_gfb =_bbd .encodeEOFHeader (_bbd ._b );_gfb !=nil {return nil ,_fd .Wrap (_gfb ,_baac ,"");};_gag +=_cd ;};_eb =_bbd ._b .Data ();if len (_eb )!=_gag {_e .Log .Debug ("\u0042\u0079\u0074\u0065\u0073 \u0077\u0072\u0069\u0074\u0074\u0065\u006e \u0028\u006e\u0029\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u0065\u0071\u0075\u0061\u006c\u0020\u0074\u006f\u0020\u0074\u0068\u0065\u0020\u006c\u0065\u006e\u0067\u0074\u0068\u0020\u006f\u0066\u0020t\u0068\u0065\u0020\u0064\u0061\u0074\u0061\u0020\u0065\u006e\u0063\u006fd\u0065\u0064\u003a\u0020\u0027\u0025d\u0027",_gag ,len (_eb ));
};return _eb ,nil ;};func (_fbdd *Page )createPage (_dcb *_fa .PageInformationSegment )error {var _aff error ;if !_dcb .IsStripe ||_dcb .PageBMHeight !=-1{_aff =_fbdd .createNormalPage (_dcb );}else {_aff =_fbdd .createStripedPage (_dcb );};return _aff ;
};func (_df *Document )AddClassifiedPage (bm *_ge .Bitmap ,method _fdf .Method )(_ag error ){const _dd ="\u0044\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u002e\u0041\u0064d\u0043\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064P\u0061\u0067\u0065";
if !_df .FullHeaders &&_df .NumberOfPages !=0{return _fd .Error (_dd ,"\u0064\u006f\u0063\u0075\u006de\u006e\u0074\u0020\u0061\u006c\u0072\u0065a\u0064\u0079\u0020\u0063\u006f\u006e\u0074\u0061\u0069\u006e\u0073\u0020\u0070\u0061\u0067\u0065\u002e\u0020\u0046\u0069\u006c\u0065\u004d\u006f\u0064\u0065\u0020\u0064\u0069\u0073\u0061\u006c\u006c\u006f\u0077\u0073\u0020\u0061\u0064\u0064i\u006e\u0067\u0020\u006d\u006f\u0072\u0065\u0020\u0074\u0068\u0061\u006e \u006f\u006e\u0065\u0020\u0070\u0061g\u0065");
};if _df .Classer ==nil {if _df .Classer ,_ag =_fdf .Init (_fdf .DefaultSettings ());_ag !=nil {return _fd .Wrap (_ag ,_dd ,"");};};_fde :=int (_df .nextPageNumber ());_eca :=&Page {Segments :[]*_fa .Header {},Bitmap :bm ,Document :_df ,FinalHeight :bm .Height ,FinalWidth :bm .Width ,PageNumber :_fde };
_df .Pages [_fde ]=_eca ;switch method {case _fdf .RankHaus :_eca .EncodingMethod =RankHausEM ;case _fdf .Correlation :_eca .EncodingMethod =CorrelationEM ;};_eca .AddPageInformationSegment ();if _ag =_df .Classer .AddPage (bm ,_fde ,method );_ag !=nil {return _fd .Wrap (_ag ,_dd ,"");
};if _df .FullHeaders {_eca .AddEndOfPageSegment ();};return nil ;};func (_bdf *Document )determineRandomDataOffsets (_cfc []*_fa .Header ,_deb uint64 ){if _bdf .OrganizationType !=_fa .ORandom {return ;};for _ ,_gcc :=range _cfc {_gcc .SegmentDataStartOffset =_deb ;
_deb +=_gcc .SegmentDataLength ;};};func (_fdaa *Document )nextPageNumber ()uint32 {_fdaa .NumberOfPages ++;return _fdaa .NumberOfPages };type Globals struct{Segments []*_fa .Header ;};func (_dfc *Document )mapData ()error {const _abf ="\u006da\u0070\u0044\u0061\u0074\u0061";
var (_bec []*_fa .Header ;_gfd int64 ;_cfd _fa .Type ;);_egf ,_cbf :=_dfc .isFileHeaderPresent ();if _cbf !=nil {return _fd .Wrap (_cbf ,_abf ,"");};if _egf {if _cbf =_dfc .parseFileHeader ();_cbf !=nil {return _fd .Wrap (_cbf ,_abf ,"");};_gfd +=int64 (_dfc ._ab );
_dfc .FullHeaders =true ;};var (_ecfa *Page ;_cba bool ;);for _cfd !=51&&!_cba {_baea ,_ae :=_fa .NewHeader (_dfc ,_dfc .InputStream ,_gfd ,_dfc .OrganizationType );if _ae !=nil {return _fd .Wrap (_ae ,_abf ,"");};_e .Log .Trace ("\u0044\u0065c\u006f\u0064\u0069\u006eg\u0020\u0073e\u0067\u006d\u0065\u006e\u0074\u0020\u006e\u0075m\u0062\u0065\u0072\u003a\u0020\u0025\u0064\u002c\u0020\u0054\u0079\u0070e\u003a\u0020\u0025\u0073",_baea .SegmentNumber ,_baea .Type );
_cfd =_baea .Type ;if _cfd !=_fa .TEndOfFile {if _baea .PageAssociation !=0{_ecfa =_dfc .Pages [_baea .PageAssociation ];if _ecfa ==nil {_ecfa =_gfdg (_dfc ,_baea .PageAssociation );_dfc .Pages [_baea .PageAssociation ]=_ecfa ;if _dfc .NumberOfPagesUnknown {_dfc .NumberOfPages ++;
};};_ecfa .Segments =append (_ecfa .Segments ,_baea );}else {_dfc .GlobalSegments .AddSegment (_baea );};};_bec =append (_bec ,_baea );_gfd =_dfc .InputStream .AbsolutePosition ();if _dfc .OrganizationType ==_fa .OSequential {_gfd +=int64 (_baea .SegmentDataLength );
};_cba ,_ae =_dfc .reachedEOF (_gfd );if _ae !=nil {_e .Log .Debug ("\u006a\u0062\u0069\u0067\u0032 \u0064\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u0020\u0072\u0065\u0061\u0063h\u0065\u0064\u0020\u0045\u004f\u0046\u0020\u0077\u0069\u0074\u0068\u0020\u0065\u0072\u0072\u006f\u0072\u003a\u0020\u0025\u0076",_ae );
return _fd .Wrap (_ae ,_abf ,"");};};_dfc .determineRandomDataOffsets (_bec ,uint64 (_gfd ));return nil ;};func (_dee *Page )clearSegmentData (){for _ede :=range _dee .Segments {_dee .Segments [_ede ].CleanSegmentData ();};};func (_beb *Page )fitsPage (_fccf *_fa .PageInformationSegment ,_fba *_ge .Bitmap )bool {return _beb .countRegions ()==1&&_fccf .DefaultPixelValue ==0&&_fccf .PageBMWidth ==_fba .Width &&_fccf .PageBMHeight ==_fba .Height ;
};func (_dcac *Page )GetSegment (number int )(*_fa .Header ,error ){const _cdec ="\u0050a\u0067e\u002e\u0047\u0065\u0074\u0053\u0065\u0067\u006d\u0065\u006e\u0074";for _ ,_bedb :=range _dcac .Segments {if _bedb .SegmentNumber ==uint32 (number ){return _bedb ,nil ;
};};_bfe :=make ([]uint32 ,len (_dcac .Segments ));for _ddd ,_cdg :=range _dcac .Segments {_bfe [_ddd ]=_cdg .SegmentNumber ;};return nil ,_fd .Errorf (_cdec ,"\u0073e\u0067\u006d\u0065n\u0074\u0020\u0077i\u0074h \u006e\u0075\u006d\u0062\u0065\u0072\u003a \u0027\u0025\u0064\u0027\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0069\u006e\u0020\u0074\u0068\u0065\u0020\u0070\u0061\u0067\u0065\u003a\u0020'%\u0064'\u002e\u0020\u004b\u006e\u006f\u0077n\u0020\u0073\u0065\u0067\u006de\u006e\u0074\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u0073\u003a \u0025\u0076",number ,_dcac .PageNumber ,_bfe );
};func (_aca *Globals )GetSegment (segmentNumber int )(*_fa .Header ,error ){const _egag ="\u0047l\u006fb\u0061\u006c\u0073\u002e\u0047e\u0074\u0053e\u0067\u006d\u0065\u006e\u0074";if _aca ==nil {return nil ,_fd .Error (_egag ,"\u0067\u006c\u006f\u0062al\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};if len (_aca .Segments )==0{return nil ,_fd .Error (_egag ,"\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u0020\u0061\u0072\u0065\u0020e\u006d\u0070\u0074\u0079");};var _ead *_fa .Header ;for _ ,_ead =range _aca .Segments {if _ead .SegmentNumber ==uint32 (segmentNumber ){break ;
};};if _ead ==nil {return nil ,_fd .Error (_egag ,"\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064");};return _ead ,nil ;};func (_ac *Document )encodeEOFHeader (_bfg _a .BinaryWriter )(_bgc int ,_fbd error ){_ega :=&_fa .Header {SegmentNumber :_ac .nextSegmentNumber (),Type :_fa .TEndOfFile };
if _bgc ,_fbd =_ega .Encode (_bfg );_fbd !=nil {return 0,_fd .Wrap (_fbd ,"\u0065n\u0063o\u0064\u0065\u0045\u004f\u0046\u0048\u0065\u0061\u0064\u0065\u0072","");};return _bgc ,nil ;};func (_eab *Page )GetHeight ()(int ,error ){return _eab .getHeight ()};
func _ccec (_fdfe *_a .Reader ,_ddbd *Globals )(*Document ,error ){_dba :=&Document {Pages :make (map[int ]*Page ),InputStream :_fdfe ,OrganizationType :_fa .OSequential ,NumberOfPagesUnknown :true ,GlobalSegments :_ddbd ,_ab :9};if _dba .GlobalSegments ==nil {_dba .GlobalSegments =&Globals {};
};if _dea :=_dba .mapData ();_dea !=nil {return nil ,_dea ;};return _dba ,nil ;};func (_bff *Globals )GetSymbolDictionary ()(*_fa .Header ,error ){const _agg ="G\u006c\u006f\u0062\u0061\u006c\u0073.\u0047\u0065\u0074\u0053\u0079\u006d\u0062\u006f\u006cD\u0069\u0063\u0074i\u006fn\u0061\u0072\u0079";
if _bff ==nil {return nil ,_fd .Error (_agg ,"\u0067\u006c\u006f\u0062al\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if len (_bff .Segments )==0{return nil ,_fd .Error (_agg ,"\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u0020\u0061\u0072\u0065\u0020e\u006d\u0070\u0074\u0079");
};for _ ,_gfbg :=range _bff .Segments {if _gfbg .Type ==_fa .TSymbolDictionary {return _gfbg ,nil ;};};return nil ,_fd .Error (_agg ,"\u0067\u006c\u006fba\u006c\u0020\u0073\u0079\u006d\u0062\u006f\u006c\u0020d\u0069c\u0074i\u006fn\u0061\u0072\u0079\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064");
};func (_fgfc *Page )getCombinationOperator (_bdg *_fa .PageInformationSegment ,_ged _ge .CombinationOperator )_ge .CombinationOperator {if _bdg .CombinationOperatorOverrideAllowed (){return _ged ;};return _bdg .CombinationOperator ();};func (_fbe *Page )getPageInformationSegment ()*_fa .Header {for _ ,_fabd :=range _fbe .Segments {if _fabd .Type ==_fa .TPageInformation {return _fabd ;
};};_e .Log .Debug ("\u0050\u0061\u0067\u0065\u0020\u0069\u006e\u0066o\u0072\u006d\u0061ti\u006f\u006e\u0020\u0073\u0065\u0067m\u0065\u006e\u0074\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u0020\u0066o\u0072\u0020\u0070\u0061\u0067\u0065\u003a\u0020%\u0073\u002e",_fbe );
return nil ;};func (_fbb *Document )reachedEOF (_gd int64 )(bool ,error ){const _geca ="\u0072\u0065\u0061\u0063\u0068\u0065\u0064\u0045\u004f\u0046";_ ,_cfcc :=_fbb .InputStream .Seek (_gd ,_ff .SeekStart );if _cfcc !=nil {_e .Log .Debug ("\u0072\u0065\u0061c\u0068\u0065\u0064\u0045\u004f\u0046\u0020\u002d\u0020\u0064\u002e\u0049\u006e\u0070\u0075\u0074\u0053\u0074\u0072\u0065\u0061\u006d\u002e\u0053\u0065\u0065\u006b\u0020\u0066a\u0069\u006c\u0065\u0064\u003a\u0020\u0025\u0076",_cfcc );
return false ,_fd .Wrap (_cfcc ,_geca ,"\u0069n\u0070\u0075\u0074\u0020\u0073\u0074\u0072\u0065\u0061\u006d\u0020s\u0065\u0065\u006b\u0020\u0066\u0061\u0069\u006c\u0065\u0064");};_ ,_cfcc =_fbb .InputStream .ReadBits (32);if _cfcc ==_ff .EOF {return true ,nil ;
}else if _cfcc !=nil {return false ,_fd .Wrap (_cfcc ,_geca ,"");};return false ,nil ;};func (_ffca *Document )produceClassifiedPage (_ef *Page ,_bf *_fa .Header )(_dgd error ){const _ffd ="p\u0072\u006f\u0064\u0075ce\u0043l\u0061\u0073\u0073\u0069\u0066i\u0065\u0064\u0050\u0061\u0067\u0065";
var _gg map[int ]int ;_aa :=_ffca ._ba ;_fca :=[]*_fa .Header {_bf };if len (_ffca ._af [_ef .PageNumber ])> 0{_gg =map[int ]int {};_eec ,_gf :=_ffca .addSymbolDictionary (_ef .PageNumber ,_ffca .Classer .UndilatedTemplates ,_ffca ._af [_ef .PageNumber ],_gg ,false );
if _gf !=nil {return _fd .Wrap (_gf ,_ffd ,"");};_fca =append (_fca ,_eec );_aa +=len (_ffca ._af [_ef .PageNumber ]);};_dag :=_ffca ._de [_ef .PageNumber ];_e .Log .Debug ("P\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020c\u006f\u006d\u0070\u0073: \u0025\u0076",_ef .PageNumber ,_dag );
_ef .addTextRegionSegment (_fca ,_ffca ._bae ,_gg ,_ffca ._de [_ef .PageNumber ],_ffca .Classer .PtaLL ,_ffca .Classer .UndilatedTemplates ,_ffca .Classer .ClassIDs ,nil ,_dab (_aa ),len (_ffca ._de [_ef .PageNumber ]));return nil ;};const (GenericEM EncodingMethod =iota ;
CorrelationEM ;RankHausEM ;);func (_cbbe *Page )Encode (w _a .BinaryWriter )(_gccg int ,_cbae error ){const _aef ="P\u0061\u0067\u0065\u002e\u0045\u006e\u0063\u006f\u0064\u0065";var _cfa int ;for _ ,_aea :=range _cbbe .Segments {if _cfa ,_cbae =_aea .Encode (w );
_cbae !=nil {return _gccg ,_fd .Wrap (_cbae ,_aef ,"");};_gccg +=_cfa ;};return _gccg ,nil ;};func (_ccc *Document )GetNumberOfPages ()(uint32 ,error ){if _ccc .NumberOfPagesUnknown ||_ccc .NumberOfPages ==0{if len (_ccc .Pages )==0{if _fggd :=_ccc .mapData ();
_fggd !=nil {return 0,_fd .Wrap (_fggd ,"\u0044o\u0063\u0075\u006d\u0065n\u0074\u002e\u0047\u0065\u0074N\u0075m\u0062e\u0072\u004f\u0066\u0050\u0061\u0067\u0065s","");};};return uint32 (len (_ccc .Pages )),nil ;};return _ccc .NumberOfPages ,nil ;};func (_fgff *Page )nextSegmentNumber ()uint32 {return _fgff .Document .nextSegmentNumber ()};
func (_cgb *Document )encodeFileHeader (_ded _a .BinaryWriter )(_ffde int ,_edg error ){const _abeb ="\u0065\u006ec\u006f\u0064\u0065F\u0069\u006c\u0065\u0048\u0065\u0061\u0064\u0065\u0072";_ffde ,_edg =_ded .Write (_fc );if _edg !=nil {return _ffde ,_fd .Wrap (_edg ,_abeb ,"\u0069\u0064");
};if _edg =_ded .WriteByte (0x01);_edg !=nil {return _ffde ,_fd .Wrap (_edg ,_abeb ,"\u0066\u006c\u0061g\u0073");};_ffde ++;_bcf :=make ([]byte ,4);_d .BigEndian .PutUint32 (_bcf ,_cgb .NumberOfPages );_efg ,_edg :=_ded .Write (_bcf );if _edg !=nil {return _efg ,_fd .Wrap (_edg ,_abeb ,"p\u0061\u0067\u0065\u0020\u006e\u0075\u006d\u0062\u0065\u0072");
};_ffde +=_efg ;return _ffde ,nil ;};func (_aga *Page )String ()string {return _g .Sprintf ("\u0050\u0061\u0067\u0065\u0020\u0023\u0025\u0064",_aga .PageNumber );};func (_ebae *Page )GetBitmap ()(_cfdb *_ge .Bitmap ,_add error ){_e .Log .Trace (_g .Sprintf ("\u005b\u0050\u0041G\u0045\u005d\u005b\u0023%\u0064\u005d\u0020\u0047\u0065\u0074\u0042i\u0074\u006d\u0061\u0070\u0020\u0062\u0065\u0067\u0069\u006e\u0073\u002e\u002e\u002e",_ebae .PageNumber ));
defer func (){if _add !=nil {_e .Log .Trace (_g .Sprintf ("\u005b\u0050\u0041\u0047\u0045\u005d\u005b\u0023\u0025\u0064\u005d\u0020\u0047\u0065\u0074B\u0069t\u006d\u0061\u0070\u0020\u0066\u0061\u0069\u006c\u0065\u0064\u002e\u0020\u0025\u0076",_ebae .PageNumber ,_add ));
}else {_e .Log .Trace (_g .Sprintf ("\u005b\u0050\u0041\u0047\u0045\u005d\u005b\u0023\u0025\u0064]\u0020\u0047\u0065\u0074\u0042\u0069\u0074m\u0061\u0070\u0020\u0066\u0069\u006e\u0069\u0073\u0068\u0065\u0064",_ebae .PageNumber ));};}();if _ebae .Bitmap !=nil {return _ebae .Bitmap ,nil ;
};_add =_ebae .composePageBitmap ();if _add !=nil {return nil ,_add ;};return _ebae .Bitmap ,nil ;};func (_aeag *Page )composePageBitmap ()error {const _aad ="\u0063\u006f\u006d\u0070\u006f\u0073\u0065\u0050\u0061\u0067\u0065\u0042i\u0074\u006d\u0061\u0070";
if _aeag .PageNumber ==0{return nil ;};_ecaa :=_aeag .getPageInformationSegment ();if _ecaa ==nil {return _fd .Error (_aad ,"\u0070\u0061\u0067e \u0069\u006e\u0066\u006f\u0072\u006d\u0061\u0074\u0069o\u006e \u0073e\u0067m\u0065\u006e\u0074\u0020\u006e\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064");
};_gfbe ,_bde :=_ecaa .GetSegmentData ();if _bde !=nil {return _bde ;};_cgg ,_cfe :=_gfbe .(*_fa .PageInformationSegment );if !_cfe {return _fd .Error (_aad ,"\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006da\u0074\u0069\u006f\u006e \u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073\u0020\u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070\u0065");
};if _bde =_aeag .createPage (_cgg );_bde !=nil {return _fd .Wrap (_bde ,_aad ,"");};_aeag .clearSegmentData ();return nil ;};func (_ffdc *Page )createNormalPage (_geb *_fa .PageInformationSegment )error {const _aefa ="\u0063\u0072e\u0061\u0074\u0065N\u006f\u0072\u006d\u0061\u006c\u0050\u0061\u0067\u0065";
_ffdc .Bitmap =_ge .New (_geb .PageBMWidth ,_geb .PageBMHeight );if _geb .DefaultPixelValue !=0{_ffdc .Bitmap .SetDefaultPixel ();};for _ ,_cad :=range _ffdc .Segments {switch _cad .Type {case 6,7,22,23,38,39,42,43:_e .Log .Trace ("\u0047\u0065\u0074\u0074in\u0067\u0020\u0053\u0065\u0067\u006d\u0065\u006e\u0074\u003a\u0020\u0025\u0064",_cad .SegmentNumber );
_dcf ,_cbad :=_cad .GetSegmentData ();if _cbad !=nil {return _cbad ;};_ggg ,_bgcd :=_dcf .(_fa .Regioner );if !_bgcd {_e .Log .Debug ("\u0053\u0065g\u006d\u0065\u006e\u0074\u003a\u0020\u0025\u0054\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u0061\u0020\u0052\u0065\u0067\u0069on\u0065\u0072",_dcf );
return _fd .Errorf (_aefa ,"i\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006a\u0062i\u0067\u0032\u0020\u0073\u0065\u0067\u006den\u0074\u0020\u0074\u0079p\u0065\u0020\u002d\u0020\u006e\u006f\u0074\u0020\u0061 R\u0065\u0067i\u006f\u006e\u0065\u0072\u003a\u0020\u0025\u0054",_dcf );
};_ecfad ,_cbad :=_ggg .GetRegionBitmap ();if _cbad !=nil {return _fd .Wrap (_cbad ,_aefa ,"");};if _ffdc .fitsPage (_geb ,_ecfad ){_ffdc .Bitmap =_ecfad ;}else {_bcfe :=_ggg .GetRegionInfo ();_cfge :=_ffdc .getCombinationOperator (_geb ,_bcfe .CombinaionOperator );
_cbad =_ge .Blit (_ecfad ,_ffdc .Bitmap ,int (_bcfe .XLocation ),int (_bcfe .YLocation ),_cfge );if _cbad !=nil {return _fd .Wrap (_cbad ,_aefa ,"");};};};};return nil ;};type EncodingMethod int ;func (_adce *Document )parseFileHeader ()error {const _ecd ="\u0070a\u0072s\u0065\u0046\u0069\u006c\u0065\u0048\u0065\u0061\u0064\u0065\u0072";
_ ,_edb :=_adce .InputStream .Seek (8,_ff .SeekStart );if _edb !=nil {return _fd .Wrap (_edb ,_ecd ,"\u0069\u0064");};_ ,_edb =_adce .InputStream .ReadBits (5);if _edb !=nil {return _fd .Wrap (_edb ,_ecd ,"\u0072\u0065\u0073\u0065\u0072\u0076\u0065\u0064\u0020\u0062\u0069\u0074\u0073");
};_fcg ,_edb :=_adce .InputStream .ReadBit ();if _edb !=nil {return _fd .Wrap (_edb ,_ecd ,"\u0065x\u0074e\u006e\u0064\u0065\u0064\u0020t\u0065\u006dp\u006c\u0061\u0074\u0065\u0073");};if _fcg ==1{_adce .GBUseExtTemplate =true ;};_fcg ,_edb =_adce .InputStream .ReadBit ();
if _edb !=nil {return _fd .Wrap (_edb ,_ecd ,"\u0075\u006e\u006b\u006eow\u006e\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u0075\u006d\u0062\u0065\u0072");};if _fcg !=1{_adce .NumberOfPagesUnknown =false ;};_fcg ,_edb =_adce .InputStream .ReadBit ();if _edb !=nil {return _fd .Wrap (_edb ,_ecd ,"\u006f\u0072\u0067\u0061\u006e\u0069\u007a\u0061\u0074\u0069\u006f\u006e \u0074\u0079\u0070\u0065");
};_adce .OrganizationType =_fa .OrganizationType (_fcg );if !_adce .NumberOfPagesUnknown {_adce .NumberOfPages ,_edb =_adce .InputStream .ReadUint32 ();if _edb !=nil {return _fd .Wrap (_edb ,_ecd ,"\u006eu\u006db\u0065\u0072\u0020\u006f\u0066\u0020\u0070\u0061\u0067\u0065\u0073");
};_adce ._ab =13;};return nil ;};func (_ce *Document )completeClassifiedPages ()(_dfd error ){const _dda ="\u0063\u006f\u006dpl\u0065\u0074\u0065\u0043\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064\u0050\u0061\u0067\u0065\u0073";if _ce .Classer ==nil {return nil ;
};_ce ._fe =make ([]int ,_ce .Classer .UndilatedTemplates .Size ());for _cg :=0;_cg < _ce .Classer .ClassIDs .Size ();_cg ++{_agc ,_bb :=_ce .Classer .ClassIDs .Get (_cg );if _bb !=nil {return _fd .Wrapf (_bb ,_dda ,"\u0063\u006c\u0061\u0073s \u0077\u0069\u0074\u0068\u0020\u0069\u0064\u003a\u0020\u0027\u0025\u0064\u0027",_cg );
};_ce ._fe [_agc ]++;};var _ad []int ;for _eg :=0;_eg < _ce .Classer .UndilatedTemplates .Size ();_eg ++{if _ce .NumberOfPages ==1||_ce ._fe [_eg ]> 1{_ad =append (_ad ,_eg );};};var (_db *Page ;_gab bool ;);for _gb ,_bc :=range *_ce .Classer .ComponentPageNumbers {if _db ,_gab =_ce .Pages [_bc ];
!_gab {return _fd .Errorf (_dda ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_gb );};if _db .EncodingMethod ==GenericEM {_e .Log .Error ("\u0047\u0065\u006e\u0065\u0072\u0069c\u0020\u0070\u0061g\u0065\u0020\u0077i\u0074\u0068\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u003a \u0027\u0025\u0064\u0027\u0020ma\u0070\u0070\u0065\u0064\u0020\u0061\u0073\u0020\u0063\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064\u0020\u0070\u0061\u0067\u0065",_gb );
continue ;};_ce ._de [_bc ]=append (_ce ._de [_bc ],_gb );_adb ,_cf :=_ce .Classer .ClassIDs .Get (_gb );if _cf !=nil {return _fd .Wrapf (_cf ,_dda ,"\u006e\u006f\u0020\u0073uc\u0068\u0020\u0063\u006c\u0061\u0073\u0073\u0049\u0044\u003a\u0020\u0025\u0064",_gb );
};if _ce ._fe [_adb ]==1&&_ce .NumberOfPages !=1{_dc :=append (_ce ._af [_bc ],_adb );_ce ._af [_bc ]=_dc ;};};if _dfd =_ce .Classer .ComputeLLCorners ();_dfd !=nil {return _fd .Wrap (_dfd ,_dda ,"");};if _ ,_dfd =_ce .addSymbolDictionary (0,_ce .Classer .UndilatedTemplates ,_ad ,_ce ._bae ,false );
_dfd !=nil {return _fd .Wrap (_dfd ,_dda ,"");};return nil ;};func _dab (_fag int )int {_fcd :=0;_abg :=(_fag &(_fag -1))==0;_fag >>=1;for ;_fag !=0;_fag >>=1{_fcd ++;};if _abg {return _fcd ;};return _fcd +1;};func (_gdg *Page )getWidth ()(int ,error ){const _aae ="\u0067\u0065\u0074\u0057\u0069\u0064\u0074\u0068";
if _gdg .FinalWidth !=0{return _gdg .FinalWidth ,nil ;};_bgg :=_gdg .getPageInformationSegment ();if _bgg ==nil {return 0,_fd .Error (_aae ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");};_egdf ,_baed :=_bgg .GetSegmentData ();
if _baed !=nil {return 0,_fd .Wrap (_baed ,_aae ,"");};_eabb ,_efff :=_egdf .(*_fa .PageInformationSegment );if !_efff {return 0,_fd .Errorf (_aae ,"\u0070\u0061\u0067\u0065\u0020\u0069n\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073 \u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070e\u003a \u0027\u0025\u0054\u0027",_egdf );
};_gdg .FinalWidth =_eabb .PageBMWidth ;return _gdg .FinalWidth ,nil ;};func (_ggd *Page )lastSegmentNumber ()(_gfbeb uint32 ,_gbbc error ){const _fabc ="\u006c\u0061\u0073\u0074\u0053\u0065\u0067\u006d\u0065\u006e\u0074\u004eu\u006d\u0062\u0065\u0072";
if len (_ggd .Segments )==0{return _gfbeb ,_fd .Errorf (_fabc ,"\u006e\u006f\u0020se\u0067\u006d\u0065\u006e\u0074\u0073\u0020\u0066\u006fu\u006ed\u0020i\u006e \u0074\u0068\u0065\u0020\u0070\u0061\u0067\u0065\u0020\u0027\u0025\u0064\u0027",_ggd .PageNumber );
};return _ggd .Segments [len (_ggd .Segments )-1].SegmentNumber ,nil ;};func InitEncodeDocument (fullHeaders bool )*Document {return &Document {FullHeaders :fullHeaders ,_b :_a .BufferedMSB (),Pages :map[int ]*Page {},_af :map[int ][]int {},_bae :map[int ]int {},_de :map[int ][]int {}};
};func (_bed *Page )AddGenericRegion (bm *_ge .Bitmap ,xloc ,yloc ,template int ,tp _fa .Type ,duplicateLineRemoval bool )error {const _bee ="P\u0061\u0067\u0065\u002eAd\u0064G\u0065\u006e\u0065\u0072\u0069c\u0052\u0065\u0067\u0069\u006f\u006e";_cfb :=&_fa .GenericRegion {};
if _gabg :=_cfb .InitEncode (bm ,xloc ,yloc ,template ,duplicateLineRemoval );_gabg !=nil {return _fd .Wrap (_gabg ,_bee ,"");};_gcb :=&_fa .Header {Type :_fa .TImmediateGenericRegion ,PageAssociation :_bed .PageNumber ,SegmentData :_cfb };_bed .Segments =append (_bed .Segments ,_gcb );
return nil ;};func (_fgee *Page )getHeight ()(int ,error ){const _cfec ="\u0067e\u0074\u0048\u0065\u0069\u0067\u0068t";if _fgee .FinalHeight !=0{return _fgee .FinalHeight ,nil ;};_dac :=_fgee .getPageInformationSegment ();if _dac ==nil {return 0,_fd .Error (_cfec ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");
};_gaf ,_bfef :=_dac .GetSegmentData ();if _bfef !=nil {return 0,_fd .Wrap (_bfef ,_cfec ,"");};_def ,_cbbf :=_gaf .(*_fa .PageInformationSegment );if !_cbbf {return 0,_fd .Errorf (_cfec ,"\u0070\u0061\u0067\u0065\u0020\u0069n\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073 \u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070e\u003a \u0027\u0025\u0054\u0027",_gaf );
};if _def .PageBMHeight ==_dg .MaxInt32 {_ ,_bfef =_fgee .GetBitmap ();if _bfef !=nil {return 0,_fd .Wrap (_bfef ,_cfec ,"");};}else {_fgee .FinalHeight =_def .PageBMHeight ;};return _fgee .FinalHeight ,nil ;};func (_beg *Globals )GetSegmentByIndex (index int )(*_fa .Header ,error ){const _dca ="\u0047l\u006f\u0062\u0061\u006cs\u002e\u0047\u0065\u0074\u0053e\u0067m\u0065n\u0074\u0042\u0079\u0049\u006e\u0064\u0065x";
if _beg ==nil {return nil ,_fd .Error (_dca ,"\u0067\u006c\u006f\u0062al\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if len (_beg .Segments )==0{return nil ,_fd .Error (_dca ,"\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u0020\u0061\u0072\u0065\u0020e\u006d\u0070\u0074\u0079");
};if index > len (_beg .Segments )-1{return nil ,_fd .Error (_dca ,"\u0069n\u0064e\u0078\u0020\u006f\u0075\u0074 \u006f\u0066 \u0072\u0061\u006e\u0067\u0065");};return _beg .Segments [index ],nil ;};func (_bfc *Document )encodeSegment (_ea *_fa .Header ,_cac *int )error {const _fgg ="\u0065\u006e\u0063\u006f\u0064\u0065\u0053\u0065\u0067\u006d\u0065\u006e\u0074";
_ea .SegmentNumber =_bfc .nextSegmentNumber ();_gaa ,_fb :=_ea .Encode (_bfc ._b );if _fb !=nil {return _fd .Wrapf (_fb ,_fgg ,"\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u003a\u0020\u0027\u0025\u0064\u0027",_ea .SegmentNumber );};*_cac +=_gaa ;return nil ;
};func (_ade *Page )createStripedPage (_fadg *_fa .PageInformationSegment )error {const _ddaa ="\u0063\u0072\u0065\u0061\u0074\u0065\u0053\u0074\u0072\u0069\u0070\u0065d\u0050\u0061\u0067\u0065";_ddg ,_aada :=_ade .collectPageStripes ();if _aada !=nil {return _fd .Wrap (_aada ,_ddaa ,"");
};var _fadb int ;for _ ,_gcd :=range _ddg {if _dfg ,_eeg :=_gcd .(*_fa .EndOfStripe );_eeg {_fadb =_dfg .LineNumber ()+1;}else {_eaa :=_gcd .(_fa .Regioner );_gbe :=_eaa .GetRegionInfo ();_fdbf :=_ade .getCombinationOperator (_fadg ,_gbe .CombinaionOperator );
_bdb ,_bfcb :=_eaa .GetRegionBitmap ();if _bfcb !=nil {return _fd .Wrap (_bfcb ,_ddaa ,"");};_bfcb =_ge .Blit (_bdb ,_ade .Bitmap ,int (_gbe .XLocation ),_fadb ,_fdbf );if _bfcb !=nil {return _fd .Wrap (_bfcb ,_ddaa ,"");};};};return nil ;};func _gfdg (_caca *Document ,_ggb int )*Page {return &Page {Document :_caca ,PageNumber :_ggb ,Segments :[]*_fa .Header {}};
};func (_ecaf *Page )AddPageInformationSegment (){_baacb :=&_fa .PageInformationSegment {PageBMWidth :_ecaf .FinalWidth ,PageBMHeight :_ecaf .FinalHeight ,ResolutionX :_ecaf .ResolutionX ,ResolutionY :_ecaf .ResolutionY ,IsLossless :_ecaf .IsLossless };
if _ecaf .BlackIsOne {_baacb .DefaultPixelValue =uint8 (0x1);};_fec :=&_fa .Header {PageAssociation :_ecaf .PageNumber ,SegmentDataLength :uint64 (_baacb .Size ()),SegmentData :_baacb ,Type :_fa .TPageInformation };_ecaf .Segments =append (_ecaf .Segments ,_fec );
};func (_bce *Page )countRegions ()int {var _fae int ;for _ ,_cadf :=range _bce .Segments {switch _cadf .Type {case 6,7,22,23,38,39,42,43:_fae ++;};};return _fae ;};func (_ggeb *Page )addTextRegionSegment (_cde []*_fa .Header ,_ggf ,_aee map[int ]int ,_gece []int ,_eba *_ge .Points ,_fge *_ge .Bitmaps ,_efd *_ffc .IntSlice ,_cdf *_ge .Boxes ,_bbe ,_fce int ){_bedd :=&_fa .TextRegion {NumberOfSymbols :uint32 (_fce )};
_bedd .InitEncode (_ggf ,_aee ,_gece ,_eba ,_fge ,_efd ,_cdf ,_ggeb .FinalWidth ,_ggeb .FinalHeight ,_bbe );_cgd :=&_fa .Header {RTSegments :_cde ,SegmentData :_bedd ,PageAssociation :_ggeb .PageNumber ,Type :_fa .TImmediateTextRegion };_ccd :=_fa .TPageInformation ;
if _aee !=nil {_ccd =_fa .TSymbolDictionary ;};var _fcag int ;for ;_fcag < len (_ggeb .Segments );_fcag ++{if _ggeb .Segments [_fcag ].Type ==_ccd {_fcag ++;break ;};};_ggeb .Segments =append (_ggeb .Segments ,nil );copy (_ggeb .Segments [_fcag +1:],_ggeb .Segments [_fcag :]);
_ggeb .Segments [_fcag ]=_cgd ;};func (_fg *Document )produceClassifiedPages ()(_be error ){const _ee ="\u0070\u0072\u006f\u0064uc\u0065\u0043\u006c\u0061\u0073\u0073\u0069\u0066\u0069\u0065\u0064\u0050\u0061\u0067e\u0073";if _fg .Classer ==nil {return nil ;
};var (_abe *Page ;_gbb bool ;_eeb *_fa .Header ;);for _cfg :=1;_cfg <=int (_fg .NumberOfPages );_cfg ++{if _abe ,_gbb =_fg .Pages [_cfg ];!_gbb {return _fd .Errorf (_ee ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_cfg );
};if _abe .EncodingMethod ==GenericEM {continue ;};if _eeb ==nil {if _eeb ,_be =_fg .GlobalSegments .GetSymbolDictionary ();_be !=nil {return _fd .Wrap (_be ,_ee ,"");};};if _be =_fg .produceClassifiedPage (_abe ,_eeb );_be !=nil {return _fd .Wrapf (_be ,_ee ,"\u0070\u0061\u0067\u0065\u003a\u0020\u0027\u0025\u0064\u0027",_cfg );
};};return nil ;};func (_dgb *Document )isFileHeaderPresent ()(bool ,error ){_dgb .InputStream .Mark ();for _ ,_gff :=range _fc {_cbb ,_acf :=_dgb .InputStream .ReadByte ();if _acf !=nil {return false ,_acf ;};if _gff !=_cbb {_dgb .InputStream .Reset ();
return false ,nil ;};};_dgb .InputStream .Reset ();return true ,nil ;};func (_cfgb *Document )GetPage (pageNumber int )(_fa .Pager ,error ){const _fcc ="\u0044\u006fc\u0075\u006d\u0065n\u0074\u002e\u0047\u0065\u0074\u0050\u0061\u0067\u0065";if pageNumber < 0{_e .Log .Debug ("\u004a\u0042\u0049\u00472\u0020\u0050\u0061\u0067\u0065\u0020\u002d\u0020\u0047e\u0074\u0050\u0061\u0067\u0065\u003a\u0020\u0025\u0064\u002e\u0020\u0050\u0061\u0067\u0065\u0020\u0063\u0061n\u006e\u006f\u0074\u0020\u0062e\u0020\u006c\u006f\u0077\u0065\u0072\u0020\u0074\u0068\u0061\u006e\u0020\u0030\u002e\u0020\u0025\u0073",pageNumber ,_c .Stack ());
return nil ,_fd .Errorf (_fcc ,"\u0069\u006e\u0076\u0061l\u0069\u0064\u0020\u006a\u0062\u0069\u0067\u0032\u0020d\u006f\u0063\u0075\u006d\u0065\u006e\u0074\u0020\u002d\u0020\u0070\u0072\u006f\u0076\u0069\u0064\u0065\u0064 \u0069\u006e\u0076\u0061\u006ci\u0064\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u003a\u0020\u0025\u0064",pageNumber );
};if pageNumber > len (_cfgb .Pages ){_e .Log .Debug ("\u0050\u0061\u0067\u0065 n\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u003a\u0020\u0025\u0064\u002e\u0020%\u0073",pageNumber ,_c .Stack ());return nil ,_fd .Error (_fcc ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006a\u0062\u0069\u0067\u0032 \u0064\u006f\u0063\u0075\u006d\u0065n\u0074\u0020\u002d\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064");
};_ed ,_dge :=_cfgb .Pages [pageNumber ];if !_dge {_e .Log .Debug ("\u0050\u0061\u0067\u0065 n\u006f\u0074\u0020\u0066\u006f\u0075\u006e\u0064\u003a\u0020\u0025\u0064\u002e\u0020%\u0073",pageNumber ,_c .Stack ());return nil ,_fd .Errorf (_fcc ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006a\u0062\u0069\u0067\u0032 \u0064\u006f\u0063\u0075\u006d\u0065n\u0074\u0020\u002d\u0020\u0070\u0061\u0067\u0065\u0020\u006e\u006f\u0074\u0020f\u006f\u0075\u006e\u0064");
};return _ed ,nil ;};func (_baa *Document )addSymbolDictionary (_gbbd int ,_gc *_ge .Bitmaps ,_fgc []int ,_fda map[int ]int ,_adc bool )(*_fa .Header ,error ){const _ca ="\u0061\u0064\u0064\u0053ym\u0062\u006f\u006c\u0044\u0069\u0063\u0074\u0069\u006f\u006e\u0061\u0072\u0079";
_ddf :=&_fa .SymbolDictionary {};if _fdb :=_ddf .InitEncode (_gc ,_fgc ,_fda ,_adc );_fdb !=nil {return nil ,_fdb ;};_cb :=&_fa .Header {Type :_fa .TSymbolDictionary ,PageAssociation :_gbbd ,SegmentData :_ddf };if _gbbd ==0{if _baa .GlobalSegments ==nil {_baa .GlobalSegments =&Globals {};
};_baa .GlobalSegments .AddSegment (_cb );return _cb ,nil ;};_gec ,_dad :=_baa .Pages [_gbbd ];if !_dad {return nil ,_fd .Errorf (_ca ,"p\u0061g\u0065\u003a\u0020\u0027\u0025\u0064\u0027\u0020n\u006f\u0074\u0020\u0066ou\u006e\u0064",_gbbd );};var (_ece int ;
_eed *_fa .Header ;);for _ece ,_eed =range _gec .Segments {if _eed .Type ==_fa .TPageInformation {break ;};};_ece ++;_gec .Segments =append (_gec .Segments ,nil );copy (_gec .Segments [_ece +1:],_gec .Segments [_ece :]);_gec .Segments [_ece ]=_cb ;return _cb ,nil ;
};func (_cbg *Page )getResolutionX ()(int ,error ){const _cgf ="\u0067\u0065\u0074\u0052\u0065\u0073\u006f\u006c\u0075t\u0069\u006f\u006e\u0058";if _cbg .ResolutionX !=0{return _cbg .ResolutionX ,nil ;};_cdgf :=_cbg .getPageInformationSegment ();if _cdgf ==nil {return 0,_fd .Error (_cgf ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");
};_agf ,_gce :=_cdgf .GetSegmentData ();if _gce !=nil {return 0,_fd .Wrap (_gce ,_cgf ,"");};_fcdc ,_effd :=_agf .(*_fa .PageInformationSegment );if !_effd {return 0,_fd .Errorf (_cgf ,"\u0070\u0061\u0067\u0065\u0020\u0069n\u0066\u006f\u0072\u006d\u0061\u0074\u0069\u006f\u006e\u0020\u0073\u0065\u0067\u006d\u0065\u006e\u0074\u0020\u0069\u0073 \u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0074\u0079\u0070e\u003a \u0027\u0025\u0054\u0027",_agf );
};_cbg .ResolutionX =_fcdc .ResolutionX ;return _cbg .ResolutionX ,nil ;};func (_dbg *Page )GetResolutionY ()(int ,error ){return _dbg .getResolutionY ()};func (_eadf *Page )GetWidth ()(int ,error ){return _eadf .getWidth ()};func (_dgf *Page )GetResolutionX ()(int ,error ){return _dgf .getResolutionX ()};
func (_afb *Page )getResolutionY ()(int ,error ){const _egda ="\u0067\u0065\u0074\u0052\u0065\u0073\u006f\u006c\u0075t\u0069\u006f\u006e\u0059";if _afb .ResolutionY !=0{return _afb .ResolutionY ,nil ;};_gfe :=_afb .getPageInformationSegment ();if _gfe ==nil {return 0,_fd .Error (_egda ,"n\u0069l\u0020\u0070\u0061\u0067\u0065\u0020\u0069\u006ef\u006f\u0072\u006d\u0061ti\u006f\u006e");
};_cec ,_egdaf :=_gfe .GetSegmentData ();if _egdaf !=nil {return 0,_fd .Wrap (_egdaf ,_egda ,"");};_cacd ,_gcbd :=_cec .(*_fa .PageInformationSegment );if !_gcbd {return 0,_fd .Errorf (_egda ,"\u0070\u0061\u0067\u0065\u0020\u0069\u006e\u0066o\u0072\u006d\u0061ti\u006f\u006e\u0020\u0073\u0065\u0067m\u0065\u006e\u0074\u0020\u0069\u0073\u0020\u006f\u0066\u0020\u0069\u006e\u0076\u0061\u006ci\u0064\u0020\u0074\u0079\u0070\u0065\u003a\u0027%\u0054\u0027",_cec );
};_afb .ResolutionY =_cacd .ResolutionY ;return _afb .ResolutionY ,nil ;};func (_ec *Document )AddGenericPage (bm *_ge .Bitmap ,duplicateLineRemoval bool )(_ga error ){const _da ="\u0044\u006f\u0063um\u0065\u006e\u0074\u002e\u0041\u0064\u0064\u0047\u0065\u006e\u0065\u0072\u0069\u0063\u0050\u0061\u0067\u0065";
if !_ec .FullHeaders &&_ec .NumberOfPages !=0{return _fd .Error (_da ,"\u0064\u006f\u0063\u0075\u006de\u006e\u0074\u0020\u0061\u006c\u0072\u0065a\u0064\u0079\u0020\u0063\u006f\u006e\u0074\u0061\u0069\u006e\u0073\u0020\u0070\u0061\u0067\u0065\u002e\u0020\u0046\u0069\u006c\u0065\u004d\u006f\u0064\u0065\u0020\u0064\u0069\u0073\u0061\u006c\u006c\u006f\u0077\u0073\u0020\u0061\u0064\u0064i\u006e\u0067\u0020\u006d\u006f\u0072\u0065\u0020\u0074\u0068\u0061\u006e \u006f\u006e\u0065\u0020\u0070\u0061g\u0065");
};_bac :=&Page {Segments :[]*_fa .Header {},Bitmap :bm ,Document :_ec ,FinalHeight :bm .Height ,FinalWidth :bm .Width ,IsLossless :true ,BlackIsOne :bm .Color ==_ge .Chocolate };_bac .PageNumber =int (_ec .nextPageNumber ());_ec .Pages [_bac .PageNumber ]=_bac ;
bm .InverseData ();_bac .AddPageInformationSegment ();if _ga =_bac .AddGenericRegion (bm ,0,0,0,_fa .TImmediateGenericRegion ,duplicateLineRemoval );_ga !=nil {return _fd .Wrap (_ga ,_da ,"");};if _ec .FullHeaders {_bac .AddEndOfPageSegment ();};return nil ;
};var _fc =[]byte {0x97,0x4A,0x42,0x32,0x0D,0x0A,0x1A,0x0A};func (_ebe *Globals )AddSegment (segment *_fa .Header ){_ebe .Segments =append (_ebe .Segments ,segment )};func (_egd *Document )GetGlobalSegment (i int )(*_fa .Header ,error ){_cbe ,_fab :=_egd .GlobalSegments .GetSegment (i );
if _fab !=nil {return nil ,_fd .Wrap (_fab ,"\u0047\u0065t\u0047\u006c\u006fb\u0061\u006c\u0053\u0065\u0067\u006d\u0065\u006e\u0074","");};return _cbe ,nil ;};func (_dde *Page )collectPageStripes ()(_gcde []_fa .Segmenter ,_gba error ){const _gagb ="\u0063o\u006cl\u0065\u0063\u0074\u0050\u0061g\u0065\u0053t\u0072\u0069\u0070\u0065\u0073";
var _agcd _fa .Segmenter ;for _ ,_fgd :=range _dde .Segments {switch _fgd .Type {case 6,7,22,23,38,39,42,43:_agcd ,_gba =_fgd .GetSegmentData ();if _gba !=nil {return nil ,_fd .Wrap (_gba ,_gagb ,"");};_gcde =append (_gcde ,_agcd );case 50:_agcd ,_gba =_fgd .GetSegmentData ();
if _gba !=nil {return nil ,_gba ;};_eac ,_aeed :=_agcd .(*_fa .EndOfStripe );if !_aeed {return nil ,_fd .Errorf (_gagb ,"\u0045\u006e\u0064\u004f\u0066\u0053\u0074\u0072\u0069\u0070\u0065\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u006f\u0066\u0020\u0076\u0061l\u0069\u0064\u0020\u0074\u0079p\u0065\u003a \u0027\u0025\u0054\u0027",_agcd );
};_gcde =append (_gcde ,_eac );_dde .FinalHeight =_eac .LineNumber ();};};return _gcde ,nil ;};func DecodeDocument (input *_a .Reader ,globals *Globals )(*Document ,error ){return _ccec (input ,globals );};