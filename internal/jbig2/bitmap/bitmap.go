//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package bitmap ;import (_bg "encoding/binary";_f "github.com/stretchr/testify/require";_gc "github.com/unidoc/unipdf/v4/common";_ga "github.com/unidoc/unipdf/v4/internal/bitwise";_bf "github.com/unidoc/unipdf/v4/internal/imageutil";_be "github.com/unidoc/unipdf/v4/internal/jbig2/basic";
_bc "github.com/unidoc/unipdf/v4/internal/jbig2/errors";_ag "image";_c "math";_a "sort";_g "strings";_d "testing";);func Blit (src *Bitmap ,dst *Bitmap ,x ,y int ,op CombinationOperator )error {var _dfe ,_ccge int ;_abgb :=src .RowStride -1;if x < 0{_ccge =-x ;
x =0;}else if x +src .Width > dst .Width {_abgb -=src .Width +x -dst .Width ;};if y < 0{_dfe =-y ;y =0;_ccge +=src .RowStride ;_abgb +=src .RowStride ;}else if y +src .Height > dst .Height {_dfe =src .Height +y -dst .Height ;};var (_ccdc int ;_cbda error ;
);_eae :=x &0x07;_agfa :=8-_eae ;_bgga :=src .Width &0x07;_agb :=_agfa -_bgga ;_ccb :=_agfa &0x07!=0;_gaf :=src .Width <=((_abgb -_ccge )<<3)+_agfa ;_gacf :=dst .GetByteIndex (x ,y );_ebgf :=_dfe +dst .Height ;if src .Height > _ebgf {_ccdc =_ebgf ;}else {_ccdc =src .Height ;
};switch {case !_ccb :_cbda =_cdb (src ,dst ,_dfe ,_ccdc ,_gacf ,_ccge ,_abgb ,op );case _gaf :_cbda =_daaf (src ,dst ,_dfe ,_ccdc ,_gacf ,_ccge ,_abgb ,_agb ,_eae ,_agfa ,op );default:_cbda =_cebf (src ,dst ,_dfe ,_ccdc ,_gacf ,_ccge ,_abgb ,_agb ,_eae ,_agfa ,op ,_bgga );
};return _cbda ;};func _dddcd ()[]int {_abeg :=make ([]int ,256);for _ebcb :=0;_ebcb <=0xff;_ebcb ++{_dcad :=byte (_ebcb );_abeg [_dcad ]=int (_dcad &0x1)+(int (_dcad >>1)&0x1)+(int (_dcad >>2)&0x1)+(int (_dcad >>3)&0x1)+(int (_dcad >>4)&0x1)+(int (_dcad >>5)&0x1)+(int (_dcad >>6)&0x1)+(int (_dcad >>7)&0x1);
};return _abeg ;};func _bag (_aaag ,_fga *Bitmap ,_ int ,_adg []byte ,_abg int )(_fca error ){const _egaa ="\u0072\u0065\u0064uc\u0065\u0052\u0061\u006e\u006b\u0042\u0069\u006e\u0061\u0072\u0079\u0032\u004c\u0065\u0076\u0065\u006c\u0032";var (_dda ,_ccc ,_ddc ,_acdc ,_eab ,_ffg ,_bfc ,_ed int ;
_gbd ,_ddb ,_ebec ,_baaa uint32 ;_cgd ,_aabg byte ;_eef uint16 ;);_bbcd :=make ([]byte ,4);_cfd :=make ([]byte ,4);for _ddc =0;_ddc < _aaag .Height -1;_ddc ,_acdc =_ddc +2,_acdc +1{_dda =_ddc *_aaag .RowStride ;_ccc =_acdc *_fga .RowStride ;for _eab ,_ffg =0,0;
_eab < _abg ;_eab ,_ffg =_eab +4,_ffg +1{for _bfc =0;_bfc < 4;_bfc ++{_ed =_dda +_eab +_bfc ;if _ed <=len (_aaag .Data )-1&&_ed < _dda +_aaag .RowStride {_bbcd [_bfc ]=_aaag .Data [_ed ];}else {_bbcd [_bfc ]=0x00;};_ed =_dda +_aaag .RowStride +_eab +_bfc ;
if _ed <=len (_aaag .Data )-1&&_ed < _dda +(2*_aaag .RowStride ){_cfd [_bfc ]=_aaag .Data [_ed ];}else {_cfd [_bfc ]=0x00;};};_gbd =_bg .BigEndian .Uint32 (_bbcd );_ddb =_bg .BigEndian .Uint32 (_cfd );_ebec =_gbd &_ddb ;_ebec |=_ebec <<1;_baaa =_gbd |_ddb ;
_baaa &=_baaa <<1;_ddb =_ebec |_baaa ;_ddb &=0xaaaaaaaa;_gbd =_ddb |(_ddb <<7);_cgd =byte (_gbd >>24);_aabg =byte ((_gbd >>8)&0xff);_ed =_ccc +_ffg ;if _ed +1==len (_fga .Data )-1||_ed +1>=_ccc +_fga .RowStride {if _fca =_fga .SetByte (_ed ,_adg [_cgd ]);
_fca !=nil {return _bc .Wrapf (_fca ,_egaa ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0025d",_ed );};}else {_eef =(uint16 (_adg [_cgd ])<<8)|uint16 (_adg [_aabg ]);if _fca =_fga .setTwoBytes (_ed ,_eef );_fca !=nil {return _bc .Wrapf (_fca ,_egaa ,"s\u0065\u0074\u0074\u0069\u006e\u0067 \u0074\u0077\u006f\u0020\u0062\u0079t\u0065\u0073\u0020\u0066\u0061\u0069\u006ce\u0064\u002c\u0020\u0069\u006e\u0064\u0065\u0078\u003a\u0020%\u0064",_ed );
};_ffg ++;};};};return nil ;};func (_cca *Bitmap )Equals (s *Bitmap )bool {if len (_cca .Data )!=len (s .Data )||_cca .Width !=s .Width ||_cca .Height !=s .Height {return false ;};for _efgf :=0;_efgf < _cca .Height ;_efgf ++{_ggfa :=_efgf *_cca .RowStride ;
for _dfc :=0;_dfc < _cca .RowStride ;_dfc ++{if _cca .Data [_ggfa +_dfc ]!=s .Data [_ggfa +_dfc ]{return false ;};};};return true ;};func (_aaf *Bitmap )Zero ()bool {_bdc :=_aaf .Width /8;_eafg :=_aaf .Width &7;var _cce byte ;if _eafg !=0{_cce =byte (0xff<<uint (8-_eafg ));
};var _fegd ,_eafb ,_aba int ;for _eafb =0;_eafb < _aaf .Height ;_eafb ++{_fegd =_aaf .RowStride *_eafb ;for _aba =0;_aba < _bdc ;_aba ,_fegd =_aba +1,_fegd +1{if _aaf .Data [_fegd ]!=0{return false ;};};if _eafg > 0{if _aaf .Data [_fegd ]&_cce !=0{return false ;
};};};return true ;};func (_aaadg *Bitmaps )SelectByIndexes (idx []int )(*Bitmaps ,error ){const _gffed ="B\u0069\u0074\u006d\u0061\u0070\u0073.\u0053\u006f\u0072\u0074\u0049\u006e\u0064\u0065\u0078e\u0073\u0042\u0079H\u0065i\u0067\u0068\u0074";_aacb ,_gdfe :=_aaadg .selectByIndexes (idx );
if _gdfe !=nil {return nil ,_bc .Wrap (_gdfe ,_gffed ,"");};return _aacb ,nil ;};func (_egc *Bitmap )setPadBits (_bdbb int ){_feca :=8-_egc .Width %8;if _feca ==8{return ;};_cec :=_egc .Width /8;_eegf :=_fag [_feca ];if _bdbb ==0{_eegf ^=_eegf ;};var _dbd int ;
for _fgfa :=0;_fgfa < _egc .Height ;_fgfa ++{_dbd =_fgfa *_egc .RowStride +_cec ;if _bdbb ==0{_egc .Data [_dbd ]&=_eegf ;}else {_egc .Data [_dbd ]|=_eegf ;};};};func _ba (_bbf *Bitmap ,_cgga int )(*Bitmap ,error ){const _aa ="\u0065x\u0070a\u006e\u0064\u0042\u0069\u006ea\u0072\u0079P\u006f\u0077\u0065\u0072\u0032";
if _bbf ==nil {return nil ,_bc .Error (_aa ,"\u0073o\u0075r\u0063\u0065\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");};if _cgga ==1{return _ffdb (nil ,_bbf );};if _cgga !=2&&_cgga !=4&&_cgga !=8{return nil ,_bc .Error (_aa ,"\u0066\u0061\u0063t\u006f\u0072\u0020\u006du\u0073\u0074\u0020\u0062\u0065\u0020\u0069n\u0020\u007b\u0032\u002c\u0034\u002c\u0038\u007d\u0020\u0072\u0061\u006e\u0067\u0065");
};_cf :=_cgga *_bbf .Width ;_ce :=_cgga *_bbf .Height ;_da :=New (_cf ,_ce );var _dbg error ;switch _cgga {case 2:_dbg =_bd (_da ,_bbf );case 4:_dbg =_cc (_da ,_bbf );case 8:_dbg =_adc (_da ,_bbf );};if _dbg !=nil {return nil ,_bc .Wrap (_dbg ,_aa ,"");
};return _da ,nil ;};func (_daac *ClassedPoints )Less (i ,j int )bool {return _daac ._bcbcb (i ,j )};func (_fdc *Bitmap )GetChocolateData ()[]byte {if _fdc .Color ==Vanilla {_fdc .inverseData ();};return _fdc .Data ;};func _ffa (_gbg ,_cffd *Bitmap ,_ int ,_bdf []byte ,_fdea int )(_ebg error ){const _bdfa ="\u0072\u0065\u0064uc\u0065\u0052\u0061\u006e\u006b\u0042\u0069\u006e\u0061\u0072\u0079\u0032\u004c\u0065\u0076\u0065\u006c\u0031";
var (_gfc ,_efg ,_eac ,_eaf ,_ded ,_eee ,_dfg ,_bce int ;_aad ,_gbe uint32 ;_gd ,_baa byte ;_gfd uint16 ;);_bgc :=make ([]byte ,4);_cbeb :=make ([]byte ,4);for _eac =0;_eac < _gbg .Height -1;_eac ,_eaf =_eac +2,_eaf +1{_gfc =_eac *_gbg .RowStride ;_efg =_eaf *_cffd .RowStride ;
for _ded ,_eee =0,0;_ded < _fdea ;_ded ,_eee =_ded +4,_eee +1{for _dfg =0;_dfg < 4;_dfg ++{_bce =_gfc +_ded +_dfg ;if _bce <=len (_gbg .Data )-1&&_bce < _gfc +_gbg .RowStride {_bgc [_dfg ]=_gbg .Data [_bce ];}else {_bgc [_dfg ]=0x00;};_bce =_gfc +_gbg .RowStride +_ded +_dfg ;
if _bce <=len (_gbg .Data )-1&&_bce < _gfc +(2*_gbg .RowStride ){_cbeb [_dfg ]=_gbg .Data [_bce ];}else {_cbeb [_dfg ]=0x00;};};_aad =_bg .BigEndian .Uint32 (_bgc );_gbe =_bg .BigEndian .Uint32 (_cbeb );_gbe |=_aad ;_gbe |=_gbe <<1;_gbe &=0xaaaaaaaa;_aad =_gbe |(_gbe <<7);
_gd =byte (_aad >>24);_baa =byte ((_aad >>8)&0xff);_bce =_efg +_eee ;if _bce +1==len (_cffd .Data )-1||_bce +1>=_efg +_cffd .RowStride {_cffd .Data [_bce ]=_bdf [_gd ];}else {_gfd =(uint16 (_bdf [_gd ])<<8)|uint16 (_bdf [_baa ]);if _ebg =_cffd .setTwoBytes (_bce ,_gfd );
_ebg !=nil {return _bc .Wrapf (_ebg ,_bdfa ,"s\u0065\u0074\u0074\u0069\u006e\u0067 \u0074\u0077\u006f\u0020\u0062\u0079t\u0065\u0073\u0020\u0066\u0061\u0069\u006ce\u0064\u002c\u0020\u0069\u006e\u0064\u0065\u0078\u003a\u0020%\u0064",_bce );};_eee ++;};};
};return nil ;};func _abfa (_eeca ,_ffae byte ,_aacc CombinationOperator )byte {switch _aacc {case CmbOpOr :return _ffae |_eeca ;case CmbOpAnd :return _ffae &_eeca ;case CmbOpXor :return _ffae ^_eeca ;case CmbOpXNor :return ^(_ffae ^_eeca );case CmbOpNot :return ^(_ffae );
default:return _ffae ;};};func (_fggg *byHeight )Len ()int {return len (_fggg .Values )};func (_gebb *Bitmap )RemoveBorder (borderSize int )(*Bitmap ,error ){if borderSize ==0{return _gebb .Copy (),nil ;};_efc ,_bfb :=_gebb .removeBorderGeneral (borderSize ,borderSize ,borderSize ,borderSize );
if _bfb !=nil {return nil ,_bc .Wrap (_bfb ,"\u0052\u0065\u006do\u0076\u0065\u0042\u006f\u0072\u0064\u0065\u0072","");};return _efc ,nil ;};func (_aee *Bitmap )SizesEqual (s *Bitmap )bool {if _aee ==s {return true ;};if _aee .Width !=s .Width ||_aee .Height !=s .Height {return false ;
};return true ;};func (_ddab Points )XSorter ()func (_fgae ,_eega int )bool {return func (_cege ,_bccgg int )bool {return _ddab [_cege ].X < _ddab [_bccgg ].X };};func Centroid (bm *Bitmap ,centTab ,sumTab []int )(Point ,error ){return bm .centroid (centTab ,sumTab )};
func init (){for _afb :=0;_afb < 256;_afb ++{_ebgd [_afb ]=uint8 (_afb &0x1)+(uint8 (_afb >>1)&0x1)+(uint8 (_afb >>2)&0x1)+(uint8 (_afb >>3)&0x1)+(uint8 (_afb >>4)&0x1)+(uint8 (_afb >>5)&0x1)+(uint8 (_afb >>6)&0x1)+(uint8 (_afb >>7)&0x1);};};func _daaf (_ddce ,_cfga *Bitmap ,_edgf ,_edgdc ,_fbg ,_edb ,_fcge ,_eddb ,_ggdb ,_eeaf int ,_bedd CombinationOperator )error {var _ebbg int ;
_adcb :=func (){_ebbg ++;_fbg +=_cfga .RowStride ;_edb +=_ddce .RowStride ;_fcge +=_ddce .RowStride };for _ebbg =_edgf ;_ebbg < _edgdc ;_adcb (){var _gbcc uint16 ;_dabb :=_fbg ;for _ebgdf :=_edb ;_ebgdf <=_fcge ;_ebgdf ++{_aff ,_ccff :=_cfga .GetByte (_dabb );
if _ccff !=nil {return _ccff ;};_gfac ,_ccff :=_ddce .GetByte (_ebgdf );if _ccff !=nil {return _ccff ;};_gbcc =(_gbcc |uint16 (_gfac ))<<uint (_eeaf );_gfac =byte (_gbcc >>8);if _ebgdf ==_fcge {_gfac =_edee (uint (_eddb ),_gfac );};if _ccff =_cfga .SetByte (_dabb ,_abfa (_aff ,_gfac ,_bedd ));
_ccff !=nil {return _ccff ;};_dabb ++;_gbcc <<=uint (_ggdb );};};return nil ;};func _eabab (_agdab ,_agfbd *Bitmap ,_bgbb ,_aeddd int )(_afbe error ){const _efff ="\u0073e\u0065d\u0066\u0069\u006c\u006c\u0042i\u006e\u0061r\u0079\u004c\u006f\u0077\u0038";
var (_edcg ,_bege ,_agbe ,_ecbf int ;_gaae ,_dcdc ,_dbgd ,_ecg ,_ddfc ,_acad ,_aefd ,_cbca byte ;);for _edcg =0;_edcg < _bgbb ;_edcg ++{_agbe =_edcg *_agdab .RowStride ;_ecbf =_edcg *_agfbd .RowStride ;for _bege =0;_bege < _aeddd ;_bege ++{if _gaae ,_afbe =_agdab .GetByte (_agbe +_bege );
_afbe !=nil {return _bc .Wrap (_afbe ,_efff ,"\u0067e\u0074 \u0073\u006f\u0075\u0072\u0063\u0065\u0020\u0062\u0079\u0074\u0065");};if _dcdc ,_afbe =_agfbd .GetByte (_ecbf +_bege );_afbe !=nil {return _bc .Wrap (_afbe ,_efff ,"\u0067\u0065\u0074\u0020\u006d\u0061\u0073\u006b\u0020\u0062\u0079\u0074\u0065");
};if _edcg > 0{if _dbgd ,_afbe =_agdab .GetByte (_agbe -_agdab .RowStride +_bege );_afbe !=nil {return _bc .Wrap (_afbe ,_efff ,"\u0069\u0020\u003e\u0020\u0030\u0020\u0062\u0079\u0074\u0065");};_gaae |=_dbgd |(_dbgd <<1)|(_dbgd >>1);if _bege > 0{if _cbca ,_afbe =_agdab .GetByte (_agbe -_agdab .RowStride +_bege -1);
_afbe !=nil {return _bc .Wrap (_afbe ,_efff ,"\u0069\u0020\u003e\u00200 \u0026\u0026\u0020\u006a\u0020\u003e\u0020\u0030\u0020\u0062\u0079\u0074\u0065");};_gaae |=_cbca <<7;};if _bege < _aeddd -1{if _cbca ,_afbe =_agdab .GetByte (_agbe -_agdab .RowStride +_bege +1);
_afbe !=nil {return _bc .Wrap (_afbe ,_efff ,"\u006a\u0020<\u0020\u0077\u0070l\u0020\u002d\u0020\u0031\u0020\u0062\u0079\u0074\u0065");};_gaae |=_cbca >>7;};};if _bege > 0{if _ecg ,_afbe =_agdab .GetByte (_agbe +_bege -1);_afbe !=nil {return _bc .Wrap (_afbe ,_efff ,"\u006a\u0020\u003e \u0030");
};_gaae |=_ecg <<7;};_gaae &=_dcdc ;if _gaae ==0||^_gaae ==0{if _afbe =_agdab .SetByte (_agbe +_bege ,_gaae );_afbe !=nil {return _bc .Wrap (_afbe ,_efff ,"\u0073e\u0074t\u0069\u006e\u0067\u0020\u0065m\u0070\u0074y\u0020\u0062\u0079\u0074\u0065");};};for {_aefd =_gaae ;
_gaae =(_gaae |(_gaae >>1)|(_gaae <<1))&_dcdc ;if (_gaae ^_aefd )==0{if _afbe =_agdab .SetByte (_agbe +_bege ,_gaae );_afbe !=nil {return _bc .Wrap (_afbe ,_efff ,"\u0073\u0065\u0074\u0074\u0069\u006e\u0067\u0020\u0070\u0072\u0065\u0076 \u0062\u0079\u0074\u0065");
};break ;};};};};for _edcg =_bgbb -1;_edcg >=0;_edcg --{_agbe =_edcg *_agdab .RowStride ;_ecbf =_edcg *_agfbd .RowStride ;for _bege =_aeddd -1;_bege >=0;_bege --{if _gaae ,_afbe =_agdab .GetByte (_agbe +_bege );_afbe !=nil {return _bc .Wrap (_afbe ,_efff ,"\u0072\u0065\u0076er\u0073\u0065\u0020\u0067\u0065\u0074\u0020\u0073\u006f\u0075\u0072\u0063\u0065\u0020\u0062\u0079\u0074\u0065");
};if _dcdc ,_afbe =_agfbd .GetByte (_ecbf +_bege );_afbe !=nil {return _bc .Wrap (_afbe ,_efff ,"r\u0065\u0076\u0065\u0072se\u0020g\u0065\u0074\u0020\u006d\u0061s\u006b\u0020\u0062\u0079\u0074\u0065");};if _edcg < _bgbb -1{if _ddfc ,_afbe =_agdab .GetByte (_agbe +_agdab .RowStride +_bege );
_afbe !=nil {return _bc .Wrap (_afbe ,_efff ,"\u0069\u0020\u003c\u0020h\u0020\u002d\u0020\u0031\u0020\u002d\u003e\u0020\u0067\u0065t\u0020s\u006f\u0075\u0072\u0063\u0065\u0020\u0062y\u0074\u0065");};_gaae |=_ddfc |(_ddfc <<1)|_ddfc >>1;if _bege > 0{if _cbca ,_afbe =_agdab .GetByte (_agbe +_agdab .RowStride +_bege -1);
_afbe !=nil {return _bc .Wrap (_afbe ,_efff ,"\u0069\u0020\u003c h\u002d\u0031\u0020\u0026\u0020\u006a\u0020\u003e\u00200\u0020-\u003e \u0067e\u0074\u0020\u0073\u006f\u0075\u0072\u0063\u0065\u0020\u0062\u0079\u0074\u0065");};_gaae |=_cbca <<7;};if _bege < _aeddd -1{if _cbca ,_afbe =_agdab .GetByte (_agbe +_agdab .RowStride +_bege +1);
_afbe !=nil {return _bc .Wrap (_afbe ,_efff ,"\u0069\u0020\u003c\u0020\u0068\u002d\u0031\u0020\u0026\u0026\u0020\u006a\u0020\u003c\u0077\u0070\u006c\u002d\u0031\u0020\u002d\u003e\u0020\u0067e\u0074\u0020\u0073\u006f\u0075r\u0063\u0065 \u0062\u0079\u0074\u0065");
};_gaae |=_cbca >>7;};};if _bege < _aeddd -1{if _acad ,_afbe =_agdab .GetByte (_agbe +_bege +1);_afbe !=nil {return _bc .Wrap (_afbe ,_efff ,"\u006a\u0020<\u0020\u0077\u0070\u006c\u0020\u002d\u0031\u0020\u002d\u003e\u0020\u0067\u0065\u0074\u0020\u0073\u006f\u0075\u0072\u0063\u0065\u0020by\u0074\u0065");
};_gaae |=_acad >>7;};_gaae &=_dcdc ;if _gaae ==0||(^_gaae )==0{if _afbe =_agdab .SetByte (_agbe +_bege ,_gaae );_afbe !=nil {return _bc .Wrap (_afbe ,_efff ,"\u0073e\u0074 \u006d\u0061\u0073\u006b\u0065\u0064\u0020\u0062\u0079\u0074\u0065");};};for {_aefd =_gaae ;
_gaae =(_gaae |(_gaae >>1)|(_gaae <<1))&_dcdc ;if (_gaae ^_aefd )==0{if _afbe =_agdab .SetByte (_agbe +_bege ,_gaae );_afbe !=nil {return _bc .Wrap (_afbe ,_efff ,"r\u0065\u0076\u0065\u0072se\u0020s\u0065\u0074\u0020\u0070\u0072e\u0076\u0020\u0062\u0079\u0074\u0065");
};break ;};};};};return nil ;};func (_dbag *ClassedPoints )ySortFunction ()func (_ddfg int ,_eccf int )bool {return func (_ccba ,_fece int )bool {return _dbag .YAtIndex (_ccba )< _dbag .YAtIndex (_fece )};};func MakePixelSumTab8 ()[]int {return _dddcd ()};
func (_ffc *Bitmap )AddBorder (borderSize ,val int )(*Bitmap ,error ){if borderSize ==0{return _ffc .Copy (),nil ;};_ddfd ,_ddbe :=_ffc .addBorderGeneral (borderSize ,borderSize ,borderSize ,borderSize ,val );if _ddbe !=nil {return nil ,_bc .Wrap (_ddbe ,"\u0041d\u0064\u0042\u006f\u0072\u0064\u0065r","");
};return _ddfd ,nil ;};func TstASymbol (t *_d .T )*Bitmap {t .Helper ();_efead :=New (6,6);_f .NoError (t ,_efead .SetPixel (1,0,1));_f .NoError (t ,_efead .SetPixel (2,0,1));_f .NoError (t ,_efead .SetPixel (3,0,1));_f .NoError (t ,_efead .SetPixel (4,0,1));
_f .NoError (t ,_efead .SetPixel (5,1,1));_f .NoError (t ,_efead .SetPixel (1,2,1));_f .NoError (t ,_efead .SetPixel (2,2,1));_f .NoError (t ,_efead .SetPixel (3,2,1));_f .NoError (t ,_efead .SetPixel (4,2,1));_f .NoError (t ,_efead .SetPixel (5,2,1));
_f .NoError (t ,_efead .SetPixel (0,3,1));_f .NoError (t ,_efead .SetPixel (5,3,1));_f .NoError (t ,_efead .SetPixel (0,4,1));_f .NoError (t ,_efead .SetPixel (5,4,1));_f .NoError (t ,_efead .SetPixel (1,5,1));_f .NoError (t ,_efead .SetPixel (2,5,1));
_f .NoError (t ,_efead .SetPixel (3,5,1));_f .NoError (t ,_efead .SetPixel (4,5,1));_f .NoError (t ,_efead .SetPixel (5,5,1));return _efead ;};func _cecc (_cddc ,_ggcd int )int {if _cddc < _ggcd {return _cddc ;};return _ggcd ;};func (_dcf *Boxes )SelectBySize (width ,height int ,tp LocationFilter ,relation SizeComparison )(_fae *Boxes ,_agca error ){const _bdg ="\u0042o\u0078e\u0073\u002e\u0053\u0065\u006ce\u0063\u0074B\u0079\u0053\u0069\u007a\u0065";
if _dcf ==nil {return nil ,_bc .Error (_bdg ,"b\u006f\u0078\u0065\u0073 '\u0062'\u0020\u006e\u006f\u0074\u0020d\u0065\u0066\u0069\u006e\u0065\u0064");};if len (*_dcf )==0{return _dcf ,nil ;};switch tp {case LocSelectWidth ,LocSelectHeight ,LocSelectIfEither ,LocSelectIfBoth :default:return nil ,_bc .Errorf (_bdg ,"\u0069\u006e\u0076al\u0069\u0064\u0020\u0066\u0069\u006c\u0074\u0065\u0072\u0020\u0074\u0079\u0070\u0065\u003a\u0020\u0025\u0064",tp );
};switch relation {case SizeSelectIfLT ,SizeSelectIfGT ,SizeSelectIfLTE ,SizeSelectIfGTE :default:return nil ,_bc .Errorf (_bdg ,"i\u006e\u0076\u0061\u006c\u0069\u0064 \u0072\u0065\u006c\u0061\u0074\u0069\u006f\u006e\u0020t\u0079\u0070\u0065:\u0020'\u0025\u0064\u0027",tp );
};_efdd :=_dcf .makeSizeIndicator (width ,height ,tp ,relation );_faf ,_agca :=_dcf .selectWithIndicator (_efdd );if _agca !=nil {return nil ,_bc .Wrap (_agca ,_bdg ,"");};return _faf ,nil ;};func (_gcf *Boxes )Add (box *_ag .Rectangle )error {if _gcf ==nil {return _bc .Error ("\u0042o\u0078\u0065\u0073\u002e\u0041\u0064d","\u0027\u0042\u006f\u0078es\u0027\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};*_gcf =append (*_gcf ,box );return nil ;};const (CmbOpOr CombinationOperator =iota ;CmbOpAnd ;CmbOpXor ;CmbOpXNor ;CmbOpReplace ;CmbOpNot ;);func _ababa (_dfdg *_be .Stack ,_gbegg ,_dgba ,_bafbd ,_adbf ,_cacgd int ,_ddgf *_ag .Rectangle )(_eedc error ){const _cdcd ="\u0070\u0075\u0073\u0068\u0046\u0069\u006c\u006c\u0053\u0065\u0067m\u0065\u006e\u0074\u0042\u006f\u0075\u006e\u0064\u0069\u006eg\u0042\u006f\u0078";
if _dfdg ==nil {return _bc .Error (_cdcd ,"\u006ei\u006c \u0073\u0074\u0061\u0063\u006b \u0070\u0072o\u0076\u0069\u0064\u0065\u0064");};if _ddgf ==nil {return _bc .Error (_cdcd ,"\u0070\u0072\u006f\u0076i\u0064\u0065\u0064\u0020\u006e\u0069\u006c\u0020\u0069\u006da\u0067e\u002e\u0052\u0065\u0063\u0074\u0061\u006eg\u006c\u0065");
};_ddgf .Min .X =_be .Min (_ddgf .Min .X ,_gbegg );_ddgf .Max .X =_be .Max (_ddgf .Max .X ,_dgba );_ddgf .Min .Y =_be .Min (_ddgf .Min .Y ,_bafbd );_ddgf .Max .Y =_be .Max (_ddgf .Max .Y ,_bafbd );if _bafbd +_adbf < 0||_bafbd +_adbf > _cacgd {return nil ;
};if _dfdg .Aux ==nil {return _bc .Error (_cdcd ,"a\u0075x\u0053\u0074\u0061\u0063\u006b\u0020\u006e\u006ft\u0020\u0064\u0065\u0066in\u0065\u0064");};var _fffg *fillSegment ;_bbdb ,_bcfcc :=_dfdg .Aux .Pop ();if _bcfcc {if _fffg ,_bcfcc =_bbdb .(*fillSegment );
!_bcfcc {return _bc .Error (_cdcd ,"a\u0075\u0078\u0053\u0074\u0061\u0063k\u0020\u0064\u0061\u0074\u0061\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0061 \u002a\u0066\u0069\u006c\u006c\u0053\u0065\u0067\u006d\u0065n\u0074");};}else {_fffg =&fillSegment {};
};_fffg ._ccce =_gbegg ;_fffg ._dbdb =_dgba ;_fffg ._cfge =_bafbd ;_fffg ._dbdg =_adbf ;_dfdg .Push (_fffg );return nil ;};func (_efd *Bitmap )setEightBytes (_abaf int ,_eebg uint64 )error {_bcb :=_efd .RowStride -(_abaf %_efd .RowStride );if _efd .RowStride !=_efd .Width >>3{_bcb --;
};if _bcb >=8{return _efd .setEightFullBytes (_abaf ,_eebg );};return _efd .setEightPartlyBytes (_abaf ,_bcb ,_eebg );};func _afa (_fbdg int )int {if _fbdg < 0{return -_fbdg ;};return _fbdg ;};func _bdfed (_gdee ,_agde ,_cggad byte )byte {return (_gdee &^(_cggad ))|(_agde &_cggad )};
func (_eegfb *Bitmaps )HeightSorter ()func (_gcfe ,_ceeda int )bool {return func (_fcgg ,_abff int )bool {_becg :=_eegfb .Values [_fcgg ].Height < _eegfb .Values [_abff ].Height ;_gc .Log .Debug ("H\u0065i\u0067\u0068\u0074\u003a\u0020\u0025\u0076\u0020<\u0020\u0025\u0076\u0020= \u0025\u0076",_eegfb .Values [_fcgg ].Height ,_eegfb .Values [_abff ].Height ,_becg );
return _becg ;};};func (_ggdf *Bitmap )connComponentsBitmapsBB (_ecbd *Bitmaps ,_adfe int )(_bdcgc *Boxes ,_agec error ){const _gaag ="\u0063\u006f\u006enC\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074\u0073\u0042\u0069\u0074\u006d\u0061\u0070\u0073\u0042\u0042";
if _adfe !=4&&_adfe !=8{return nil ,_bc .Error (_gaag ,"\u0063\u006f\u006e\u006e\u0065\u0063t\u0069\u0076\u0069\u0074\u0079\u0020\u006d\u0075\u0073\u0074\u0020\u0062\u0065 \u0061\u0020\u0027\u0034\u0027\u0020\u006fr\u0020\u0027\u0038\u0027");};if _ecbd ==nil {return nil ,_bc .Error (_gaag ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0042\u0069\u0074ma\u0070\u0073");
};if len (_ecbd .Values )> 0{return nil ,_bc .Error (_gaag ,"\u0070\u0072\u006f\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u006fn\u002d\u0065\u006d\u0070\u0074\u0079\u0020\u0042\u0069\u0074m\u0061\u0070\u0073");};if _ggdf .Zero (){return &Boxes {},nil ;
};var (_gcdb ,_fcfb ,_gfggb ,_fgeb *Bitmap ;);_ggdf .setPadBits (0);if _gcdb ,_agec =_ffdb (nil ,_ggdf );_agec !=nil {return nil ,_bc .Wrap (_agec ,_gaag ,"\u0062\u006d\u0031");};if _fcfb ,_agec =_ffdb (nil ,_ggdf );_agec !=nil {return nil ,_bc .Wrap (_agec ,_gaag ,"\u0062\u006d\u0032");
};_edggd :=&_be .Stack {};_edggd .Aux =&_be .Stack {};_bdcgc =&Boxes {};var (_aaae ,_aadcf int ;_bebg _ag .Point ;_bfed bool ;_afae *_ag .Rectangle ;);for {if _bebg ,_bfed ,_agec =_gcdb .nextOnPixel (_aaae ,_aadcf );_agec !=nil {return nil ,_bc .Wrap (_agec ,_gaag ,"");
};if !_bfed {break ;};if _afae ,_agec =_ebde (_gcdb ,_edggd ,_bebg .X ,_bebg .Y ,_adfe );_agec !=nil {return nil ,_bc .Wrap (_agec ,_gaag ,"");};if _agec =_bdcgc .Add (_afae );_agec !=nil {return nil ,_bc .Wrap (_agec ,_gaag ,"");};if _gfggb ,_agec =_gcdb .clipRectangle (_afae ,nil );
_agec !=nil {return nil ,_bc .Wrap (_agec ,_gaag ,"\u0062\u006d\u0033");};if _fgeb ,_agec =_fcfb .clipRectangle (_afae ,nil );_agec !=nil {return nil ,_bc .Wrap (_agec ,_gaag ,"\u0062\u006d\u0034");};if _ ,_agec =_cgcd (_gfggb ,_gfggb ,_fgeb );_agec !=nil {return nil ,_bc .Wrap (_agec ,_gaag ,"\u0062m\u0033\u0020\u005e\u0020\u0062\u006d4");
};if _agec =_fcfb .RasterOperation (_afae .Min .X ,_afae .Min .Y ,_afae .Dx (),_afae .Dy (),PixSrcXorDst ,_gfggb ,0,0);_agec !=nil {return nil ,_bc .Wrap (_agec ,_gaag ,"\u0062\u006d\u0032\u0020\u002d\u0058\u004f\u0052\u002d>\u0020\u0062\u006d\u0033");
};_ecbd .AddBitmap (_gfggb );_aaae =_bebg .X ;_aadcf =_bebg .Y ;};_ecbd .Boxes =*_bdcgc ;return _bdcgc ,nil ;};func (_ebeca *Bitmap )GetUnpaddedData ()([]byte ,error ){_gebc :=uint (_ebeca .Width &0x07);if _gebc ==0{return _ebeca .Data ,nil ;};_fggf :=_ebeca .Width *_ebeca .Height ;
if _fggf %8!=0{_fggf >>=3;_fggf ++;}else {_fggf >>=3;};_gad :=make ([]byte ,_fggf );_bed :=_ga .NewWriterMSB (_gad );const _fgaf ="\u0047e\u0074U\u006e\u0070\u0061\u0064\u0064\u0065\u0064\u0044\u0061\u0074\u0061";for _dbba :=0;_dbba < _ebeca .Height ;_dbba ++{for _caa :=0;
_caa < _ebeca .RowStride ;_caa ++{_cae :=_ebeca .Data [_dbba *_ebeca .RowStride +_caa ];if _caa !=_ebeca .RowStride -1{_edg :=_bed .WriteByte (_cae );if _edg !=nil {return nil ,_bc .Wrap (_edg ,_fgaf ,"");};continue ;};for _cfc :=uint (0);_cfc < _gebc ;
_cfc ++{_fcc :=_bed .WriteBit (int (_cae >>(7-_cfc )&0x01));if _fcc !=nil {return nil ,_bc .Wrap (_fcc ,_fgaf ,"");};};};};return _gad ,nil ;};func (_aacd *Bitmap )CountPixels ()int {return _aacd .countPixels ()};func (_dfbg *BitmapsArray )GetBox (i int )(*_ag .Rectangle ,error ){const _aaadc ="\u0042\u0069\u0074\u006dap\u0073\u0041\u0072\u0072\u0061\u0079\u002e\u0047\u0065\u0074\u0042\u006f\u0078";
if _dfbg ==nil {return nil ,_bc .Error (_aaadc ,"p\u0072\u006f\u0076\u0069\u0064\u0065d\u0020\u006e\u0069\u006c\u0020\u0027\u0042\u0069\u0074m\u0061\u0070\u0073A\u0072r\u0061\u0079\u0027");};if i > len (_dfbg .Boxes )-1{return nil ,_bc .Errorf (_aaadc ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};return _dfbg .Boxes [i ],nil ;};func MakePixelCentroidTab8 ()[]int {return _cbdab ()};func (_dfed *Bitmaps )String ()string {_gdce :=_g .Builder {};for _ ,_bbgc :=range _dfed .Values {_gdce .WriteString (_bbgc .String ());_gdce .WriteRune ('\n');};return _gdce .String ();
};func _fggc (_aada ,_dgbg *Bitmap ,_gebg ,_gedec int )(*Bitmap ,error ){const _gbec ="\u0065\u0072\u006f\u0064\u0065\u0042\u0072\u0069\u0063\u006b";if _dgbg ==nil {return nil ,_bc .Error (_gbec ,"\u0073o\u0075r\u0063\u0065\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");
};if _gebg < 1||_gedec < 1{return nil ,_bc .Error (_gbec ,"\u0068\u0073\u0069\u007a\u0065\u0020\u0061\u006e\u0064\u0020\u0076\u0073\u0069\u007a\u0065\u0020\u0061\u0072e\u0020\u006e\u006f\u0074\u0020\u0067\u0072e\u0061\u0074\u0065\u0072\u0020\u0074\u0068\u0061\u006e\u0020\u006fr\u0020\u0065\u0071\u0075\u0061\u006c\u0020\u0074\u006f\u0020\u0031");
};if _gebg ==1&&_gedec ==1{_dbdf ,_bggd :=_ffdb (_aada ,_dgbg );if _bggd !=nil {return nil ,_bc .Wrap (_bggd ,_gbec ,"\u0068S\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u0026\u0026 \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");
};return _dbdf ,nil ;};if _gebg ==1||_gedec ==1{_ecfd :=SelCreateBrick (_gedec ,_gebg ,_gedec /2,_gebg /2,SelHit );_fcgd ,_dcgf :=_fddfd (_aada ,_dgbg ,_ecfd );if _dcgf !=nil {return nil ,_bc .Wrap (_dcgf ,_gbec ,"\u0068S\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u007c\u007c \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");
};return _fcgd ,nil ;};_affd :=SelCreateBrick (1,_gebg ,0,_gebg /2,SelHit );_ddbbf :=SelCreateBrick (_gedec ,1,_gedec /2,0,SelHit );_aedd ,_bfefb :=_fddfd (nil ,_dgbg ,_affd );if _bfefb !=nil {return nil ,_bc .Wrap (_bfefb ,_gbec ,"\u0031s\u0074\u0020\u0065\u0072\u006f\u0064e");
};_aada ,_bfefb =_fddfd (_aada ,_aedd ,_ddbbf );if _bfefb !=nil {return nil ,_bc .Wrap (_bfefb ,_gbec ,"\u0032n\u0064\u0020\u0065\u0072\u006f\u0064e");};return _aada ,nil ;};func _cgb (_efbc ,_dde *Bitmap ,_afd int ,_gbee []byte ,_agc int )(_bdd error ){const _febf ="\u0072\u0065\u0064uc\u0065\u0052\u0061\u006e\u006b\u0042\u0069\u006e\u0061\u0072\u0079\u0032\u004c\u0065\u0076\u0065\u006c\u0034";
var (_defg ,_feeb ,_fdd ,_ecf ,_efa ,_cgdf ,_aaab ,_ggd int ;_edf ,_gff uint32 ;_dca ,_fbaf byte ;_afcc uint16 ;);_bef :=make ([]byte ,4);_gdab :=make ([]byte ,4);for _fdd =0;_fdd < _efbc .Height -1;_fdd ,_ecf =_fdd +2,_ecf +1{_defg =_fdd *_efbc .RowStride ;
_feeb =_ecf *_dde .RowStride ;for _efa ,_cgdf =0,0;_efa < _agc ;_efa ,_cgdf =_efa +4,_cgdf +1{for _aaab =0;_aaab < 4;_aaab ++{_ggd =_defg +_efa +_aaab ;if _ggd <=len (_efbc .Data )-1&&_ggd < _defg +_efbc .RowStride {_bef [_aaab ]=_efbc .Data [_ggd ];}else {_bef [_aaab ]=0x00;
};_ggd =_defg +_efbc .RowStride +_efa +_aaab ;if _ggd <=len (_efbc .Data )-1&&_ggd < _defg +(2*_efbc .RowStride ){_gdab [_aaab ]=_efbc .Data [_ggd ];}else {_gdab [_aaab ]=0x00;};};_edf =_bg .BigEndian .Uint32 (_bef );_gff =_bg .BigEndian .Uint32 (_gdab );
_gff &=_edf ;_gff &=_gff <<1;_gff &=0xaaaaaaaa;_edf =_gff |(_gff <<7);_dca =byte (_edf >>24);_fbaf =byte ((_edf >>8)&0xff);_ggd =_feeb +_cgdf ;if _ggd +1==len (_dde .Data )-1||_ggd +1>=_feeb +_dde .RowStride {_dde .Data [_ggd ]=_gbee [_dca ];if _bdd =_dde .SetByte (_ggd ,_gbee [_dca ]);
_bdd !=nil {return _bc .Wrapf (_bdd ,_febf ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0025d",_ggd );};}else {_afcc =(uint16 (_gbee [_dca ])<<8)|uint16 (_gbee [_fbaf ]);if _bdd =_dde .setTwoBytes (_ggd ,_afcc );_bdd !=nil {return _bc .Wrapf (_bdd ,_febf ,"s\u0065\u0074\u0074\u0069\u006e\u0067 \u0074\u0077\u006f\u0020\u0062\u0079t\u0065\u0073\u0020\u0066\u0061\u0069\u006ce\u0064\u002c\u0020\u0069\u006e\u0064\u0065\u0078\u003a\u0020%\u0064",_ggd );
};_cgdf ++;};};};return nil ;};const (MopDilation MorphOperation =iota ;MopErosion ;MopOpening ;MopClosing ;MopRankBinaryReduction ;MopReplicativeBinaryExpansion ;MopAddBorder ;);func _eggf (_efge *Bitmap ,_aggad int )(*Bitmap ,error ){const _cdeac ="\u0065x\u0070a\u006e\u0064\u0052\u0065\u0070\u006c\u0069\u0063\u0061\u0074\u0065";
if _efge ==nil {return nil ,_bc .Error (_cdeac ,"\u0073o\u0075r\u0063\u0065\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");};if _aggad <=0{return nil ,_bc .Error (_cdeac ,"i\u006e\u0076\u0061\u006cid\u0020f\u0061\u0063\u0074\u006f\u0072 \u002d\u0020\u003c\u003d\u0020\u0030");
};if _aggad ==1{_cecf ,_ddefd :=_ffdb (nil ,_efge );if _ddefd !=nil {return nil ,_bc .Wrap (_ddefd ,_cdeac ,"\u0066\u0061\u0063\u0074\u006f\u0072\u0020\u003d\u0020\u0031");};return _cecf ,nil ;};_aadg ,_efad :=_aca (_efge ,_aggad ,_aggad );if _efad !=nil {return nil ,_bc .Wrap (_efad ,_cdeac ,"");
};return _aadg ,nil ;};func _faca (_dgdbd ,_gga int )int {if _dgdbd > _gga {return _dgdbd ;};return _gga ;};func (_gbeg *ClassedPoints )GroupByY ()([]*ClassedPoints ,error ){const _bacc ="\u0043\u006c\u0061\u0073se\u0064\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047\u0072\u006f\u0075\u0070\u0042y\u0059";
if _befg :=_gbeg .validateIntSlice ();_befg !=nil {return nil ,_bc .Wrap (_befg ,_bacc ,"");};if _gbeg .IntSlice .Size ()==0{return nil ,_bc .Error (_bacc ,"\u004e\u006f\u0020\u0063la\u0073\u0073\u0065\u0073\u0020\u0070\u0072\u006f\u0076\u0069\u0064\u0065\u0064");
};_gbeg .SortByY ();var (_adac []*ClassedPoints ;_baada int ;);_cadf :=-1;var _egba *ClassedPoints ;for _dbbd :=0;_dbbd < len (_gbeg .IntSlice );_dbbd ++{_baada =int (_gbeg .YAtIndex (_dbbd ));if _baada !=_cadf {_egba =&ClassedPoints {Points :_gbeg .Points };
_cadf =_baada ;_adac =append (_adac ,_egba );};_egba .IntSlice =append (_egba .IntSlice ,_gbeg .IntSlice [_dbbd ]);};for _ ,_dacd :=range _adac {_dacd .SortByX ();};return _adac ,nil ;};type byWidth Bitmaps ;func (_bcdcb *byWidth )Less (i ,j int )bool {return _bcdcb .Values [i ].Width < _bcdcb .Values [j ].Width };
func NewWithData (width ,height int ,data []byte )(*Bitmap ,error ){const _ceb ="N\u0065\u0077\u0057\u0069\u0074\u0068\u0044\u0061\u0074\u0061";_feef :=_dac (width ,height );_feef .Data =data ;if len (data )< height *_feef .RowStride {return nil ,_bc .Errorf (_ceb ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0064\u0061\u0074\u0061\u0020l\u0065\u006e\u0067\u0074\u0068\u003a \u0025\u0064\u0020\u002d\u0020\u0073\u0068\u006f\u0075\u006c\u0064\u0020\u0062e\u003a\u0020\u0025\u0064",len (data ),height *_feef .RowStride );
};return _feef ,nil ;};func (_ecff *Points )AddPoint (x ,y float32 ){*_ecff =append (*_ecff ,Point {x ,y })};func (_gccg *ClassedPoints )SortByX (){_gccg ._bcbcb =_gccg .xSortFunction ();_a .Sort (_gccg )};func _ff (_ge *Bitmap ,_dcg *Bitmap ,_abd int )(_fdb error ){const _eea ="e\u0078\u0070\u0061\u006edB\u0069n\u0061\u0072\u0079\u0050\u006fw\u0065\u0072\u0032\u004c\u006f\u0077";
switch _abd {case 2:_fdb =_bd (_ge ,_dcg );case 4:_fdb =_cc (_ge ,_dcg );case 8:_fdb =_adc (_ge ,_dcg );default:return _bc .Error (_eea ,"\u0065\u0078p\u0061\u006e\u0073\u0069o\u006e\u0020f\u0061\u0063\u0074\u006f\u0072\u0020\u006e\u006ft\u0020\u0069\u006e\u0020\u007b\u0032\u002c\u0034\u002c\u0038\u007d\u0020r\u0061\u006e\u0067\u0065");
};if _fdb !=nil {_fdb =_bc .Wrap (_fdb ,_eea ,"");};return _fdb ;};func (_ecfe *Bitmap )setAll ()error {_cbg :=_bdbg (_ecfe ,0,0,_ecfe .Width ,_ecfe .Height ,PixSet ,nil ,0,0);if _cbg !=nil {return _bc .Wrap (_cbg ,"\u0073\u0065\u0074\u0041\u006c\u006c","");
};return nil ;};func _bfeff (_gcdge ,_dbad ,_cgge *Bitmap ,_ggbga int )(*Bitmap ,error ){const _bega ="\u0073\u0065\u0065\u0064\u0046\u0069\u006c\u006c\u0042i\u006e\u0061\u0072\u0079";if _dbad ==nil {return nil ,_bc .Error (_bega ,"s\u006fu\u0072\u0063\u0065\u0020\u0062\u0069\u0074\u006da\u0070\u0020\u0069\u0073 n\u0069\u006c");
};if _cgge ==nil {return nil ,_bc .Error (_bega ,"'\u006da\u0073\u006b\u0027\u0020\u0062\u0069\u0074\u006da\u0070\u0020\u0069\u0073 n\u0069\u006c");};if _ggbga !=4&&_ggbga !=8{return nil ,_bc .Error (_bega ,"\u0063\u006f\u006en\u0065\u0063\u0074\u0069v\u0069\u0074\u0079\u0020\u006e\u006f\u0074 \u0069\u006e\u0020\u0072\u0061\u006e\u0067\u0065\u0020\u007b\u0034\u002c\u0038\u007d");
};var _efca error ;_gcdge ,_efca =_ffdb (_gcdge ,_dbad );if _efca !=nil {return nil ,_bc .Wrap (_efca ,_bega ,"\u0063o\u0070y\u0020\u0073\u006f\u0075\u0072c\u0065\u0020t\u006f\u0020\u0027\u0064\u0027");};_baccf :=_dbad .createTemplate ();_cgge .setPadBits (0);
for _cggaf :=0;_cggaf < _aaad ;_cggaf ++{_baccf ,_efca =_ffdb (_baccf ,_gcdge );if _efca !=nil {return nil ,_bc .Wrapf (_efca ,_bega ,"\u0069\u0074\u0065\u0072\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0025\u0064",_cggaf );};if _efca =_adaf (_gcdge ,_cgge ,_ggbga );
_efca !=nil {return nil ,_bc .Wrapf (_efca ,_bega ,"\u0069\u0074\u0065\u0072\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0025\u0064",_cggaf );};if _baccf .Equals (_gcdge ){break ;};};return _gcdge ,nil ;};func TstVSymbol (t *_d .T ,scale ...int )*Bitmap {_cgda ,_gcgbf :=NewWithData (5,5,[]byte {0x88,0x88,0x88,0x50,0x20});
_f .NoError (t ,_gcgbf );return TstGetScaledSymbol (t ,_cgda ,scale ...);};func (_bfbc *Bitmap )SetDefaultPixel (){for _abb :=range _bfbc .Data {_bfbc .Data [_abb ]=byte (0xff);};};func _gfgfad (_bcef *Bitmap )(_eadb *Bitmap ,_begb int ,_ccdaf error ){const _bcaf ="\u0042i\u0074\u006d\u0061\u0070.\u0077\u006f\u0072\u0064\u004da\u0073k\u0042y\u0044\u0069\u006c\u0061\u0074\u0069\u006fn";
if _bcef ==nil {return nil ,0,_bc .Errorf (_bcaf ,"\u0027\u0073\u0027\u0020bi\u0074\u006d\u0061\u0070\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006ee\u0064");};var _bdad ,_gfgfag *Bitmap ;if _bdad ,_ccdaf =_ffdb (nil ,_bcef );_ccdaf !=nil {return nil ,0,_bc .Wrap (_ccdaf ,_bcaf ,"\u0063\u006f\u0070\u0079\u0020\u0027\u0073\u0027");
};var (_cbb [13]int ;_bgb ,_adb int ;);_gcgb :=12;_bbaa :=_be .NewNumSlice (_gcgb +1);_fcca :=_be .NewNumSlice (_gcgb +1);var _egb *Boxes ;for _fgag :=0;_fgag <=_gcgb ;_fgag ++{if _fgag ==0{if _gfgfag ,_ccdaf =_ffdb (nil ,_bdad );_ccdaf !=nil {return nil ,0,_bc .Wrap (_ccdaf ,_bcaf ,"\u0066i\u0072\u0073\u0074\u0020\u0062\u006d2");
};}else {if _gfgfag ,_ccdaf =_agcf (_bdad ,MorphProcess {Operation :MopDilation ,Arguments :[]int {2,1}});_ccdaf !=nil {return nil ,0,_bc .Wrap (_ccdaf ,_bcaf ,"\u0064\u0069\u006ca\u0074\u0069\u006f\u006e\u0020\u0062\u006d\u0032");};};if _egb ,_ccdaf =_gfgfag .connComponentsBB (4);
_ccdaf !=nil {return nil ,0,_bc .Wrap (_ccdaf ,_bcaf ,"");};_cbb [_fgag ]=len (*_egb );_bbaa .AddInt (_cbb [_fgag ]);switch _fgag {case 0:_bgb =_cbb [0];default:_adb =_cbb [_fgag -1]-_cbb [_fgag ];_fcca .AddInt (_adb );};_bdad =_gfgfag ;};_ecag :=true ;
_bbdc :=2;var _bdaf ,_gafe int ;for _ebd :=1;_ebd < len (*_fcca );_ebd ++{if _bdaf ,_ccdaf =_bbaa .GetInt (_ebd );_ccdaf !=nil {return nil ,0,_bc .Wrap (_ccdaf ,_bcaf ,"\u0043\u0068\u0065\u0063ki\u006e\u0067\u0020\u0062\u0065\u0073\u0074\u0020\u0064\u0069\u006c\u0061\u0074\u0069o\u006e");
};if _ecag &&_bdaf < int (0.3*float32 (_bgb )){_bbdc =_ebd +1;_ecag =false ;};if _adb ,_ccdaf =_fcca .GetInt (_ebd );_ccdaf !=nil {return nil ,0,_bc .Wrap (_ccdaf ,_bcaf ,"\u0067\u0065\u0074\u0074\u0069\u006e\u0067\u0020\u006ea\u0044\u0069\u0066\u0066");
};if _adb > _gafe {_gafe =_adb ;};};_afgb :=_bcef .XResolution ;if _afgb ==0{_afgb =150;};if _afgb > 110{_bbdc ++;};if _bbdc < 2{_gc .Log .Trace ("J\u0042\u0049\u0047\u0032\u0020\u0073\u0065\u0074\u0074\u0069\u006e\u0067\u0020\u0069\u0042\u0065\u0073\u0074 \u0074\u006f\u0020\u006d\u0069\u006e\u0069\u006d\u0075\u006d a\u006c\u006c\u006fw\u0061b\u006c\u0065");
_bbdc =2;};_begb =_bbdc +1;if _eadb ,_ccdaf =_faaa (nil ,_bcef ,_bbdc +1,1);_ccdaf !=nil {return nil ,0,_bc .Wrap (_ccdaf ,_bcaf ,"\u0067\u0065\u0074\u0074in\u0067\u0020\u006d\u0061\u0073\u006b\u0020\u0066\u0061\u0069\u006c\u0065\u0064");};return _eadb ,_begb ,nil ;
};func (_cfcf *Bitmap )addPadBits ()(_fbaa error ){const _beg ="\u0062\u0069\u0074\u006d\u0061\u0070\u002e\u0061\u0064\u0064\u0050\u0061d\u0042\u0069\u0074\u0073";_egf :=_cfcf .Width %8;if _egf ==0{return nil ;};_dad :=_cfcf .Width /8;_aagg :=_ga .NewReader (_cfcf .Data );
_fbad :=make ([]byte ,_cfcf .Height *_cfcf .RowStride );_bgcb :=_ga .NewWriterMSB (_fbad );_bcg :=make ([]byte ,_dad );var (_efcf int ;_ggde uint64 ;);for _efcf =0;_efcf < _cfcf .Height ;_efcf ++{if _ ,_fbaa =_aagg .Read (_bcg );_fbaa !=nil {return _bc .Wrap (_fbaa ,_beg ,"\u0066u\u006c\u006c\u0020\u0062\u0079\u0074e");
};if _ ,_fbaa =_bgcb .Write (_bcg );_fbaa !=nil {return _bc .Wrap (_fbaa ,_beg ,"\u0066\u0075\u006c\u006c\u0020\u0062\u0079\u0074\u0065\u0073");};if _ggde ,_fbaa =_aagg .ReadBits (byte (_egf ));_fbaa !=nil {return _bc .Wrap (_fbaa ,_beg ,"\u0073\u006b\u0069\u0070\u0070\u0069\u006e\u0067\u0020\u0062\u0069\u0074\u0073");
};if _fbaa =_bgcb .WriteByte (byte (_ggde )<<uint (8-_egf ));_fbaa !=nil {return _bc .Wrap (_fbaa ,_beg ,"\u006ca\u0073\u0074\u0020\u0062\u0079\u0074e");};};_cfcf .Data =_bgcb .Data ();return nil ;};func _affe (_daf ,_agfc *Bitmap ,_gfag CombinationOperator )*Bitmap {_eced :=New (_daf .Width ,_daf .Height );
for _eddg :=0;_eddg < len (_eced .Data );_eddg ++{_eced .Data [_eddg ]=_abfa (_daf .Data [_eddg ],_agfc .Data [_eddg ],_gfag );};return _eced ;};func _bgcf (_cabf ,_eddf *Bitmap ,_faee ,_eabg ,_dega uint ,_bccg ,_fcde int ,_aaga bool ,_bdgg ,_bbfd int )error {for _eecg :=_bccg ;
_eecg < _fcde ;_eecg ++{if _bdgg +1< len (_cabf .Data ){_eccc :=_eecg +1==_fcde ;_ceab ,_ccdg :=_cabf .GetByte (_bdgg );if _ccdg !=nil {return _ccdg ;};_bdgg ++;_ceab <<=_faee ;_gbag ,_ccdg :=_cabf .GetByte (_bdgg );if _ccdg !=nil {return _ccdg ;};_gbag >>=_eabg ;
_adff :=_ceab |_gbag ;if _eccc &&!_aaga {_adff =_edee (_dega ,_adff );};_ccdg =_eddf .SetByte (_bbfd ,_adff );if _ccdg !=nil {return _ccdg ;};_bbfd ++;if _eccc &&_aaga {_aadc ,_dgbf :=_cabf .GetByte (_bdgg );if _dgbf !=nil {return _dgbf ;};_aadc <<=_faee ;
_adff =_edee (_dega ,_aadc );if _dgbf =_eddf .SetByte (_bbfd ,_adff );_dgbf !=nil {return _dgbf ;};};continue ;};_dcgb ,_dgff :=_cabf .GetByte (_bdgg );if _dgff !=nil {_gc .Log .Debug ("G\u0065\u0074\u0074\u0069\u006e\u0067 \u0074\u0068\u0065\u0020\u0076\u0061l\u0075\u0065\u0020\u0061\u0074\u003a\u0020%\u0064\u0020\u0066\u0061\u0069\u006c\u0065\u0064\u003a\u0020%\u0073",_bdgg ,_dgff );
return _dgff ;};_dcgb <<=_faee ;_bdgg ++;_dgff =_eddf .SetByte (_bbfd ,_dcgb );if _dgff !=nil {return _dgff ;};_bbfd ++;};return nil ;};func TstAddSymbol (t *_d .T ,bms *Bitmaps ,sym *Bitmap ,x *int ,y int ,space int ){bms .AddBitmap (sym );_bede :=_ag .Rect (*x ,y ,*x +sym .Width ,y +sym .Height );
bms .AddBox (&_bede );*x +=sym .Width +space ;};func _eaab (_cfbg ...MorphProcess )(_ebeb error ){const _baag ="v\u0065r\u0069\u0066\u0079\u004d\u006f\u0072\u0070\u0068P\u0072\u006f\u0063\u0065ss\u0065\u0073";var _edbb ,_gdcd int ;for _fbdea ,_dbcbc :=range _cfbg {if _ebeb =_dbcbc .verify (_fbdea ,&_edbb ,&_gdcd );
_ebeb !=nil {return _bc .Wrap (_ebeb ,_baag ,"");};};if _gdcd !=0&&_edbb !=0{return _bc .Error (_baag ,"\u004d\u006f\u0072\u0070\u0068\u0020\u0073\u0065\u0071\u0075\u0065n\u0063\u0065\u0020\u002d\u0020\u0062\u006f\u0072d\u0065r\u0020\u0061\u0064\u0064\u0065\u0064\u0020\u0062\u0075\u0074\u0020\u006e\u0065\u0074\u0020\u0072\u0065\u0064u\u0063\u0074\u0069\u006f\u006e\u0020\u006e\u006f\u0074\u0020\u0030");
};return nil ;};func (_gcg *Bitmap )GetByteIndex (x ,y int )int {return y *_gcg .RowStride +(x >>3)};func _bec (_fddc ,_cacb *Bitmap ,_eggca *Selection )(*Bitmap ,error ){const _dccf ="c\u006c\u006f\u0073\u0065\u0042\u0069\u0074\u006d\u0061\u0070";var _aeg error ;
if _fddc ,_aeg =_baef (_fddc ,_cacb ,_eggca );_aeg !=nil {return nil ,_aeg ;};_dgae ,_aeg :=_bgdb (nil ,_cacb ,_eggca );if _aeg !=nil {return nil ,_bc .Wrap (_aeg ,_dccf ,"");};if _ ,_aeg =_fddfd (_fddc ,_dgae ,_eggca );_aeg !=nil {return nil ,_bc .Wrap (_aeg ,_dccf ,"");
};return _fddc ,nil ;};func TstWordBitmap (t *_d .T ,scale ...int )*Bitmap {_acde :=1;if len (scale )> 0{_acde =scale [0];};_ebgfg :=3;_cbcf :=9+7+15+2*_ebgfg ;_fadg :=5+_ebgfg +5;_agfec :=New (_cbcf *_acde ,_fadg *_acde );_gdfd :=&Bitmaps {};var _ecggb *int ;
_ebgfg *=_acde ;_ebfg :=0;_ecggb =&_ebfg ;_acgfg :=0;_edec :=TstDSymbol (t ,scale ...);TstAddSymbol (t ,_gdfd ,_edec ,_ecggb ,_acgfg ,1*_acde );_edec =TstOSymbol (t ,scale ...);TstAddSymbol (t ,_gdfd ,_edec ,_ecggb ,_acgfg ,_ebgfg );_edec =TstISymbol (t ,scale ...);
TstAddSymbol (t ,_gdfd ,_edec ,_ecggb ,_acgfg ,1*_acde );_edec =TstTSymbol (t ,scale ...);TstAddSymbol (t ,_gdfd ,_edec ,_ecggb ,_acgfg ,_ebgfg );_edec =TstNSymbol (t ,scale ...);TstAddSymbol (t ,_gdfd ,_edec ,_ecggb ,_acgfg ,1*_acde );_edec =TstOSymbol (t ,scale ...);
TstAddSymbol (t ,_gdfd ,_edec ,_ecggb ,_acgfg ,1*_acde );_edec =TstWSymbol (t ,scale ...);TstAddSymbol (t ,_gdfd ,_edec ,_ecggb ,_acgfg ,0);*_ecggb =0;_acgfg =5*_acde +_ebgfg ;_edec =TstOSymbol (t ,scale ...);TstAddSymbol (t ,_gdfd ,_edec ,_ecggb ,_acgfg ,1*_acde );
_edec =TstRSymbol (t ,scale ...);TstAddSymbol (t ,_gdfd ,_edec ,_ecggb ,_acgfg ,_ebgfg );_edec =TstNSymbol (t ,scale ...);TstAddSymbol (t ,_gdfd ,_edec ,_ecggb ,_acgfg ,1*_acde );_edec =TstESymbol (t ,scale ...);TstAddSymbol (t ,_gdfd ,_edec ,_ecggb ,_acgfg ,1*_acde );
_edec =TstVSymbol (t ,scale ...);TstAddSymbol (t ,_gdfd ,_edec ,_ecggb ,_acgfg ,1*_acde );_edec =TstESymbol (t ,scale ...);TstAddSymbol (t ,_gdfd ,_edec ,_ecggb ,_acgfg ,1*_acde );_edec =TstRSymbol (t ,scale ...);TstAddSymbol (t ,_gdfd ,_edec ,_ecggb ,_acgfg ,0);
TstWriteSymbols (t ,_gdfd ,_agfec );return _agfec ;};func _gac ()(_df [256]uint16 ){for _ef :=0;_ef < 256;_ef ++{if _ef &0x01!=0{_df [_ef ]|=0x3;};if _ef &0x02!=0{_df [_ef ]|=0xc;};if _ef &0x04!=0{_df [_ef ]|=0x30;};if _ef &0x08!=0{_df [_ef ]|=0xc0;};if _ef &0x10!=0{_df [_ef ]|=0x300;
};if _ef &0x20!=0{_df [_ef ]|=0xc00;};if _ef &0x40!=0{_df [_ef ]|=0x3000;};if _ef &0x80!=0{_df [_ef ]|=0xc000;};};return _df ;};func _gbdg (_bdbd ,_cabd *Bitmap ,_acff ,_gfgff int )(*Bitmap ,error ){const _afcbf ="d\u0069\u006c\u0061\u0074\u0065\u0042\u0072\u0069\u0063\u006b";
if _cabd ==nil {_gc .Log .Debug ("\u0064\u0069\u006c\u0061\u0074\u0065\u0042\u0072\u0069\u0063k\u0020\u0073\u006f\u0075\u0072\u0063\u0065 \u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");return nil ,_bc .Error (_afcbf ,"\u0073o\u0075\u0072\u0063\u0065 \u0062\u0069\u0074\u006d\u0061p\u0020n\u006ft\u0020\u0064\u0065\u0066\u0069\u006e\u0065d");
};if _acff < 1||_gfgff < 1{return nil ,_bc .Error (_afcbf ,"\u0068\u0053\u007a\u0069\u0065 \u0061\u006e\u0064\u0020\u0076\u0053\u0069\u007a\u0065\u0020\u0061\u0072\u0065 \u006e\u006f\u0020\u0067\u0072\u0065\u0061\u0074\u0065\u0072\u0020\u0065\u0071\u0075\u0061\u006c\u0020\u0074\u006f\u0020\u0031");
};if _acff ==1&&_gfgff ==1{_fegf ,_gefd :=_ffdb (_bdbd ,_cabd );if _gefd !=nil {return nil ,_bc .Wrap (_gefd ,_afcbf ,"\u0068S\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u0026\u0026 \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");
};return _fegf ,nil ;};if _acff ==1||_gfgff ==1{_bgfb :=SelCreateBrick (_gfgff ,_acff ,_gfgff /2,_acff /2,SelHit );_agbd ,_gbef :=_bgdb (_bdbd ,_cabd ,_bgfb );if _gbef !=nil {return nil ,_bc .Wrap (_gbef ,_afcbf ,"\u0068s\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u007c\u007c \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");
};return _agbd ,nil ;};_fgab :=SelCreateBrick (1,_acff ,0,_acff /2,SelHit );_ada :=SelCreateBrick (_gfgff ,1,_gfgff /2,0,SelHit );_dfgc ,_bad :=_bgdb (nil ,_cabd ,_fgab );if _bad !=nil {return nil ,_bc .Wrap (_bad ,_afcbf ,"\u0031\u0073\u0074\u0020\u0064\u0069\u006c\u0061\u0074\u0065");
};_bdbd ,_bad =_bgdb (_bdbd ,_dfgc ,_ada );if _bad !=nil {return nil ,_bc .Wrap (_bad ,_afcbf ,"\u0032\u006e\u0064\u0020\u0064\u0069\u006c\u0061\u0074\u0065");};return _bdbd ,nil ;};func (_agd Points )Get (i int )(Point ,error ){if i > len (_agd )-1{return Point {},_bc .Errorf ("\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047\u0065\u0074","\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};return _agd [i ],nil ;};type Point struct{X ,Y float32 ;};func DilateBrick (d ,s *Bitmap ,hSize ,vSize int )(*Bitmap ,error ){return _gbdg (d ,s ,hSize ,vSize )};func (_fbd *Bitmap )Copy ()*Bitmap {_bge :=make ([]byte ,len (_fbd .Data ));copy (_bge ,_fbd .Data );
return &Bitmap {Width :_fbd .Width ,Height :_fbd .Height ,RowStride :_fbd .RowStride ,Data :_bge ,Color :_fbd .Color ,Text :_fbd .Text ,BitmapNumber :_fbd .BitmapNumber ,Special :_fbd .Special };};func (_gcb *Bitmap )createTemplate ()*Bitmap {return &Bitmap {Width :_gcb .Width ,Height :_gcb .Height ,RowStride :_gcb .RowStride ,Color :_gcb .Color ,Text :_gcb .Text ,BitmapNumber :_gcb .BitmapNumber ,Special :_gcb .Special ,Data :make ([]byte ,len (_gcb .Data ))};
};func _adc (_cgg ,_ab *Bitmap )(_eeb error ){const _ebe ="\u0065\u0078\u0070\u0061nd\u0042\u0069\u006e\u0061\u0072\u0079\u0046\u0061\u0063\u0074\u006f\u0072\u0038";_bgf :=_ab .RowStride ;_fe :=_cgg .RowStride ;var _fec ,_bb ,_gfgf ,_dd ,_abf int ;for _gfgf =0;
_gfgf < _ab .Height ;_gfgf ++{_fec =_gfgf *_bgf ;_bb =8*_gfgf *_fe ;for _dd =0;_dd < _bgf ;_dd ++{if _eeb =_cgg .setEightBytes (_bb +_dd *8,_caee [_ab .Data [_fec +_dd ]]);_eeb !=nil {return _bc .Wrap (_eeb ,_ebe ,"");};};for _abf =1;_abf < 8;_abf ++{for _dd =0;
_dd < _fe ;_dd ++{if _eeb =_cgg .SetByte (_bb +_abf *_fe +_dd ,_cgg .Data [_bb +_dd ]);_eeb !=nil {return _bc .Wrap (_eeb ,_ebe ,"");};};};};return nil ;};func _deaaf (_afbc *Bitmap ,_egbc *Bitmap ,_ggda *Selection ,_deda **Bitmap )(*Bitmap ,error ){const _gcaaa ="\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u004d\u006f\u0072\u0070\u0068A\u0072\u0067\u0073\u0031";
if _egbc ==nil {return nil ,_bc .Error (_gcaaa ,"\u004d\u006f\u0072\u0070\u0068\u0041\u0072\u0067\u0073\u0031\u0020'\u0073\u0027\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066i\u006e\u0065\u0064");};if _ggda ==nil {return nil ,_bc .Error (_gcaaa ,"\u004d\u006f\u0072\u0068p\u0041\u0072\u0067\u0073\u0031\u0020\u0027\u0073\u0065\u006c'\u0020n\u006f\u0074\u0020\u0064\u0065\u0066\u0069n\u0065\u0064");
};_faffd ,_abgg :=_ggda .Height ,_ggda .Width ;if _faffd ==0||_abgg ==0{return nil ,_bc .Error (_gcaaa ,"\u0073\u0065\u006c\u0065ct\u0069\u006f\u006e\u0020\u006f\u0066\u0020\u0073\u0069\u007a\u0065\u0020\u0030");};if _afbc ==nil {_afbc =_egbc .createTemplate ();
*_deda =_egbc ;return _afbc ,nil ;};_afbc .Width =_egbc .Width ;_afbc .Height =_egbc .Height ;_afbc .RowStride =_egbc .RowStride ;_afbc .Color =_egbc .Color ;_afbc .Data =make ([]byte ,_egbc .RowStride *_egbc .Height );if _afbc ==_egbc {*_deda =_egbc .Copy ();
}else {*_deda =_egbc ;};return _afbc ,nil ;};func _adaf (_gfbc *Bitmap ,_cabeb *Bitmap ,_dfddc int )(_gbf error ){const _cccd ="\u0073\u0065\u0065\u0064\u0066\u0069\u006c\u006c\u0042\u0069\u006e\u0061r\u0079\u004c\u006f\u0077";_dfeaf :=_cecc (_gfbc .Height ,_cabeb .Height );
_bagf :=_cecc (_gfbc .RowStride ,_cabeb .RowStride );switch _dfddc {case 4:_gbf =_agcae (_gfbc ,_cabeb ,_dfeaf ,_bagf );case 8:_gbf =_eabab (_gfbc ,_cabeb ,_dfeaf ,_bagf );default:return _bc .Errorf (_cccd ,"\u0063\u006f\u006e\u006e\u0065\u0063\u0074\u0069\u0076\u0069\u0074\u0079\u0020\u006d\u0075\u0073\u0074\u0020\u0062\u0065\u0020\u0034\u0020\u006fr\u0020\u0038\u0020\u002d\u0020i\u0073\u003a \u0027\u0025\u0064\u0027",_dfddc );
};if _gbf !=nil {return _bc .Wrap (_gbf ,_cccd ,"");};return nil ;};func _bfga (_bbeg ,_dbefe *Bitmap ,_dcgc *Selection )(*Bitmap ,error ){const _gcag ="\u006f\u0070\u0065\u006e";var _bcbc error ;_bbeg ,_bcbc =_baef (_bbeg ,_dbefe ,_dcgc );if _bcbc !=nil {return nil ,_bc .Wrap (_bcbc ,_gcag ,"");
};_afaf ,_bcbc :=_fddfd (nil ,_dbefe ,_dcgc );if _bcbc !=nil {return nil ,_bc .Wrap (_bcbc ,_gcag ,"");};_ ,_bcbc =_bgdb (_bbeg ,_afaf ,_dcgc );if _bcbc !=nil {return nil ,_bc .Wrap (_bcbc ,_gcag ,"");};return _bbeg ,nil ;};var _ _a .Interface =&ClassedPoints {};
func _ccefe (_daba ,_edggf *Bitmap ,_ffdc ,_dffg int )(*Bitmap ,error ){const _fdaf ="\u0063\u006c\u006f\u0073\u0065\u0053\u0061\u0066\u0065B\u0072\u0069\u0063\u006b";if _edggf ==nil {return nil ,_bc .Error (_fdaf ,"\u0073\u006f\u0075\u0072\u0063\u0065\u0020\u0069\u0073\u0020\u006e\u0069\u006c");
};if _ffdc < 1||_dffg < 1{return nil ,_bc .Error (_fdaf ,"\u0068s\u0069\u007a\u0065\u0020\u0061\u006e\u0064\u0020\u0076\u0073\u0069z\u0065\u0020\u006e\u006f\u0074\u0020\u003e\u003d\u0020\u0031");};if _ffdc ==1&&_dffg ==1{return _ffdb (_daba ,_edggf );};
if MorphBC ==SymmetricMorphBC {_cba ,_adfeb :=_faaa (_daba ,_edggf ,_ffdc ,_dffg );if _adfeb !=nil {return nil ,_bc .Wrap (_adfeb ,_fdaf ,"\u0053\u0079m\u006d\u0065\u0074r\u0069\u0063\u004d\u006f\u0072\u0070\u0068\u0042\u0043");};return _cba ,nil ;};_ccag :=_faca (_ffdc /2,_dffg /2);
_efege :=8*((_ccag +7)/8);_cgee ,_dcga :=_edggf .AddBorder (_efege ,0);if _dcga !=nil {return nil ,_bc .Wrapf (_dcga ,_fdaf ,"\u0042\u006f\u0072\u0064\u0065\u0072\u0053\u0069\u007ae\u003a\u0020\u0025\u0064",_efege );};var _cgdg ,_ccga *Bitmap ;if _ffdc ==1||_dffg ==1{_fbga :=SelCreateBrick (_dffg ,_ffdc ,_dffg /2,_ffdc /2,SelHit );
_cgdg ,_dcga =_bec (nil ,_cgee ,_fbga );if _dcga !=nil {return nil ,_bc .Wrap (_dcga ,_fdaf ,"\u0068S\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u007c\u007c \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");};}else {_ebdd :=SelCreateBrick (1,_ffdc ,0,_ffdc /2,SelHit );
_cfcc ,_gebd :=_bgdb (nil ,_cgee ,_ebdd );if _gebd !=nil {return nil ,_bc .Wrap (_gebd ,_fdaf ,"\u0072\u0065\u0067\u0075la\u0072\u0020\u002d\u0020\u0066\u0069\u0072\u0073\u0074\u0020\u0064\u0069\u006c\u0061t\u0065");};_cfaa :=SelCreateBrick (_dffg ,1,_dffg /2,0,SelHit );
_cgdg ,_gebd =_bgdb (nil ,_cfcc ,_cfaa );if _gebd !=nil {return nil ,_bc .Wrap (_gebd ,_fdaf ,"\u0072\u0065\u0067ul\u0061\u0072\u0020\u002d\u0020\u0073\u0065\u0063\u006f\u006e\u0064\u0020\u0064\u0069\u006c\u0061\u0074\u0065");};if _ ,_gebd =_fddfd (_cfcc ,_cgdg ,_ebdd );
_gebd !=nil {return nil ,_bc .Wrap (_gebd ,_fdaf ,"r\u0065\u0067\u0075\u006car\u0020-\u0020\u0066\u0069\u0072\u0073t\u0020\u0065\u0072\u006f\u0064\u0065");};if _ ,_gebd =_fddfd (_cgdg ,_cfcc ,_cfaa );_gebd !=nil {return nil ,_bc .Wrap (_gebd ,_fdaf ,"\u0072\u0065\u0067\u0075la\u0072\u0020\u002d\u0020\u0073\u0065\u0063\u006f\u006e\u0064\u0020\u0065\u0072\u006fd\u0065");
};};if _ccga ,_dcga =_cgdg .RemoveBorder (_efege );_dcga !=nil {return nil ,_bc .Wrap (_dcga ,_fdaf ,"\u0072e\u0067\u0075\u006c\u0061\u0072");};if _daba ==nil {return _ccga ,nil ;};if _ ,_dcga =_ffdb (_daba ,_ccga );_dcga !=nil {return nil ,_dcga ;};return _daba ,nil ;
};type Bitmaps struct{Values []*Bitmap ;Boxes []*_ag .Rectangle ;};func _aadcb (_dcfbc *Bitmap ,_fcfd *_be .Stack ,_bdffc ,_ggbc int )(_aead *_ag .Rectangle ,_fdbf error ){const _ebaa ="\u0073e\u0065d\u0046\u0069\u006c\u006c\u0053\u0074\u0061\u0063\u006b\u0042\u0042";
if _dcfbc ==nil {return nil ,_bc .Error (_ebaa ,"\u0070\u0072\u006fvi\u0064\u0065\u0064\u0020\u006e\u0069\u006c\u0020\u0027\u0073\u0027\u0020\u0042\u0069\u0074\u006d\u0061\u0070");};if _fcfd ==nil {return nil ,_bc .Error (_ebaa ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0027\u0073\u0074ac\u006b\u0027");
};_ffbd ,_febg :=_dcfbc .Width ,_dcfbc .Height ;_eecb :=_ffbd -1;_ggdd :=_febg -1;if _bdffc < 0||_bdffc > _eecb ||_ggbc < 0||_ggbc > _ggdd ||!_dcfbc .GetPixel (_bdffc ,_ggbc ){return nil ,nil ;};var _caff *_ag .Rectangle ;_caff ,_fdbf =Rect (100000,100000,0,0);
if _fdbf !=nil {return nil ,_bc .Wrap (_fdbf ,_ebaa ,"");};if _fdbf =_ababa (_fcfd ,_bdffc ,_bdffc ,_ggbc ,1,_ggdd ,_caff );_fdbf !=nil {return nil ,_bc .Wrap (_fdbf ,_ebaa ,"\u0069\u006e\u0069t\u0069\u0061\u006c\u0020\u0070\u0075\u0073\u0068");};if _fdbf =_ababa (_fcfd ,_bdffc ,_bdffc ,_ggbc +1,-1,_ggdd ,_caff );
_fdbf !=nil {return nil ,_bc .Wrap (_fdbf ,_ebaa ,"\u0032\u006ed\u0020\u0069\u006ei\u0074\u0069\u0061\u006c\u0020\u0070\u0075\u0073\u0068");};_caff .Min .X ,_caff .Max .X =_bdffc ,_bdffc ;_caff .Min .Y ,_caff .Max .Y =_ggbc ,_ggbc ;var (_bdabe *fillSegment ;
_ffaea int ;);for _fcfd .Len ()> 0{if _bdabe ,_fdbf =_gfaf (_fcfd );_fdbf !=nil {return nil ,_bc .Wrap (_fdbf ,_ebaa ,"");};_ggbc =_bdabe ._cfge ;for _bdffc =_bdabe ._ccce ;_bdffc >=0&&_dcfbc .GetPixel (_bdffc ,_ggbc );_bdffc --{if _fdbf =_dcfbc .SetPixel (_bdffc ,_ggbc ,0);
_fdbf !=nil {return nil ,_bc .Wrap (_fdbf ,_ebaa ,"");};};if _bdffc >=_bdabe ._ccce {for _bdffc ++;_bdffc <=_bdabe ._dbdb &&_bdffc <=_eecb &&!_dcfbc .GetPixel (_bdffc ,_ggbc );_bdffc ++{};_ffaea =_bdffc ;if _bdffc > _bdabe ._dbdb ||_bdffc > _eecb {continue ;
};}else {_ffaea =_bdffc +1;if _ffaea < _bdabe ._ccce -1{if _fdbf =_ababa (_fcfd ,_ffaea ,_bdabe ._ccce -1,_bdabe ._cfge ,-_bdabe ._dbdg ,_ggdd ,_caff );_fdbf !=nil {return nil ,_bc .Wrap (_fdbf ,_ebaa ,"\u006c\u0065\u0061\u006b\u0020\u006f\u006e\u0020\u006c\u0065\u0066\u0074 \u0073\u0069\u0064\u0065");
};};_bdffc =_bdabe ._ccce +1;};for {for ;_bdffc <=_eecb &&_dcfbc .GetPixel (_bdffc ,_ggbc );_bdffc ++{if _fdbf =_dcfbc .SetPixel (_bdffc ,_ggbc ,0);_fdbf !=nil {return nil ,_bc .Wrap (_fdbf ,_ebaa ,"\u0032n\u0064\u0020\u0073\u0065\u0074");};};if _fdbf =_ababa (_fcfd ,_ffaea ,_bdffc -1,_bdabe ._cfge ,_bdabe ._dbdg ,_ggdd ,_caff );
_fdbf !=nil {return nil ,_bc .Wrap (_fdbf ,_ebaa ,"n\u006f\u0072\u006d\u0061\u006c\u0020\u0070\u0075\u0073\u0068");};if _bdffc > _bdabe ._dbdb +1{if _fdbf =_ababa (_fcfd ,_bdabe ._dbdb +1,_bdffc -1,_bdabe ._cfge ,-_bdabe ._dbdg ,_ggdd ,_caff );_fdbf !=nil {return nil ,_bc .Wrap (_fdbf ,_ebaa ,"\u006ce\u0061k\u0020\u006f\u006e\u0020\u0072i\u0067\u0068t\u0020\u0073\u0069\u0064\u0065");
};};for _bdffc ++;_bdffc <=_bdabe ._dbdb &&_bdffc <=_eecb &&!_dcfbc .GetPixel (_bdffc ,_ggbc );_bdffc ++{};_ffaea =_bdffc ;if _bdffc > _bdabe ._dbdb ||_bdffc > _eecb {break ;};};};_caff .Max .X ++;_caff .Max .Y ++;return _caff ,nil ;};func NewWithUnpaddedData (width ,height int ,data []byte )(*Bitmap ,error ){const _dceg ="\u004e\u0065\u0077\u0057it\u0068\u0055\u006e\u0070\u0061\u0064\u0064\u0065\u0064\u0044\u0061\u0074\u0061";
_ceba :=_dac (width ,height );_ceba .Data =data ;if _ddg :=((width *height )+7)>>3;len (data )< _ddg {return nil ,_bc .Errorf (_dceg ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0064a\u0074\u0061\u0020\u006c\u0065\u006e\u0067\u0074\u0068\u003a\u0020\u0027\u0025\u0064\u0027\u002e\u0020\u0054\u0068\u0065\u0020\u0064\u0061t\u0061\u0020s\u0068\u006fu\u006c\u0064\u0020\u0063\u006f\u006e\u0074\u0061\u0069\u006e\u0020\u0061\u0074 l\u0065\u0061\u0073\u0074\u003a\u0020\u0027\u0025\u0064'\u0020\u0062\u0079\u0074\u0065\u0073",len (data ),_ddg );
};if _gaa :=_ceba .addPadBits ();_gaa !=nil {return nil ,_bc .Wrap (_gaa ,_dceg ,"");};return _ceba ,nil ;};func (_ecee *Boxes )Get (i int )(*_ag .Rectangle ,error ){const _eagdc ="\u0042o\u0078\u0065\u0073\u002e\u0047\u0065t";if _ecee ==nil {return nil ,_bc .Error (_eagdc ,"\u0027\u0042\u006f\u0078es\u0027\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};if i > len (*_ecee )-1{return nil ,_bc .Errorf (_eagdc ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );};return (*_ecee )[i ],nil ;};func Rect (x ,y ,w ,h int )(*_ag .Rectangle ,error ){const _gfbe ="b\u0069\u0074\u006d\u0061\u0070\u002e\u0052\u0065\u0063\u0074";
if x < 0{w +=x ;x =0;if w <=0{return nil ,_bc .Errorf (_gfbe ,"x\u003a\u0027\u0025\u0064\u0027\u0020<\u0020\u0030\u0020\u0061\u006e\u0064\u0020\u0077\u003a \u0027\u0025\u0064'\u0020<\u003d\u0020\u0030",x ,w );};};if y < 0{h +=y ;y =0;if h <=0{return nil ,_bc .Error (_gfbe ,"\u0079\u0020\u003c 0\u0020\u0061\u006e\u0064\u0020\u0062\u006f\u0078\u0020\u006f\u0066\u0066\u0020\u002b\u0071\u0075\u0061\u0064");
};};_dbfc :=_ag .Rect (x ,y ,x +w ,y +h );return &_dbfc ,nil ;};func (_fefe *Bitmaps )SortByHeight (){_bccf :=(*byHeight )(_fefe );_a .Sort (_bccf )};var MorphBC BoundaryCondition ;func _dbce (_ddgd ,_gcgc ,_eabad *Bitmap )(*Bitmap ,error ){const _ffce ="\u0073\u0075\u0062\u0074\u0072\u0061\u0063\u0074";
if _gcgc ==nil {return nil ,_bc .Error (_ffce ,"'\u0073\u0031\u0027\u0020\u0069\u0073\u0020\u006e\u0069\u006c");};if _eabad ==nil {return nil ,_bc .Error (_ffce ,"'\u0073\u0032\u0027\u0020\u0069\u0073\u0020\u006e\u0069\u006c");};var _gdde error ;switch _ddgd {case _gcgc :if _gdde =_ddgd .RasterOperation (0,0,_gcgc .Width ,_gcgc .Height ,PixNotSrcAndDst ,_eabad ,0,0);
_gdde !=nil {return nil ,_bc .Wrap (_gdde ,_ffce ,"\u0064 \u003d\u003d\u0020\u0073\u0031");};case _eabad :if _gdde =_ddgd .RasterOperation (0,0,_gcgc .Width ,_gcgc .Height ,PixNotSrcAndDst ,_gcgc ,0,0);_gdde !=nil {return nil ,_bc .Wrap (_gdde ,_ffce ,"\u0064 \u003d\u003d\u0020\u0073\u0032");
};default:_ddgd ,_gdde =_ffdb (_ddgd ,_gcgc );if _gdde !=nil {return nil ,_bc .Wrap (_gdde ,_ffce ,"");};if _gdde =_ddgd .RasterOperation (0,0,_gcgc .Width ,_gcgc .Height ,PixNotSrcAndDst ,_eabad ,0,0);_gdde !=nil {return nil ,_bc .Wrap (_gdde ,_ffce ,"\u0064e\u0066\u0061\u0075\u006c\u0074");
};};return _ddgd ,nil ;};type Boxes []*_ag .Rectangle ;func (_eeee *Bitmap )resizeImageData (_ffe *Bitmap )error {if _ffe ==nil {return _bc .Error ("\u0072e\u0073i\u007a\u0065\u0049\u006d\u0061\u0067\u0065\u0044\u0061\u0074\u0061","\u0073r\u0063 \u0069\u0073\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");
};if _eeee .SizesEqual (_ffe ){return nil ;};_eeee .Data =make ([]byte ,len (_ffe .Data ));_eeee .Width =_ffe .Width ;_eeee .Height =_ffe .Height ;_eeee .RowStride =_ffe .RowStride ;return nil ;};func (_fdca *Bitmap )setFourBytes (_aece int ,_bcfe uint32 )error {if _aece +3> len (_fdca .Data )-1{return _bc .Errorf ("\u0073\u0065\u0074F\u006f\u0075\u0072\u0042\u0079\u0074\u0065\u0073","\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",_aece );
};_fdca .Data [_aece ]=byte ((_bcfe &0xff000000)>>24);_fdca .Data [_aece +1]=byte ((_bcfe &0xff0000)>>16);_fdca .Data [_aece +2]=byte ((_bcfe &0xff00)>>8);_fdca .Data [_aece +3]=byte (_bcfe &0xff);return nil ;};func (_dddd *Bitmap )countPixels ()int {var (_beb int ;
_faaf uint8 ;_deg byte ;_ace int ;);_bcda :=_dddd .RowStride ;_agfb :=uint (_dddd .Width &0x07);if _agfb !=0{_faaf =uint8 ((0xff<<(8-_agfb ))&0xff);_bcda --;};for _gace :=0;_gace < _dddd .Height ;_gace ++{for _ace =0;_ace < _bcda ;_ace ++{_deg =_dddd .Data [_gace *_dddd .RowStride +_ace ];
_beb +=int (_ebgd [_deg ]);};if _agfb !=0{_beb +=int (_ebgd [_dddd .Data [_gace *_dddd .RowStride +_ace ]&_faaf ]);};};return _beb ;};func TstImageBitmap ()*Bitmap {return _fcbeg .Copy ()};func Centroids (bms []*Bitmap )(*Points ,error ){_adedg :=make ([]Point ,len (bms ));
_ceed :=_cbdab ();_abcd :=_dddcd ();var _ecce error ;for _febfa ,_ffac :=range bms {_adedg [_febfa ],_ecce =_ffac .centroid (_ceed ,_abcd );if _ecce !=nil {return nil ,_ecce ;};};_afgf :=Points (_adedg );return &_afgf ,nil ;};func MorphSequence (src *Bitmap ,sequence ...MorphProcess )(*Bitmap ,error ){return _agcf (src ,sequence ...);
};func (_eag *Bitmap )equivalent (_cfg *Bitmap )bool {if _eag ==_cfg {return true ;};if !_eag .SizesEqual (_cfg ){return false ;};_cdeg :=_affe (_eag ,_cfg ,CmbOpXor );_gedf :=_eag .countPixels ();_gcd :=int (0.25*float32 (_gedf ));if _cdeg .thresholdPixelSum (_gcd ){return false ;
};var (_geeb [9][9]int ;_cdd [18][9]int ;_fed [9][18]int ;_eebf int ;_cacg int ;);_bbg :=9;_cccb :=_eag .Height /_bbg ;_dbbg :=_eag .Width /_bbg ;_bbab ,_gdaba :=_cccb /2,_dbbg /2;if _cccb < _dbbg {_bbab =_dbbg /2;_gdaba =_cccb /2;};_eagd :=float64 (_bbab )*float64 (_gdaba )*_c .Pi ;
_cbc :=int (float64 (_cccb *_dbbg /2)*0.9);_fcaa :=int (float64 (_dbbg *_cccb /2)*0.9);for _eaad :=0;_eaad < _bbg ;_eaad ++{_cgbd :=_dbbg *_eaad +_eebf ;var _edfd int ;if _eaad ==_bbg -1{_eebf =0;_edfd =_eag .Width ;}else {_edfd =_cgbd +_dbbg ;if ((_eag .Width -_eebf )%_bbg )> 0{_eebf ++;
_edfd ++;};};for _ebc :=0;_ebc < _bbg ;_ebc ++{_dba :=_cccb *_ebc +_cacg ;var _ecfg int ;if _ebc ==_bbg -1{_cacg =0;_ecfg =_eag .Height ;}else {_ecfg =_dba +_cccb ;if (_eag .Height -_cacg )%_bbg > 0{_cacg ++;_ecfg ++;};};var _eacc ,_eadc ,_ccab ,_fdba int ;
_efgfc :=(_cgbd +_edfd )/2;_dcb :=(_dba +_ecfg )/2;for _bgg :=_cgbd ;_bgg < _edfd ;_bgg ++{for _abaa :=_dba ;_abaa < _ecfg ;_abaa ++{if _cdeg .GetPixel (_bgg ,_abaa ){if _bgg < _efgfc {_eacc ++;}else {_eadc ++;};if _abaa < _dcb {_fdba ++;}else {_ccab ++;
};};};};_geeb [_eaad ][_ebc ]=_eacc +_eadc ;_cdd [_eaad *2][_ebc ]=_eacc ;_cdd [_eaad *2+1][_ebc ]=_eadc ;_fed [_eaad ][_ebc *2]=_fdba ;_fed [_eaad ][_ebc *2+1]=_ccab ;};};for _cbdc :=0;_cbdc < _bbg *2-1;_cbdc ++{for _cge :=0;_cge < (_bbg -1);_cge ++{var _dfa int ;
for _dbe :=0;_dbe < 2;_dbe ++{for _bcc :=0;_bcc < 2;_bcc ++{_dfa +=_cdd [_cbdc +_dbe ][_cge +_bcc ];};};if _dfa > _fcaa {return false ;};};};for _aagge :=0;_aagge < (_bbg -1);_aagge ++{for _ddef :=0;_ddef < ((_bbg *2)-1);_ddef ++{var _dfag int ;for _bbag :=0;
_bbag < 2;_bbag ++{for _dab :=0;_dab < 2;_dab ++{_dfag +=_fed [_aagge +_bbag ][_ddef +_dab ];};};if _dfag > _cbc {return false ;};};};for _aafd :=0;_aafd < (_bbg -2);_aafd ++{for _cab :=0;_cab < (_bbg -2);_cab ++{var _fea ,_acea int ;for _dfaa :=0;_dfaa < 3;
_dfaa ++{for _ddae :=0;_ddae < 3;_ddae ++{if _dfaa ==_ddae {_fea +=_geeb [_aafd +_dfaa ][_cab +_ddae ];};if (2-_dfaa )==_ddae {_acea +=_geeb [_aafd +_dfaa ][_cab +_ddae ];};};};if _fea > _fcaa ||_acea > _fcaa {return false ;};};};for _bde :=0;_bde < (_bbg -1);
_bde ++{for _ccee :=0;_ccee < (_bbg -1);_ccee ++{var _efef int ;for _gacbf :=0;_gacbf < 2;_gacbf ++{for _acf :=0;_acf < 2;_acf ++{_efef +=_geeb [_bde +_gacbf ][_ccee +_acf ];};};if float64 (_efef )> _eagd {return false ;};};};return true ;};func _cdb (_bfe ,_aaeba *Bitmap ,_abad ,_edge ,_bbcgb ,_fdg ,_fgc int ,_dbab CombinationOperator )error {var _dggc int ;
_cffdb :=func (){_dggc ++;_bbcgb +=_aaeba .RowStride ;_fdg +=_bfe .RowStride ;_fgc +=_bfe .RowStride };for _dggc =_abad ;_dggc < _edge ;_cffdb (){_fede :=_bbcgb ;for _dag :=_fdg ;_dag <=_fgc ;_dag ++{_cbge ,_gdbg :=_aaeba .GetByte (_fede );if _gdbg !=nil {return _gdbg ;
};_cga ,_gdbg :=_bfe .GetByte (_dag );if _gdbg !=nil {return _gdbg ;};if _gdbg =_aaeba .SetByte (_fede ,_abfa (_cbge ,_cga ,_dbab ));_gdbg !=nil {return _gdbg ;};_fede ++;};};return nil ;};func CorrelationScoreThresholded (bm1 ,bm2 *Bitmap ,area1 ,area2 int ,delX ,delY float32 ,maxDiffW ,maxDiffH int ,tab ,downcount []int ,scoreThreshold float32 )(bool ,error ){const _bafb ="C\u006f\u0072\u0072\u0065\u006c\u0061t\u0069\u006f\u006e\u0053\u0063\u006f\u0072\u0065\u0054h\u0072\u0065\u0073h\u006fl\u0064\u0065\u0064";
if bm1 ==nil {return false ,_bc .Error (_bafb ,"\u0063\u006f\u0072\u0072\u0065\u006c\u0061\u0074\u0069\u006f\u006e\u0053\u0063\u006f\u0072\u0065\u0054\u0068\u0072\u0065\u0073\u0068\u006f\u006cd\u0065\u0064\u0020\u0062\u006d1\u0020\u0069s\u0020\u006e\u0069\u006c");
};if bm2 ==nil {return false ,_bc .Error (_bafb ,"\u0063\u006f\u0072\u0072\u0065\u006c\u0061\u0074\u0069\u006f\u006e\u0053\u0063\u006f\u0072\u0065\u0054\u0068\u0072\u0065\u0073\u0068\u006f\u006cd\u0065\u0064\u0020\u0062\u006d2\u0020\u0069s\u0020\u006e\u0069\u006c");
};if area1 <=0||area2 <=0{return false ,_bc .Error (_bafb ,"c\u006f\u0072\u0072\u0065\u006c\u0061\u0074\u0069\u006fn\u0053\u0063\u006f\u0072\u0065\u0054\u0068re\u0073\u0068\u006f\u006cd\u0065\u0064\u0020\u002d\u0020\u0061\u0072\u0065\u0061s \u006d\u0075s\u0074\u0020\u0062\u0065\u0020\u003e\u0020\u0030");
};if downcount ==nil {return false ,_bc .Error (_bafb ,"\u0070\u0072\u006fvi\u0064\u0065\u0064\u0020\u006e\u006f\u0020\u0027\u0064\u006f\u0077\u006e\u0063\u006f\u0075\u006e\u0074\u0027");};if tab ==nil {return false ,_bc .Error (_bafb ,"p\u0072\u006f\u0076\u0069de\u0064 \u006e\u0069\u006c\u0020\u0027s\u0075\u006d\u0074\u0061\u0062\u0027");
};_eegg ,_adce :=bm1 .Width ,bm1 .Height ;_dfcc ,_deb :=bm2 .Width ,bm2 .Height ;if _be .Abs (_eegg -_dfcc )> maxDiffW {return false ,nil ;};if _be .Abs (_adce -_deb )> maxDiffH {return false ,nil ;};_agfe :=int (delX +_be .Sign (delX )*0.5);_bcdd :=int (delY +_be .Sign (delY )*0.5);
_eecad :=int (_c .Ceil (_c .Sqrt (float64 (scoreThreshold )*float64 (area1 )*float64 (area2 ))));_feeeg :=bm2 .RowStride ;_afbd :=_faca (_bcdd ,0);_ceda :=_cecc (_deb +_bcdd ,_adce );_bga :=bm1 .RowStride *_afbd ;_gdaf :=bm2 .RowStride *(_afbd -_bcdd );
var _dcfb int ;if _ceda <=_adce {_dcfb =downcount [_ceda -1];};_ggaf :=_faca (_agfe ,0);_efcfb :=_cecc (_dfcc +_agfe ,_eegg );var _abe ,_bffc int ;if _agfe >=8{_abe =_agfe >>3;_bga +=_abe ;_ggaf -=_abe <<3;_efcfb -=_abe <<3;_agfe &=7;}else if _agfe <=-8{_bffc =-((_agfe +7)>>3);
_gdaf +=_bffc ;_feeeg -=_bffc ;_agfe +=_bffc <<3;};var (_gdcb ,_egbd ,_dgcd int ;_aaabe ,_dbde ,_cbf byte ;);if _ggaf >=_efcfb ||_afbd >=_ceda {return false ,nil ;};_dfgf :=(_efcfb +7)>>3;switch {case _agfe ==0:for _egbd =_afbd ;_egbd < _ceda ;_egbd ,_bga ,_gdaf =_egbd +1,_bga +bm1 .RowStride ,_gdaf +bm2 .RowStride {for _dgcd =0;
_dgcd < _dfgf ;_dgcd ++{_aaabe =bm1 .Data [_bga +_dgcd ]&bm2 .Data [_gdaf +_dgcd ];_gdcb +=tab [_aaabe ];};if _gdcb >=_eecad {return true ,nil ;};if _dea :=_gdcb +downcount [_egbd ]-_dcfb ;_dea < _eecad {return false ,nil ;};};case _agfe > 0&&_feeeg < _dfgf :for _egbd =_afbd ;
_egbd < _ceda ;_egbd ,_bga ,_gdaf =_egbd +1,_bga +bm1 .RowStride ,_gdaf +bm2 .RowStride {_dbde =bm1 .Data [_bga ];_cbf =bm2 .Data [_gdaf ]>>uint (_agfe );_aaabe =_dbde &_cbf ;_gdcb +=tab [_aaabe ];for _dgcd =1;_dgcd < _feeeg ;_dgcd ++{_dbde =bm1 .Data [_bga +_dgcd ];
_cbf =bm2 .Data [_gdaf +_dgcd ]>>uint (_agfe )|bm2 .Data [_gdaf +_dgcd -1]<<uint (8-_agfe );_aaabe =_dbde &_cbf ;_gdcb +=tab [_aaabe ];};_dbde =bm1 .Data [_bga +_dgcd ];_cbf =bm2 .Data [_gdaf +_dgcd -1]<<uint (8-_agfe );_aaabe =_dbde &_cbf ;_gdcb +=tab [_aaabe ];
if _gdcb >=_eecad {return true ,nil ;}else if _gdcb +downcount [_egbd ]-_dcfb < _eecad {return false ,nil ;};};case _agfe > 0&&_feeeg >=_dfgf :for _egbd =_afbd ;_egbd < _ceda ;_egbd ,_bga ,_gdaf =_egbd +1,_bga +bm1 .RowStride ,_gdaf +bm2 .RowStride {_dbde =bm1 .Data [_bga ];
_cbf =bm2 .Data [_gdaf ]>>uint (_agfe );_aaabe =_dbde &_cbf ;_gdcb +=tab [_aaabe ];for _dgcd =1;_dgcd < _dfgf ;_dgcd ++{_dbde =bm1 .Data [_bga +_dgcd ];_cbf =bm2 .Data [_gdaf +_dgcd ]>>uint (_agfe );_cbf |=bm2 .Data [_gdaf +_dgcd -1]<<uint (8-_agfe );_aaabe =_dbde &_cbf ;
_gdcb +=tab [_aaabe ];};if _gdcb >=_eecad {return true ,nil ;}else if _gdcb +downcount [_egbd ]-_dcfb < _eecad {return false ,nil ;};};case _dfgf < _feeeg :for _egbd =_afbd ;_egbd < _ceda ;_egbd ,_bga ,_gdaf =_egbd +1,_bga +bm1 .RowStride ,_gdaf +bm2 .RowStride {for _dgcd =0;
_dgcd < _dfgf ;_dgcd ++{_dbde =bm1 .Data [_bga +_dgcd ];_cbf =bm2 .Data [_gdaf +_dgcd ]<<uint (-_agfe );_cbf |=bm2 .Data [_gdaf +_dgcd +1]>>uint (8+_agfe );_aaabe =_dbde &_cbf ;_gdcb +=tab [_aaabe ];};if _gdcb >=_eecad {return true ,nil ;}else if _feafd :=_gdcb +downcount [_egbd ]-_dcfb ;
_feafd < _eecad {return false ,nil ;};};case _feeeg >=_dfgf :for _egbd =_afbd ;_egbd < _ceda ;_egbd ,_bga ,_gdaf =_egbd +1,_bga +bm1 .RowStride ,_gdaf +bm2 .RowStride {for _dgcd =0;_dgcd < _dfgf ;_dgcd ++{_dbde =bm1 .Data [_bga +_dgcd ];_cbf =bm2 .Data [_gdaf +_dgcd ]<<uint (-_agfe );
_cbf |=bm2 .Data [_gdaf +_dgcd +1]>>uint (8+_agfe );_aaabe =_dbde &_cbf ;_gdcb +=tab [_aaabe ];};_dbde =bm1 .Data [_bga +_dgcd ];_cbf =bm2 .Data [_gdaf +_dgcd ]<<uint (-_agfe );_aaabe =_dbde &_cbf ;_gdcb +=tab [_aaabe ];if _gdcb >=_eecad {return true ,nil ;
}else if _gdcb +downcount [_egbd ]-_dcfb < _eecad {return false ,nil ;};};};_gaca :=float32 (_gdcb )*float32 (_gdcb )/(float32 (area1 )*float32 (area2 ));if _gaca >=scoreThreshold {_gc .Log .Trace ("\u0063\u006f\u0075\u006e\u0074\u003a\u0020\u0025\u0064\u0020\u003c\u0020\u0074\u0068\u0072\u0065\u0073\u0068\u006f\u006cd\u0020\u0025\u0064\u0020\u0062\u0075\u0074\u0020\u0073c\u006f\u0072\u0065\u0020\u0025\u0066\u0020\u003e\u003d\u0020\u0073\u0063\u006fr\u0065\u0054\u0068\u0072\u0065\u0073h\u006f\u006c\u0064 \u0025\u0066",_gdcb ,_eecad ,_gaca ,scoreThreshold );
};return false ,nil ;};func Dilate (d *Bitmap ,s *Bitmap ,sel *Selection )(*Bitmap ,error ){return _bgdb (d ,s ,sel )};var _ebgd [256]uint8 ;func (_gfgcg *ClassedPoints )Swap (i ,j int ){_gfgcg .IntSlice [i ],_gfgcg .IntSlice [j ]=_gfgcg .IntSlice [j ],_gfgcg .IntSlice [i ];
};const (AsymmetricMorphBC BoundaryCondition =iota ;SymmetricMorphBC ;);func Extract (roi _ag .Rectangle ,src *Bitmap )(*Bitmap ,error ){_cgba :=New (roi .Dx (),roi .Dy ());_cbdf :=roi .Min .X &0x07;_bcea :=8-_cbdf ;_fbde :=uint (8-_cgba .Width &0x07);
_cdea :=src .GetByteIndex (roi .Min .X ,roi .Min .Y );_daaef :=src .GetByteIndex (roi .Max .X -1,roi .Min .Y );_gede :=_cgba .RowStride ==_daaef +1-_cdea ;var _afce int ;for _dcd :=roi .Min .Y ;_dcd < roi .Max .Y ;_dcd ++{_efag :=_cdea ;_cega :=_afce ;
switch {case _cdea ==_daaef :_gfff ,_eggc :=src .GetByte (_efag );if _eggc !=nil {return nil ,_eggc ;};_gfff <<=uint (_cbdf );_eggc =_cgba .SetByte (_cega ,_edee (_fbde ,_gfff ));if _eggc !=nil {return nil ,_eggc ;};case _cbdf ==0:for _gcdg :=_cdea ;_gcdg <=_daaef ;
_gcdg ++{_ebgc ,_bcca :=src .GetByte (_efag );if _bcca !=nil {return nil ,_bcca ;};_efag ++;if _gcdg ==_daaef &&_gede {_ebgc =_edee (_fbde ,_ebgc );};_bcca =_cgba .SetByte (_cega ,_ebgc );if _bcca !=nil {return nil ,_bcca ;};_cega ++;};default:_eafc :=_bgcf (src ,_cgba ,uint (_cbdf ),uint (_bcea ),_fbde ,_cdea ,_daaef ,_gede ,_efag ,_cega );
if _eafc !=nil {return nil ,_eafc ;};};_cdea +=src .RowStride ;_daaef +=src .RowStride ;_afce +=_cgba .RowStride ;};return _cgba ,nil ;};type MorphProcess struct{Operation MorphOperation ;Arguments []int ;};func (_fcb *Bitmap )And (s *Bitmap )(_afg *Bitmap ,_ecae error ){const _gfb ="\u0042\u0069\u0074\u006d\u0061\u0070\u002e\u0041\u006e\u0064";
if _fcb ==nil {return nil ,_bc .Error (_gfb ,"\u0027b\u0069t\u006d\u0061\u0070\u0020\u0027b\u0027\u0020i\u0073\u0020\u006e\u0069\u006c");};if s ==nil {return nil ,_bc .Error (_gfb ,"\u0062\u0069\u0074\u006d\u0061\u0070\u0020\u0027\u0073\u0027\u0020\u0069s\u0020\u006e\u0069\u006c");
};if !_fcb .SizesEqual (s ){_gc .Log .Debug ("\u0025\u0073\u0020-\u0020\u0042\u0069\u0074\u006d\u0061\u0070\u0020\u0027\u0073\u0027\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u0065\u0071\u0075\u0061\u006c\u0020\u0073\u0069\u007a\u0065 \u0077\u0069\u0074\u0068\u0020\u0027\u0062\u0027",_gfb );
};if _afg ,_ecae =_ffdb (_afg ,_fcb );_ecae !=nil {return nil ,_bc .Wrap (_ecae ,_gfb ,"\u0063\u0061\u006e't\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0027\u0064\u0027\u0020\u0062\u0069\u0074\u006d\u0061\u0070");};if _ecae =_afg .RasterOperation (0,0,_afg .Width ,_afg .Height ,PixSrcAndDst ,s ,0,0);
_ecae !=nil {return nil ,_bc .Wrap (_ecae ,_gfb ,"");};return _afg ,nil ;};const _aaad =5000;func TstPSymbol (t *_d .T )*Bitmap {t .Helper ();_gfad :=New (5,8);_f .NoError (t ,_gfad .SetPixel (0,0,1));_f .NoError (t ,_gfad .SetPixel (1,0,1));_f .NoError (t ,_gfad .SetPixel (2,0,1));
_f .NoError (t ,_gfad .SetPixel (3,0,1));_f .NoError (t ,_gfad .SetPixel (4,1,1));_f .NoError (t ,_gfad .SetPixel (0,1,1));_f .NoError (t ,_gfad .SetPixel (4,2,1));_f .NoError (t ,_gfad .SetPixel (0,2,1));_f .NoError (t ,_gfad .SetPixel (4,3,1));_f .NoError (t ,_gfad .SetPixel (0,3,1));
_f .NoError (t ,_gfad .SetPixel (0,4,1));_f .NoError (t ,_gfad .SetPixel (1,4,1));_f .NoError (t ,_gfad .SetPixel (2,4,1));_f .NoError (t ,_gfad .SetPixel (3,4,1));_f .NoError (t ,_gfad .SetPixel (0,5,1));_f .NoError (t ,_gfad .SetPixel (0,6,1));_f .NoError (t ,_gfad .SetPixel (0,7,1));
return _gfad ;};func (_bafag *Bitmaps )selectByIndicator (_gabf *_be .NumSlice )(_cgbf *Bitmaps ,_dabc error ){const _gbga ="\u0042i\u0074\u006d\u0061\u0070s\u002e\u0073\u0065\u006c\u0065c\u0074B\u0079I\u006e\u0064\u0069\u0063\u0061\u0074\u006fr";if _bafag ==nil {return nil ,_bc .Error (_gbga ,"\u0027\u0062\u0027 b\u0069\u0074\u006d\u0061\u0070\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};if _gabf ==nil {return nil ,_bc .Error (_gbga ,"'\u006e\u0061\u0027\u0020\u0069\u006ed\u0069\u0063\u0061\u0074\u006f\u0072\u0073\u0020\u006eo\u0074\u0020\u0064e\u0066i\u006e\u0065\u0064");};if len (_bafag .Values )==0{return _bafag ,nil ;};if len (*_gabf )!=len (_bafag .Values ){return nil ,_bc .Errorf (_gbga ,"\u006ea\u0020\u006ce\u006e\u0067\u0074\u0068:\u0020\u0025\u0064,\u0020\u0069\u0073\u0020\u0064\u0069\u0066\u0066\u0065re\u006e\u0074\u0020t\u0068\u0061n\u0020\u0062\u0069\u0074\u006d\u0061p\u0073\u003a \u0025\u0064",len (*_gabf ),len (_bafag .Values ));
};var _egeb ,_adedb ,_ccfe int ;for _adedb =0;_adedb < len (*_gabf );_adedb ++{if _egeb ,_dabc =_gabf .GetInt (_adedb );_dabc !=nil {return nil ,_bc .Wrap (_dabc ,_gbga ,"f\u0069\u0072\u0073\u0074\u0020\u0063\u0068\u0065\u0063\u006b");};if _egeb ==1{_ccfe ++;
};};if _ccfe ==len (_bafag .Values ){return _bafag ,nil ;};_cgbf =&Bitmaps {};_dfbb :=len (_bafag .Values )==len (_bafag .Boxes );for _adedb =0;_adedb < len (*_gabf );_adedb ++{if _egeb =int ((*_gabf )[_adedb ]);_egeb ==0{continue ;};_cgbf .Values =append (_cgbf .Values ,_bafag .Values [_adedb ]);
if _dfbb {_cgbf .Boxes =append (_cgbf .Boxes ,_bafag .Boxes [_adedb ]);};};return _cgbf ,nil ;};var _gdfa =[]byte {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3E,0x78,0x27,0xC2,0x27,0x91,0x00,0x22,0x48,0x21,0x03,0x24,0x91,0x00,0x22,0x48,0x21,0x02,0xA4,0x95,0x00,0x22,0x48,0x21,0x02,0x64,0x9B,0x00,0x3C,0x78,0x21,0x02,0x27,0x91,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0xF8,0x00,0x00,0x00,0x00,0x00,0x7F,0xF8,0x00,0x00,0x00,0x00,0x00,0x63,0x18,0x00,0x00,0x00,0x00,0x00,0x63,0x18,0x00,0x00,0x00,0x00,0x00,0x63,0x18,0x00,0x00,0x00,0x00,0x00,0x7F,0xF8,0x00,0x00,0x00,0x00,0x00,0x15,0x50,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
func (_bebef Points )GetIntY (i int )(int ,error ){if i >=len (_bebef ){return 0,_bc .Errorf ("\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047\u0065t\u0049\u006e\u0074\u0059","\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};return int (_bebef [i ].Y ),nil ;};func _cbebg (_baaae ,_gaadf int ,_gaed string )*Selection {_ddbba :=&Selection {Height :_baaae ,Width :_gaadf ,Name :_gaed };_ddbba .Data =make ([][]SelectionValue ,_baaae );for _gacfgd :=0;_gacfgd < _baaae ;_gacfgd ++{_ddbba .Data [_gacfgd ]=make ([]SelectionValue ,_gaadf );
};return _ddbba ;};type ClassedPoints struct{*Points ;_be .IntSlice ;_bcbcb func (_fgb ,_bfd int )bool ;};func (_gdbc *Bitmap )SetPadBits (value int ){_gdbc .setPadBits (value )};type SizeSelection int ;func (_acba *Bitmap )ClipRectangle (box *_ag .Rectangle )(_fbf *Bitmap ,_cebg *_ag .Rectangle ,_gfde error ){const _cfde ="\u0043\u006c\u0069\u0070\u0052\u0065\u0063\u0074\u0061\u006e\u0067\u006c\u0065";
if box ==nil {return nil ,nil ,_bc .Error (_cfde ,"\u0062o\u0078 \u0069\u0073\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");};_aaaa ,_dcc :=_acba .Width ,_acba .Height ;_bcfd :=_ag .Rect (0,0,_aaaa ,_dcc );if !box .Overlaps (_bcfd ){return nil ,nil ,_bc .Error (_cfde ,"b\u006f\u0078\u0020\u0064oe\u0073n\u0027\u0074\u0020\u006f\u0076e\u0072\u006c\u0061\u0070\u0020\u0062");
};_daa :=box .Intersect (_bcfd );_bcdc ,_gabb :=_daa .Min .X ,_daa .Min .Y ;_dgg ,_eaa :=_daa .Dx (),_daa .Dy ();_fbf =New (_dgg ,_eaa );_fbf .Text =_acba .Text ;if _gfde =_fbf .RasterOperation (0,0,_dgg ,_eaa ,PixSrc ,_acba ,_bcdc ,_gabb );_gfde !=nil {return nil ,nil ,_bc .Wrap (_gfde ,_cfde ,"\u0050\u0069\u0078\u0053\u0072\u0063\u0020\u0074\u006f\u0020\u0063\u006ci\u0070\u0070\u0065\u0064");
};_cebg =&_daa ;return _fbf ,_cebg ,nil ;};func TstWSymbol (t *_d .T ,scale ...int )*Bitmap {_bfdg ,_cacfg :=NewWithData (5,5,[]byte {0x88,0x88,0xA8,0xD8,0x88});_f .NoError (t ,_cacfg );return TstGetScaledSymbol (t ,_bfdg ,scale ...);};func (_ddfb *byHeight )Swap (i ,j int ){_ddfb .Values [i ],_ddfb .Values [j ]=_ddfb .Values [j ],_ddfb .Values [i ];
if _ddfb .Boxes !=nil {_ddfb .Boxes [i ],_ddfb .Boxes [j ]=_ddfb .Boxes [j ],_ddfb .Boxes [i ];};};func _ggf (_efe *Bitmap ,_afc ...int )(_ddd *Bitmap ,_cfa error ){const _ffd ="\u0072\u0065\u0064uc\u0065\u0052\u0061\u006e\u006b\u0042\u0069\u006e\u0061\u0072\u0079\u0043\u0061\u0073\u0063\u0061\u0064\u0065";
if _efe ==nil {return nil ,_bc .Error (_ffd ,"\u0073o\u0075\u0072\u0063\u0065 \u0062\u0069\u0074\u006d\u0061p\u0020n\u006ft\u0020\u0064\u0065\u0066\u0069\u006e\u0065d");};if len (_afc )==0||len (_afc )> 4{return nil ,_bc .Error (_ffd ,"t\u0068\u0065\u0072\u0065\u0020\u006d\u0075\u0073\u0074 \u0062\u0065\u0020\u0061\u0074\u0020\u006cea\u0073\u0074\u0020\u006fn\u0065\u0020\u0061\u006e\u0064\u0020\u0061\u0074\u0020mo\u0073\u0074 \u0034\u0020\u006c\u0065\u0076\u0065\u006c\u0073");
};if _afc [0]<=0{_gc .Log .Debug ("\u006c\u0065\u0076\u0065\u006c\u0031\u0020\u003c\u003d\u0020\u0030 \u002d\u0020\u006e\u006f\u0020\u0072\u0065\u0064\u0075\u0063t\u0069\u006f\u006e");_ddd ,_cfa =_ffdb (nil ,_efe );if _cfa !=nil {return nil ,_bc .Wrap (_cfa ,_ffd ,"l\u0065\u0076\u0065\u006c\u0031\u0020\u003c\u003d\u0020\u0030");
};return _ddd ,nil ;};_baf :=_gdd ();_ddd =_efe ;for _geb ,_fgg :=range _afc {if _fgg <=0{break ;};_ddd ,_cfa =_acb (_ddd ,_fgg ,_baf );if _cfa !=nil {return nil ,_bc .Wrapf (_cfa ,_ffd ,"\u006c\u0065\u0076\u0065\u006c\u0025\u0064\u0020\u0072\u0065\u0064\u0075c\u0074\u0069\u006f\u006e",_geb );
};};return _ddd ,nil ;};func (_dcaf *Bitmap )String ()string {var _aecg ="\u000a";for _afge :=0;_afge < _dcaf .Height ;_afge ++{var _abfg string ;for _dga :=0;_dga < _dcaf .Width ;_dga ++{_dbc :=_dcaf .GetPixel (_dga ,_afge );if _dbc {_abfg +="\u0031";
}else {_abfg +="\u0030";};};_aecg +=_abfg +"\u000a";};return _aecg ;};func _dac (_egg ,_bcd int )*Bitmap {return &Bitmap {Width :_egg ,Height :_bcd ,RowStride :(_egg +7)>>3};};func _cc (_cbe ,_ae *Bitmap )(_ea error ){const _eg ="\u0065\u0078\u0070\u0061nd\u0042\u0069\u006e\u0061\u0072\u0079\u0046\u0061\u0063\u0074\u006f\u0072\u0034";
_gab :=_ae .RowStride ;_fde :=_cbe .RowStride ;_ega :=_ae .RowStride *4-_cbe .RowStride ;var (_fg ,_ee byte ;_gca uint32 ;_de ,_ac ,_ead ,_ca ,_gfg ,_dbf ,_gfgg int ;);for _ead =0;_ead < _ae .Height ;_ead ++{_de =_ead *_gab ;_ac =4*_ead *_fde ;for _ca =0;
_ca < _gab ;_ca ++{_fg =_ae .Data [_de +_ca ];_gca =_dbcg [_fg ];_dbf =_ac +_ca *4;if _ega !=0&&(_ca +1)*4> _cbe .RowStride {for _gfg =_ega ;_gfg > 0;_gfg --{_ee =byte ((_gca >>uint (_gfg *8))&0xff);_gfgg =_dbf +(_ega -_gfg );if _ea =_cbe .SetByte (_gfgg ,_ee );
_ea !=nil {return _bc .Wrapf (_ea ,_eg ,"D\u0069\u0066\u0066\u0065\u0072\u0065n\u0074\u0020\u0072\u006f\u0077\u0073\u0074\u0072\u0069d\u0065\u0073\u002e \u004b:\u0020\u0025\u0064",_gfg );};};}else if _ea =_cbe .setFourBytes (_dbf ,_gca );_ea !=nil {return _bc .Wrap (_ea ,_eg ,"");
};if _ea =_cbe .setFourBytes (_ac +_ca *4,_dbcg [_ae .Data [_de +_ca ]]);_ea !=nil {return _bc .Wrap (_ea ,_eg ,"");};};for _gfg =1;_gfg < 4;_gfg ++{for _ca =0;_ca < _fde ;_ca ++{if _ea =_cbe .SetByte (_ac +_gfg *_fde +_ca ,_cbe .Data [_ac +_ca ]);_ea !=nil {return _bc .Wrapf (_ea ,_eg ,"\u0063\u006f\u0070\u0079\u0020\u0027\u0071\u0075\u0061\u0064\u0072\u0061\u0062l\u0065\u0027\u0020\u006c\u0069\u006ee\u003a\u0020\u0027\u0025\u0064\u0027\u002c\u0020\u0062\u0079\u0074\u0065\u003a \u0027\u0025\u0064\u0027",_gfg ,_ca );
};};};};return nil ;};func (_feed *Bitmap )clipRectangle (_bbae ,_gce *_ag .Rectangle )(_agcd *Bitmap ,_gdc error ){const _aafc ="\u0063\u006c\u0069\u0070\u0052\u0065\u0063\u0074\u0061\u006e\u0067\u006c\u0065";if _bbae ==nil {return nil ,_bc .Error (_aafc ,"\u0070r\u006fv\u0069\u0064\u0065\u0064\u0020n\u0069\u006c \u0027\u0062\u006f\u0078\u0027");
};_ged ,_gacg :=_feed .Width ,_feed .Height ;_acag ,_gdc :=ClipBoxToRectangle (_bbae ,_ged ,_gacg );if _gdc !=nil {_gc .Log .Warning ("\u0027\u0062ox\u0027\u0020\u0064o\u0065\u0073\u006e\u0027t o\u0076er\u006c\u0061\u0070\u0020\u0062\u0069\u0074ma\u0070\u0020\u0027\u0062\u0027\u003a\u0020%\u0076",_gdc );
return nil ,nil ;};_bdb ,_fcbd :=_acag .Min .X ,_acag .Min .Y ;_fcg ,_cdc :=_acag .Max .X -_acag .Min .X ,_acag .Max .Y -_acag .Min .Y ;_agcd =New (_fcg ,_cdc );_agcd .Text =_feed .Text ;if _gdc =_agcd .RasterOperation (0,0,_fcg ,_cdc ,PixSrc ,_feed ,_bdb ,_fcbd );
_gdc !=nil {return nil ,_bc .Wrap (_gdc ,_aafc ,"");};if _gce !=nil {*_gce =*_acag ;};return _agcd ,nil ;};func (_fddf *Bitmap )GetBitOffset (x int )int {return x &0x07};var (_bded =_gac ();_dbcg =_abdg ();_caee =_eadd (););func TstISymbol (t *_d .T ,scale ...int )*Bitmap {_gfgaa ,_cfgb :=NewWithData (1,5,[]byte {0x80,0x80,0x80,0x80,0x80});
_f .NoError (t ,_cfgb );return TstGetScaledSymbol (t ,_gfgaa ,scale ...);};func _gdd ()(_abdc []byte ){_abdc =make ([]byte ,256);for _edd :=0;_edd < 256;_edd ++{_eca :=byte (_edd );_abdc [_eca ]=(_eca &0x01)|((_eca &0x04)>>1)|((_eca &0x10)>>2)|((_eca &0x40)>>3)|((_eca &0x02)<<3)|((_eca &0x08)<<2)|((_eca &0x20)<<1)|(_eca &0x80);
};return _abdc ;};func Copy (d ,s *Bitmap )(*Bitmap ,error ){return _ffdb (d ,s )};func (_fdebd *Bitmap )setTwoBytes (_dbfd int ,_ccdaa uint16 )error {if _dbfd +1> len (_fdebd .Data )-1{return _bc .Errorf ("s\u0065\u0074\u0054\u0077\u006f\u0042\u0079\u0074\u0065\u0073","\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",_dbfd );
};_fdebd .Data [_dbfd ]=byte ((_ccdaa &0xff00)>>8);_fdebd .Data [_dbfd +1]=byte (_ccdaa &0xff);return nil ;};func (_cdgd Points )GetIntX (i int )(int ,error ){if i >=len (_cdgd ){return 0,_bc .Errorf ("\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047\u0065t\u0049\u006e\u0074\u0058","\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};return int (_cdgd [i ].X ),nil ;};func TstCSymbol (t *_d .T )*Bitmap {t .Helper ();_aabe :=New (6,6);_f .NoError (t ,_aabe .SetPixel (1,0,1));_f .NoError (t ,_aabe .SetPixel (2,0,1));_f .NoError (t ,_aabe .SetPixel (3,0,1));_f .NoError (t ,_aabe .SetPixel (4,0,1));
_f .NoError (t ,_aabe .SetPixel (0,1,1));_f .NoError (t ,_aabe .SetPixel (5,1,1));_f .NoError (t ,_aabe .SetPixel (0,2,1));_f .NoError (t ,_aabe .SetPixel (0,3,1));_f .NoError (t ,_aabe .SetPixel (0,4,1));_f .NoError (t ,_aabe .SetPixel (5,4,1));_f .NoError (t ,_aabe .SetPixel (1,5,1));
_f .NoError (t ,_aabe .SetPixel (2,5,1));_f .NoError (t ,_aabe .SetPixel (3,5,1));_f .NoError (t ,_aabe .SetPixel (4,5,1));return _aabe ;};func _ecgg (_gcea *Bitmap ,_aaeg *_be .Stack ,_bafd ,_ddgdg int )(_fdfg *_ag .Rectangle ,_gfae error ){const _abae ="\u0073e\u0065d\u0046\u0069\u006c\u006c\u0053\u0074\u0061\u0063\u006b\u0042\u0042";
if _gcea ==nil {return nil ,_bc .Error (_abae ,"\u0070\u0072\u006fvi\u0064\u0065\u0064\u0020\u006e\u0069\u006c\u0020\u0027\u0073\u0027\u0020\u0042\u0069\u0074\u006d\u0061\u0070");};if _aaeg ==nil {return nil ,_bc .Error (_abae ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0027\u0073\u0074ac\u006b\u0027");
};_bdbc ,_gaga :=_gcea .Width ,_gcea .Height ;_dadf :=_bdbc -1;_agbdfe :=_gaga -1;if _bafd < 0||_bafd > _dadf ||_ddgdg < 0||_ddgdg > _agbdfe ||!_gcea .GetPixel (_bafd ,_ddgdg ){return nil ,nil ;};_acgfc :=_ag .Rect (100000,100000,0,0);if _gfae =_ababa (_aaeg ,_bafd ,_bafd ,_ddgdg ,1,_agbdfe ,&_acgfc );
_gfae !=nil {return nil ,_bc .Wrap (_gfae ,_abae ,"\u0069\u006e\u0069t\u0069\u0061\u006c\u0020\u0070\u0075\u0073\u0068");};if _gfae =_ababa (_aaeg ,_bafd ,_bafd ,_ddgdg +1,-1,_agbdfe ,&_acgfc );_gfae !=nil {return nil ,_bc .Wrap (_gfae ,_abae ,"\u0032\u006ed\u0020\u0069\u006ei\u0074\u0069\u0061\u006c\u0020\u0070\u0075\u0073\u0068");
};_acgfc .Min .X ,_acgfc .Max .X =_bafd ,_bafd ;_acgfc .Min .Y ,_acgfc .Max .Y =_ddgdg ,_ddgdg ;var (_gabc *fillSegment ;_bfgd int ;);for _aaeg .Len ()> 0{if _gabc ,_gfae =_gfaf (_aaeg );_gfae !=nil {return nil ,_bc .Wrap (_gfae ,_abae ,"");};_ddgdg =_gabc ._cfge ;
for _bafd =_gabc ._ccce -1;_bafd >=0&&_gcea .GetPixel (_bafd ,_ddgdg );_bafd --{if _gfae =_gcea .SetPixel (_bafd ,_ddgdg ,0);_gfae !=nil {return nil ,_bc .Wrap (_gfae ,_abae ,"\u0031s\u0074\u0020\u0073\u0065\u0074");};};if _bafd >=_gabc ._ccce -1{for {for _bafd ++;
_bafd <=_gabc ._dbdb +1&&_bafd <=_dadf &&!_gcea .GetPixel (_bafd ,_ddgdg );_bafd ++{};_bfgd =_bafd ;if _bafd > _gabc ._dbdb +1||_bafd > _dadf {break ;};for ;_bafd <=_dadf &&_gcea .GetPixel (_bafd ,_ddgdg );_bafd ++{if _gfae =_gcea .SetPixel (_bafd ,_ddgdg ,0);
_gfae !=nil {return nil ,_bc .Wrap (_gfae ,_abae ,"\u0032n\u0064\u0020\u0073\u0065\u0074");};};if _gfae =_ababa (_aaeg ,_bfgd ,_bafd -1,_gabc ._cfge ,_gabc ._dbdg ,_agbdfe ,&_acgfc );_gfae !=nil {return nil ,_bc .Wrap (_gfae ,_abae ,"n\u006f\u0072\u006d\u0061\u006c\u0020\u0070\u0075\u0073\u0068");
};if _bafd > _gabc ._dbdb {if _gfae =_ababa (_aaeg ,_gabc ._dbdb +1,_bafd -1,_gabc ._cfge ,-_gabc ._dbdg ,_agbdfe ,&_acgfc );_gfae !=nil {return nil ,_bc .Wrap (_gfae ,_abae ,"\u006ce\u0061k\u0020\u006f\u006e\u0020\u0072i\u0067\u0068t\u0020\u0073\u0069\u0064\u0065");
};};};continue ;};_bfgd =_bafd +1;if _bfgd < _gabc ._ccce {if _gfae =_ababa (_aaeg ,_bfgd ,_gabc ._ccce -1,_gabc ._cfge ,-_gabc ._dbdg ,_agbdfe ,&_acgfc );_gfae !=nil {return nil ,_bc .Wrap (_gfae ,_abae ,"\u006c\u0065\u0061\u006b\u0020\u006f\u006e\u0020\u006c\u0065\u0066\u0074 \u0073\u0069\u0064\u0065");
};};_bafd =_gabc ._ccce ;for {for ;_bafd <=_dadf &&_gcea .GetPixel (_bafd ,_ddgdg );_bafd ++{if _gfae =_gcea .SetPixel (_bafd ,_ddgdg ,0);_gfae !=nil {return nil ,_bc .Wrap (_gfae ,_abae ,"\u0032n\u0064\u0020\u0073\u0065\u0074");};};if _gfae =_ababa (_aaeg ,_bfgd ,_bafd -1,_gabc ._cfge ,_gabc ._dbdg ,_agbdfe ,&_acgfc );
_gfae !=nil {return nil ,_bc .Wrap (_gfae ,_abae ,"n\u006f\u0072\u006d\u0061\u006c\u0020\u0070\u0075\u0073\u0068");};if _bafd > _gabc ._dbdb {if _gfae =_ababa (_aaeg ,_gabc ._dbdb +1,_bafd -1,_gabc ._cfge ,-_gabc ._dbdg ,_agbdfe ,&_acgfc );_gfae !=nil {return nil ,_bc .Wrap (_gfae ,_abae ,"\u006ce\u0061k\u0020\u006f\u006e\u0020\u0072i\u0067\u0068t\u0020\u0073\u0069\u0064\u0065");
};};for _bafd ++;_bafd <=_gabc ._dbdb +1&&_bafd <=_dadf &&!_gcea .GetPixel (_bafd ,_ddgdg );_bafd ++{};_bfgd =_bafd ;if _bafd > _gabc ._dbdb +1||_bafd > _dadf {break ;};};};_acgfc .Max .X ++;_acgfc .Max .Y ++;return &_acgfc ,nil ;};func (_dge *Bitmap )SetPixel (x ,y int ,pixel byte )error {_cda :=_dge .GetByteIndex (x ,y );
if _cda > len (_dge .Data )-1{return _bc .Errorf ("\u0053\u0065\u0074\u0050\u0069\u0078\u0065\u006c","\u0069\u006e\u0064\u0065x \u006f\u0075\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065\u003a\u0020%\u0064",_cda );};_gea :=_dge .GetBitOffset (x );
_agcb :=uint (7-_gea );_bba :=_dge .Data [_cda ];var _aadd byte ;if pixel ==1{_aadd =_bba |(pixel &0x01<<_agcb );}else {_aadd =_bba &^(1<<_agcb );};_dge .Data [_cda ]=_aadd ;return nil ;};func _ebde (_agad *Bitmap ,_ddgdd *_be .Stack ,_ggaa ,_dbcd ,_bdbbc int )(_fbgd *_ag .Rectangle ,_fcda error ){const _aacde ="\u0073e\u0065d\u0046\u0069\u006c\u006c\u0053\u0074\u0061\u0063\u006b\u0042\u0042";
if _agad ==nil {return nil ,_bc .Error (_aacde ,"\u0070\u0072\u006fvi\u0064\u0065\u0064\u0020\u006e\u0069\u006c\u0020\u0027\u0073\u0027\u0020\u0042\u0069\u0074\u006d\u0061\u0070");};if _ddgdd ==nil {return nil ,_bc .Error (_aacde ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0027\u0073\u0074ac\u006b\u0027");
};switch _bdbbc {case 4:if _fbgd ,_fcda =_aadcb (_agad ,_ddgdd ,_ggaa ,_dbcd );_fcda !=nil {return nil ,_bc .Wrap (_fcda ,_aacde ,"");};return _fbgd ,nil ;case 8:if _fbgd ,_fcda =_ecgg (_agad ,_ddgdd ,_ggaa ,_dbcd );_fcda !=nil {return nil ,_bc .Wrap (_fcda ,_aacde ,"");
};return _fbgd ,nil ;default:return nil ,_bc .Errorf (_aacde ,"\u0063\u006f\u006e\u006e\u0065\u0063\u0074\u0069\u0076\u0069\u0074\u0079\u0020\u0069\u0073 \u006eo\u0074\u0020\u0034\u0020\u006f\u0072\u0020\u0038\u003a\u0020\u0027\u0025\u0064\u0027",_bdbbc );
};};func _fbbd (_agea *Bitmap ,_dagb ,_gec ,_bdaa ,_effb int ,_gdae RasterOperator ,_bffa *Bitmap ,_bacb ,_cggff int )error {var (_fafbg bool ;_aeca bool ;_cdgc int ;_dgac int ;_bbbb int ;_fbce bool ;_ecfgf byte ;_dbdc int ;_gde int ;_cfae int ;_ccbb ,_ddbbfg int ;
);_eafd :=8-(_dagb &7);_fabe :=_fag [_eafd ];_gfbg :=_agea .RowStride *_gec +(_dagb >>3);_dfda :=_bffa .RowStride *_cggff +(_bacb >>3);if _bdaa < _eafd {_fafbg =true ;_fabe &=_dcfg [8-_eafd +_bdaa ];};if !_fafbg {_cdgc =(_bdaa -_eafd )>>3;if _cdgc > 0{_aeca =true ;
_dgac =_gfbg +1;_bbbb =_dfda +1;};};_dbdc =(_dagb +_bdaa )&7;if !_fafbg &&_dbdc !=0{_fbce =true ;_ecfgf =_dcfg [_dbdc ];_gde =_gfbg +1+_cdgc ;_cfae =_dfda +1+_cdgc ;};switch _gdae {case PixSrc :for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gfbg ]=_bdfed (_agea .Data [_gfbg ],_bffa .Data [_dfda ],_fabe );
_gfbg +=_agea .RowStride ;_dfda +=_bffa .RowStride ;};if _aeca {for _ccbb =0;_ccbb < _effb ;_ccbb ++{for _ddbbfg =0;_ddbbfg < _cdgc ;_ddbbfg ++{_agea .Data [_dgac +_ddbbfg ]=_bffa .Data [_bbbb +_ddbbfg ];};_dgac +=_agea .RowStride ;_bbbb +=_bffa .RowStride ;
};};if _fbce {for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gde ]=_bdfed (_agea .Data [_gde ],_bffa .Data [_cfae ],_ecfgf );_gde +=_agea .RowStride ;_cfae +=_bffa .RowStride ;};};case PixNotSrc :for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gfbg ]=_bdfed (_agea .Data [_gfbg ],^_bffa .Data [_dfda ],_fabe );
_gfbg +=_agea .RowStride ;_dfda +=_bffa .RowStride ;};if _aeca {for _ccbb =0;_ccbb < _effb ;_ccbb ++{for _ddbbfg =0;_ddbbfg < _cdgc ;_ddbbfg ++{_agea .Data [_dgac +_ddbbfg ]=^_bffa .Data [_bbbb +_ddbbfg ];};_dgac +=_agea .RowStride ;_bbbb +=_bffa .RowStride ;
};};if _fbce {for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gde ]=_bdfed (_agea .Data [_gde ],^_bffa .Data [_cfae ],_ecfgf );_gde +=_agea .RowStride ;_cfae +=_bffa .RowStride ;};};case PixSrcOrDst :for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gfbg ]=_bdfed (_agea .Data [_gfbg ],_bffa .Data [_dfda ]|_agea .Data [_gfbg ],_fabe );
_gfbg +=_agea .RowStride ;_dfda +=_bffa .RowStride ;};if _aeca {for _ccbb =0;_ccbb < _effb ;_ccbb ++{for _ddbbfg =0;_ddbbfg < _cdgc ;_ddbbfg ++{_agea .Data [_dgac +_ddbbfg ]|=_bffa .Data [_bbbb +_ddbbfg ];};_dgac +=_agea .RowStride ;_bbbb +=_bffa .RowStride ;
};};if _fbce {for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gde ]=_bdfed (_agea .Data [_gde ],_bffa .Data [_cfae ]|_agea .Data [_gde ],_ecfgf );_gde +=_agea .RowStride ;_cfae +=_bffa .RowStride ;};};case PixSrcAndDst :for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gfbg ]=_bdfed (_agea .Data [_gfbg ],_bffa .Data [_dfda ]&_agea .Data [_gfbg ],_fabe );
_gfbg +=_agea .RowStride ;_dfda +=_bffa .RowStride ;};if _aeca {for _ccbb =0;_ccbb < _effb ;_ccbb ++{for _ddbbfg =0;_ddbbfg < _cdgc ;_ddbbfg ++{_agea .Data [_dgac +_ddbbfg ]&=_bffa .Data [_bbbb +_ddbbfg ];};_dgac +=_agea .RowStride ;_bbbb +=_bffa .RowStride ;
};};if _fbce {for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gde ]=_bdfed (_agea .Data [_gde ],_bffa .Data [_cfae ]&_agea .Data [_gde ],_ecfgf );_gde +=_agea .RowStride ;_cfae +=_bffa .RowStride ;};};case PixSrcXorDst :for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gfbg ]=_bdfed (_agea .Data [_gfbg ],_bffa .Data [_dfda ]^_agea .Data [_gfbg ],_fabe );
_gfbg +=_agea .RowStride ;_dfda +=_bffa .RowStride ;};if _aeca {for _ccbb =0;_ccbb < _effb ;_ccbb ++{for _ddbbfg =0;_ddbbfg < _cdgc ;_ddbbfg ++{_agea .Data [_dgac +_ddbbfg ]^=_bffa .Data [_bbbb +_ddbbfg ];};_dgac +=_agea .RowStride ;_bbbb +=_bffa .RowStride ;
};};if _fbce {for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gde ]=_bdfed (_agea .Data [_gde ],_bffa .Data [_cfae ]^_agea .Data [_gde ],_ecfgf );_gde +=_agea .RowStride ;_cfae +=_bffa .RowStride ;};};case PixNotSrcOrDst :for _ccbb =0;_ccbb < _effb ;
_ccbb ++{_agea .Data [_gfbg ]=_bdfed (_agea .Data [_gfbg ],^(_bffa .Data [_dfda ])|_agea .Data [_gfbg ],_fabe );_gfbg +=_agea .RowStride ;_dfda +=_bffa .RowStride ;};if _aeca {for _ccbb =0;_ccbb < _effb ;_ccbb ++{for _ddbbfg =0;_ddbbfg < _cdgc ;_ddbbfg ++{_agea .Data [_dgac +_ddbbfg ]|=^(_bffa .Data [_bbbb +_ddbbfg ]);
};_dgac +=_agea .RowStride ;_bbbb +=_bffa .RowStride ;};};if _fbce {for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gde ]=_bdfed (_agea .Data [_gde ],^(_bffa .Data [_cfae ])|_agea .Data [_gde ],_ecfgf );_gde +=_agea .RowStride ;_cfae +=_bffa .RowStride ;
};};case PixNotSrcAndDst :for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gfbg ]=_bdfed (_agea .Data [_gfbg ],^(_bffa .Data [_dfda ])&_agea .Data [_gfbg ],_fabe );_gfbg +=_agea .RowStride ;_dfda +=_bffa .RowStride ;};if _aeca {for _ccbb =0;_ccbb < _effb ;
_ccbb ++{for _ddbbfg =0;_ddbbfg < _cdgc ;_ddbbfg ++{_agea .Data [_dgac +_ddbbfg ]&=^_bffa .Data [_bbbb +_ddbbfg ];};_dgac +=_agea .RowStride ;_bbbb +=_bffa .RowStride ;};};if _fbce {for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gde ]=_bdfed (_agea .Data [_gde ],^(_bffa .Data [_cfae ])&_agea .Data [_gde ],_ecfgf );
_gde +=_agea .RowStride ;_cfae +=_bffa .RowStride ;};};case PixSrcOrNotDst :for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gfbg ]=_bdfed (_agea .Data [_gfbg ],_bffa .Data [_dfda ]|^(_agea .Data [_gfbg ]),_fabe );_gfbg +=_agea .RowStride ;_dfda +=_bffa .RowStride ;
};if _aeca {for _ccbb =0;_ccbb < _effb ;_ccbb ++{for _ddbbfg =0;_ddbbfg < _cdgc ;_ddbbfg ++{_agea .Data [_dgac +_ddbbfg ]=_bffa .Data [_bbbb +_ddbbfg ]|^(_agea .Data [_dgac +_ddbbfg ]);};_dgac +=_agea .RowStride ;_bbbb +=_bffa .RowStride ;};};if _fbce {for _ccbb =0;
_ccbb < _effb ;_ccbb ++{_agea .Data [_gde ]=_bdfed (_agea .Data [_gde ],_bffa .Data [_cfae ]|^(_agea .Data [_gde ]),_ecfgf );_gde +=_agea .RowStride ;_cfae +=_bffa .RowStride ;};};case PixSrcAndNotDst :for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gfbg ]=_bdfed (_agea .Data [_gfbg ],_bffa .Data [_dfda ]&^(_agea .Data [_gfbg ]),_fabe );
_gfbg +=_agea .RowStride ;_dfda +=_bffa .RowStride ;};if _aeca {for _ccbb =0;_ccbb < _effb ;_ccbb ++{for _ddbbfg =0;_ddbbfg < _cdgc ;_ddbbfg ++{_agea .Data [_dgac +_ddbbfg ]=_bffa .Data [_bbbb +_ddbbfg ]&^(_agea .Data [_dgac +_ddbbfg ]);};_dgac +=_agea .RowStride ;
_bbbb +=_bffa .RowStride ;};};if _fbce {for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gde ]=_bdfed (_agea .Data [_gde ],_bffa .Data [_cfae ]&^(_agea .Data [_gde ]),_ecfgf );_gde +=_agea .RowStride ;_cfae +=_bffa .RowStride ;};};case PixNotPixSrcOrDst :for _ccbb =0;
_ccbb < _effb ;_ccbb ++{_agea .Data [_gfbg ]=_bdfed (_agea .Data [_gfbg ],^(_bffa .Data [_dfda ]|_agea .Data [_gfbg ]),_fabe );_gfbg +=_agea .RowStride ;_dfda +=_bffa .RowStride ;};if _aeca {for _ccbb =0;_ccbb < _effb ;_ccbb ++{for _ddbbfg =0;_ddbbfg < _cdgc ;
_ddbbfg ++{_agea .Data [_dgac +_ddbbfg ]=^(_bffa .Data [_bbbb +_ddbbfg ]|_agea .Data [_dgac +_ddbbfg ]);};_dgac +=_agea .RowStride ;_bbbb +=_bffa .RowStride ;};};if _fbce {for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gde ]=_bdfed (_agea .Data [_gde ],^(_bffa .Data [_cfae ]|_agea .Data [_gde ]),_ecfgf );
_gde +=_agea .RowStride ;_cfae +=_bffa .RowStride ;};};case PixNotPixSrcAndDst :for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gfbg ]=_bdfed (_agea .Data [_gfbg ],^(_bffa .Data [_dfda ]&_agea .Data [_gfbg ]),_fabe );_gfbg +=_agea .RowStride ;_dfda +=_bffa .RowStride ;
};if _aeca {for _ccbb =0;_ccbb < _effb ;_ccbb ++{for _ddbbfg =0;_ddbbfg < _cdgc ;_ddbbfg ++{_agea .Data [_dgac +_ddbbfg ]=^(_bffa .Data [_bbbb +_ddbbfg ]&_agea .Data [_dgac +_ddbbfg ]);};_dgac +=_agea .RowStride ;_bbbb +=_bffa .RowStride ;};};if _fbce {for _ccbb =0;
_ccbb < _effb ;_ccbb ++{_agea .Data [_gde ]=_bdfed (_agea .Data [_gde ],^(_bffa .Data [_cfae ]&_agea .Data [_gde ]),_ecfgf );_gde +=_agea .RowStride ;_cfae +=_bffa .RowStride ;};};case PixNotPixSrcXorDst :for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gfbg ]=_bdfed (_agea .Data [_gfbg ],^(_bffa .Data [_dfda ]^_agea .Data [_gfbg ]),_fabe );
_gfbg +=_agea .RowStride ;_dfda +=_bffa .RowStride ;};if _aeca {for _ccbb =0;_ccbb < _effb ;_ccbb ++{for _ddbbfg =0;_ddbbfg < _cdgc ;_ddbbfg ++{_agea .Data [_dgac +_ddbbfg ]=^(_bffa .Data [_bbbb +_ddbbfg ]^_agea .Data [_dgac +_ddbbfg ]);};_dgac +=_agea .RowStride ;
_bbbb +=_bffa .RowStride ;};};if _fbce {for _ccbb =0;_ccbb < _effb ;_ccbb ++{_agea .Data [_gde ]=_bdfed (_agea .Data [_gde ],^(_bffa .Data [_cfae ]^_agea .Data [_gde ]),_ecfgf );_gde +=_agea .RowStride ;_cfae +=_bffa .RowStride ;};};default:_gc .Log .Debug ("I\u006e\u0076\u0061\u006c\u0069\u0064 \u0072\u0061\u0073\u0074\u0065\u0072\u0020\u006f\u0070e\u0072\u0061\u0074o\u0072:\u0020\u0025\u0064",_gdae );
return _bc .Error ("\u0072\u0061\u0073\u0074er\u004f\u0070\u0056\u0041\u006c\u0069\u0067\u006e\u0065\u0064\u004c\u006f\u0077","\u0069\u006e\u0076al\u0069\u0064\u0020\u0072\u0061\u0073\u0074\u0065\u0072\u0020\u006f\u0070\u0065\u0072\u0061\u0074\u006f\u0072");
};return nil ;};func (_edfa *BitmapsArray )AddBitmaps (bm *Bitmaps ){_edfa .Values =append (_edfa .Values ,bm )};const (_afaa shift =iota ;_eafde ;);func _bgdb (_abec *Bitmap ,_gcca *Bitmap ,_dffd *Selection )(*Bitmap ,error ){var (_fbc *Bitmap ;_ceaf error ;
);_abec ,_ceaf =_deaaf (_abec ,_gcca ,_dffd ,&_fbc );if _ceaf !=nil {return nil ,_ceaf ;};if _ceaf =_abec .clearAll ();_ceaf !=nil {return nil ,_ceaf ;};var _dbca SelectionValue ;for _cedf :=0;_cedf < _dffd .Height ;_cedf ++{for _deaa :=0;_deaa < _dffd .Width ;
_deaa ++{_dbca =_dffd .Data [_cedf ][_deaa ];if _dbca ==SelHit {if _ceaf =_abec .RasterOperation (_deaa -_dffd .Cx ,_cedf -_dffd .Cy ,_gcca .Width ,_gcca .Height ,PixSrcOrDst ,_fbc ,0,0);_ceaf !=nil {return nil ,_ceaf ;};};};};return _abec ,nil ;};func TstImageBitmapData ()[]byte {return _fcbeg .Data };
func (_gdg *Bitmap )GetPixel (x ,y int )bool {_cffb :=_gdg .GetByteIndex (x ,y );_dbb :=_gdg .GetBitOffset (x );_cea :=uint (7-_dbb );if _cffb > len (_gdg .Data )-1{_gc .Log .Debug ("\u0054\u0072\u0079\u0069\u006e\u0067\u0020\u0074\u006f\u0020\u0067\u0065\u0074\u0020\u0070\u0069\u0078\u0065\u006c\u0020o\u0075\u0074\u0020\u006f\u0066\u0020\u0074\u0068\u0065\u0020\u0064\u0061\u0074\u0061\u0020\u0072\u0061\u006e\u0067\u0065\u002e \u0078\u003a\u0020\u0027\u0025\u0064\u0027\u002c\u0020\u0079\u003a\u0027\u0025\u0064'\u002c\u0020\u0062m\u003a\u0020\u0027\u0025\u0073\u0027",x ,y ,_gdg );
return false ;};if (_gdg .Data [_cffb ]>>_cea )&0x01>=1{return true ;};return false ;};type byHeight Bitmaps ;func (_cfbc *BitmapsArray )GetBitmaps (i int )(*Bitmaps ,error ){const _cebb ="\u0042\u0069\u0074ma\u0070\u0073\u0041\u0072\u0072\u0061\u0079\u002e\u0047\u0065\u0074\u0042\u0069\u0074\u006d\u0061\u0070\u0073";
if _cfbc ==nil {return nil ,_bc .Error (_cebb ,"p\u0072\u006f\u0076\u0069\u0064\u0065d\u0020\u006e\u0069\u006c\u0020\u0027\u0042\u0069\u0074m\u0061\u0070\u0073A\u0072r\u0061\u0079\u0027");};if i > len (_cfbc .Values )-1{return nil ,_bc .Errorf (_cebb ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};return _cfbc .Values [i ],nil ;};type RasterOperator int ;func _cbdab ()[]int {_bcge :=make ([]int ,256);_bcge [0]=0;_bcge [1]=7;var _afced int ;for _afced =2;_afced < 4;_afced ++{_bcge [_afced ]=_bcge [_afced -2]+6;};for _afced =4;_afced < 8;_afced ++{_bcge [_afced ]=_bcge [_afced -4]+5;
};for _afced =8;_afced < 16;_afced ++{_bcge [_afced ]=_bcge [_afced -8]+4;};for _afced =16;_afced < 32;_afced ++{_bcge [_afced ]=_bcge [_afced -16]+3;};for _afced =32;_afced < 64;_afced ++{_bcge [_afced ]=_bcge [_afced -32]+2;};for _afced =64;_afced < 128;
_afced ++{_bcge [_afced ]=_bcge [_afced -64]+1;};for _afced =128;_afced < 256;_afced ++{_bcge [_afced ]=_bcge [_afced -128];};return _bcge ;};func _faaa (_gfcbd ,_ecec *Bitmap ,_eacd ,_eafgf int )(*Bitmap ,error ){const _faegc ="\u0063\u006c\u006f\u0073\u0065\u0042\u0072\u0069\u0063\u006b";
if _ecec ==nil {return nil ,_bc .Error (_faegc ,"\u0073o\u0075r\u0063\u0065\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");};if _eacd < 1||_eafgf < 1{return nil ,_bc .Error (_faegc ,"\u0068S\u0069\u007a\u0065\u0020\u0061\u006e\u0064\u0020\u0076\u0053\u0069z\u0065\u0020\u006e\u006f\u0074\u0020\u003e\u003d\u0020\u0031");
};if _eacd ==1&&_eafgf ==1{return _ecec .Copy (),nil ;};if _eacd ==1||_eafgf ==1{_eace :=SelCreateBrick (_eafgf ,_eacd ,_eafgf /2,_eacd /2,SelHit );var _fecf error ;_gfcbd ,_fecf =_bec (_gfcbd ,_ecec ,_eace );if _fecf !=nil {return nil ,_bc .Wrap (_fecf ,_faegc ,"\u0068S\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u007c\u007c \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");
};return _gfcbd ,nil ;};_ddfdf :=SelCreateBrick (1,_eacd ,0,_eacd /2,SelHit );_acca :=SelCreateBrick (_eafgf ,1,_eafgf /2,0,SelHit );_bcdac ,_bfba :=_bgdb (nil ,_ecec ,_ddfdf );if _bfba !=nil {return nil ,_bc .Wrap (_bfba ,_faegc ,"\u0031\u0073\u0074\u0020\u0064\u0069\u006c\u0061\u0074\u0065");
};if _gfcbd ,_bfba =_bgdb (_gfcbd ,_bcdac ,_acca );_bfba !=nil {return nil ,_bc .Wrap (_bfba ,_faegc ,"\u0032\u006e\u0064\u0020\u0064\u0069\u006c\u0061\u0074\u0065");};if _ ,_bfba =_fddfd (_bcdac ,_gfcbd ,_ddfdf );_bfba !=nil {return nil ,_bc .Wrap (_bfba ,_faegc ,"\u0031s\u0074\u0020\u0065\u0072\u006f\u0064e");
};if _ ,_bfba =_fddfd (_gfcbd ,_bcdac ,_acca );_bfba !=nil {return nil ,_bc .Wrap (_bfba ,_faegc ,"\u0032n\u0064\u0020\u0065\u0072\u006f\u0064e");};return _gfcbd ,nil ;};func (_dgd *Bitmap )ThresholdPixelSum (thresh int ,tab8 []int )(_fa bool ,_bcfg error ){const _fgf ="\u0042i\u0074\u006d\u0061\u0070\u002e\u0054\u0068\u0072\u0065\u0073\u0068o\u006c\u0064\u0050\u0069\u0078\u0065\u006c\u0053\u0075\u006d";
if tab8 ==nil {tab8 =_dddcd ();};_agf :=_dgd .Width >>3;_gffe :=_dgd .Width &7;_cfe :=byte (0xff<<uint (8-_gffe ));var (_adga ,_cffg ,_cee ,_gaad int ;_cbd byte ;);for _adga =0;_adga < _dgd .Height ;_adga ++{_cee =_dgd .RowStride *_adga ;for _cffg =0;_cffg < _agf ;
_cffg ++{_cbd ,_bcfg =_dgd .GetByte (_cee +_cffg );if _bcfg !=nil {return false ,_bc .Wrap (_bcfg ,_fgf ,"\u0066\u0075\u006c\u006c\u0042\u0079\u0074\u0065");};_gaad +=tab8 [_cbd ];};if _gffe !=0{_cbd ,_bcfg =_dgd .GetByte (_cee +_cffg );if _bcfg !=nil {return false ,_bc .Wrap (_bcfg ,_fgf ,"p\u0061\u0072\u0074\u0069\u0061\u006c\u0042\u0079\u0074\u0065");
};_cbd &=_cfe ;_gaad +=tab8 [_cbd ];};if _gaad > thresh {return true ,nil ;};};return _fa ,nil ;};const (SelDontCare SelectionValue =iota ;SelHit ;SelMiss ;);type shift int ;func (_cfff *Bitmaps )AddBox (box *_ag .Rectangle ){_cfff .Boxes =append (_cfff .Boxes ,box )};
func _ffdb (_cebgf ,_eabb *Bitmap )(*Bitmap ,error ){if _eabb ==nil {return nil ,_bc .Error ("\u0063\u006f\u0070\u0079\u0042\u0069\u0074\u006d\u0061\u0070","\u0073o\u0075r\u0063\u0065\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");};if _eabb ==_cebgf {return _cebgf ,nil ;
};if _cebgf ==nil {_cebgf =_eabb .createTemplate ();copy (_cebgf .Data ,_eabb .Data );return _cebgf ,nil ;};_gacc :=_cebgf .resizeImageData (_eabb );if _gacc !=nil {return nil ,_bc .Wrap (_gacc ,"\u0063\u006f\u0070\u0079\u0042\u0069\u0074\u006d\u0061\u0070","");
};_cebgf .Text =_eabb .Text ;copy (_cebgf .Data ,_eabb .Data );return _cebgf ,nil ;};func (_gcce *ClassedPoints )validateIntSlice ()error {const _cgcaa ="\u0076\u0061l\u0069\u0064\u0061t\u0065\u0049\u006e\u0074\u0053\u006c\u0069\u0063\u0065";for _ ,_ddbc :=range _gcce .IntSlice {if _ddbc >=(_gcce .Points .Size ()){return _bc .Errorf (_cgcaa ,"c\u006c\u0061\u0073\u0073\u0020\u0069\u0064\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u0061\u0020\u0076\u0061\u006ci\u0064 \u0069\u006e\u0064\u0065x\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0070\u006f\u0069\u006e\u0074\u0073\u0020\u006f\u0066\u0020\u0073\u0069\u007a\u0065\u003a\u0020\u0025\u0064",_ddbc ,_gcce .Points .Size ());
};};return nil ;};func (_fbbc *Points )Add (pt *Points )error {const _bccc ="\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0041\u0064\u0064";if _fbbc ==nil {return _bc .Error (_bccc ,"\u0070o\u0069n\u0074\u0073\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");
};if pt ==nil {return _bc .Error (_bccc ,"a\u0072\u0067\u0075\u006d\u0065\u006et\u0020\u0070\u006f\u0069\u006e\u0074\u0073\u0020\u006eo\u0074\u0020\u0064e\u0066i\u006e\u0065\u0064");};*_fbbc =append (*_fbbc ,*pt ...);return nil ;};func (_beec *Bitmap )GetByte (index int )(byte ,error ){if index > len (_beec .Data )-1||index < 0{return 0,_bc .Errorf ("\u0047e\u0074\u0042\u0079\u0074\u0065","\u0069\u006e\u0064\u0065x:\u0020\u0025\u0064\u0020\u006f\u0075\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006eg\u0065",index );
};return _beec .Data [index ],nil ;};func CorrelationScoreSimple (bm1 ,bm2 *Bitmap ,area1 ,area2 int ,delX ,delY float32 ,maxDiffW ,maxDiffH int ,tab []int )(_gged float64 ,_dgad error ){const _agga ="\u0043\u006f\u0072\u0072el\u0061\u0074\u0069\u006f\u006e\u0053\u0063\u006f\u0072\u0065\u0053\u0069\u006d\u0070l\u0065";
if bm1 ==nil ||bm2 ==nil {return _gged ,_bc .Error (_agga ,"n\u0069l\u0020\u0062\u0069\u0074\u006d\u0061\u0070\u0073 \u0070\u0072\u006f\u0076id\u0065\u0064");};if tab ==nil {return _gged ,_bc .Error (_agga ,"\u0074\u0061\u0062\u0020\u0075\u006e\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};if area1 ==0||area2 ==0{return _gged ,_bc .Error (_agga ,"\u0070\u0072\u006f\u0076\u0069\u0064\u0065\u0064\u0020\u0061\u0072e\u0061\u0073\u0020\u006d\u0075\u0073\u0074\u0020\u0062\u0065 \u003e\u0020\u0030");};_bdac ,_agcc :=bm1 .Width ,bm1 .Height ;_bbff ,_afcb :=bm2 .Width ,bm2 .Height ;
if _afa (_bdac -_bbff )> maxDiffW {return 0,nil ;};if _afa (_agcc -_afcb )> maxDiffH {return 0,nil ;};var _edbag ,_cged int ;if delX >=0{_edbag =int (delX +0.5);}else {_edbag =int (delX -0.5);};if delY >=0{_cged =int (delY +0.5);}else {_cged =int (delY -0.5);
};_cdac :=bm1 .createTemplate ();if _dgad =_cdac .RasterOperation (_edbag ,_cged ,_bbff ,_afcb ,PixSrc ,bm2 ,0,0);_dgad !=nil {return _gged ,_bc .Wrap (_dgad ,_agga ,"\u0062m\u0032 \u0074\u006f\u0020\u0054\u0065\u006d\u0070\u006c\u0061\u0074\u0065");};
if _dgad =_cdac .RasterOperation (0,0,_bdac ,_agcc ,PixSrcAndDst ,bm1 ,0,0);_dgad !=nil {return _gged ,_bc .Wrap (_dgad ,_agga ,"b\u006d\u0031\u0020\u0061\u006e\u0064\u0020\u0062\u006d\u0054");};_abag :=_cdac .countPixels ();_gged =float64 (_abag )*float64 (_abag )/(float64 (area1 )*float64 (area2 ));
return _gged ,nil ;};func TstTSymbol (t *_d .T ,scale ...int )*Bitmap {_dege ,_aaca :=NewWithData (5,5,[]byte {0xF8,0x20,0x20,0x20,0x20});_f .NoError (t ,_aaca );return TstGetScaledSymbol (t ,_dege ,scale ...);};type Bitmap struct{Width ,Height int ;BitmapNumber int ;
RowStride int ;Data []byte ;Color Color ;Special int ;Text string ;XResolution ,YResolution int ;};func _fffb (_cbbbd *Bitmap ,_cfgad ,_bdcb int ,_cgaa ,_aagab int ,_bgef RasterOperator ){var (_fcbc bool ;_dfee bool ;_ebce int ;_gfba int ;_ggfg int ;_cfaga int ;
_bdfe bool ;_bcdbf byte ;);_cfagb :=8-(_cfgad &7);_dafb :=_fag [_cfagb ];_bced :=_cbbbd .RowStride *_bdcb +(_cfgad >>3);if _cgaa < _cfagb {_fcbc =true ;_dafb &=_dcfg [8-_cfagb +_cgaa ];};if !_fcbc {_ebce =(_cgaa -_cfagb )>>3;if _ebce !=0{_dfee =true ;_gfba =_bced +1;
};};_ggfg =(_cfgad +_cgaa )&7;if !_fcbc &&_ggfg !=0{_bdfe =true ;_bcdbf =_dcfg [_ggfg ];_cfaga =_bced +1+_ebce ;};var _gaac ,_ebccc int ;switch _bgef {case PixClr :for _gaac =0;_gaac < _aagab ;_gaac ++{_cbbbd .Data [_bced ]=_bdfed (_cbbbd .Data [_bced ],0x0,_dafb );
_bced +=_cbbbd .RowStride ;};if _dfee {for _gaac =0;_gaac < _aagab ;_gaac ++{for _ebccc =0;_ebccc < _ebce ;_ebccc ++{_cbbbd .Data [_gfba +_ebccc ]=0x0;};_gfba +=_cbbbd .RowStride ;};};if _bdfe {for _gaac =0;_gaac < _aagab ;_gaac ++{_cbbbd .Data [_cfaga ]=_bdfed (_cbbbd .Data [_cfaga ],0x0,_bcdbf );
_cfaga +=_cbbbd .RowStride ;};};case PixSet :for _gaac =0;_gaac < _aagab ;_gaac ++{_cbbbd .Data [_bced ]=_bdfed (_cbbbd .Data [_bced ],0xff,_dafb );_bced +=_cbbbd .RowStride ;};if _dfee {for _gaac =0;_gaac < _aagab ;_gaac ++{for _ebccc =0;_ebccc < _ebce ;
_ebccc ++{_cbbbd .Data [_gfba +_ebccc ]=0xff;};_gfba +=_cbbbd .RowStride ;};};if _bdfe {for _gaac =0;_gaac < _aagab ;_gaac ++{_cbbbd .Data [_cfaga ]=_bdfed (_cbbbd .Data [_cfaga ],0xff,_bcdbf );_cfaga +=_cbbbd .RowStride ;};};case PixNotDst :for _gaac =0;
_gaac < _aagab ;_gaac ++{_cbbbd .Data [_bced ]=_bdfed (_cbbbd .Data [_bced ],^_cbbbd .Data [_bced ],_dafb );_bced +=_cbbbd .RowStride ;};if _dfee {for _gaac =0;_gaac < _aagab ;_gaac ++{for _ebccc =0;_ebccc < _ebce ;_ebccc ++{_cbbbd .Data [_gfba +_ebccc ]=^(_cbbbd .Data [_gfba +_ebccc ]);
};_gfba +=_cbbbd .RowStride ;};};if _bdfe {for _gaac =0;_gaac < _aagab ;_gaac ++{_cbbbd .Data [_cfaga ]=_bdfed (_cbbbd .Data [_cfaga ],^_cbbbd .Data [_cfaga ],_bcdbf );_cfaga +=_cbbbd .RowStride ;};};};};func (_bcec *ClassedPoints )Len ()int {return _bcec .IntSlice .Size ()};
func TstESymbol (t *_d .T ,scale ...int )*Bitmap {_degg ,_bebae :=NewWithData (4,5,[]byte {0xF0,0x80,0xE0,0x80,0xF0});_f .NoError (t ,_bebae );return TstGetScaledSymbol (t ,_degg ,scale ...);};func (_fdeb *Bitmap )inverseData (){if _fdae :=_fdeb .RasterOperation (0,0,_fdeb .Width ,_fdeb .Height ,PixNotDst ,nil ,0,0);
_fdae !=nil {_gc .Log .Debug ("\u0049n\u0076\u0065\u0072\u0073e\u0020\u0064\u0061\u0074\u0061 \u0066a\u0069l\u0065\u0064\u003a\u0020\u0027\u0025\u0076'",_fdae );};if _fdeb .Color ==Chocolate {_fdeb .Color =Vanilla ;}else {_fdeb .Color =Chocolate ;};};func TstWriteSymbols (t *_d .T ,bms *Bitmaps ,src *Bitmap ){for _cfdec :=0;
_cfdec < bms .Size ();_cfdec ++{_babd :=bms .Values [_cfdec ];_dgag :=bms .Boxes [_cfdec ];_dcdb :=src .RasterOperation (_dgag .Min .X ,_dgag .Min .Y ,_babd .Width ,_babd .Height ,PixSrc ,_babd ,0,0);_f .NoError (t ,_dcdb );};};func (_baeg *ClassedPoints )GetIntYByClass (i int )(int ,error ){const _fccf ="\u0043\u006c\u0061\u0073s\u0065\u0064\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047e\u0074I\u006e\u0074\u0059\u0042\u0079\u0043\u006ca\u0073\u0073";
if i >=_baeg .IntSlice .Size (){return 0,_bc .Errorf (_fccf ,"\u0069\u003a\u0020\u0027\u0025\u0064\u0027 \u0069\u0073\u0020o\u0075\u0074\u0020\u006ff\u0020\u0074\u0068\u0065\u0020\u0072\u0061\u006e\u0067\u0065\u0020\u006f\u0066\u0020\u0074\u0068\u0065\u0020\u0049\u006e\u0074\u0053\u006c\u0069\u0063\u0065",i );
};return int (_baeg .YAtIndex (i )),nil ;};func TstWordBitmapWithSpaces (t *_d .T ,scale ...int )*Bitmap {_efee :=1;if len (scale )> 0{_efee =scale [0];};_ggfdd :=3;_geaa :=9+7+15+2*_ggfdd +2*_ggfdd ;_gfggc :=5+_ggfdd +5+2*_ggfdd ;_dbged :=New (_geaa *_efee ,_gfggc *_efee );
_ebddc :=&Bitmaps {};var _eaec *int ;_ggfdd *=_efee ;_eagf :=_ggfdd ;_eaec =&_eagf ;_ggee :=_ggfdd ;_dcde :=TstDSymbol (t ,scale ...);TstAddSymbol (t ,_ebddc ,_dcde ,_eaec ,_ggee ,1*_efee );_dcde =TstOSymbol (t ,scale ...);TstAddSymbol (t ,_ebddc ,_dcde ,_eaec ,_ggee ,_ggfdd );
_dcde =TstISymbol (t ,scale ...);TstAddSymbol (t ,_ebddc ,_dcde ,_eaec ,_ggee ,1*_efee );_dcde =TstTSymbol (t ,scale ...);TstAddSymbol (t ,_ebddc ,_dcde ,_eaec ,_ggee ,_ggfdd );_dcde =TstNSymbol (t ,scale ...);TstAddSymbol (t ,_ebddc ,_dcde ,_eaec ,_ggee ,1*_efee );
_dcde =TstOSymbol (t ,scale ...);TstAddSymbol (t ,_ebddc ,_dcde ,_eaec ,_ggee ,1*_efee );_dcde =TstWSymbol (t ,scale ...);TstAddSymbol (t ,_ebddc ,_dcde ,_eaec ,_ggee ,0);*_eaec =_ggfdd ;_ggee =5*_efee +_ggfdd ;_dcde =TstOSymbol (t ,scale ...);TstAddSymbol (t ,_ebddc ,_dcde ,_eaec ,_ggee ,1*_efee );
_dcde =TstRSymbol (t ,scale ...);TstAddSymbol (t ,_ebddc ,_dcde ,_eaec ,_ggee ,_ggfdd );_dcde =TstNSymbol (t ,scale ...);TstAddSymbol (t ,_ebddc ,_dcde ,_eaec ,_ggee ,1*_efee );_dcde =TstESymbol (t ,scale ...);TstAddSymbol (t ,_ebddc ,_dcde ,_eaec ,_ggee ,1*_efee );
_dcde =TstVSymbol (t ,scale ...);TstAddSymbol (t ,_ebddc ,_dcde ,_eaec ,_ggee ,1*_efee );_dcde =TstESymbol (t ,scale ...);TstAddSymbol (t ,_ebddc ,_dcde ,_eaec ,_ggee ,1*_efee );_dcde =TstRSymbol (t ,scale ...);TstAddSymbol (t ,_ebddc ,_dcde ,_eaec ,_ggee ,0);
TstWriteSymbols (t ,_ebddc ,_dbged );return _dbged ;};type BoundaryCondition int ;func (_cebc Points )YSorter ()func (_addgb ,_fcba int )bool {return func (_fdfc ,_addb int )bool {return _cebc [_fdfc ].Y < _cebc [_addb ].Y };};func _adgd (_bbd ,_gfgc *Bitmap ,_bcf int ,_dae []byte ,_cdef int )(_fded error ){const _ec ="\u0072\u0065\u0064uc\u0065\u0052\u0061\u006e\u006b\u0042\u0069\u006e\u0061\u0072\u0079\u0032\u004c\u0065\u0076\u0065\u006c\u0033";
var (_gacb ,_fda ,_age ,_geg ,_gdb ,_daef ,_dfb ,_ece int ;_ccd ,_gda ,_efb ,_ede uint32 ;_deeg ,_ffgc byte ;_ecc uint16 ;);_fdedg :=make ([]byte ,4);_feb :=make ([]byte ,4);for _age =0;_age < _bbd .Height -1;_age ,_geg =_age +2,_geg +1{_gacb =_age *_bbd .RowStride ;
_fda =_geg *_gfgc .RowStride ;for _gdb ,_daef =0,0;_gdb < _cdef ;_gdb ,_daef =_gdb +4,_daef +1{for _dfb =0;_dfb < 4;_dfb ++{_ece =_gacb +_gdb +_dfb ;if _ece <=len (_bbd .Data )-1&&_ece < _gacb +_bbd .RowStride {_fdedg [_dfb ]=_bbd .Data [_ece ];}else {_fdedg [_dfb ]=0x00;
};_ece =_gacb +_bbd .RowStride +_gdb +_dfb ;if _ece <=len (_bbd .Data )-1&&_ece < _gacb +(2*_bbd .RowStride ){_feb [_dfb ]=_bbd .Data [_ece ];}else {_feb [_dfb ]=0x00;};};_ccd =_bg .BigEndian .Uint32 (_fdedg );_gda =_bg .BigEndian .Uint32 (_feb );_efb =_ccd &_gda ;
_efb |=_efb <<1;_ede =_ccd |_gda ;_ede &=_ede <<1;_gda =_efb &_ede ;_gda &=0xaaaaaaaa;_ccd =_gda |(_gda <<7);_deeg =byte (_ccd >>24);_ffgc =byte ((_ccd >>8)&0xff);_ece =_fda +_daef ;if _ece +1==len (_gfgc .Data )-1||_ece +1>=_fda +_gfgc .RowStride {if _fded =_gfgc .SetByte (_ece ,_dae [_deeg ]);
_fded !=nil {return _bc .Wrapf (_fded ,_ec ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0025d",_ece );};}else {_ecc =(uint16 (_dae [_deeg ])<<8)|uint16 (_dae [_ffgc ]);if _fded =_gfgc .setTwoBytes (_ece ,_ecc );_fded !=nil {return _bc .Wrapf (_fded ,_ec ,"s\u0065\u0074\u0074\u0069\u006e\u0067 \u0074\u0077\u006f\u0020\u0062\u0079t\u0065\u0073\u0020\u0066\u0061\u0069\u006ce\u0064\u002c\u0020\u0069\u006e\u0064\u0065\u0078\u003a\u0020%\u0064",_ece );
};_daef ++;};};};return nil ;};func (_feee *Bitmap )AddBorderGeneral (left ,right ,top ,bot int ,val int )(*Bitmap ,error ){return _feee .addBorderGeneral (left ,right ,top ,bot ,val );};func (_feaf *Bitmap )connComponentsBB (_dgda int )(_bca *Boxes ,_cbdg error ){const _ccacb ="\u0042\u0069\u0074ma\u0070\u002e\u0063\u006f\u006e\u006e\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074\u0073\u0042\u0042";
if _dgda !=4&&_dgda !=8{return nil ,_bc .Error (_ccacb ,"\u0063\u006f\u006e\u006e\u0065\u0063t\u0069\u0076\u0069\u0074\u0079\u0020\u006d\u0075\u0073\u0074\u0020\u0062\u0065 \u0061\u0020\u0027\u0034\u0027\u0020\u006fr\u0020\u0027\u0038\u0027");};if _feaf .Zero (){return &Boxes {},nil ;
};_feaf .setPadBits (0);_cfdef ,_cbdg :=_ffdb (nil ,_feaf );if _cbdg !=nil {return nil ,_bc .Wrap (_cbdg ,_ccacb ,"\u0062\u006d\u0031");};_acge :=&_be .Stack {};_acge .Aux =&_be .Stack {};_bca =&Boxes {};var (_affg ,_bab int ;_bcbe _ag .Point ;_fbdde bool ;
_dbgbc *_ag .Rectangle ;);for {if _bcbe ,_fbdde ,_cbdg =_cfdef .nextOnPixel (_bab ,_affg );_cbdg !=nil {return nil ,_bc .Wrap (_cbdg ,_ccacb ,"");};if !_fbdde {break ;};if _dbgbc ,_cbdg =_ebde (_cfdef ,_acge ,_bcbe .X ,_bcbe .Y ,_dgda );_cbdg !=nil {return nil ,_bc .Wrap (_cbdg ,_ccacb ,"");
};if _cbdg =_bca .Add (_dbgbc );_cbdg !=nil {return nil ,_bc .Wrap (_cbdg ,_ccacb ,"");};_bab =_bcbe .X ;_affg =_bcbe .Y ;};return _bca ,nil ;};type Selection struct{Height ,Width int ;Cx ,Cy int ;Name string ;Data [][]SelectionValue ;};func (_aaeb *Bitmap )addBorderGeneral (_dddf ,_dgc ,_ecb ,_aaef int ,_feeg int )(*Bitmap ,error ){const _fbdd ="\u0061\u0064d\u0042\u006f\u0072d\u0065\u0072\u0047\u0065\u006e\u0065\u0072\u0061\u006c";
if _dddf < 0||_dgc < 0||_ecb < 0||_aaef < 0{return nil ,_bc .Error (_fbdd ,"n\u0065\u0067\u0061\u0074iv\u0065 \u0062\u006f\u0072\u0064\u0065r\u0020\u0061\u0064\u0064\u0065\u0064");};_dgdb ,_dfgd :=_aaeb .Width ,_aaeb .Height ;_ceag :=_dgdb +_dddf +_dgc ;
_gfa :=_dfgd +_ecb +_aaef ;_gadc :=New (_ceag ,_gfa );_gadc .Color =_aaeb .Color ;_ddgb :=PixClr ;if _feeg > 0{_ddgb =PixSet ;};_faa :=_gadc .RasterOperation (0,0,_dddf ,_gfa ,_ddgb ,nil ,0,0);if _faa !=nil {return nil ,_bc .Wrap (_faa ,_fbdd ,"\u006c\u0065\u0066\u0074");
};_faa =_gadc .RasterOperation (_ceag -_dgc ,0,_dgc ,_gfa ,_ddgb ,nil ,0,0);if _faa !=nil {return nil ,_bc .Wrap (_faa ,_fbdd ,"\u0072\u0069\u0067h\u0074");};_faa =_gadc .RasterOperation (0,0,_ceag ,_ecb ,_ddgb ,nil ,0,0);if _faa !=nil {return nil ,_bc .Wrap (_faa ,_fbdd ,"\u0074\u006f\u0070");
};_faa =_gadc .RasterOperation (0,_gfa -_aaef ,_ceag ,_aaef ,_ddgb ,nil ,0,0);if _faa !=nil {return nil ,_bc .Wrap (_faa ,_fbdd ,"\u0062\u006f\u0074\u0074\u006f\u006d");};_faa =_gadc .RasterOperation (_dddf ,_ecb ,_dgdb ,_dfgd ,PixSrc ,_aaeb ,0,0);if _faa !=nil {return nil ,_bc .Wrap (_faa ,_fbdd ,"\u0063\u006f\u0070\u0079");
};return _gadc ,nil ;};func RasterOperation (dest *Bitmap ,dx ,dy ,dw ,dh int ,op RasterOperator ,src *Bitmap ,sx ,sy int )error {return _bdbg (dest ,dx ,dy ,dw ,dh ,op ,src ,sx ,sy );};func _fddfd (_efbf ,_cebff *Bitmap ,_fdbc *Selection )(*Bitmap ,error ){const _edbad ="\u0065\u0072\u006fd\u0065";
var (_gcae error ;_eegc *Bitmap ;);_efbf ,_gcae =_deaaf (_efbf ,_cebff ,_fdbc ,&_eegc );if _gcae !=nil {return nil ,_bc .Wrap (_gcae ,_edbad ,"");};if _gcae =_efbf .setAll ();_gcae !=nil {return nil ,_bc .Wrap (_gcae ,_edbad ,"");};var _cgca SelectionValue ;
for _gaff :=0;_gaff < _fdbc .Height ;_gaff ++{for _efbg :=0;_efbg < _fdbc .Width ;_efbg ++{_cgca =_fdbc .Data [_gaff ][_efbg ];if _cgca ==SelHit {_gcae =_bdbg (_efbf ,_fdbc .Cx -_efbg ,_fdbc .Cy -_gaff ,_cebff .Width ,_cebff .Height ,PixSrcAndDst ,_eegc ,0,0);
if _gcae !=nil {return nil ,_bc .Wrap (_gcae ,_edbad ,"");};};};};if MorphBC ==SymmetricMorphBC {return _efbf ,nil ;};_edfg ,_adcg ,_aga ,_bcdg :=_fdbc .findMaxTranslations ();if _edfg > 0{if _gcae =_efbf .RasterOperation (0,0,_edfg ,_cebff .Height ,PixClr ,nil ,0,0);
_gcae !=nil {return nil ,_bc .Wrap (_gcae ,_edbad ,"\u0078\u0070\u0020\u003e\u0020\u0030");};};if _aga > 0{if _gcae =_efbf .RasterOperation (_cebff .Width -_aga ,0,_aga ,_cebff .Height ,PixClr ,nil ,0,0);_gcae !=nil {return nil ,_bc .Wrap (_gcae ,_edbad ,"\u0078\u006e\u0020\u003e\u0020\u0030");
};};if _adcg > 0{if _gcae =_efbf .RasterOperation (0,0,_cebff .Width ,_adcg ,PixClr ,nil ,0,0);_gcae !=nil {return nil ,_bc .Wrap (_gcae ,_edbad ,"\u0079\u0070\u0020\u003e\u0020\u0030");};};if _bcdg > 0{if _gcae =_efbf .RasterOperation (0,_cebff .Height -_bcdg ,_cebff .Width ,_bcdg ,PixClr ,nil ,0,0);
_gcae !=nil {return nil ,_bc .Wrap (_gcae ,_edbad ,"\u0079\u006e\u0020\u003e\u0020\u0030");};};return _efbf ,nil ;};func (_gdf MorphProcess )verify (_gbeeb int ,_degf ,_gdbcb *int )error {const _fecd ="\u004d\u006f\u0072\u0070hP\u0072\u006f\u0063\u0065\u0073\u0073\u002e\u0076\u0065\u0072\u0069\u0066\u0079";
switch _gdf .Operation {case MopDilation ,MopErosion ,MopOpening ,MopClosing :if len (_gdf .Arguments )!=2{return _bc .Error (_fecd ,"\u004f\u0070\u0065\u0072\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0027\u0064\u0027\u002c\u0020\u0027\u0065\u0027\u002c \u0027\u006f\u0027\u002c\u0020\u0027\u0063\u0027\u0020\u0072\u0065\u0071\u0075\u0069\u0072\u0065\u0073\u0020\u0061\u0074\u0020\u006c\u0065\u0061\u0073\u0074\u0020\u0032\u0020\u0061r\u0067\u0075\u006d\u0065\u006et\u0073");
};_addg ,_fgce :=_gdf .getWidthHeight ();if _addg <=0||_fgce <=0{return _bc .Error (_fecd ,"O\u0070er\u0061t\u0069o\u006e\u003a\u0020\u0027\u0064'\u002c\u0020\u0027e\u0027\u002c\u0020\u0027\u006f'\u002c\u0020\u0027c\u0027\u0020\u0020\u0072\u0065\u0071\u0075\u0069\u0072\u0065\u0073 \u0062\u006f\u0074h w\u0069\u0064\u0074\u0068\u0020\u0061n\u0064\u0020\u0068\u0065\u0069\u0067\u0068\u0074\u0020\u0074\u006f\u0020b\u0065 \u003e\u003d\u0020\u0030");
};case MopRankBinaryReduction :_eaeg :=len (_gdf .Arguments );*_degf +=_eaeg ;if _eaeg < 1||_eaeg > 4{return _bc .Error (_fecd ,"\u004f\u0070\u0065\u0072\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0027\u0072\u0027\u0020\u0072\u0065\u0071\u0075\u0069r\u0065\u0073\u0020\u0061\u0074\u0020\u006c\u0065\u0061s\u0074\u0020\u0031\u0020\u0061\u006e\u0064\u0020\u0061\u0074\u0020\u006d\u006fs\u0074\u0020\u0034\u0020\u0061\u0072g\u0075\u006d\u0065n\u0074\u0073");
};for _dfdc :=0;_dfdc < _eaeg ;_dfdc ++{if _gdf .Arguments [_dfdc ]< 1||_gdf .Arguments [_dfdc ]> 4{return _bc .Error (_fecd ,"\u0052\u0061\u006e\u006b\u0042\u0069n\u0061\u0072\u0079\u0052\u0065\u0064\u0075\u0063\u0074\u0069\u006f\u006e\u0020\u006c\u0065\u0076\u0065\u006c\u0020\u006du\u0073\u0074\u0020\u0062\u0065\u0020\u0069\u006e\u0020\u0072\u0061\u006e\u0067\u0065 \u00280\u002c\u0020\u0034\u003e");
};};case MopReplicativeBinaryExpansion :if len (_gdf .Arguments )==0{return _bc .Error (_fecd ,"\u0052\u0065\u0070\u006c\u0069\u0063\u0061\u0074i\u0076\u0065\u0042in\u0061\u0072\u0079\u0045\u0078\u0070a\u006e\u0073\u0069\u006f\u006e\u0020\u0072\u0065\u0071\u0075\u0069\u0072\u0065\u0073\u0020o\u006e\u0065\u0020\u0061\u0072\u0067\u0075\u006de\u006e\u0074");
};_bggf :=_gdf .Arguments [0];if _bggf !=2&&_bggf !=4&&_bggf !=8{return _bc .Error (_fecd ,"R\u0065\u0070\u006c\u0069\u0063\u0061\u0074\u0069\u0076\u0065\u0042\u0069\u006e\u0061\u0072\u0079\u0045\u0078\u0070\u0061\u006e\u0073\u0069\u006f\u006e\u0020m\u0075s\u0074\u0020\u0062\u0065 \u006f\u0066 \u0066\u0061\u0063\u0074\u006f\u0072\u0020\u0069\u006e\u0020\u0072\u0061\u006e\u0067\u0065\u0020\u007b\u0032\u002c\u0034\u002c\u0038\u007d");
};*_degf -=_gcdda [_bggf /4];case MopAddBorder :if len (_gdf .Arguments )==0{return _bc .Error (_fecd ,"\u0041\u0064\u0064B\u006f\u0072\u0064\u0065r\u0020\u0072\u0065\u0071\u0075\u0069\u0072e\u0073\u0020\u006f\u006e\u0065\u0020\u0061\u0072\u0067\u0075\u006d\u0065\u006e\u0074");
};_gae :=_gdf .Arguments [0];if _gbeeb > 0{return _bc .Error (_fecd ,"\u0041\u0064\u0064\u0042\u006f\u0072\u0064\u0065\u0072\u0020\u006d\u0075\u0073t\u0020\u0062\u0065\u0020\u0061\u0020f\u0069\u0072\u0073\u0074\u0020\u006d\u006f\u0072\u0070\u0068\u0020\u0070\u0072o\u0063\u0065\u0073\u0073");
};if _gae < 1{return _bc .Error (_fecd ,"\u0041\u0064\u0064\u0042o\u0072\u0064\u0065\u0072\u0020\u0076\u0061\u006c\u0075\u0065 \u006co\u0077\u0065\u0072\u0020\u0074\u0068\u0061n\u0020\u0030");};*_gdbcb =_gae ;};return nil ;};func _eabgb (_adab *Bitmap ,_agac ,_fbbca int ,_fcee ,_fbddf int ,_ebgg RasterOperator ,_ceaa *Bitmap ,_eed ,_feea int )error {var _caca ,_gdacb ,_deae ,_ddaef int ;
if _agac < 0{_eed -=_agac ;_fcee +=_agac ;_agac =0;};if _eed < 0{_agac -=_eed ;_fcee +=_eed ;_eed =0;};_caca =_agac +_fcee -_adab .Width ;if _caca > 0{_fcee -=_caca ;};_gdacb =_eed +_fcee -_ceaa .Width ;if _gdacb > 0{_fcee -=_gdacb ;};if _fbbca < 0{_feea -=_fbbca ;
_fbddf +=_fbbca ;_fbbca =0;};if _feea < 0{_fbbca -=_feea ;_fbddf +=_feea ;_feea =0;};_deae =_fbbca +_fbddf -_adab .Height ;if _deae > 0{_fbddf -=_deae ;};_ddaef =_feea +_fbddf -_ceaa .Height ;if _ddaef > 0{_fbddf -=_ddaef ;};if _fcee <=0||_fbddf <=0{return nil ;
};var _fgdd error ;switch {case _agac &7==0&&_eed &7==0:_fgdd =_ffba (_adab ,_agac ,_fbbca ,_fcee ,_fbddf ,_ebgg ,_ceaa ,_eed ,_feea );case _agac &7==_eed &7:_fgdd =_fbbd (_adab ,_agac ,_fbbca ,_fcee ,_fbddf ,_ebgg ,_ceaa ,_eed ,_feea );default:_fgdd =_bdgd (_adab ,_agac ,_fbbca ,_fcee ,_fbddf ,_ebgg ,_ceaa ,_eed ,_feea );
};if _fgdd !=nil {return _bc .Wrap (_fgdd ,"r\u0061\u0073\u0074\u0065\u0072\u004f\u0070\u004c\u006f\u0077","");};return nil ;};func (_abee *Bitmaps )GroupByWidth ()(*BitmapsArray ,error ){const _geff ="\u0047\u0072\u006fu\u0070\u0042\u0079\u0057\u0069\u0064\u0074\u0068";
if len (_abee .Values )==0{return nil ,_bc .Error (_geff ,"\u006eo\u0020v\u0061\u006c\u0075\u0065\u0073 \u0070\u0072o\u0076\u0069\u0064\u0065\u0064");};_eegaf :=&BitmapsArray {};_abee .SortByWidth ();_ffcee :=-1;_gdff :=-1;for _bfefc :=0;_bfefc < len (_abee .Values );
_bfefc ++{_daff :=_abee .Values [_bfefc ].Width ;if _daff > _ffcee {_ffcee =_daff ;_gdff ++;_eegaf .Values =append (_eegaf .Values ,&Bitmaps {});};_eegaf .Values [_gdff ].AddBitmap (_abee .Values [_bfefc ]);};return _eegaf ,nil ;};func _acb (_bbc *Bitmap ,_acbf int ,_gabg []byte )(_eec *Bitmap ,_gb error ){const _dfd ="\u0072\u0065\u0064\u0075\u0063\u0065\u0052\u0061\u006e\u006b\u0042\u0069n\u0061\u0072\u0079\u0032";
if _bbc ==nil {return nil ,_bc .Error (_dfd ,"\u0073o\u0075\u0072\u0063\u0065 \u0062\u0069\u0074\u006d\u0061p\u0020n\u006ft\u0020\u0064\u0065\u0066\u0069\u006e\u0065d");};if _acbf < 1||_acbf > 4{return nil ,_bc .Error (_dfd ,"\u006c\u0065\u0076\u0065\u006c\u0020\u006d\u0075\u0073\u0074 \u0062\u0065\u0020\u0069\u006e\u0020\u0073e\u0074\u0020\u007b\u0031\u002c\u0032\u002c\u0033\u002c\u0034\u007d");
};if _bbc .Height <=1{return nil ,_bc .Errorf (_dfd ,"\u0073o\u0075\u0072c\u0065\u0020\u0068e\u0069\u0067\u0068\u0074\u0020\u006d\u0075s\u0074\u0020\u0062\u0065\u0020\u0061t\u0020\u006c\u0065\u0061\u0073\u0074\u0020\u0027\u0032\u0027\u0020-\u0020\u0069\u0073\u003a\u0020\u0027\u0025\u0064\u0027",_bbc .Height );
};_eec =New (_bbc .Width /2,_bbc .Height /2);if _gabg ==nil {_gabg =_gdd ();};_fba :=_cecc (_bbc .RowStride ,2*_eec .RowStride );switch _acbf {case 1:_gb =_ffa (_bbc ,_eec ,_acbf ,_gabg ,_fba );case 2:_gb =_bag (_bbc ,_eec ,_acbf ,_gabg ,_fba );case 3:_gb =_adgd (_bbc ,_eec ,_acbf ,_gabg ,_fba );
case 4:_gb =_cgb (_bbc ,_eec ,_acbf ,_gabg ,_fba );};if _gb !=nil {return nil ,_gb ;};return _eec ,nil ;};func (_edgd *Bitmap )thresholdPixelSum (_dbeb int )bool {var (_degb int ;_aaba uint8 ;_acgd byte ;_cfcg int ;);_acgg :=_edgd .RowStride ;_cafe :=uint (_edgd .Width &0x07);
if _cafe !=0{_aaba =uint8 ((0xff<<(8-_cafe ))&0xff);_acgg --;};for _gef :=0;_gef < _edgd .Height ;_gef ++{for _cfcg =0;_cfcg < _acgg ;_cfcg ++{_acgd =_edgd .Data [_gef *_edgd .RowStride +_cfcg ];_degb +=int (_ebgd [_acgd ]);};if _cafe !=0{_acgd =_edgd .Data [_gef *_edgd .RowStride +_cfcg ]&_aaba ;
_degb +=int (_ebgd [_acgd ]);};if _degb > _dbeb {return true ;};};return false ;};func (_edde *Bitmaps )GetBitmap (i int )(*Bitmap ,error ){const _cebde ="\u0047e\u0074\u0042\u0069\u0074\u006d\u0061p";if _edde ==nil {return nil ,_bc .Error (_cebde ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0042\u0069\u0074ma\u0070\u0073");
};if i > len (_edde .Values )-1{return nil ,_bc .Errorf (_cebde ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );};return _edde .Values [i ],nil ;};func (_fff *Bitmap )centroid (_bacg ,_face []int )(Point ,error ){_gcaa :=Point {};
_fff .setPadBits (0);if len (_bacg )==0{_bacg =_cbdab ();};if len (_face )==0{_face =_dddcd ();};var _ecab ,_gfbf ,_bedg ,_efeg ,_fecdf ,_egbb int ;var _dcfe byte ;for _fecdf =0;_fecdf < _fff .Height ;_fecdf ++{_bbe :=_fff .RowStride *_fecdf ;_efeg =0;
for _egbb =0;_egbb < _fff .RowStride ;_egbb ++{_dcfe =_fff .Data [_bbe +_egbb ];if _dcfe !=0{_efeg +=_face [_dcfe ];_ecab +=_bacg [_dcfe ]+_egbb *8*_face [_dcfe ];};};_bedg +=_efeg ;_gfbf +=_efeg *_fecdf ;};if _bedg !=0{_gcaa .X =float32 (_ecab )/float32 (_bedg );
_gcaa .Y =float32 (_gfbf )/float32 (_bedg );};return _gcaa ,nil ;};var _gcdda =[5]int {1,2,3,0,4};func _efgff (_cfbf *Bitmap ,_egca ,_eccae ,_dfgg ,_agead int ,_cgff RasterOperator ){if _egca < 0{_dfgg +=_egca ;_egca =0;};_ggg :=_egca +_dfgg -_cfbf .Width ;
if _ggg > 0{_dfgg -=_ggg ;};if _eccae < 0{_agead +=_eccae ;_eccae =0;};_gccgg :=_eccae +_agead -_cfbf .Height ;if _gccgg > 0{_agead -=_gccgg ;};if _dfgg <=0||_agead <=0{return ;};if (_egca &7)==0{_fffa (_cfbf ,_egca ,_eccae ,_dfgg ,_agead ,_cgff );}else {_fffb (_cfbf ,_egca ,_eccae ,_dfgg ,_agead ,_cgff );
};};type Getter interface{GetBitmap ()*Bitmap ;};func (_adgc *ClassedPoints )GetIntXByClass (i int )(int ,error ){const _abfb ="\u0043\u006c\u0061\u0073s\u0065\u0064\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047e\u0074I\u006e\u0074\u0059\u0042\u0079\u0043\u006ca\u0073\u0073";
if i >=_adgc .IntSlice .Size (){return 0,_bc .Errorf (_abfb ,"\u0069\u003a\u0020\u0027\u0025\u0064\u0027 \u0069\u0073\u0020o\u0075\u0074\u0020\u006ff\u0020\u0074\u0068\u0065\u0020\u0072\u0061\u006e\u0067\u0065\u0020\u006f\u0066\u0020\u0074\u0068\u0065\u0020\u0049\u006e\u0074\u0053\u006c\u0069\u0063\u0065",i );
};return int (_adgc .XAtIndex (i )),nil ;};func (_facag *Bitmaps )SortByWidth (){_ddbca :=(*byWidth )(_facag );_a .Sort (_ddbca )};func (_dceb *byWidth )Len ()int {return len (_dceb .Values )};func SelCreateBrick (h ,w int ,cy ,cx int ,tp SelectionValue )*Selection {_abcb :=_cbebg (h ,w ,"");
_abcb .setOrigin (cy ,cx );var _dggf ,_ecga int ;for _dggf =0;_dggf < h ;_dggf ++{for _ecga =0;_ecga < w ;_ecga ++{_abcb .Data [_dggf ][_ecga ]=tp ;};};return _abcb ;};func (_dbeba *ClassedPoints )XAtIndex (i int )float32 {return (*_dbeba .Points )[_dbeba .IntSlice [i ]].X };
func (_fdcg *Bitmaps )selectByIndexes (_agece []int )(*Bitmaps ,error ){_ebdg :=&Bitmaps {};for _ ,_fadf :=range _agece {_ebcf ,_accf :=_fdcg .GetBitmap (_fadf );if _accf !=nil {return nil ,_bc .Wrap (_accf ,"\u0073e\u006ce\u0063\u0074\u0042\u0079\u0049\u006e\u0064\u0065\u0078\u0065\u0073","");
};_ebdg .AddBitmap (_ebcf );};return _ebdg ,nil ;};func (_add *Bitmap )clearAll ()error {return _add .RasterOperation (0,0,_add .Width ,_add .Height ,PixClr ,nil ,0,0);};func (_ggfe *Bitmap )RasterOperation (dx ,dy ,dw ,dh int ,op RasterOperator ,src *Bitmap ,sx ,sy int )error {return _bdbg (_ggfe ,dx ,dy ,dw ,dh ,op ,src ,sx ,sy );
};func (_ffgg *ClassedPoints )YAtIndex (i int )float32 {return (*_ffgg .Points )[_ffgg .IntSlice [i ]].Y };func NewClassedPoints (points *Points ,classes _be .IntSlice )(*ClassedPoints ,error ){const _gacfg ="\u004e\u0065w\u0043\u006c\u0061s\u0073\u0065\u0064\u0050\u006f\u0069\u006e\u0074\u0073";
if points ==nil {return nil ,_bc .Error (_gacfg ,"\u0070\u0072\u006f\u0076id\u0065\u0064\u0020\u006e\u0069\u006c\u0020\u0070\u006f\u0069\u006e\u0074\u0073");};if classes ==nil {return nil ,_bc .Error (_gacfg ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0063\u006c\u0061ss\u0065\u0073");
};_acac :=&ClassedPoints {Points :points ,IntSlice :classes };if _gdbgb :=_acac .validateIntSlice ();_gdbgb !=nil {return nil ,_bc .Wrap (_gdbgb ,_gacfg ,"");};return _acac ,nil ;};func (_acc *Bitmap )CreateTemplate ()*Bitmap {return _acc .createTemplate ()};
func (_caf *Bitmap )SetByte (index int ,v byte )error {if index > len (_caf .Data )-1||index < 0{return _bc .Errorf ("\u0053e\u0074\u0042\u0079\u0074\u0065","\u0069\u006e\u0064\u0065x \u006f\u0075\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065\u003a\u0020%\u0064",index );
};_caf .Data [index ]=v ;return nil ;};func CorrelationScore (bm1 ,bm2 *Bitmap ,area1 ,area2 int ,delX ,delY float32 ,maxDiffW ,maxDiffH int ,tab []int )(_ccef float64 ,_fgdg error ){const _bac ="\u0063\u006fr\u0072\u0065\u006ca\u0074\u0069\u006f\u006e\u0053\u0063\u006f\u0072\u0065";
if bm1 ==nil ||bm2 ==nil {return 0,_bc .Error (_bac ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0062\u0069\u0074ma\u0070\u0073");};if tab ==nil {return 0,_bc .Error (_bac ,"\u0027\u0074\u0061\u0062\u0027\u0020\u006e\u006f\u0074\u0020\u0064\u0065f\u0069\u006e\u0065\u0064");
};if area1 <=0||area2 <=0{return 0,_bc .Error (_bac ,"\u0061\u0072\u0065\u0061s\u0020\u006d\u0075\u0073\u0074\u0020\u0062\u0065\u0020\u0067r\u0065a\u0074\u0065\u0072\u0020\u0074\u0068\u0061n\u0020\u0030");};_gbb ,_fcbe :=bm1 .Width ,bm1 .Height ;_geba ,_efgfa :=bm2 .Width ,bm2 .Height ;
_agfg :=_afa (_gbb -_geba );if _agfg > maxDiffW {return 0,nil ;};_aaaga :=_afa (_fcbe -_efgfa );if _aaaga > maxDiffH {return 0,nil ;};var _fcag ,_bcgg int ;if delX >=0{_fcag =int (delX +0.5);}else {_fcag =int (delX -0.5);};if delY >=0{_bcgg =int (delY +0.5);
}else {_bcgg =int (delY -0.5);};_aedg :=_faca (_bcgg ,0);_cdege :=_cecc (_efgfa +_bcgg ,_fcbe );_bdab :=bm1 .RowStride *_aedg ;_bafg :=bm2 .RowStride *(_aedg -_bcgg );_fcac :=_faca (_fcag ,0);_bbb :=_cecc (_geba +_fcag ,_gbb );_feefc :=bm2 .RowStride ;
var _acggg ,_cdg int ;if _fcag >=8{_acggg =_fcag >>3;_bdab +=_acggg ;_fcac -=_acggg <<3;_bbb -=_acggg <<3;_fcag &=7;}else if _fcag <=-8{_cdg =-((_fcag +7)>>3);_bafg +=_cdg ;_feefc -=_cdg ;_fcag +=_cdg <<3;};if _fcac >=_bbb ||_aedg >=_cdege {return 0,nil ;
};_ffb :=(_bbb +7)>>3;var (_acgdd ,_fdf ,_fab byte ;_ffcbc ,_eff ,_bafa int ;);switch {case _fcag ==0:for _bafa =_aedg ;_bafa < _cdege ;_bafa ,_bdab ,_bafg =_bafa +1,_bdab +bm1 .RowStride ,_bafg +bm2 .RowStride {for _eff =0;_eff < _ffb ;_eff ++{_fab =bm1 .Data [_bdab +_eff ]&bm2 .Data [_bafg +_eff ];
_ffcbc +=tab [_fab ];};};case _fcag > 0:if _feefc < _ffb {for _bafa =_aedg ;_bafa < _cdege ;_bafa ,_bdab ,_bafg =_bafa +1,_bdab +bm1 .RowStride ,_bafg +bm2 .RowStride {_acgdd ,_fdf =bm1 .Data [_bdab ],bm2 .Data [_bafg ]>>uint (_fcag );_fab =_acgdd &_fdf ;
_ffcbc +=tab [_fab ];for _eff =1;_eff < _feefc ;_eff ++{_acgdd ,_fdf =bm1 .Data [_bdab +_eff ],(bm2 .Data [_bafg +_eff ]>>uint (_fcag ))|(bm2 .Data [_bafg +_eff -1]<<uint (8-_fcag ));_fab =_acgdd &_fdf ;_ffcbc +=tab [_fab ];};_acgdd =bm1 .Data [_bdab +_eff ];
_fdf =bm2 .Data [_bafg +_eff -1]<<uint (8-_fcag );_fab =_acgdd &_fdf ;_ffcbc +=tab [_fab ];};}else {for _bafa =_aedg ;_bafa < _cdege ;_bafa ,_bdab ,_bafg =_bafa +1,_bdab +bm1 .RowStride ,_bafg +bm2 .RowStride {_acgdd ,_fdf =bm1 .Data [_bdab ],bm2 .Data [_bafg ]>>uint (_fcag );
_fab =_acgdd &_fdf ;_ffcbc +=tab [_fab ];for _eff =1;_eff < _ffb ;_eff ++{_acgdd =bm1 .Data [_bdab +_eff ];_fdf =(bm2 .Data [_bafg +_eff ]>>uint (_fcag ))|(bm2 .Data [_bafg +_eff -1]<<uint (8-_fcag ));_fab =_acgdd &_fdf ;_ffcbc +=tab [_fab ];};};};default:if _ffb < _feefc {for _bafa =_aedg ;
_bafa < _cdege ;_bafa ,_bdab ,_bafg =_bafa +1,_bdab +bm1 .RowStride ,_bafg +bm2 .RowStride {for _eff =0;_eff < _ffb ;_eff ++{_acgdd =bm1 .Data [_bdab +_eff ];_fdf =bm2 .Data [_bafg +_eff ]<<uint (-_fcag );_fdf |=bm2 .Data [_bafg +_eff +1]>>uint (8+_fcag );
_fab =_acgdd &_fdf ;_ffcbc +=tab [_fab ];};};}else {for _bafa =_aedg ;_bafa < _cdege ;_bafa ,_bdab ,_bafg =_bafa +1,_bdab +bm1 .RowStride ,_bafg +bm2 .RowStride {for _eff =0;_eff < _ffb -1;_eff ++{_acgdd =bm1 .Data [_bdab +_eff ];_fdf =bm2 .Data [_bafg +_eff ]<<uint (-_fcag );
_fdf |=bm2 .Data [_bafg +_eff +1]>>uint (8+_fcag );_fab =_acgdd &_fdf ;_ffcbc +=tab [_fab ];};_acgdd =bm1 .Data [_bdab +_eff ];_fdf =bm2 .Data [_bafg +_eff ]<<uint (-_fcag );_fab =_acgdd &_fdf ;_ffcbc +=tab [_fab ];};};};_ccef =float64 (_ffcbc )*float64 (_ffcbc )/(float64 (area1 )*float64 (area2 ));
return _ccef ,nil ;};func (_ggag *Bitmaps )GroupByHeight ()(*BitmapsArray ,error ){const _efeb ="\u0047\u0072\u006f\u0075\u0070\u0042\u0079\u0048\u0065\u0069\u0067\u0068\u0074";if len (_ggag .Values )==0{return nil ,_bc .Error (_efeb ,"\u006eo\u0020v\u0061\u006c\u0075\u0065\u0073 \u0070\u0072o\u0076\u0069\u0064\u0065\u0064");
};_aege :=&BitmapsArray {};_ggag .SortByHeight ();_faab :=-1;_efbd :=-1;for _febc :=0;_febc < len (_ggag .Values );_febc ++{_fggd :=_ggag .Values [_febc ].Height ;if _fggd > _faab {_faab =_fggd ;_efbd ++;_aege .Values =append (_aege .Values ,&Bitmaps {});
};_aege .Values [_efbd ].AddBitmap (_ggag .Values [_febc ]);};return _aege ,nil ;};func _gfaf (_fdec *_be .Stack )(_ffec *fillSegment ,_cdfb error ){const _ffcd ="\u0070\u006f\u0070\u0046\u0069\u006c\u006c\u0053\u0065g\u006d\u0065\u006e\u0074";if _fdec ==nil {return nil ,_bc .Error (_ffcd ,"\u006ei\u006c \u0073\u0074\u0061\u0063\u006b \u0070\u0072o\u0076\u0069\u0064\u0065\u0064");
};if _fdec .Aux ==nil {return nil ,_bc .Error (_ffcd ,"a\u0075x\u0053\u0074\u0061\u0063\u006b\u0020\u006e\u006ft\u0020\u0064\u0065\u0066in\u0065\u0064");};_ggba ,_aabf :=_fdec .Pop ();if !_aabf {return nil ,nil ;};_cgcg ,_aabf :=_ggba .(*fillSegment );
if !_aabf {return nil ,_bc .Error (_ffcd ,"\u0073\u0074\u0061ck\u0020\u0064\u006f\u0065\u0073\u006e\u0027\u0074\u0020c\u006fn\u0074a\u0069n\u0020\u002a\u0066\u0069\u006c\u006c\u0053\u0065\u0067\u006d\u0065\u006e\u0074");};_ffec =&fillSegment {_cgcg ._ccce ,_cgcg ._dbdb ,_cgcg ._cfge +_cgcg ._dbdg ,_cgcg ._dbdg };
_fdec .Aux .Push (_cgcg );return _ffec ,nil ;};func TstOSymbol (t *_d .T ,scale ...int )*Bitmap {_cdfg ,_cdgg :=NewWithData (4,5,[]byte {0xF0,0x90,0x90,0x90,0xF0});_f .NoError (t ,_cdgg );return TstGetScaledSymbol (t ,_cdfg ,scale ...);};func (_ebaba *Bitmaps )CountPixels ()*_be .NumSlice {_ebeg :=&_be .NumSlice {};
for _ ,_bafga :=range _ebaba .Values {_ebeg .AddInt (_bafga .CountPixels ());};return _ebeg ;};func (_dff *Bitmap )nextOnPixel (_gegg ,_acg int )(_gcc _ag .Point ,_dbbc bool ,_dbgb error ){const _daae ="n\u0065\u0078\u0074\u004f\u006e\u0050\u0069\u0078\u0065\u006c";
_gcc ,_dbbc ,_dbgb =_dff .nextOnPixelLow (_dff .Width ,_dff .Height ,_dff .RowStride ,_gegg ,_acg );if _dbgb !=nil {return _gcc ,false ,_bc .Wrap (_dbgb ,_daae ,"");};return _gcc ,_dbbc ,nil ;};type SelectionValue int ;func _ffba (_dcff *Bitmap ,_dgfa ,_gceb ,_cegb ,_gcbe int ,_bafgb RasterOperator ,_cabb *Bitmap ,_fbda ,_bdbbf int )error {var (_gfggd byte ;
_agfaa int ;_acbc int ;_bgcfg ,_afdc int ;_dcae ,_gfga int ;);_bafbg :=_cegb >>3;_gbccc :=_cegb &7;if _gbccc > 0{_gfggd =_dcfg [_gbccc ];};_agfaa =_cabb .RowStride *_bdbbf +(_fbda >>3);_acbc =_dcff .RowStride *_gceb +(_dgfa >>3);switch _bafgb {case PixSrc :for _dcae =0;
_dcae < _gcbe ;_dcae ++{_bgcfg =_agfaa +_dcae *_cabb .RowStride ;_afdc =_acbc +_dcae *_dcff .RowStride ;for _gfga =0;_gfga < _bafbg ;_gfga ++{_dcff .Data [_afdc ]=_cabb .Data [_bgcfg ];_afdc ++;_bgcfg ++;};if _gbccc > 0{_dcff .Data [_afdc ]=_bdfed (_dcff .Data [_afdc ],_cabb .Data [_bgcfg ],_gfggd );
};};case PixNotSrc :for _dcae =0;_dcae < _gcbe ;_dcae ++{_bgcfg =_agfaa +_dcae *_cabb .RowStride ;_afdc =_acbc +_dcae *_dcff .RowStride ;for _gfga =0;_gfga < _bafbg ;_gfga ++{_dcff .Data [_afdc ]=^(_cabb .Data [_bgcfg ]);_afdc ++;_bgcfg ++;};if _gbccc > 0{_dcff .Data [_afdc ]=_bdfed (_dcff .Data [_afdc ],^_cabb .Data [_bgcfg ],_gfggd );
};};case PixSrcOrDst :for _dcae =0;_dcae < _gcbe ;_dcae ++{_bgcfg =_agfaa +_dcae *_cabb .RowStride ;_afdc =_acbc +_dcae *_dcff .RowStride ;for _gfga =0;_gfga < _bafbg ;_gfga ++{_dcff .Data [_afdc ]|=_cabb .Data [_bgcfg ];_afdc ++;_bgcfg ++;};if _gbccc > 0{_dcff .Data [_afdc ]=_bdfed (_dcff .Data [_afdc ],_cabb .Data [_bgcfg ]|_dcff .Data [_afdc ],_gfggd );
};};case PixSrcAndDst :for _dcae =0;_dcae < _gcbe ;_dcae ++{_bgcfg =_agfaa +_dcae *_cabb .RowStride ;_afdc =_acbc +_dcae *_dcff .RowStride ;for _gfga =0;_gfga < _bafbg ;_gfga ++{_dcff .Data [_afdc ]&=_cabb .Data [_bgcfg ];_afdc ++;_bgcfg ++;};if _gbccc > 0{_dcff .Data [_afdc ]=_bdfed (_dcff .Data [_afdc ],_cabb .Data [_bgcfg ]&_dcff .Data [_afdc ],_gfggd );
};};case PixSrcXorDst :for _dcae =0;_dcae < _gcbe ;_dcae ++{_bgcfg =_agfaa +_dcae *_cabb .RowStride ;_afdc =_acbc +_dcae *_dcff .RowStride ;for _gfga =0;_gfga < _bafbg ;_gfga ++{_dcff .Data [_afdc ]^=_cabb .Data [_bgcfg ];_afdc ++;_bgcfg ++;};if _gbccc > 0{_dcff .Data [_afdc ]=_bdfed (_dcff .Data [_afdc ],_cabb .Data [_bgcfg ]^_dcff .Data [_afdc ],_gfggd );
};};case PixNotSrcOrDst :for _dcae =0;_dcae < _gcbe ;_dcae ++{_bgcfg =_agfaa +_dcae *_cabb .RowStride ;_afdc =_acbc +_dcae *_dcff .RowStride ;for _gfga =0;_gfga < _bafbg ;_gfga ++{_dcff .Data [_afdc ]|=^(_cabb .Data [_bgcfg ]);_afdc ++;_bgcfg ++;};if _gbccc > 0{_dcff .Data [_afdc ]=_bdfed (_dcff .Data [_afdc ],^(_cabb .Data [_bgcfg ])|_dcff .Data [_afdc ],_gfggd );
};};case PixNotSrcAndDst :for _dcae =0;_dcae < _gcbe ;_dcae ++{_bgcfg =_agfaa +_dcae *_cabb .RowStride ;_afdc =_acbc +_dcae *_dcff .RowStride ;for _gfga =0;_gfga < _bafbg ;_gfga ++{_dcff .Data [_afdc ]&=^(_cabb .Data [_bgcfg ]);_afdc ++;_bgcfg ++;};if _gbccc > 0{_dcff .Data [_afdc ]=_bdfed (_dcff .Data [_afdc ],^(_cabb .Data [_bgcfg ])&_dcff .Data [_afdc ],_gfggd );
};};case PixSrcOrNotDst :for _dcae =0;_dcae < _gcbe ;_dcae ++{_bgcfg =_agfaa +_dcae *_cabb .RowStride ;_afdc =_acbc +_dcae *_dcff .RowStride ;for _gfga =0;_gfga < _bafbg ;_gfga ++{_dcff .Data [_afdc ]=_cabb .Data [_bgcfg ]|^(_dcff .Data [_afdc ]);_afdc ++;
_bgcfg ++;};if _gbccc > 0{_dcff .Data [_afdc ]=_bdfed (_dcff .Data [_afdc ],_cabb .Data [_bgcfg ]|^(_dcff .Data [_afdc ]),_gfggd );};};case PixSrcAndNotDst :for _dcae =0;_dcae < _gcbe ;_dcae ++{_bgcfg =_agfaa +_dcae *_cabb .RowStride ;_afdc =_acbc +_dcae *_dcff .RowStride ;
for _gfga =0;_gfga < _bafbg ;_gfga ++{_dcff .Data [_afdc ]=_cabb .Data [_bgcfg ]&^(_dcff .Data [_afdc ]);_afdc ++;_bgcfg ++;};if _gbccc > 0{_dcff .Data [_afdc ]=_bdfed (_dcff .Data [_afdc ],_cabb .Data [_bgcfg ]&^(_dcff .Data [_afdc ]),_gfggd );};};case PixNotPixSrcOrDst :for _dcae =0;
_dcae < _gcbe ;_dcae ++{_bgcfg =_agfaa +_dcae *_cabb .RowStride ;_afdc =_acbc +_dcae *_dcff .RowStride ;for _gfga =0;_gfga < _bafbg ;_gfga ++{_dcff .Data [_afdc ]=^(_cabb .Data [_bgcfg ]|_dcff .Data [_afdc ]);_afdc ++;_bgcfg ++;};if _gbccc > 0{_dcff .Data [_afdc ]=_bdfed (_dcff .Data [_afdc ],^(_cabb .Data [_bgcfg ]|_dcff .Data [_afdc ]),_gfggd );
};};case PixNotPixSrcAndDst :for _dcae =0;_dcae < _gcbe ;_dcae ++{_bgcfg =_agfaa +_dcae *_cabb .RowStride ;_afdc =_acbc +_dcae *_dcff .RowStride ;for _gfga =0;_gfga < _bafbg ;_gfga ++{_dcff .Data [_afdc ]=^(_cabb .Data [_bgcfg ]&_dcff .Data [_afdc ]);_afdc ++;
_bgcfg ++;};if _gbccc > 0{_dcff .Data [_afdc ]=_bdfed (_dcff .Data [_afdc ],^(_cabb .Data [_bgcfg ]&_dcff .Data [_afdc ]),_gfggd );};};case PixNotPixSrcXorDst :for _dcae =0;_dcae < _gcbe ;_dcae ++{_bgcfg =_agfaa +_dcae *_cabb .RowStride ;_afdc =_acbc +_dcae *_dcff .RowStride ;
for _gfga =0;_gfga < _bafbg ;_gfga ++{_dcff .Data [_afdc ]=^(_cabb .Data [_bgcfg ]^_dcff .Data [_afdc ]);_afdc ++;_bgcfg ++;};if _gbccc > 0{_dcff .Data [_afdc ]=_bdfed (_dcff .Data [_afdc ],^(_cabb .Data [_bgcfg ]^_dcff .Data [_afdc ]),_gfggd );};};default:_gc .Log .Debug ("\u0050\u0072ov\u0069\u0064\u0065d\u0020\u0069\u006e\u0076ali\u0064 r\u0061\u0073\u0074\u0065\u0072\u0020\u006fpe\u0072\u0061\u0074\u006f\u0072\u003a\u0020%\u0076",_bafgb );
return _bc .Error ("\u0072\u0061\u0073\u0074er\u004f\u0070\u0042\u0079\u0074\u0065\u0041\u006c\u0069\u0067\u006e\u0065\u0064\u004co\u0077","\u0069\u006e\u0076al\u0069\u0064\u0020\u0072\u0061\u0073\u0074\u0065\u0072\u0020\u006f\u0070\u0065\u0072\u0061\u0074\u006f\u0072");
};return nil ;};func (_gbfa *Bitmaps )Size ()int {return len (_gbfa .Values )};func TstRSymbol (t *_d .T ,scale ...int )*Bitmap {_ddddf ,_egggg :=NewWithData (4,5,[]byte {0xF0,0x90,0xF0,0xA0,0x90});_f .NoError (t ,_egggg );return TstGetScaledSymbol (t ,_ddddf ,scale ...);
};func (_feedc *Bitmaps )ClipToBitmap (s *Bitmap )(*Bitmaps ,error ){const _fdab ="B\u0069t\u006d\u0061\u0070\u0073\u002e\u0043\u006c\u0069p\u0054\u006f\u0042\u0069tm\u0061\u0070";if _feedc ==nil {return nil ,_bc .Error (_fdab ,"\u0042\u0069\u0074\u006dap\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};if s ==nil {return nil ,_bc .Error (_fdab ,"\u0073o\u0075\u0072\u0063\u0065 \u0062\u0069\u0074\u006d\u0061p\u0020n\u006ft\u0020\u0064\u0065\u0066\u0069\u006e\u0065d");};_baae :=len (_feedc .Values );_cdfa :=&Bitmaps {Values :make ([]*Bitmap ,_baae ),Boxes :make ([]*_ag .Rectangle ,_baae )};
var (_afe ,_fffad *Bitmap ;_afcg *_ag .Rectangle ;_dgfe error ;);for _ceacf :=0;_ceacf < _baae ;_ceacf ++{if _afe ,_dgfe =_feedc .GetBitmap (_ceacf );_dgfe !=nil {return nil ,_bc .Wrap (_dgfe ,_fdab ,"");};if _afcg ,_dgfe =_feedc .GetBox (_ceacf );_dgfe !=nil {return nil ,_bc .Wrap (_dgfe ,_fdab ,"");
};if _fffad ,_dgfe =s .clipRectangle (_afcg ,nil );_dgfe !=nil {return nil ,_bc .Wrap (_dgfe ,_fdab ,"");};if _fffad ,_dgfe =_fffad .And (_afe );_dgfe !=nil {return nil ,_bc .Wrap (_dgfe ,_fdab ,"");};_cdfa .Values [_ceacf ]=_fffad ;_cdfa .Boxes [_ceacf ]=_afcg ;
};return _cdfa ,nil ;};const (_ SizeComparison =iota ;SizeSelectIfLT ;SizeSelectIfGT ;SizeSelectIfLTE ;SizeSelectIfGTE ;SizeSelectIfEQ ;);func _baef (_bbfb ,_fgaga *Bitmap ,_efgb *Selection )(*Bitmap ,error ){const _cdda ="\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u004d\u006f\u0072\u0070\u0068A\u0072\u0067\u0073\u0032";
var _bgab ,_afgbc int ;if _fgaga ==nil {return nil ,_bc .Error (_cdda ,"s\u006fu\u0072\u0063\u0065\u0020\u0062\u0069\u0074\u006da\u0070\u0020\u0069\u0073 n\u0069\u006c");};if _efgb ==nil {return nil ,_bc .Error (_cdda ,"\u0073e\u006c \u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};_bgab =_efgb .Width ;_afgbc =_efgb .Height ;if _bgab ==0||_afgbc ==0{return nil ,_bc .Error (_cdda ,"\u0073\u0065\u006c\u0020\u006f\u0066\u0020\u0073\u0069\u007a\u0065\u0020\u0030");};if _bbfb ==nil {return _fgaga .createTemplate (),nil ;};if _cbcb :=_bbfb .resizeImageData (_fgaga );
_cbcb !=nil {return nil ,_cbcb ;};return _bbfb ,nil ;};func RankHausTest (p1 ,p2 ,p3 ,p4 *Bitmap ,delX ,delY float32 ,maxDiffW ,maxDiffH ,area1 ,area3 int ,rank float32 ,tab8 []int )(_bae bool ,_dbfb error ){const _aced ="\u0052\u0061\u006ek\u0048\u0061\u0075\u0073\u0054\u0065\u0073\u0074";
_faeg ,_fdgc :=p1 .Width ,p1 .Height ;_gedee ,_ddea :=p3 .Width ,p3 .Height ;if _be .Abs (_faeg -_gedee )> maxDiffW {return false ,nil ;};if _be .Abs (_fdgc -_ddea )> maxDiffH {return false ,nil ;};_baca :=int (float32 (area1 )*(1.0-rank )+0.5);_fcdf :=int (float32 (area3 )*(1.0-rank )+0.5);
var _gcff ,_dcea int ;if delX >=0{_gcff =int (delX +0.5);}else {_gcff =int (delX -0.5);};if delY >=0{_dcea =int (delY +0.5);}else {_dcea =int (delY -0.5);};_cgce :=p1 .CreateTemplate ();if _dbfb =_cgce .RasterOperation (0,0,_faeg ,_fdgc ,PixSrc ,p1 ,0,0);
_dbfb !=nil {return false ,_bc .Wrap (_dbfb ,_aced ,"p\u0031\u0020\u002d\u0053\u0052\u0043\u002d\u003e\u0020\u0074");};if _dbfb =_cgce .RasterOperation (_gcff ,_dcea ,_faeg ,_fdgc ,PixNotSrcAndDst ,p4 ,0,0);_dbfb !=nil {return false ,_bc .Wrap (_dbfb ,_aced ,"\u0074 \u0026\u0020\u0021\u0070\u0034");
};_bae ,_dbfb =_cgce .ThresholdPixelSum (_baca ,tab8 );if _dbfb !=nil {return false ,_bc .Wrap (_dbfb ,_aced ,"\u0074\u002d\u003e\u0074\u0068\u0072\u0065\u0073\u0068\u0031");};if _bae {return false ,nil ;};if _dbfb =_cgce .RasterOperation (_gcff ,_dcea ,_gedee ,_ddea ,PixSrc ,p3 ,0,0);
_dbfb !=nil {return false ,_bc .Wrap (_dbfb ,_aced ,"p\u0033\u0020\u002d\u0053\u0052\u0043\u002d\u003e\u0020\u0074");};if _dbfb =_cgce .RasterOperation (0,0,_gedee ,_ddea ,PixNotSrcAndDst ,p2 ,0,0);_dbfb !=nil {return false ,_bc .Wrap (_dbfb ,_aced ,"\u0074 \u0026\u0020\u0021\u0070\u0032");
};_bae ,_dbfb =_cgce .ThresholdPixelSum (_fcdf ,tab8 );if _dbfb !=nil {return false ,_bc .Wrap (_dbfb ,_aced ,"\u0074\u002d\u003e\u0074\u0068\u0072\u0065\u0073\u0068\u0033");};return !_bae ,nil ;};func _aca (_fee *Bitmap ,_abc ,_gg int )(*Bitmap ,error ){const _fb ="e\u0078\u0070\u0061\u006edB\u0069n\u0061\u0072\u0079\u0052\u0065p\u006c\u0069\u0063\u0061\u0074\u0065";
if _fee ==nil {return nil ,_bc .Error (_fb ,"\u0073o\u0075r\u0063\u0065\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");};if _abc <=0||_gg <=0{return nil ,_bc .Error (_fb ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0073\u0063\u0061l\u0065\u0020\u0066\u0061\u0063\u0074\u006f\u0072\u003a\u0020<\u003d\u0020\u0030");
};if _abc ==_gg {if _abc ==1{_cac ,_aec :=_ffdb (nil ,_fee );if _aec !=nil {return nil ,_bc .Wrap (_aec ,_fb ,"\u0078\u0046\u0061\u0063\u0074\u0020\u003d\u003d\u0020y\u0046\u0061\u0063\u0074");};return _cac ,nil ;};if _abc ==2||_abc ==4||_abc ==8{_aef ,_aac :=_ba (_fee ,_abc );
if _aac !=nil {return nil ,_bc .Wrap (_aac ,_fb ,"\u0078\u0046a\u0063\u0074\u0020i\u006e\u0020\u007b\u0032\u002c\u0034\u002c\u0038\u007d");};return _aef ,nil ;};};_dg :=_abc *_fee .Width ;_bda :=_gg *_fee .Height ;_af :=New (_dg ,_bda );_aag :=_af .RowStride ;
var (_aab ,_ebf ,_def ,_aae ,_aaa int ;_gee byte ;_ddf error ;);for _ebf =0;_ebf < _fee .Height ;_ebf ++{_aab =_gg *_ebf *_aag ;for _def =0;_def < _fee .Width ;_def ++{if _fc :=_fee .GetPixel (_def ,_ebf );_fc {_aaa =_abc *_def ;for _aae =0;_aae < _abc ;
_aae ++{_af .setBit (_aab *8+_aaa +_aae );};};};for _aae =1;_aae < _gg ;_aae ++{_bff :=_aab +_aae *_aag ;for _cde :=0;_cde < _aag ;_cde ++{if _gee ,_ddf =_af .GetByte (_aab +_cde );_ddf !=nil {return nil ,_bc .Wrapf (_ddf ,_fb ,"\u0072\u0065\u0070\u006cic\u0061\u0074\u0069\u006e\u0067\u0020\u006c\u0069\u006e\u0065\u003a\u0020\u0027\u0025d\u0027",_aae );
};if _ddf =_af .SetByte (_bff +_cde ,_gee );_ddf !=nil {return nil ,_bc .Wrap (_ddf ,_fb ,"\u0053\u0065\u0074\u0074in\u0067\u0020\u0062\u0079\u0074\u0065\u0020\u0066\u0061\u0069\u006c\u0065\u0064");};};};};return _af ,nil ;};func (_fdfd *BitmapsArray )AddBox (box *_ag .Rectangle ){_fdfd .Boxes =append (_fdfd .Boxes ,box )};
type BitmapsArray struct{Values []*Bitmaps ;Boxes []*_ag .Rectangle ;};func (_ggc *Bitmap )removeBorderGeneral (_ccda ,_fcad ,_gbge ,_ffdg int )(*Bitmap ,error ){const _gbgg ="\u0072\u0065\u006d\u006fve\u0042\u006f\u0072\u0064\u0065\u0072\u0047\u0065\u006e\u0065\u0072\u0061\u006c";
if _ccda < 0||_fcad < 0||_gbge < 0||_ffdg < 0{return nil ,_bc .Error (_gbgg ,"\u006e\u0065g\u0061\u0074\u0069\u0076\u0065\u0020\u0062\u0072\u006f\u0064\u0065\u0072\u0020\u0072\u0065\u006d\u006f\u0076\u0065\u0020\u0076\u0061lu\u0065\u0073");};_eggb ,_efcd :=_ggc .Width ,_ggc .Height ;
_fgd :=_eggb -_ccda -_fcad ;_aed :=_efcd -_gbge -_ffdg ;if _fgd <=0{return nil ,_bc .Errorf (_gbgg ,"w\u0069\u0064\u0074\u0068: \u0025d\u0020\u006d\u0075\u0073\u0074 \u0062\u0065\u0020\u003e\u0020\u0030",_fgd );};if _aed <=0{return nil ,_bc .Errorf (_gbgg ,"\u0068\u0065\u0069\u0067ht\u003a\u0020\u0025\u0064\u0020\u006d\u0075\u0073\u0074\u0020\u0062\u0065\u0020\u003e \u0030",_aed );
};_gbdf :=New (_fgd ,_aed );_gbdf .Color =_ggc .Color ;_eaba :=_gbdf .RasterOperation (0,0,_fgd ,_aed ,PixSrc ,_ggc ,_ccda ,_gbge );if _eaba !=nil {return nil ,_bc .Wrap (_eaba ,_gbgg ,"");};return _gbdf ,nil ;};func (_cfb *Bitmap )setEightPartlyBytes (_gge ,_efea int ,_dbef uint64 )(_fbe error ){var (_fegc byte ;
_gfe int ;);const _eabd ="\u0073\u0065\u0074\u0045ig\u0068\u0074\u0050\u0061\u0072\u0074\u006c\u0079\u0042\u0079\u0074\u0065\u0073";for _fac :=1;_fac <=_efea ;_fac ++{_gfe =64-_fac *8;_fegc =byte (_dbef >>uint (_gfe )&0xff);_gc .Log .Trace ("\u0074\u0065\u006d\u0070\u003a\u0020\u0025\u0030\u0038\u0062\u002c\u0020\u0069\u006e\u0064\u0065\u0078\u003a %\u0064,\u0020\u0069\u0064\u0078\u003a\u0020\u0025\u0064\u002c\u0020\u0066\u0075l\u006c\u0042\u0079\u0074\u0065\u0073\u004e\u0075\u006d\u0062\u0065\u0072\u003a\u0020\u0025\u0064\u002c \u0073\u0068\u0069\u0066\u0074\u003a\u0020\u0025\u0064",_fegc ,_gge ,_gge +_fac -1,_efea ,_gfe );
if _fbe =_cfb .SetByte (_gge +_fac -1,_fegc );_fbe !=nil {return _bc .Wrap (_fbe ,_eabd ,"\u0066\u0075\u006c\u006c\u0042\u0079\u0074\u0065");};};_cabe :=_cfb .RowStride *8-_cfb .Width ;if _cabe ==0{return nil ;};_gfe -=8;_fegc =byte (_dbef >>uint (_gfe )&0xff)<<uint (_cabe );
if _fbe =_cfb .SetByte (_gge +_efea ,_fegc );_fbe !=nil {return _bc .Wrap (_fbe ,_eabd ,"\u0070\u0061\u0064\u0064\u0065\u0064");};return nil ;};func (_bbcb *Selection )setOrigin (_ggec ,_edbe int ){_bbcb .Cy ,_bbcb .Cx =_ggec ,_edbe };const (Vanilla Color =iota ;
Chocolate ;);func (_fcf *Bitmap )setEightFullBytes (_dggg int ,_bdff uint64 )error {if _dggg +7> len (_fcf .Data )-1{return _bc .Error ("\u0073\u0065\u0074\u0045\u0069\u0067\u0068\u0074\u0042\u0079\u0074\u0065\u0073","\u0069n\u0064e\u0078\u0020\u006f\u0075\u0074 \u006f\u0066 \u0072\u0061\u006e\u0067\u0065");
};_fcf .Data [_dggg ]=byte ((_bdff &0xff00000000000000)>>56);_fcf .Data [_dggg +1]=byte ((_bdff &0xff000000000000)>>48);_fcf .Data [_dggg +2]=byte ((_bdff &0xff0000000000)>>40);_fcf .Data [_dggg +3]=byte ((_bdff &0xff00000000)>>32);_fcf .Data [_dggg +4]=byte ((_bdff &0xff000000)>>24);
_fcf .Data [_dggg +5]=byte ((_bdff &0xff0000)>>16);_fcf .Data [_dggg +6]=byte ((_bdff &0xff00)>>8);_fcf .Data [_dggg +7]=byte (_bdff &0xff);return nil ;};func _cebf (_geac ,_eege *Bitmap ,_abdcb ,_dcce ,_ced ,_afab ,_gbc ,_fcga ,_aabd ,_baad int ,_aagc CombinationOperator ,_abbc int )error {var _dadg int ;
_bcdb :=func (){_dadg ++;_ced +=_eege .RowStride ;_afab +=_geac .RowStride ;_gbc +=_geac .RowStride };for _dadg =_abdcb ;_dadg < _dcce ;_bcdb (){var _eba uint16 ;_fbdf :=_ced ;for _cggf :=_afab ;_cggf <=_gbc ;_cggf ++{_adf ,_gdac :=_eege .GetByte (_fbdf );
if _gdac !=nil {return _gdac ;};_bfef ,_gdac :=_geac .GetByte (_cggf );if _gdac !=nil {return _gdac ;};_eba =(_eba |(uint16 (_bfef )&0xff))<<uint (_baad );_bfef =byte (_eba >>8);if _gdac =_eege .SetByte (_fbdf ,_abfa (_adf ,_bfef ,_aagc ));_gdac !=nil {return _gdac ;
};_fbdf ++;_eba <<=uint (_aabd );if _cggf ==_gbc {_bfef =byte (_eba >>(8-uint8 (_baad )));if _abbc !=0{_bfef =_edee (uint (8+_fcga ),_bfef );};_adf ,_gdac =_eege .GetByte (_fbdf );if _gdac !=nil {return _gdac ;};if _gdac =_eege .SetByte (_fbdf ,_abfa (_adf ,_bfef ,_aagc ));
_gdac !=nil {return _gdac ;};};};};return nil ;};func (_gadd *Bitmap )GetVanillaData ()[]byte {if _gadd .Color ==Chocolate {_gadd .inverseData ();};return _gadd .Data ;};func New (width ,height int )*Bitmap {_bea :=_dac (width ,height );_bea .Data =make ([]byte ,height *_bea .RowStride );
return _bea ;};func (_eedf *Bitmaps )AddBitmap (bm *Bitmap ){_eedf .Values =append (_eedf .Values ,bm )};func (_fggbd *byHeight )Less (i ,j int )bool {return _fggbd .Values [i ].Height < _fggbd .Values [j ].Height };const (ComponentConn Component =iota ;
ComponentCharacters ;ComponentWords ;);func (_dcbd Points )GetGeometry (i int )(_cecfc ,_cgdc float32 ,_dfea error ){if i > len (_dcbd )-1{return 0,0,_bc .Errorf ("\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047\u0065\u0074","\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};_cfdd :=_dcbd [i ];return _cfdd .X ,_cfdd .Y ,nil ;};func (_aadb *Bitmaps )SelectBySize (width ,height int ,tp LocationFilter ,relation SizeComparison )(_cfeb *Bitmaps ,_edbcg error ){const _abgf ="B\u0069t\u006d\u0061\u0070\u0073\u002e\u0053\u0065\u006ce\u0063\u0074\u0042\u0079Si\u007a\u0065";
if _aadb ==nil {return nil ,_bc .Error (_abgf ,"\u0027\u0062\u0027 B\u0069\u0074\u006d\u0061\u0070\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};switch tp {case LocSelectWidth ,LocSelectHeight ,LocSelectIfEither ,LocSelectIfBoth :default:return nil ,_bc .Errorf (_abgf ,"\u0070\u0072\u006f\u0076\u0069d\u0065\u0064\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006c\u006fc\u0061\u0074\u0069\u006f\u006e\u0020\u0066\u0069\u006c\u0074\u0065\u0072\u0020\u0074\u0079\u0070\u0065\u003a\u0020\u0025\u0064",tp );
};switch relation {case SizeSelectIfLT ,SizeSelectIfGT ,SizeSelectIfLTE ,SizeSelectIfGTE ,SizeSelectIfEQ :default:return nil ,_bc .Errorf (_abgf ,"\u0069\u006e\u0076\u0061li\u0064\u0020\u0072\u0065\u006c\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0027\u0025d\u0027",relation );
};_dgfeb ,_edbcg :=_aadb .makeSizeIndicator (width ,height ,tp ,relation );if _edbcg !=nil {return nil ,_bc .Wrap (_edbcg ,_abgf ,"");};_cfeb ,_edbcg =_aadb .selectByIndicator (_dgfeb );if _edbcg !=nil {return nil ,_bc .Wrap (_edbcg ,_abgf ,"");};return _cfeb ,nil ;
};func (_dgf *Bitmap )nextOnPixelLow (_gcdd ,_fge ,_ggb ,_gdcf ,_gfgfa int )(_ggbg _ag .Point ,_aaea bool ,_cdf error ){const _dbcb ="B\u0069\u0074\u006d\u0061p.\u006ee\u0078\u0074\u004f\u006e\u0050i\u0078\u0065\u006c\u004c\u006f\u0077";var (_gfcb int ;
_cebd byte ;);_dddc :=_gfgfa *_ggb ;_acgf :=_dddc +(_gdcf /8);if _cebd ,_cdf =_dgf .GetByte (_acgf );_cdf !=nil {return _ggbg ,false ,_bc .Wrap (_cdf ,_dbcb ,"\u0078\u0053\u0074\u0061\u0072\u0074\u0020\u0061\u006e\u0064 \u0079\u0053\u0074\u0061\u0072\u0074\u0020o\u0075\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065");
};if _cebd !=0{_gcbd :=_gdcf -(_gdcf %8)+7;for _gfcb =_gdcf ;_gfcb <=_gcbd &&_gfcb < _gcdd ;_gfcb ++{if _dgf .GetPixel (_gfcb ,_gfgfa ){_ggbg .X =_gfcb ;_ggbg .Y =_gfgfa ;return _ggbg ,true ,nil ;};};};_ffcb :=(_gdcf /8)+1;_gfcb =8*_ffcb ;var _fcd int ;
for _acgf =_dddc +_ffcb ;_gfcb < _gcdd ;_acgf ,_gfcb =_acgf +1,_gfcb +8{if _cebd ,_cdf =_dgf .GetByte (_acgf );_cdf !=nil {return _ggbg ,false ,_bc .Wrap (_cdf ,_dbcb ,"r\u0065\u0073\u0074\u0020of\u0020t\u0068\u0065\u0020\u006c\u0069n\u0065\u0020\u0062\u0079\u0074\u0065");
};if _cebd ==0{continue ;};for _fcd =0;_fcd < 8&&_gfcb < _gcdd ;_fcd ,_gfcb =_fcd +1,_gfcb +1{if _dgf .GetPixel (_gfcb ,_gfgfa ){_ggbg .X =_gfcb ;_ggbg .Y =_gfgfa ;return _ggbg ,true ,nil ;};};};for _ebb :=_gfgfa +1;_ebb < _fge ;_ebb ++{_dddc =_ebb *_ggb ;
for _acgf ,_gfcb =_dddc ,0;_gfcb < _gcdd ;_acgf ,_gfcb =_acgf +1,_gfcb +8{if _cebd ,_cdf =_dgf .GetByte (_acgf );_cdf !=nil {return _ggbg ,false ,_bc .Wrap (_cdf ,_dbcb ,"\u0066o\u006cl\u006f\u0077\u0069\u006e\u0067\u0020\u006c\u0069\u006e\u0065\u0073");
};if _cebd ==0{continue ;};for _fcd =0;_fcd < 8&&_gfcb < _gcdd ;_fcd ,_gfcb =_fcd +1,_gfcb +1{if _dgf .GetPixel (_gfcb ,_ebb ){_ggbg .X =_gfcb ;_ggbg .Y =_ebb ;return _ggbg ,true ,nil ;};};};};return _ggbg ,false ,nil ;};func (_bgfe *Bitmaps )makeSizeIndicator (_dcca ,_baebc int ,_edcc LocationFilter ,_eecce SizeComparison )(_abfbd *_be .NumSlice ,_fdaec error ){const _cddd ="\u0042i\u0074\u006d\u0061\u0070s\u002e\u006d\u0061\u006b\u0065S\u0069z\u0065I\u006e\u0064\u0069\u0063\u0061\u0074\u006fr";
if _bgfe ==nil {return nil ,_bc .Error (_cddd ,"\u0062\u0069\u0074ma\u0070\u0073\u0020\u0027\u0062\u0027\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};switch _edcc {case LocSelectWidth ,LocSelectHeight ,LocSelectIfEither ,LocSelectIfBoth :default:return nil ,_bc .Errorf (_cddd ,"\u0070\u0072\u006f\u0076\u0069d\u0065\u0064\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006c\u006fc\u0061\u0074\u0069\u006f\u006e\u0020\u0066\u0069\u006c\u0074\u0065\u0072\u0020\u0074\u0079\u0070\u0065\u003a\u0020\u0025\u0064",_edcc );
};switch _eecce {case SizeSelectIfLT ,SizeSelectIfGT ,SizeSelectIfLTE ,SizeSelectIfGTE ,SizeSelectIfEQ :default:return nil ,_bc .Errorf (_cddd ,"\u0069\u006e\u0076\u0061li\u0064\u0020\u0072\u0065\u006c\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0027\u0025d\u0027",_eecce );
};_abfbd =&_be .NumSlice {};var (_bdfedg ,_agab ,_gddg int ;_gfgad *Bitmap ;);for _ ,_gfgad =range _bgfe .Values {_bdfedg =0;_agab ,_gddg =_gfgad .Width ,_gfgad .Height ;switch _edcc {case LocSelectWidth :if (_eecce ==SizeSelectIfLT &&_agab < _dcca )||(_eecce ==SizeSelectIfGT &&_agab > _dcca )||(_eecce ==SizeSelectIfLTE &&_agab <=_dcca )||(_eecce ==SizeSelectIfGTE &&_agab >=_dcca )||(_eecce ==SizeSelectIfEQ &&_agab ==_dcca ){_bdfedg =1;
};case LocSelectHeight :if (_eecce ==SizeSelectIfLT &&_gddg < _baebc )||(_eecce ==SizeSelectIfGT &&_gddg > _baebc )||(_eecce ==SizeSelectIfLTE &&_gddg <=_baebc )||(_eecce ==SizeSelectIfGTE &&_gddg >=_baebc )||(_eecce ==SizeSelectIfEQ &&_gddg ==_baebc ){_bdfedg =1;
};case LocSelectIfEither :if (_eecce ==SizeSelectIfLT &&(_agab < _dcca ||_gddg < _baebc ))||(_eecce ==SizeSelectIfGT &&(_agab > _dcca ||_gddg > _baebc ))||(_eecce ==SizeSelectIfLTE &&(_agab <=_dcca ||_gddg <=_baebc ))||(_eecce ==SizeSelectIfGTE &&(_agab >=_dcca ||_gddg >=_baebc ))||(_eecce ==SizeSelectIfEQ &&(_agab ==_dcca ||_gddg ==_baebc )){_bdfedg =1;
};case LocSelectIfBoth :if (_eecce ==SizeSelectIfLT &&(_agab < _dcca &&_gddg < _baebc ))||(_eecce ==SizeSelectIfGT &&(_agab > _dcca &&_gddg > _baebc ))||(_eecce ==SizeSelectIfLTE &&(_agab <=_dcca &&_gddg <=_baebc ))||(_eecce ==SizeSelectIfGTE &&(_agab >=_dcca &&_gddg >=_baebc ))||(_eecce ==SizeSelectIfEQ &&(_agab ==_dcca &&_gddg ==_baebc )){_bdfedg =1;
};};_abfbd .AddInt (_bdfedg );};return _abfbd ,nil ;};func _eadd ()(_cff [256]uint64 ){for _ccf :=0;_ccf < 256;_ccf ++{if _ccf &0x01!=0{_cff [_ccf ]|=0xff;};if _ccf &0x02!=0{_cff [_ccf ]|=0xff00;};if _ccf &0x04!=0{_cff [_ccf ]|=0xff0000;};if _ccf &0x08!=0{_cff [_ccf ]|=0xff000000;
};if _ccf &0x10!=0{_cff [_ccf ]|=0xff00000000;};if _ccf &0x20!=0{_cff [_ccf ]|=0xff0000000000;};if _ccf &0x40!=0{_cff [_ccf ]|=0xff000000000000;};if _ccf &0x80!=0{_cff [_ccf ]|=0xff00000000000000;};};return _cff ;};var (_fbddb *Bitmap ;_fcbeg *Bitmap ;
);func (_beba *Bitmaps )WidthSorter ()func (_egbce ,_dggb int )bool {return func (_ggeg ,_bcae int )bool {return _beba .Values [_ggeg ].Width < _beba .Values [_bcae ].Width };};func (_acfd *Bitmaps )GetBox (i int )(*_ag .Rectangle ,error ){const _fabd ="\u0047\u0065\u0074\u0042\u006f\u0078";
if _acfd ==nil {return nil ,_bc .Error (_fabd ,"\u0070\u0072\u006f\u0076id\u0065\u0064\u0020\u006e\u0069\u006c\u0020\u0027\u0042\u0069\u0074\u006d\u0061\u0070s\u0027");};if i > len (_acfd .Boxes )-1{return nil ,_bc .Errorf (_fabd ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};return _acfd .Boxes [i ],nil ;};func _bdgd (_bacdf *Bitmap ,_adgf ,_dgaeg ,_dgbd ,_fbafg int ,_ecaf RasterOperator ,_ffgaf *Bitmap ,_cacd ,_fgbg int )error {var (_gebgg bool ;_bdge bool ;_cebcd byte ;_bbac int ;_bedgc int ;_ccaa int ;_gebf int ;_cbbb bool ;
_gbecg int ;_aeae int ;_ffdf int ;_cdaf bool ;_cggg byte ;_fgde int ;_cdcc int ;_bddc int ;_bgee byte ;_gccbf int ;_dadgg int ;_acagg uint ;_ecac uint ;_dfga byte ;_decf shift ;_agbdf bool ;_daacc bool ;_dgaa ,_ffbf int ;);if _cacd &7!=0{_dadgg =8-(_cacd &7);
};if _adgf &7!=0{_bedgc =8-(_adgf &7);};if _dadgg ==0&&_bedgc ==0{_dfga =_fag [0];}else {if _bedgc > _dadgg {_acagg =uint (_bedgc -_dadgg );}else {_acagg =uint (8-(_dadgg -_bedgc ));};_ecac =8-_acagg ;_dfga =_fag [_acagg ];};if (_adgf &7)!=0{_gebgg =true ;
_bbac =8-(_adgf &7);_cebcd =_fag [_bbac ];_ccaa =_bacdf .RowStride *_dgaeg +(_adgf >>3);_gebf =_ffgaf .RowStride *_fgbg +(_cacd >>3);_gccbf =8-(_cacd &7);if _bbac > _gccbf {_decf =_afaa ;if _dgbd >=_dadgg {_agbdf =true ;};}else {_decf =_eafde ;};};if _dgbd < _bbac {_bdge =true ;
_cebcd &=_dcfg [8-_bbac +_dgbd ];};if !_bdge {_gbecg =(_dgbd -_bbac )>>3;if _gbecg !=0{_cbbb =true ;_aeae =_bacdf .RowStride *_dgaeg +((_adgf +_bedgc )>>3);_ffdf =_ffgaf .RowStride *_fgbg +((_cacd +_bedgc )>>3);};};_fgde =(_adgf +_dgbd )&7;if !_bdge &&_fgde !=0{_cdaf =true ;
_cggg =_dcfg [_fgde ];_cdcc =_bacdf .RowStride *_dgaeg +((_adgf +_bedgc )>>3)+_gbecg ;_bddc =_ffgaf .RowStride *_fgbg +((_cacd +_bedgc )>>3)+_gbecg ;if _fgde > int (_ecac ){_daacc =true ;};};switch _ecaf {case PixSrc :if _gebgg {for _dgaa =0;_dgaa < _fbafg ;
_dgaa ++{if _decf ==_afaa {_bgee =_ffgaf .Data [_gebf ]<<_acagg ;if _agbdf {_bgee =_bdfed (_bgee ,_ffgaf .Data [_gebf +1]>>_ecac ,_dfga );};}else {_bgee =_ffgaf .Data [_gebf ]>>_ecac ;};_bacdf .Data [_ccaa ]=_bdfed (_bacdf .Data [_ccaa ],_bgee ,_cebcd );
_ccaa +=_bacdf .RowStride ;_gebf +=_ffgaf .RowStride ;};};if _cbbb {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{for _ffbf =0;_ffbf < _gbecg ;_ffbf ++{_bgee =_bdfed (_ffgaf .Data [_ffdf +_ffbf ]<<_acagg ,_ffgaf .Data [_ffdf +_ffbf +1]>>_ecac ,_dfga );_bacdf .Data [_aeae +_ffbf ]=_bgee ;
};_aeae +=_bacdf .RowStride ;_ffdf +=_ffgaf .RowStride ;};};if _cdaf {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{_bgee =_ffgaf .Data [_bddc ]<<_acagg ;if _daacc {_bgee =_bdfed (_bgee ,_ffgaf .Data [_bddc +1]>>_ecac ,_dfga );};_bacdf .Data [_cdcc ]=_bdfed (_bacdf .Data [_cdcc ],_bgee ,_cggg );
_cdcc +=_bacdf .RowStride ;_bddc +=_ffgaf .RowStride ;};};case PixNotSrc :if _gebgg {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{if _decf ==_afaa {_bgee =_ffgaf .Data [_gebf ]<<_acagg ;if _agbdf {_bgee =_bdfed (_bgee ,_ffgaf .Data [_gebf +1]>>_ecac ,_dfga );
};}else {_bgee =_ffgaf .Data [_gebf ]>>_ecac ;};_bacdf .Data [_ccaa ]=_bdfed (_bacdf .Data [_ccaa ],^_bgee ,_cebcd );_ccaa +=_bacdf .RowStride ;_gebf +=_ffgaf .RowStride ;};};if _cbbb {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{for _ffbf =0;_ffbf < _gbecg ;
_ffbf ++{_bgee =_bdfed (_ffgaf .Data [_ffdf +_ffbf ]<<_acagg ,_ffgaf .Data [_ffdf +_ffbf +1]>>_ecac ,_dfga );_bacdf .Data [_aeae +_ffbf ]=^_bgee ;};_aeae +=_bacdf .RowStride ;_ffdf +=_ffgaf .RowStride ;};};if _cdaf {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{_bgee =_ffgaf .Data [_bddc ]<<_acagg ;
if _daacc {_bgee =_bdfed (_bgee ,_ffgaf .Data [_bddc +1]>>_ecac ,_dfga );};_bacdf .Data [_cdcc ]=_bdfed (_bacdf .Data [_cdcc ],^_bgee ,_cggg );_cdcc +=_bacdf .RowStride ;_bddc +=_ffgaf .RowStride ;};};case PixSrcOrDst :if _gebgg {for _dgaa =0;_dgaa < _fbafg ;
_dgaa ++{if _decf ==_afaa {_bgee =_ffgaf .Data [_gebf ]<<_acagg ;if _agbdf {_bgee =_bdfed (_bgee ,_ffgaf .Data [_gebf +1]>>_ecac ,_dfga );};}else {_bgee =_ffgaf .Data [_gebf ]>>_ecac ;};_bacdf .Data [_ccaa ]=_bdfed (_bacdf .Data [_ccaa ],_bgee |_bacdf .Data [_ccaa ],_cebcd );
_ccaa +=_bacdf .RowStride ;_gebf +=_ffgaf .RowStride ;};};if _cbbb {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{for _ffbf =0;_ffbf < _gbecg ;_ffbf ++{_bgee =_bdfed (_ffgaf .Data [_ffdf +_ffbf ]<<_acagg ,_ffgaf .Data [_ffdf +_ffbf +1]>>_ecac ,_dfga );_bacdf .Data [_aeae +_ffbf ]|=_bgee ;
};_aeae +=_bacdf .RowStride ;_ffdf +=_ffgaf .RowStride ;};};if _cdaf {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{_bgee =_ffgaf .Data [_bddc ]<<_acagg ;if _daacc {_bgee =_bdfed (_bgee ,_ffgaf .Data [_bddc +1]>>_ecac ,_dfga );};_bacdf .Data [_cdcc ]=_bdfed (_bacdf .Data [_cdcc ],_bgee |_bacdf .Data [_cdcc ],_cggg );
_cdcc +=_bacdf .RowStride ;_bddc +=_ffgaf .RowStride ;};};case PixSrcAndDst :if _gebgg {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{if _decf ==_afaa {_bgee =_ffgaf .Data [_gebf ]<<_acagg ;if _agbdf {_bgee =_bdfed (_bgee ,_ffgaf .Data [_gebf +1]>>_ecac ,_dfga );
};}else {_bgee =_ffgaf .Data [_gebf ]>>_ecac ;};_bacdf .Data [_ccaa ]=_bdfed (_bacdf .Data [_ccaa ],_bgee &_bacdf .Data [_ccaa ],_cebcd );_ccaa +=_bacdf .RowStride ;_gebf +=_ffgaf .RowStride ;};};if _cbbb {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{for _ffbf =0;
_ffbf < _gbecg ;_ffbf ++{_bgee =_bdfed (_ffgaf .Data [_ffdf +_ffbf ]<<_acagg ,_ffgaf .Data [_ffdf +_ffbf +1]>>_ecac ,_dfga );_bacdf .Data [_aeae +_ffbf ]&=_bgee ;};_aeae +=_bacdf .RowStride ;_ffdf +=_ffgaf .RowStride ;};};if _cdaf {for _dgaa =0;_dgaa < _fbafg ;
_dgaa ++{_bgee =_ffgaf .Data [_bddc ]<<_acagg ;if _daacc {_bgee =_bdfed (_bgee ,_ffgaf .Data [_bddc +1]>>_ecac ,_dfga );};_bacdf .Data [_cdcc ]=_bdfed (_bacdf .Data [_cdcc ],_bgee &_bacdf .Data [_cdcc ],_cggg );_cdcc +=_bacdf .RowStride ;_bddc +=_ffgaf .RowStride ;
};};case PixSrcXorDst :if _gebgg {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{if _decf ==_afaa {_bgee =_ffgaf .Data [_gebf ]<<_acagg ;if _agbdf {_bgee =_bdfed (_bgee ,_ffgaf .Data [_gebf +1]>>_ecac ,_dfga );};}else {_bgee =_ffgaf .Data [_gebf ]>>_ecac ;};_bacdf .Data [_ccaa ]=_bdfed (_bacdf .Data [_ccaa ],_bgee ^_bacdf .Data [_ccaa ],_cebcd );
_ccaa +=_bacdf .RowStride ;_gebf +=_ffgaf .RowStride ;};};if _cbbb {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{for _ffbf =0;_ffbf < _gbecg ;_ffbf ++{_bgee =_bdfed (_ffgaf .Data [_ffdf +_ffbf ]<<_acagg ,_ffgaf .Data [_ffdf +_ffbf +1]>>_ecac ,_dfga );_bacdf .Data [_aeae +_ffbf ]^=_bgee ;
};_aeae +=_bacdf .RowStride ;_ffdf +=_ffgaf .RowStride ;};};if _cdaf {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{_bgee =_ffgaf .Data [_bddc ]<<_acagg ;if _daacc {_bgee =_bdfed (_bgee ,_ffgaf .Data [_bddc +1]>>_ecac ,_dfga );};_bacdf .Data [_cdcc ]=_bdfed (_bacdf .Data [_cdcc ],_bgee ^_bacdf .Data [_cdcc ],_cggg );
_cdcc +=_bacdf .RowStride ;_bddc +=_ffgaf .RowStride ;};};case PixNotSrcOrDst :if _gebgg {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{if _decf ==_afaa {_bgee =_ffgaf .Data [_gebf ]<<_acagg ;if _agbdf {_bgee =_bdfed (_bgee ,_ffgaf .Data [_gebf +1]>>_ecac ,_dfga );
};}else {_bgee =_ffgaf .Data [_gebf ]>>_ecac ;};_bacdf .Data [_ccaa ]=_bdfed (_bacdf .Data [_ccaa ],^_bgee |_bacdf .Data [_ccaa ],_cebcd );_ccaa +=_bacdf .RowStride ;_gebf +=_ffgaf .RowStride ;};};if _cbbb {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{for _ffbf =0;
_ffbf < _gbecg ;_ffbf ++{_bgee =_bdfed (_ffgaf .Data [_ffdf +_ffbf ]<<_acagg ,_ffgaf .Data [_ffdf +_ffbf +1]>>_ecac ,_dfga );_bacdf .Data [_aeae +_ffbf ]|=^_bgee ;};_aeae +=_bacdf .RowStride ;_ffdf +=_ffgaf .RowStride ;};};if _cdaf {for _dgaa =0;_dgaa < _fbafg ;
_dgaa ++{_bgee =_ffgaf .Data [_bddc ]<<_acagg ;if _daacc {_bgee =_bdfed (_bgee ,_ffgaf .Data [_bddc +1]>>_ecac ,_dfga );};_bacdf .Data [_cdcc ]=_bdfed (_bacdf .Data [_cdcc ],^_bgee |_bacdf .Data [_cdcc ],_cggg );_cdcc +=_bacdf .RowStride ;_bddc +=_ffgaf .RowStride ;
};};case PixNotSrcAndDst :if _gebgg {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{if _decf ==_afaa {_bgee =_ffgaf .Data [_gebf ]<<_acagg ;if _agbdf {_bgee =_bdfed (_bgee ,_ffgaf .Data [_gebf +1]>>_ecac ,_dfga );};}else {_bgee =_ffgaf .Data [_gebf ]>>_ecac ;};
_bacdf .Data [_ccaa ]=_bdfed (_bacdf .Data [_ccaa ],^_bgee &_bacdf .Data [_ccaa ],_cebcd );_ccaa +=_bacdf .RowStride ;_gebf +=_ffgaf .RowStride ;};};if _cbbb {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{for _ffbf =0;_ffbf < _gbecg ;_ffbf ++{_bgee =_bdfed (_ffgaf .Data [_ffdf +_ffbf ]<<_acagg ,_ffgaf .Data [_ffdf +_ffbf +1]>>_ecac ,_dfga );
_bacdf .Data [_aeae +_ffbf ]&=^_bgee ;};_aeae +=_bacdf .RowStride ;_ffdf +=_ffgaf .RowStride ;};};if _cdaf {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{_bgee =_ffgaf .Data [_bddc ]<<_acagg ;if _daacc {_bgee =_bdfed (_bgee ,_ffgaf .Data [_bddc +1]>>_ecac ,_dfga );
};_bacdf .Data [_cdcc ]=_bdfed (_bacdf .Data [_cdcc ],^_bgee &_bacdf .Data [_cdcc ],_cggg );_cdcc +=_bacdf .RowStride ;_bddc +=_ffgaf .RowStride ;};};case PixSrcOrNotDst :if _gebgg {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{if _decf ==_afaa {_bgee =_ffgaf .Data [_gebf ]<<_acagg ;
if _agbdf {_bgee =_bdfed (_bgee ,_ffgaf .Data [_gebf +1]>>_ecac ,_dfga );};}else {_bgee =_ffgaf .Data [_gebf ]>>_ecac ;};_bacdf .Data [_ccaa ]=_bdfed (_bacdf .Data [_ccaa ],_bgee |^_bacdf .Data [_ccaa ],_cebcd );_ccaa +=_bacdf .RowStride ;_gebf +=_ffgaf .RowStride ;
};};if _cbbb {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{for _ffbf =0;_ffbf < _gbecg ;_ffbf ++{_bgee =_bdfed (_ffgaf .Data [_ffdf +_ffbf ]<<_acagg ,_ffgaf .Data [_ffdf +_ffbf +1]>>_ecac ,_dfga );_bacdf .Data [_aeae +_ffbf ]=_bgee |^_bacdf .Data [_aeae +_ffbf ];
};_aeae +=_bacdf .RowStride ;_ffdf +=_ffgaf .RowStride ;};};if _cdaf {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{_bgee =_ffgaf .Data [_bddc ]<<_acagg ;if _daacc {_bgee =_bdfed (_bgee ,_ffgaf .Data [_bddc +1]>>_ecac ,_dfga );};_bacdf .Data [_cdcc ]=_bdfed (_bacdf .Data [_cdcc ],_bgee |^_bacdf .Data [_cdcc ],_cggg );
_cdcc +=_bacdf .RowStride ;_bddc +=_ffgaf .RowStride ;};};case PixSrcAndNotDst :if _gebgg {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{if _decf ==_afaa {_bgee =_ffgaf .Data [_gebf ]<<_acagg ;if _agbdf {_bgee =_bdfed (_bgee ,_ffgaf .Data [_gebf +1]>>_ecac ,_dfga );
};}else {_bgee =_ffgaf .Data [_gebf ]>>_ecac ;};_bacdf .Data [_ccaa ]=_bdfed (_bacdf .Data [_ccaa ],_bgee &^_bacdf .Data [_ccaa ],_cebcd );_ccaa +=_bacdf .RowStride ;_gebf +=_ffgaf .RowStride ;};};if _cbbb {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{for _ffbf =0;
_ffbf < _gbecg ;_ffbf ++{_bgee =_bdfed (_ffgaf .Data [_ffdf +_ffbf ]<<_acagg ,_ffgaf .Data [_ffdf +_ffbf +1]>>_ecac ,_dfga );_bacdf .Data [_aeae +_ffbf ]=_bgee &^_bacdf .Data [_aeae +_ffbf ];};_aeae +=_bacdf .RowStride ;_ffdf +=_ffgaf .RowStride ;};};if _cdaf {for _dgaa =0;
_dgaa < _fbafg ;_dgaa ++{_bgee =_ffgaf .Data [_bddc ]<<_acagg ;if _daacc {_bgee =_bdfed (_bgee ,_ffgaf .Data [_bddc +1]>>_ecac ,_dfga );};_bacdf .Data [_cdcc ]=_bdfed (_bacdf .Data [_cdcc ],_bgee &^_bacdf .Data [_cdcc ],_cggg );_cdcc +=_bacdf .RowStride ;
_bddc +=_ffgaf .RowStride ;};};case PixNotPixSrcOrDst :if _gebgg {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{if _decf ==_afaa {_bgee =_ffgaf .Data [_gebf ]<<_acagg ;if _agbdf {_bgee =_bdfed (_bgee ,_ffgaf .Data [_gebf +1]>>_ecac ,_dfga );};}else {_bgee =_ffgaf .Data [_gebf ]>>_ecac ;
};_bacdf .Data [_ccaa ]=_bdfed (_bacdf .Data [_ccaa ],^(_bgee |_bacdf .Data [_ccaa ]),_cebcd );_ccaa +=_bacdf .RowStride ;_gebf +=_ffgaf .RowStride ;};};if _cbbb {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{for _ffbf =0;_ffbf < _gbecg ;_ffbf ++{_bgee =_bdfed (_ffgaf .Data [_ffdf +_ffbf ]<<_acagg ,_ffgaf .Data [_ffdf +_ffbf +1]>>_ecac ,_dfga );
_bacdf .Data [_aeae +_ffbf ]=^(_bgee |_bacdf .Data [_aeae +_ffbf ]);};_aeae +=_bacdf .RowStride ;_ffdf +=_ffgaf .RowStride ;};};if _cdaf {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{_bgee =_ffgaf .Data [_bddc ]<<_acagg ;if _daacc {_bgee =_bdfed (_bgee ,_ffgaf .Data [_bddc +1]>>_ecac ,_dfga );
};_bacdf .Data [_cdcc ]=_bdfed (_bacdf .Data [_cdcc ],^(_bgee |_bacdf .Data [_cdcc ]),_cggg );_cdcc +=_bacdf .RowStride ;_bddc +=_ffgaf .RowStride ;};};case PixNotPixSrcAndDst :if _gebgg {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{if _decf ==_afaa {_bgee =_ffgaf .Data [_gebf ]<<_acagg ;
if _agbdf {_bgee =_bdfed (_bgee ,_ffgaf .Data [_gebf +1]>>_ecac ,_dfga );};}else {_bgee =_ffgaf .Data [_gebf ]>>_ecac ;};_bacdf .Data [_ccaa ]=_bdfed (_bacdf .Data [_ccaa ],^(_bgee &_bacdf .Data [_ccaa ]),_cebcd );_ccaa +=_bacdf .RowStride ;_gebf +=_ffgaf .RowStride ;
};};if _cbbb {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{for _ffbf =0;_ffbf < _gbecg ;_ffbf ++{_bgee =_bdfed (_ffgaf .Data [_ffdf +_ffbf ]<<_acagg ,_ffgaf .Data [_ffdf +_ffbf +1]>>_ecac ,_dfga );_bacdf .Data [_aeae +_ffbf ]=^(_bgee &_bacdf .Data [_aeae +_ffbf ]);
};_aeae +=_bacdf .RowStride ;_ffdf +=_ffgaf .RowStride ;};};if _cdaf {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{_bgee =_ffgaf .Data [_bddc ]<<_acagg ;if _daacc {_bgee =_bdfed (_bgee ,_ffgaf .Data [_bddc +1]>>_ecac ,_dfga );};_bacdf .Data [_cdcc ]=_bdfed (_bacdf .Data [_cdcc ],^(_bgee &_bacdf .Data [_cdcc ]),_cggg );
_cdcc +=_bacdf .RowStride ;_bddc +=_ffgaf .RowStride ;};};case PixNotPixSrcXorDst :if _gebgg {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{if _decf ==_afaa {_bgee =_ffgaf .Data [_gebf ]<<_acagg ;if _agbdf {_bgee =_bdfed (_bgee ,_ffgaf .Data [_gebf +1]>>_ecac ,_dfga );
};}else {_bgee =_ffgaf .Data [_gebf ]>>_ecac ;};_bacdf .Data [_ccaa ]=_bdfed (_bacdf .Data [_ccaa ],^(_bgee ^_bacdf .Data [_ccaa ]),_cebcd );_ccaa +=_bacdf .RowStride ;_gebf +=_ffgaf .RowStride ;};};if _cbbb {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{for _ffbf =0;
_ffbf < _gbecg ;_ffbf ++{_bgee =_bdfed (_ffgaf .Data [_ffdf +_ffbf ]<<_acagg ,_ffgaf .Data [_ffdf +_ffbf +1]>>_ecac ,_dfga );_bacdf .Data [_aeae +_ffbf ]=^(_bgee ^_bacdf .Data [_aeae +_ffbf ]);};_aeae +=_bacdf .RowStride ;_ffdf +=_ffgaf .RowStride ;};};
if _cdaf {for _dgaa =0;_dgaa < _fbafg ;_dgaa ++{_bgee =_ffgaf .Data [_bddc ]<<_acagg ;if _daacc {_bgee =_bdfed (_bgee ,_ffgaf .Data [_bddc +1]>>_ecac ,_dfga );};_bacdf .Data [_cdcc ]=_bdfed (_bacdf .Data [_cdcc ],^(_bgee ^_bacdf .Data [_cdcc ]),_cggg );
_cdcc +=_bacdf .RowStride ;_bddc +=_ffgaf .RowStride ;};};default:_gc .Log .Debug ("\u004f\u0070e\u0072\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006e\u006f\u0074\u0020\u0070\u0065\u0072\u006d\u0069tt\u0065\u0064",_ecaf );
return _bc .Error ("\u0072a\u0073t\u0065\u0072\u004f\u0070\u0047e\u006e\u0065r\u0061\u006c\u004c\u006f\u0077","\u0072\u0061\u0073\u0074\u0065\u0072\u0020\u006f\u0070\u0065r\u0061\u0074\u0069\u006f\u006e\u0020\u006eo\u0074\u0020\u0070\u0065\u0072\u006d\u0069\u0074\u0074\u0065\u0064");
};return nil ;};func (_fad *Boxes )selectWithIndicator (_ebcc *_be .NumSlice )(_ffga *Boxes ,_cace error ){const _gdad ="\u0042o\u0078\u0065\u0073\u002es\u0065\u006c\u0065\u0063\u0074W\u0069t\u0068I\u006e\u0064\u0069\u0063\u0061\u0074\u006fr";if _fad ==nil {return nil ,_bc .Error (_gdad ,"b\u006f\u0078\u0065\u0073 '\u0062'\u0020\u006e\u006f\u0074\u0020d\u0065\u0066\u0069\u006e\u0065\u0064");
};if _ebcc ==nil {return nil ,_bc .Error (_gdad ,"\u0027\u006ea\u0027\u0020\u006eo\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if len (*_ebcc )!=len (*_fad ){return nil ,_bc .Error (_gdad ,"\u0062\u006f\u0078\u0065\u0073\u0020\u0027\u0062\u0027\u0020\u0068\u0061\u0073\u0020\u0064\u0069\u0066\u0066\u0065\u0072\u0065\u006e\u0074\u0020s\u0069\u007a\u0065\u0020\u0074h\u0061\u006e \u0027\u006e\u0061\u0027");
};var _geed ,_cad int ;for _fggb :=0;_fggb < len (*_ebcc );_fggb ++{if _geed ,_cace =_ebcc .GetInt (_fggb );_cace !=nil {return nil ,_bc .Wrap (_cace ,_gdad ,"\u0063\u0068\u0065\u0063\u006b\u0069\u006e\u0067\u0020c\u006f\u0075\u006e\u0074");};if _geed ==1{_cad ++;
};};if _cad ==len (*_fad ){return _fad ,nil ;};_adcd :=Boxes {};for _ccac :=0;_ccac < len (*_ebcc );_ccac ++{_geed =int ((*_ebcc )[_ccac ]);if _geed ==0{continue ;};_adcd =append (_adcd ,(*_fad )[_ccac ]);};_ffga =&_adcd ;return _ffga ,nil ;};func TstDSymbol (t *_d .T ,scale ...int )*Bitmap {_gddf ,_caba :=NewWithData (4,5,[]byte {0xf0,0x90,0x90,0x90,0xE0});
_f .NoError (t ,_caba );return TstGetScaledSymbol (t ,_gddf ,scale ...);};func _agcae (_cdec ,_eecc *Bitmap ,_gbaf ,_bdece int )(_agda error ){const _gecg ="\u0073e\u0065d\u0066\u0069\u006c\u006c\u0042i\u006e\u0061r\u0079\u004c\u006f\u0077\u0034";var (_egcc ,_fdga ,_bcdcg ,_bace int ;
_ceaga ,_aegc ,_ddde ,_bdggg ,_fbbe ,_bddb ,_edbc byte ;);for _egcc =0;_egcc < _gbaf ;_egcc ++{_bcdcg =_egcc *_cdec .RowStride ;_bace =_egcc *_eecc .RowStride ;for _fdga =0;_fdga < _bdece ;_fdga ++{_ceaga ,_agda =_cdec .GetByte (_bcdcg +_fdga );if _agda !=nil {return _bc .Wrap (_agda ,_gecg ,"\u0066i\u0072\u0073\u0074\u0020\u0067\u0065t");
};_aegc ,_agda =_eecc .GetByte (_bace +_fdga );if _agda !=nil {return _bc .Wrap (_agda ,_gecg ,"\u0073\u0065\u0063\u006f\u006e\u0064\u0020\u0067\u0065\u0074");};if _egcc > 0{_ddde ,_agda =_cdec .GetByte (_bcdcg -_cdec .RowStride +_fdga );if _agda !=nil {return _bc .Wrap (_agda ,_gecg ,"\u0069\u0020\u003e \u0030");
};_ceaga |=_ddde ;};if _fdga > 0{_bdggg ,_agda =_cdec .GetByte (_bcdcg +_fdga -1);if _agda !=nil {return _bc .Wrap (_agda ,_gecg ,"\u006a\u0020\u003e \u0030");};_ceaga |=_bdggg <<7;};_ceaga &=_aegc ;if _ceaga ==0||(^_ceaga )==0{if _agda =_cdec .SetByte (_bcdcg +_fdga ,_ceaga );
_agda !=nil {return _bc .Wrap (_agda ,_gecg ,"b\u0074\u0020\u003d\u003d 0\u0020|\u007c\u0020\u0028\u005e\u0062t\u0029\u0020\u003d\u003d\u0020\u0030");};continue ;};for {_edbc =_ceaga ;_ceaga =(_ceaga |(_ceaga >>1)|(_ceaga <<1))&_aegc ;if (_ceaga ^_edbc )==0{if _agda =_cdec .SetByte (_bcdcg +_fdga ,_ceaga );
_agda !=nil {return _bc .Wrap (_agda ,_gecg ,"\u0073\u0065\u0074\u0074\u0069\u006e\u0067\u0020\u0070\u0072\u0065\u0076 \u0062\u0079\u0074\u0065");};break ;};};};};for _egcc =_gbaf -1;_egcc >=0;_egcc --{_bcdcg =_egcc *_cdec .RowStride ;_bace =_egcc *_eecc .RowStride ;
for _fdga =_bdece -1;_fdga >=0;_fdga --{if _ceaga ,_agda =_cdec .GetByte (_bcdcg +_fdga );_agda !=nil {return _bc .Wrap (_agda ,_gecg ,"\u0072\u0065\u0076\u0065\u0072\u0073\u0065\u0020\u0066\u0069\u0072\u0073t\u0020\u0067\u0065\u0074");};if _aegc ,_agda =_eecc .GetByte (_bace +_fdga );
_agda !=nil {return _bc .Wrap (_agda ,_gecg ,"r\u0065\u0076\u0065\u0072se\u0020g\u0065\u0074\u0020\u006d\u0061s\u006b\u0020\u0062\u0079\u0074\u0065");};if _egcc < _gbaf -1{if _fbbe ,_agda =_cdec .GetByte (_bcdcg +_cdec .RowStride +_fdga );_agda !=nil {return _bc .Wrap (_agda ,_gecg ,"\u0072\u0065v\u0065\u0072\u0073e\u0020\u0069\u0020\u003c\u0020\u0068\u0020\u002d\u0031");
};_ceaga |=_fbbe ;};if _fdga < _bdece -1{if _bddb ,_agda =_cdec .GetByte (_bcdcg +_fdga +1);_agda !=nil {return _bc .Wrap (_agda ,_gecg ,"\u0072\u0065\u0076\u0065rs\u0065\u0020\u006a\u0020\u003c\u0020\u0077\u0070\u006c\u0020\u002d\u0020\u0031");};_ceaga |=_bddb >>7;
};_ceaga &=_aegc ;if _ceaga ==0||(^_ceaga )==0{if _agda =_cdec .SetByte (_bcdcg +_fdga ,_ceaga );_agda !=nil {return _bc .Wrap (_agda ,_gecg ,"\u0073\u0065\u0074\u0074\u0069\u006e\u0067\u0020\u006d\u0061\u0073k\u0065\u0064\u0020\u0062\u0079\u0074\u0065\u0020\u0066\u0061i\u006c\u0065\u0064");
};continue ;};for {_edbc =_ceaga ;_ceaga =(_ceaga |(_ceaga >>1)|(_ceaga <<1))&_aegc ;if (_ceaga ^_edbc )==0{if _agda =_cdec .SetByte (_bcdcg +_fdga ,_ceaga );_agda !=nil {return _bc .Wrap (_agda ,_gecg ,"\u0072e\u0076\u0065\u0072\u0073e\u0020\u0073\u0065\u0074\u0074i\u006eg\u0020p\u0072\u0065\u0076\u0020\u0062\u0079\u0074e");
};break ;};};};};return nil ;};type CombinationOperator int ;func (_bcac Points )Size ()int {return len (_bcac )};func _abdg ()(_acd [256]uint32 ){for _dee :=0;_dee < 256;_dee ++{if _dee &0x01!=0{_acd [_dee ]|=0xf;};if _dee &0x02!=0{_acd [_dee ]|=0xf0;
};if _dee &0x04!=0{_acd [_dee ]|=0xf00;};if _dee &0x08!=0{_acd [_dee ]|=0xf000;};if _dee &0x10!=0{_acd [_dee ]|=0xf0000;};if _dee &0x20!=0{_acd [_dee ]|=0xf00000;};if _dee &0x40!=0{_acd [_dee ]|=0xf000000;};if _dee &0x80!=0{_acd [_dee ]|=0xf0000000;};};
return _acd ;};func ClipBoxToRectangle (box *_ag .Rectangle ,wi ,hi int )(_ebee *_ag .Rectangle ,_fef error ){const _cedc ="\u0043l\u0069p\u0042\u006f\u0078\u0054\u006fR\u0065\u0063t\u0061\u006e\u0067\u006c\u0065";if box ==nil {return nil ,_bc .Error (_cedc ,"\u0027\u0062\u006f\u0078\u0027\u0020\u006e\u006f\u0074\u0020\u0064\u0065f\u0069\u006e\u0065\u0064");
};if box .Min .X >=wi ||box .Min .Y >=hi ||box .Max .X <=0||box .Max .Y <=0{return nil ,_bc .Error (_cedc ,"\u0027\u0062\u006fx'\u0020\u006f\u0075\u0074\u0073\u0069\u0064\u0065\u0020\u0072\u0065\u0063\u0074\u0061\u006e\u0067\u006c\u0065");};_cfag :=*box ;
_ebee =&_cfag ;if _ebee .Min .X < 0{_ebee .Max .X +=_ebee .Min .X ;_ebee .Min .X =0;};if _ebee .Min .Y < 0{_ebee .Max .Y +=_ebee .Min .Y ;_ebee .Min .Y =0;};if _ebee .Max .X > wi {_ebee .Max .X =wi ;};if _ebee .Max .Y > hi {_ebee .Max .Y =hi ;};return _ebee ,nil ;
};func _bd (_cg ,_gf *Bitmap )(_dc error ){const _cb ="\u0065\u0078\u0070\u0061nd\u0042\u0069\u006e\u0061\u0072\u0079\u0046\u0061\u0063\u0074\u006f\u0072\u0032";_bee :=_gf .RowStride ;_cd :=_cg .RowStride ;var (_db byte ;_e uint16 ;_dce ,_cgc ,_fd ,_eb ,_ad int ;
);for _fd =0;_fd < _gf .Height ;_fd ++{_dce =_fd *_bee ;_cgc =2*_fd *_cd ;for _eb =0;_eb < _bee ;_eb ++{_db =_gf .Data [_dce +_eb ];_e =_bded [_db ];_ad =_cgc +_eb *2;if _cg .RowStride !=_gf .RowStride *2&&(_eb +1)*2> _cg .RowStride {_dc =_cg .SetByte (_ad ,byte (_e >>8));
}else {_dc =_cg .setTwoBytes (_ad ,_e );};if _dc !=nil {return _bc .Wrap (_dc ,_cb ,"");};};for _eb =0;_eb < _cd ;_eb ++{_ad =_cgc +_cd +_eb ;_db =_cg .Data [_cgc +_eb ];if _dc =_cg .SetByte (_ad ,_db );_dc !=nil {return _bc .Wrapf (_dc ,_cb ,"c\u006f\u0070\u0079\u0020\u0064\u006fu\u0062\u006c\u0065\u0064\u0020\u006ci\u006e\u0065\u003a\u0020\u0027\u0025\u0064'\u002c\u0020\u0042\u0079\u0074\u0065\u003a\u0020\u0027\u0025d\u0027",_cgc +_eb ,_cgc +_cd +_eb );
};};};return nil ;};func TstFrameBitmapData ()[]byte {return _fbddb .Data };type MorphOperation int ;func (_gccb *ClassedPoints )SortByY (){_gccb ._bcbcb =_gccb .ySortFunction ();_a .Sort (_gccb )};func (_bgd *Bitmap )InverseData (){_bgd .inverseData ()};
func (_cfdc *Bitmap )Equivalent (s *Bitmap )bool {return _cfdc .equivalent (s )};type fillSegment struct{_ccce int ;_dbdb int ;_cfge int ;_dbdg int ;};func HausTest (p1 ,p2 ,p3 ,p4 *Bitmap ,delX ,delY float32 ,maxDiffW ,maxDiffH int )(bool ,error ){const _bebe ="\u0048\u0061\u0075\u0073\u0054\u0065\u0073\u0074";
_bfea ,_afgbg :=p1 .Width ,p1 .Height ;_afgee ,_ccde :=p3 .Width ,p3 .Height ;if _be .Abs (_bfea -_afgee )> maxDiffW {return false ,nil ;};if _be .Abs (_afgbg -_ccde )> maxDiffH {return false ,nil ;};_bffe :=int (delX +_be .Sign (delX )*0.5);_ege :=int (delY +_be .Sign (delY )*0.5);
var _ecef error ;_aea :=p1 .CreateTemplate ();if _ecef =_aea .RasterOperation (0,0,_bfea ,_afgbg ,PixSrc ,p1 ,0,0);_ecef !=nil {return false ,_bc .Wrap (_ecef ,_bebe ,"p\u0031\u0020\u002d\u0053\u0052\u0043\u002d\u003e\u0020\u0074");};if _ecef =_aea .RasterOperation (_bffe ,_ege ,_bfea ,_afgbg ,PixNotSrcAndDst ,p4 ,0,0);
_ecef !=nil {return false ,_bc .Wrap (_ecef ,_bebe ,"\u0021p\u0034\u0020\u0026\u0020\u0074");};if _aea .Zero (){return false ,nil ;};if _ecef =_aea .RasterOperation (_bffe ,_ege ,_afgee ,_ccde ,PixSrc ,p3 ,0,0);_ecef !=nil {return false ,_bc .Wrap (_ecef ,_bebe ,"p\u0033\u0020\u002d\u0053\u0052\u0043\u002d\u003e\u0020\u0074");
};if _ecef =_aea .RasterOperation (0,0,_afgee ,_ccde ,PixNotSrcAndDst ,p2 ,0,0);_ecef !=nil {return false ,_bc .Wrap (_ecef ,_bebe ,"\u0021p\u0032\u0020\u0026\u0020\u0074");};return _aea .Zero (),nil ;};func (_gebda CombinationOperator )String ()string {var _ebag string ;
switch _gebda {case CmbOpOr :_ebag ="\u004f\u0052";case CmbOpAnd :_ebag ="\u0041\u004e\u0044";case CmbOpXor :_ebag ="\u0058\u004f\u0052";case CmbOpXNor :_ebag ="\u0058\u004e\u004f\u0052";case CmbOpReplace :_ebag ="\u0052E\u0050\u004c\u0041\u0043\u0045";
case CmbOpNot :_ebag ="\u004e\u004f\u0054";};return _ebag ;};func CombineBytes (oldByte ,newByte byte ,op CombinationOperator )byte {return _abfa (oldByte ,newByte ,op );};type LocationFilter int ;func TstFrameBitmap ()*Bitmap {return _fbddb .Copy ()};
func TstNSymbol (t *_d .T ,scale ...int )*Bitmap {_fdcgg ,_fgcf :=NewWithData (4,5,[]byte {0x90,0xD0,0xB0,0x90,0x90});_f .NoError (t ,_fgcf );return TstGetScaledSymbol (t ,_fdcgg ,scale ...);};func (_dfbe *byWidth )Swap (i ,j int ){_dfbe .Values [i ],_dfbe .Values [j ]=_dfbe .Values [j ],_dfbe .Values [i ];
if _dfbe .Boxes !=nil {_dfbe .Boxes [i ],_dfbe .Boxes [j ]=_dfbe .Boxes [j ],_dfbe .Boxes [i ];};};func _bdbg (_cag *Bitmap ,_fdee ,_bffg ,_bdbdg ,_adde int ,_bfbcc RasterOperator ,_cdbb *Bitmap ,_eaceg ,_dec int )error {const _fbgf ="\u0072a\u0073t\u0065\u0072\u004f\u0070\u0065\u0072\u0061\u0074\u0069\u006f\u006e";
if _cag ==nil {return _bc .Error (_fbgf ,"\u006e\u0069\u006c\u0020\u0027\u0064\u0065\u0073\u0074\u0027\u0020\u0042i\u0074\u006d\u0061\u0070");};if _bfbcc ==PixDst {return nil ;};switch _bfbcc {case PixClr ,PixSet ,PixNotDst :_efgff (_cag ,_fdee ,_bffg ,_bdbdg ,_adde ,_bfbcc );
return nil ;};if _cdbb ==nil {_gc .Log .Debug ("\u0052a\u0073\u0074e\u0072\u004f\u0070\u0065r\u0061\u0074\u0069o\u006e\u0020\u0073\u006f\u0075\u0072\u0063\u0065\u0020bi\u0074\u006d\u0061p\u0020\u0069s\u0020\u006e\u006f\u0074\u0020\u0064e\u0066\u0069n\u0065\u0064");
return _bc .Error (_fbgf ,"\u006e\u0069l\u0020\u0027\u0073r\u0063\u0027\u0020\u0062\u0069\u0074\u006d\u0061\u0070");};if _egac :=_eabgb (_cag ,_fdee ,_bffg ,_bdbdg ,_adde ,_bfbcc ,_cdbb ,_eaceg ,_dec );_egac !=nil {return _bc .Wrap (_egac ,_fbgf ,"");};
return nil ;};type Component int ;func _agcf (_bfeaa *Bitmap ,_ggfaf ...MorphProcess )(_ceac *Bitmap ,_gdag error ){const _dcec ="\u006d\u006f\u0072\u0070\u0068\u0053\u0065\u0071\u0075\u0065\u006e\u0063\u0065";if _bfeaa ==nil {return nil ,_bc .Error (_dcec ,"\u006d\u006f\u0072\u0070\u0068\u0053\u0065\u0071\u0075\u0065\u006e\u0063\u0065 \u0073\u006f\u0075\u0072\u0063\u0065 \u0062\u0069\u0074\u006d\u0061\u0070\u0020\u006e\u006f\u0074\u0020\u0064\u0065f\u0069\u006e\u0065\u0064");
};if len (_ggfaf )==0{return nil ,_bc .Error (_dcec ,"m\u006f\u0072\u0070\u0068\u0053\u0065q\u0075\u0065\u006e\u0063\u0065\u002c \u0073\u0065\u0071\u0075\u0065\u006e\u0063e\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006ee\u0064");};if _gdag =_eaab (_ggfaf ...);
_gdag !=nil {return nil ,_bc .Wrap (_gdag ,_dcec ,"");};var _bfbcg ,_egaf ,_cfdeb int ;_ceac =_bfeaa .Copy ();for _ ,_gbea :=range _ggfaf {switch _gbea .Operation {case MopDilation :_bfbcg ,_egaf =_gbea .getWidthHeight ();_ceac ,_gdag =DilateBrick (nil ,_ceac ,_bfbcg ,_egaf );
if _gdag !=nil {return nil ,_bc .Wrap (_gdag ,_dcec ,"");};case MopErosion :_bfbcg ,_egaf =_gbea .getWidthHeight ();_ceac ,_gdag =_fggc (nil ,_ceac ,_bfbcg ,_egaf );if _gdag !=nil {return nil ,_bc .Wrap (_gdag ,_dcec ,"");};case MopOpening :_bfbcg ,_egaf =_gbea .getWidthHeight ();
_ceac ,_gdag =_dcefb (nil ,_ceac ,_bfbcg ,_egaf );if _gdag !=nil {return nil ,_bc .Wrap (_gdag ,_dcec ,"");};case MopClosing :_bfbcg ,_egaf =_gbea .getWidthHeight ();_ceac ,_gdag =_ccefe (nil ,_ceac ,_bfbcg ,_egaf );if _gdag !=nil {return nil ,_bc .Wrap (_gdag ,_dcec ,"");
};case MopRankBinaryReduction :_ceac ,_gdag =_ggf (_ceac ,_gbea .Arguments ...);if _gdag !=nil {return nil ,_bc .Wrap (_gdag ,_dcec ,"");};case MopReplicativeBinaryExpansion :_ceac ,_gdag =_eggf (_ceac ,_gbea .Arguments [0]);if _gdag !=nil {return nil ,_bc .Wrap (_gdag ,_dcec ,"");
};case MopAddBorder :_cfdeb =_gbea .Arguments [0];_ceac ,_gdag =_ceac .AddBorder (_cfdeb ,0);if _gdag !=nil {return nil ,_bc .Wrap (_gdag ,_dcec ,"");};default:return nil ,_bc .Error (_dcec ,"i\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006d\u006fr\u0070\u0068\u004f\u0070\u0065\u0072\u0061ti\u006f\u006e\u0020\u0070r\u006f\u0076\u0069\u0064\u0065\u0064\u0020\u0074\u006f t\u0068\u0065 \u0073\u0065\u0071\u0075\u0065\u006e\u0063\u0065");
};};if _cfdeb > 0{_ceac ,_gdag =_ceac .RemoveBorder (_cfdeb );if _gdag !=nil {return nil ,_bc .Wrap (_gdag ,_dcec ,"\u0062\u006f\u0072\u0064\u0065\u0072\u0020\u003e\u0020\u0030");};};return _ceac ,nil ;};func init (){const _aeff ="\u0062\u0069\u0074\u006dap\u0073\u002e\u0069\u006e\u0069\u0074\u0069\u0061\u006c\u0069\u007a\u0061\u0074\u0069o\u006e";
_fbddb =New (50,40);var _febd error ;_fbddb ,_febd =_fbddb .AddBorder (2,1);if _febd !=nil {panic (_bc .Wrap (_febd ,_aeff ,"f\u0072\u0061\u006d\u0065\u0042\u0069\u0074\u006d\u0061\u0070"));};_fcbeg ,_febd =NewWithData (50,22,_gdfa );if _febd !=nil {panic (_bc .Wrap (_febd ,_aeff ,"i\u006d\u0061\u0067\u0065\u0042\u0069\u0074\u006d\u0061\u0070"));
};};func _dcefb (_ccca ,_cbgd *Bitmap ,_cggc ,_dbgc int )(*Bitmap ,error ){const _bacd ="\u006fp\u0065\u006e\u0042\u0072\u0069\u0063k";if _cbgd ==nil {return nil ,_bc .Error (_bacd ,"\u0073o\u0075\u0072\u0063\u0065 \u0062\u0069\u0074\u006d\u0061p\u0020n\u006ft\u0020\u0064\u0065\u0066\u0069\u006e\u0065d");
};if _cggc < 1&&_dbgc < 1{return nil ,_bc .Error (_bacd ,"\u0068\u0053\u0069\u007ae \u003c\u0020\u0031\u0020\u0026\u0026\u0020\u0076\u0053\u0069\u007a\u0065\u0020\u003c \u0031");};if _cggc ==1&&_dbgc ==1{return _cbgd .Copy (),nil ;};if _cggc ==1||_dbgc ==1{var _ggfd error ;
_bfcc :=SelCreateBrick (_dbgc ,_cggc ,_dbgc /2,_cggc /2,SelHit );_ccca ,_ggfd =_bfga (_ccca ,_cbgd ,_bfcc );if _ggfd !=nil {return nil ,_bc .Wrap (_ggfd ,_bacd ,"\u0068S\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u007c\u007c \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");
};return _ccca ,nil ;};_eeff :=SelCreateBrick (1,_cggc ,0,_cggc /2,SelHit );_caeeb :=SelCreateBrick (_dbgc ,1,_dbgc /2,0,SelHit );_gag ,_cef :=_fddfd (nil ,_cbgd ,_eeff );if _cef !=nil {return nil ,_bc .Wrap (_cef ,_bacd ,"\u0031s\u0074\u0020\u0065\u0072\u006f\u0064e");
};_ccca ,_cef =_fddfd (_ccca ,_gag ,_caeeb );if _cef !=nil {return nil ,_bc .Wrap (_cef ,_bacd ,"\u0032n\u0064\u0020\u0065\u0072\u006f\u0064e");};_ ,_cef =_bgdb (_gag ,_ccca ,_eeff );if _cef !=nil {return nil ,_bc .Wrap (_cef ,_bacd ,"\u0031\u0073\u0074\u0020\u0064\u0069\u006c\u0061\u0074\u0065");
};_ ,_cef =_bgdb (_ccca ,_gag ,_caeeb );if _cef !=nil {return nil ,_bc .Wrap (_cef ,_bacd ,"\u0032\u006e\u0064\u0020\u0064\u0069\u006c\u0061\u0074\u0065");};return _ccca ,nil ;};const (_ LocationFilter =iota ;LocSelectWidth ;LocSelectHeight ;LocSelectXVal ;
LocSelectYVal ;LocSelectIfEither ;LocSelectIfBoth ;);const (_ SizeSelection =iota ;SizeSelectByWidth ;SizeSelectByHeight ;SizeSelectByMaxDimension ;SizeSelectByArea ;SizeSelectByPerimeter ;);func _fffa (_gdbd *Bitmap ,_dbga ,_cfagg int ,_abab ,_cccba int ,_gcbg RasterOperator ){var (_fgea int ;
_cegd byte ;_cbed ,_egea int ;_gdcg int ;);_gada :=_abab >>3;_baeb :=_abab &7;if _baeb > 0{_cegd =_dcfg [_baeb ];};_fgea =_gdbd .RowStride *_cfagg +(_dbga >>3);switch _gcbg {case PixClr :for _cbed =0;_cbed < _cccba ;_cbed ++{_gdcg =_fgea +_cbed *_gdbd .RowStride ;
for _egea =0;_egea < _gada ;_egea ++{_gdbd .Data [_gdcg ]=0x0;_gdcg ++;};if _baeb > 0{_gdbd .Data [_gdcg ]=_bdfed (_gdbd .Data [_gdcg ],0x0,_cegd );};};case PixSet :for _cbed =0;_cbed < _cccba ;_cbed ++{_gdcg =_fgea +_cbed *_gdbd .RowStride ;for _egea =0;
_egea < _gada ;_egea ++{_gdbd .Data [_gdcg ]=0xff;_gdcg ++;};if _baeb > 0{_gdbd .Data [_gdcg ]=_bdfed (_gdbd .Data [_gdcg ],0xff,_cegd );};};case PixNotDst :for _cbed =0;_cbed < _cccba ;_cbed ++{_gdcg =_fgea +_cbed *_gdbd .RowStride ;for _egea =0;_egea < _gada ;
_egea ++{_gdbd .Data [_gdcg ]=^_gdbd .Data [_gdcg ];_gdcg ++;};if _baeb > 0{_gdbd .Data [_gdcg ]=_bdfed (_gdbd .Data [_gdcg ],^_gdbd .Data [_gdcg ],_cegd );};};};};func TstGetScaledSymbol (t *_d .T ,sm *Bitmap ,scale ...int )*Bitmap {if len (scale )==0{return sm ;
};if scale [0]==1{return sm ;};_fbae ,_ecaa :=MorphSequence (sm ,MorphProcess {Operation :MopReplicativeBinaryExpansion ,Arguments :scale });_f .NoError (t ,_ecaa );return _fbae ;};func (_aagf *Bitmap )RemoveBorderGeneral (left ,right ,top ,bot int )(*Bitmap ,error ){return _aagf .removeBorderGeneral (left ,right ,top ,bot );
};func (_cgcc *Selection )findMaxTranslations ()(_aagabg ,_bfec ,_eefg ,_bebga int ){for _cacdg :=0;_cacdg < _cgcc .Height ;_cacdg ++{for _gdeb :=0;_gdeb < _cgcc .Width ;_gdeb ++{if _cgcc .Data [_cacdg ][_gdeb ]==SelHit {_aagabg =_faca (_aagabg ,_cgcc .Cx -_gdeb );
_bfec =_faca (_bfec ,_cgcc .Cy -_cacdg );_eefg =_faca (_eefg ,_gdeb -_cgcc .Cx );_bebga =_faca (_bebga ,_cacdg -_cgcc .Cy );};};};return _aagabg ,_bfec ,_eefg ,_bebga ;};var (_dcfg =[]byte {0x00,0x80,0xC0,0xE0,0xF0,0xF8,0xFC,0xFE,0xFF};_fag =[]byte {0x00,0x01,0x03,0x07,0x0F,0x1F,0x3F,0x7F,0xFF};
);func (_dgb *Bitmap )ToImage ()_ag .Image {_cacf ,_eeg :=_bf .NewImage (_dgb .Width ,_dgb .Height ,1,1,_dgb .Data ,nil ,nil );if _eeg !=nil {_gc .Log .Error ("\u0043\u006f\u006e\u0076\u0065\u0072\u0074\u0069\u006e\u0067\u0020j\u0062\u0069\u0067\u0032\u002e\u0042\u0069\u0074m\u0061p\u0020\u0074\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u0075\u0074\u0069\u006c\u002e\u0049\u006d\u0061\u0067e\u0020\u0066\u0061\u0069\u006c\u0065\u0064\u003a\u0020\u0025\u0076",_eeg );
};return _cacf ;};func _cgcd (_fgfe ,_caeg ,_bbcg *Bitmap )(*Bitmap ,error ){const _cbec ="\u0062\u0069\u0074\u006d\u0061\u0070\u002e\u0078\u006f\u0072";if _caeg ==nil {return nil ,_bc .Error (_cbec ,"'\u0062\u0031\u0027\u0020\u0069\u0073\u0020\u006e\u0069\u006c");
};if _bbcg ==nil {return nil ,_bc .Error (_cbec ,"'\u0062\u0032\u0027\u0020\u0069\u0073\u0020\u006e\u0069\u006c");};if _fgfe ==_bbcg {return nil ,_bc .Error (_cbec ,"'\u0064\u0027\u0020\u003d\u003d\u0020\u0027\u0062\u0032\u0027");};if !_caeg .SizesEqual (_bbcg ){_gc .Log .Debug ("\u0025s\u0020\u002d \u0042\u0069\u0074\u006da\u0070\u0020\u0027b\u0031\u0027\u0020\u0069\u0073\u0020\u006e\u006f\u0074 e\u0071\u0075\u0061l\u0020\u0073i\u007a\u0065\u0020\u0077\u0069\u0074h\u0020\u0027b\u0032\u0027",_cbec );
};var _edcb error ;if _fgfe ,_edcb =_ffdb (_fgfe ,_caeg );_edcb !=nil {return nil ,_bc .Wrap (_edcb ,_cbec ,"\u0063\u0061n\u0027\u0074\u0020c\u0072\u0065\u0061\u0074\u0065\u0020\u0027\u0064\u0027");};if _edcb =_fgfe .RasterOperation (0,0,_fgfe .Width ,_fgfe .Height ,PixSrcXorDst ,_bbcg ,0,0);
_edcb !=nil {return nil ,_bc .Wrap (_edcb ,_cbec ,"");};return _fgfe ,nil ;};func (_abaad *Bitmap )ConnComponents (bms *Bitmaps ,connectivity int )(_bcfc *Boxes ,_bdcg error ){const _fgff ="B\u0069\u0074\u006d\u0061p.\u0043o\u006e\u006e\u0043\u006f\u006dp\u006f\u006e\u0065\u006e\u0074\u0073";
if _abaad ==nil {return nil ,_bc .Error (_fgff ,"\u0070r\u006f\u0076\u0069\u0064e\u0064\u0020\u0065\u006d\u0070t\u0079 \u0027b\u0027\u0020\u0062\u0069\u0074\u006d\u0061p");};if connectivity !=4&&connectivity !=8{return nil ,_bc .Error (_fgff ,"\u0063\u006f\u006ene\u0063\u0074\u0069\u0076\u0069\u0074\u0079\u0020\u006e\u006f\u0074\u0020\u0034\u0020\u006f\u0072\u0020\u0038");
};if bms ==nil {if _bcfc ,_bdcg =_abaad .connComponentsBB (connectivity );_bdcg !=nil {return nil ,_bc .Wrap (_bdcg ,_fgff ,"");};}else {if _bcfc ,_bdcg =_abaad .connComponentsBitmapsBB (bms ,connectivity );_bdcg !=nil {return nil ,_bc .Wrap (_bdcg ,_fgff ,"");
};};return _bcfc ,nil ;};const (PixSrc RasterOperator =0xc;PixDst RasterOperator =0xa;PixNotSrc RasterOperator =0x3;PixNotDst RasterOperator =0x5;PixClr RasterOperator =0x0;PixSet RasterOperator =0xf;PixSrcOrDst RasterOperator =0xe;PixSrcAndDst RasterOperator =0x8;
PixSrcXorDst RasterOperator =0x6;PixNotSrcOrDst RasterOperator =0xb;PixNotSrcAndDst RasterOperator =0x2;PixSrcOrNotDst RasterOperator =0xd;PixSrcAndNotDst RasterOperator =0x4;PixNotPixSrcOrDst RasterOperator =0x1;PixNotPixSrcAndDst RasterOperator =0x7;
PixNotPixSrcXorDst RasterOperator =0x9;PixPaint =PixSrcOrDst ;PixSubtract =PixNotSrcAndDst ;PixMask =PixSrcAndDst ;);type SizeComparison int ;type Points []Point ;func (_ddbb *Boxes )makeSizeIndicator (_bbad ,_agg int ,_bfg LocationFilter ,_gaaa SizeComparison )*_be .NumSlice {_gbcce :=&_be .NumSlice {};
var _cfda ,_eadg ,_ddgc int ;for _ ,_ceg :=range *_ddbb {_cfda =0;_eadg ,_ddgc =_ceg .Dx (),_ceg .Dy ();switch _bfg {case LocSelectWidth :if (_gaaa ==SizeSelectIfLT &&_eadg < _bbad )||(_gaaa ==SizeSelectIfGT &&_eadg > _bbad )||(_gaaa ==SizeSelectIfLTE &&_eadg <=_bbad )||(_gaaa ==SizeSelectIfGTE &&_eadg >=_bbad ){_cfda =1;
};case LocSelectHeight :if (_gaaa ==SizeSelectIfLT &&_ddgc < _agg )||(_gaaa ==SizeSelectIfGT &&_ddgc > _agg )||(_gaaa ==SizeSelectIfLTE &&_ddgc <=_agg )||(_gaaa ==SizeSelectIfGTE &&_ddgc >=_agg ){_cfda =1;};case LocSelectIfEither :if (_gaaa ==SizeSelectIfLT &&(_ddgc < _agg ||_eadg < _bbad ))||(_gaaa ==SizeSelectIfGT &&(_ddgc > _agg ||_eadg > _bbad ))||(_gaaa ==SizeSelectIfLTE &&(_ddgc <=_agg ||_eadg <=_bbad ))||(_gaaa ==SizeSelectIfGTE &&(_ddgc >=_agg ||_eadg >=_bbad )){_cfda =1;
};case LocSelectIfBoth :if (_gaaa ==SizeSelectIfLT &&(_ddgc < _agg &&_eadg < _bbad ))||(_gaaa ==SizeSelectIfGT &&(_ddgc > _agg &&_eadg > _bbad ))||(_gaaa ==SizeSelectIfLTE &&(_ddgc <=_agg &&_eadg <=_bbad ))||(_gaaa ==SizeSelectIfGTE &&(_ddgc >=_agg &&_eadg >=_bbad )){_cfda =1;
};};_gbcce .AddInt (_cfda );};return _gbcce ;};func _edee (_fgga uint ,_edba byte )byte {return _edba >>_fgga <<_fgga };type Color int ;func TstImageBitmapInverseData ()[]byte {_bfcd :=_fcbeg .Copy ();_bfcd .InverseData ();return _bfcd .Data ;};func (_ade *Bitmap )GetComponents (components Component ,maxWidth ,maxHeight int )(_bdce *Bitmaps ,_eebb *Boxes ,_eeaa error ){const _cgf ="B\u0069t\u006d\u0061\u0070\u002e\u0047\u0065\u0074\u0043o\u006d\u0070\u006f\u006een\u0074\u0073";
if _ade ==nil {return nil ,nil ,_bc .Error (_cgf ,"\u0073\u006f\u0075\u0072\u0063\u0065\u0020\u0042\u0069\u0074\u006da\u0070\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069n\u0065\u0064\u002e");};switch components {case ComponentConn ,ComponentCharacters ,ComponentWords :default:return nil ,nil ,_bc .Error (_cgf ,"\u0069\u006e\u0076\u0061l\u0069\u0064\u0020\u0063\u006f\u006d\u0070\u006f\u006e\u0065n\u0074s\u0020\u0070\u0061\u0072\u0061\u006d\u0065t\u0065\u0072");
};if _ade .Zero (){_eebb =&Boxes {};_bdce =&Bitmaps {};return _bdce ,_eebb ,nil ;};switch components {case ComponentConn :_bdce =&Bitmaps {};if _eebb ,_eeaa =_ade .ConnComponents (_bdce ,8);_eeaa !=nil {return nil ,nil ,_bc .Wrap (_eeaa ,_cgf ,"\u006e\u006f \u0070\u0072\u0065p\u0072\u006f\u0063\u0065\u0073\u0073\u0069\u006e\u0067");
};case ComponentCharacters :_gbaga ,_edgg :=MorphSequence (_ade ,MorphProcess {Operation :MopClosing ,Arguments :[]int {1,6}});if _edgg !=nil {return nil ,nil ,_bc .Wrap (_edgg ,_cgf ,"\u0063h\u0061\u0072\u0061\u0063\u0074\u0065\u0072\u0073\u0020\u0070\u0072e\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u0069\u006e\u0067");
};if _gc .Log .IsLogLevel (_gc .LogLevelTrace ){_gc .Log .Trace ("\u0043o\u006d\u0070o\u006e\u0065\u006e\u0074C\u0068\u0061\u0072a\u0063\u0074\u0065\u0072\u0073\u0020\u0062\u0069\u0074ma\u0070\u0020\u0061f\u0074\u0065r\u0020\u0063\u006c\u006f\u0073\u0069n\u0067\u003a \u0025\u0073",_gbaga .String ());
};_fbb :=&Bitmaps {};_eebb ,_edgg =_gbaga .ConnComponents (_fbb ,8);if _edgg !=nil {return nil ,nil ,_bc .Wrap (_edgg ,_cgf ,"\u0063h\u0061\u0072\u0061\u0063\u0074\u0065\u0072\u0073\u0020\u0070\u0072e\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u0069\u006e\u0067");
};if _gc .Log .IsLogLevel (_gc .LogLevelTrace ){_gc .Log .Trace ("\u0043\u006f\u006d\u0070\u006f\u006ee\u006e\u0074\u0043\u0068\u0061\u0072\u0061\u0063\u0074\u0065\u0072\u0073\u0020\u0062\u0069\u0074\u006d\u0061\u0070\u0020a\u0066\u0074\u0065\u0072\u0020\u0063\u006f\u006e\u006e\u0065\u0063\u0074\u0069\u0076i\u0074y\u003a\u0020\u0025\u0073",_fbb .String ());
};if _bdce ,_edgg =_fbb .ClipToBitmap (_ade );_edgg !=nil {return nil ,nil ,_bc .Wrap (_edgg ,_cgf ,"\u0063h\u0061\u0072\u0061\u0063\u0074\u0065\u0072\u0073\u0020\u0070\u0072e\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u0069\u006e\u0067");};case ComponentWords :_ebab :=1;
var _cbgeb *Bitmap ;switch {case _ade .XResolution <=200:_cbgeb =_ade ;case _ade .XResolution <=400:_ebab =2;_cbgeb ,_eeaa =_ggf (_ade ,1,0,0,0);if _eeaa !=nil {return nil ,nil ,_bc .Wrap (_eeaa ,_cgf ,"w\u006f\u0072\u0064\u0020\u0070\u0072e\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u0020\u002d \u0078\u0072\u0065s\u003c=\u0034\u0030\u0030");
};default:_ebab =4;_cbgeb ,_eeaa =_ggf (_ade ,1,1,0,0);if _eeaa !=nil {return nil ,nil ,_bc .Wrap (_eeaa ,_cgf ,"\u0077\u006f\u0072\u0064 \u0070\u0072\u0065\u0070\u0072\u006f\u0063\u0065\u0073\u0073 \u002d \u0078\u0072\u0065\u0073\u0020\u003e\u00204\u0030\u0030");
};};_aaccd ,_ ,_ffdd :=_gfgfad (_cbgeb );if _ffdd !=nil {return nil ,nil ,_bc .Wrap (_ffdd ,_cgf ,"\u0077o\u0072d\u0020\u0070\u0072\u0065\u0070\u0072\u006f\u0063\u0065\u0073\u0073");};_dbge ,_ffdd :=_eggf (_aaccd ,_ebab );if _ffdd !=nil {return nil ,nil ,_bc .Wrap (_ffdd ,_cgf ,"\u0077o\u0072d\u0020\u0070\u0072\u0065\u0070\u0072\u006f\u0063\u0065\u0073\u0073");
};_bfeg :=&Bitmaps {};if _eebb ,_ffdd =_dbge .ConnComponents (_bfeg ,4);_ffdd !=nil {return nil ,nil ,_bc .Wrap (_ffdd ,_cgf ,"\u0077\u006f\u0072\u0064\u0020\u0070r\u0065\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u002c\u0020\u0063\u006f\u006en\u0065\u0063\u0074\u0020\u0065\u0078\u0070a\u006e\u0064\u0065\u0064");
};if _bdce ,_ffdd =_bfeg .ClipToBitmap (_ade );_ffdd !=nil {return nil ,nil ,_bc .Wrap (_ffdd ,_cgf ,"\u0077o\u0072d\u0020\u0070\u0072\u0065\u0070\u0072\u006f\u0063\u0065\u0073\u0073");};};_bdce ,_eeaa =_bdce .SelectBySize (maxWidth ,maxHeight ,LocSelectIfBoth ,SizeSelectIfLTE );
if _eeaa !=nil {return nil ,nil ,_bc .Wrap (_eeaa ,_cgf ,"");};_eebb ,_eeaa =_eebb .SelectBySize (maxWidth ,maxHeight ,LocSelectIfBoth ,SizeSelectIfLTE );if _eeaa !=nil {return nil ,nil ,_bc .Wrap (_eeaa ,_cgf ,"");};return _bdce ,_eebb ,nil ;};func (_cggd MorphProcess )getWidthHeight ()(_faff ,_aded int ){return _cggd .Arguments [0],_cggd .Arguments [1];
};func (_gagg *ClassedPoints )xSortFunction ()func (_gacd int ,_bgfa int )bool {return func (_fafb ,_bggg int )bool {return _gagg .XAtIndex (_fafb )< _gagg .XAtIndex (_bggg )};};func (_ebef *Bitmap )setBit (_edc int ){_ebef .Data [(_edc >>3)]|=0x80>>uint (_edc &7)};
