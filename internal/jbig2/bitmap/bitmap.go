//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package bitmap ;import (_b "encoding/binary";_d "github.com/stretchr/testify/require";_abc "github.com/unidoc/unipdf/v4/common";_ff "github.com/unidoc/unipdf/v4/internal/bitwise";_cf "github.com/unidoc/unipdf/v4/internal/imageutil";_ed "github.com/unidoc/unipdf/v4/internal/jbig2/basic";
_f "github.com/unidoc/unipdf/v4/internal/jbig2/errors";_ab "image";_ac "math";_dc "sort";_e "strings";_c "testing";);func (_edbg *Bitmap )GetPixel (x ,y int )bool {_afb :=_edbg .GetByteIndex (x ,y );_adfb :=_edbg .GetBitOffset (x );_eff :=uint (7-_adfb );
if _afb > len (_edbg .Data )-1{_abc .Log .Debug ("\u0054\u0072\u0079\u0069\u006e\u0067\u0020\u0074\u006f\u0020\u0067\u0065\u0074\u0020\u0070\u0069\u0078\u0065\u006c\u0020o\u0075\u0074\u0020\u006f\u0066\u0020\u0074\u0068\u0065\u0020\u0064\u0061\u0074\u0061\u0020\u0072\u0061\u006e\u0067\u0065\u002e \u0078\u003a\u0020\u0027\u0025\u0064\u0027\u002c\u0020\u0079\u003a\u0027\u0025\u0064'\u002c\u0020\u0062m\u003a\u0020\u0027\u0025\u0073\u0027",x ,y ,_edbg );
return false ;};if (_edbg .Data [_afb ]>>_eff )&0x01>=1{return true ;};return false ;};func TstFrameBitmap ()*Bitmap {return _dbef .Copy ()};type RasterOperator int ;type LocationFilter int ;func _ggba (_ebfce *Bitmap ,_faage ,_fffac int ,_aegf ,_edbf int ,_gbgg RasterOperator ){var (_aefg bool ;
_afbe bool ;_bbaac int ;_dffg int ;_fceb int ;_cfdd int ;_ffdc bool ;_bdef byte ;);_fddd :=8-(_faage &7);_ddbbf :=_dgeaa [_fddd ];_dcbg :=_ebfce .RowStride *_fffac +(_faage >>3);if _aegf < _fddd {_aefg =true ;_ddbbf &=_abfdd [8-_fddd +_aegf ];};if !_aefg {_bbaac =(_aegf -_fddd )>>3;
if _bbaac !=0{_afbe =true ;_dffg =_dcbg +1;};};_fceb =(_faage +_aegf )&7;if !_aefg &&_fceb !=0{_ffdc =true ;_bdef =_abfdd [_fceb ];_cfdd =_dcbg +1+_bbaac ;};var _efaab ,_agce int ;switch _gbgg {case PixClr :for _efaab =0;_efaab < _edbf ;_efaab ++{_ebfce .Data [_dcbg ]=_egbbc (_ebfce .Data [_dcbg ],0x0,_ddbbf );
_dcbg +=_ebfce .RowStride ;};if _afbe {for _efaab =0;_efaab < _edbf ;_efaab ++{for _agce =0;_agce < _bbaac ;_agce ++{_ebfce .Data [_dffg +_agce ]=0x0;};_dffg +=_ebfce .RowStride ;};};if _ffdc {for _efaab =0;_efaab < _edbf ;_efaab ++{_ebfce .Data [_cfdd ]=_egbbc (_ebfce .Data [_cfdd ],0x0,_bdef );
_cfdd +=_ebfce .RowStride ;};};case PixSet :for _efaab =0;_efaab < _edbf ;_efaab ++{_ebfce .Data [_dcbg ]=_egbbc (_ebfce .Data [_dcbg ],0xff,_ddbbf );_dcbg +=_ebfce .RowStride ;};if _afbe {for _efaab =0;_efaab < _edbf ;_efaab ++{for _agce =0;_agce < _bbaac ;
_agce ++{_ebfce .Data [_dffg +_agce ]=0xff;};_dffg +=_ebfce .RowStride ;};};if _ffdc {for _efaab =0;_efaab < _edbf ;_efaab ++{_ebfce .Data [_cfdd ]=_egbbc (_ebfce .Data [_cfdd ],0xff,_bdef );_cfdd +=_ebfce .RowStride ;};};case PixNotDst :for _efaab =0;
_efaab < _edbf ;_efaab ++{_ebfce .Data [_dcbg ]=_egbbc (_ebfce .Data [_dcbg ],^_ebfce .Data [_dcbg ],_ddbbf );_dcbg +=_ebfce .RowStride ;};if _afbe {for _efaab =0;_efaab < _edbf ;_efaab ++{for _agce =0;_agce < _bbaac ;_agce ++{_ebfce .Data [_dffg +_agce ]=^(_ebfce .Data [_dffg +_agce ]);
};_dffg +=_ebfce .RowStride ;};};if _ffdc {for _efaab =0;_efaab < _edbf ;_efaab ++{_ebfce .Data [_cfdd ]=_egbbc (_ebfce .Data [_cfdd ],^_ebfce .Data [_cfdd ],_bdef );_cfdd +=_ebfce .RowStride ;};};};};func (_feagc *ClassedPoints )GroupByY ()([]*ClassedPoints ,error ){const _edef ="\u0043\u006c\u0061\u0073se\u0064\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047\u0072\u006f\u0075\u0070\u0042y\u0059";
if _agf :=_feagc .validateIntSlice ();_agf !=nil {return nil ,_f .Wrap (_agf ,_edef ,"");};if _feagc .IntSlice .Size ()==0{return nil ,_f .Error (_edef ,"\u004e\u006f\u0020\u0063la\u0073\u0073\u0065\u0073\u0020\u0070\u0072\u006f\u0076\u0069\u0064\u0065\u0064");
};_feagc .SortByY ();var (_cgad []*ClassedPoints ;_bgfde int ;);_bgfa :=-1;var _bbag *ClassedPoints ;for _ffbga :=0;_ffbga < len (_feagc .IntSlice );_ffbga ++{_bgfde =int (_feagc .YAtIndex (_ffbga ));if _bgfde !=_bgfa {_bbag =&ClassedPoints {Points :_feagc .Points };
_bgfa =_bgfde ;_cgad =append (_cgad ,_bbag );};_bbag .IntSlice =append (_bbag .IntSlice ,_feagc .IntSlice [_ffbga ]);};for _ ,_cfcf :=range _cgad {_cfcf .SortByX ();};return _cgad ,nil ;};func _beac (_gee *Bitmap ,_acdf ,_acdade ,_fdfe ,_ddcb int ,_aada RasterOperator ){if _acdf < 0{_fdfe +=_acdf ;
_acdf =0;};_dfde :=_acdf +_fdfe -_gee .Width ;if _dfde > 0{_fdfe -=_dfde ;};if _acdade < 0{_ddcb +=_acdade ;_acdade =0;};_gade :=_acdade +_ddcb -_gee .Height ;if _gade > 0{_ddcb -=_gade ;};if _fdfe <=0||_ddcb <=0{return ;};if (_acdf &7)==0{_bec (_gee ,_acdf ,_acdade ,_fdfe ,_ddcb ,_aada );
}else {_ggba (_gee ,_acdf ,_acdade ,_fdfe ,_ddcb ,_aada );};};func (_acc *Bitmap )setFourBytes (_gacc int ,_afbg uint32 )error {if _gacc +3> len (_acc .Data )-1{return _f .Errorf ("\u0073\u0065\u0074F\u006f\u0075\u0072\u0042\u0079\u0074\u0065\u0073","\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",_gacc );
};_acc .Data [_gacc ]=byte ((_afbg &0xff000000)>>24);_acc .Data [_gacc +1]=byte ((_afbg &0xff0000)>>16);_acc .Data [_gacc +2]=byte ((_afbg &0xff00)>>8);_acc .Data [_gacc +3]=byte (_afbg &0xff);return nil ;};func (_cbdb *Bitmap )addPadBits ()(_ddc error ){const _fdb ="\u0062\u0069\u0074\u006d\u0061\u0070\u002e\u0061\u0064\u0064\u0050\u0061d\u0042\u0069\u0074\u0073";
_deee :=_cbdb .Width %8;if _deee ==0{return nil ;};_efee :=_cbdb .Width /8;_cfba :=_ff .NewReader (_cbdb .Data );_acdb :=make ([]byte ,_cbdb .Height *_cbdb .RowStride );_gfae :=_ff .NewWriterMSB (_acdb );_fda :=make ([]byte ,_efee );var (_fgge int ;_aec uint64 ;
);for _fgge =0;_fgge < _cbdb .Height ;_fgge ++{if _ ,_ddc =_cfba .Read (_fda );_ddc !=nil {return _f .Wrap (_ddc ,_fdb ,"\u0066u\u006c\u006c\u0020\u0062\u0079\u0074e");};if _ ,_ddc =_gfae .Write (_fda );_ddc !=nil {return _f .Wrap (_ddc ,_fdb ,"\u0066\u0075\u006c\u006c\u0020\u0062\u0079\u0074\u0065\u0073");
};if _aec ,_ddc =_cfba .ReadBits (byte (_deee ));_ddc !=nil {return _f .Wrap (_ddc ,_fdb ,"\u0073\u006b\u0069\u0070\u0070\u0069\u006e\u0067\u0020\u0062\u0069\u0074\u0073");};if _ddc =_gfae .WriteByte (byte (_aec )<<uint (8-_deee ));_ddc !=nil {return _f .Wrap (_ddc ,_fdb ,"\u006ca\u0073\u0074\u0020\u0062\u0079\u0074e");
};};_cbdb .Data =_gfae .Data ();return nil ;};func _cacgf (_acgf *Bitmap ,_fgcdg *Bitmap ,_afcb *Selection ,_aagc **Bitmap )(*Bitmap ,error ){const _gaeg ="\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u004d\u006f\u0072\u0070\u0068A\u0072\u0067\u0073\u0031";
if _fgcdg ==nil {return nil ,_f .Error (_gaeg ,"\u004d\u006f\u0072\u0070\u0068\u0041\u0072\u0067\u0073\u0031\u0020'\u0073\u0027\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066i\u006e\u0065\u0064");};if _afcb ==nil {return nil ,_f .Error (_gaeg ,"\u004d\u006f\u0072\u0068p\u0041\u0072\u0067\u0073\u0031\u0020\u0027\u0073\u0065\u006c'\u0020n\u006f\u0074\u0020\u0064\u0065\u0066\u0069n\u0065\u0064");
};_fgbda ,_fgbg :=_afcb .Height ,_afcb .Width ;if _fgbda ==0||_fgbg ==0{return nil ,_f .Error (_gaeg ,"\u0073\u0065\u006c\u0065ct\u0069\u006f\u006e\u0020\u006f\u0066\u0020\u0073\u0069\u007a\u0065\u0020\u0030");};if _acgf ==nil {_acgf =_fgcdg .createTemplate ();
*_aagc =_fgcdg ;return _acgf ,nil ;};_acgf .Width =_fgcdg .Width ;_acgf .Height =_fgcdg .Height ;_acgf .RowStride =_fgcdg .RowStride ;_acgf .Color =_fgcdg .Color ;_acgf .Data =make ([]byte ,_fgcdg .RowStride *_fgcdg .Height );if _acgf ==_fgcdg {*_aagc =_fgcdg .Copy ();
}else {*_aagc =_fgcdg ;};return _acgf ,nil ;};func (_ecg *Bitmap )GetBitOffset (x int )int {return x &0x07};func NewWithData (width ,height int ,data []byte )(*Bitmap ,error ){const _eea ="N\u0065\u0077\u0057\u0069\u0074\u0068\u0044\u0061\u0074\u0061";
_fed :=_fffg (width ,height );_fed .Data =data ;if len (data )< height *_fed .RowStride {return nil ,_f .Errorf (_eea ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0064\u0061\u0074\u0061\u0020l\u0065\u006e\u0067\u0074\u0068\u003a \u0025\u0064\u0020\u002d\u0020\u0073\u0068\u006f\u0075\u006c\u0064\u0020\u0062e\u003a\u0020\u0025\u0064",len (data ),height *_fed .RowStride );
};return _fed ,nil ;};func (_fffa *Bitmap )setBit (_bac int ){_fffa .Data [(_bac >>3)]|=0x80>>uint (_bac &7)};func (_eeec *Bitmap )inverseData (){if _cgce :=_eeec .RasterOperation (0,0,_eeec .Width ,_eeec .Height ,PixNotDst ,nil ,0,0);_cgce !=nil {_abc .Log .Debug ("\u0049n\u0076\u0065\u0072\u0073e\u0020\u0064\u0061\u0074\u0061 \u0066a\u0069l\u0065\u0064\u003a\u0020\u0027\u0025\u0076'",_cgce );
};if _eeec .Color ==Chocolate {_eeec .Color =Vanilla ;}else {_eeec .Color =Chocolate ;};};func Rect (x ,y ,w ,h int )(*_ab .Rectangle ,error ){const _dgg ="b\u0069\u0074\u006d\u0061\u0070\u002e\u0052\u0065\u0063\u0074";if x < 0{w +=x ;x =0;if w <=0{return nil ,_f .Errorf (_dgg ,"x\u003a\u0027\u0025\u0064\u0027\u0020<\u0020\u0030\u0020\u0061\u006e\u0064\u0020\u0077\u003a \u0027\u0025\u0064'\u0020<\u003d\u0020\u0030",x ,w );
};};if y < 0{h +=y ;y =0;if h <=0{return nil ,_f .Error (_dgg ,"\u0079\u0020\u003c 0\u0020\u0061\u006e\u0064\u0020\u0062\u006f\u0078\u0020\u006f\u0066\u0066\u0020\u002b\u0071\u0075\u0061\u0064");};};_eddf :=_ab .Rect (x ,y ,x +w ,y +h );return &_eddf ,nil ;
};func (_fedb *Bitmap )AddBorder (borderSize ,val int )(*Bitmap ,error ){if borderSize ==0{return _fedb .Copy (),nil ;};_egf ,_ece :=_fedb .addBorderGeneral (borderSize ,borderSize ,borderSize ,borderSize ,val );if _ece !=nil {return nil ,_f .Wrap (_ece ,"\u0041d\u0064\u0042\u006f\u0072\u0064\u0065r","");
};return _egf ,nil ;};func _ceed (_egea ,_ceb *Bitmap ,_gcdg ,_gbdc ,_feagf ,_gfba ,_abca ,_ceaa ,_dfga ,_ecdd int ,_gacf CombinationOperator )error {var _bggg int ;_agcg :=func (){_bggg ++;_feagf +=_ceb .RowStride ;_gfba +=_egea .RowStride ;_abca +=_egea .RowStride };
for _bggg =_gcdg ;_bggg < _gbdc ;_agcg (){var _bbfd uint16 ;_cfebb :=_feagf ;for _fgaa :=_gfba ;_fgaa <=_abca ;_fgaa ++{_gde ,_gged :=_ceb .GetByte (_cfebb );if _gged !=nil {return _gged ;};_fgfe ,_gged :=_egea .GetByte (_fgaa );if _gged !=nil {return _gged ;
};_bbfd =(_bbfd |uint16 (_fgfe ))<<uint (_ecdd );_fgfe =byte (_bbfd >>8);if _fgaa ==_abca {_fgfe =_dca (uint (_ceaa ),_fgfe );};if _gged =_ceb .SetByte (_cfebb ,_bfb (_gde ,_fgfe ,_gacf ));_gged !=nil {return _gged ;};_cfebb ++;_bbfd <<=uint (_dfga );};
};return nil ;};func init (){for _aeeae :=0;_aeeae < 256;_aeeae ++{_bgd [_aeeae ]=uint8 (_aeeae &0x1)+(uint8 (_aeeae >>1)&0x1)+(uint8 (_aeeae >>2)&0x1)+(uint8 (_aeeae >>3)&0x1)+(uint8 (_aeeae >>4)&0x1)+(uint8 (_aeeae >>5)&0x1)+(uint8 (_aeeae >>6)&0x1)+(uint8 (_aeeae >>7)&0x1);
};};func (_cadab *ClassedPoints )xSortFunction ()func (_gbdcf int ,_gecb int )bool {return func (_bbgc ,_daac int )bool {return _cadab .XAtIndex (_bbgc )< _cadab .XAtIndex (_daac )};};var (_abfdd =[]byte {0x00,0x80,0xC0,0xE0,0xF0,0xF8,0xFC,0xFE,0xFF};_dgeaa =[]byte {0x00,0x01,0x03,0x07,0x0F,0x1F,0x3F,0x7F,0xFF};
);func _fffg (_dgf ,_bge int )*Bitmap {return &Bitmap {Width :_dgf ,Height :_bge ,RowStride :(_dgf +7)>>3};};func (_eege *Boxes )makeSizeIndicator (_cge ,_acac int ,_fabb LocationFilter ,_cca SizeComparison )*_ed .NumSlice {_ebee :=&_ed .NumSlice {};var _aceb ,_fdec ,_fccd int ;
for _ ,_aadf :=range *_eege {_aceb =0;_fdec ,_fccd =_aadf .Dx (),_aadf .Dy ();switch _fabb {case LocSelectWidth :if (_cca ==SizeSelectIfLT &&_fdec < _cge )||(_cca ==SizeSelectIfGT &&_fdec > _cge )||(_cca ==SizeSelectIfLTE &&_fdec <=_cge )||(_cca ==SizeSelectIfGTE &&_fdec >=_cge ){_aceb =1;
};case LocSelectHeight :if (_cca ==SizeSelectIfLT &&_fccd < _acac )||(_cca ==SizeSelectIfGT &&_fccd > _acac )||(_cca ==SizeSelectIfLTE &&_fccd <=_acac )||(_cca ==SizeSelectIfGTE &&_fccd >=_acac ){_aceb =1;};case LocSelectIfEither :if (_cca ==SizeSelectIfLT &&(_fccd < _acac ||_fdec < _cge ))||(_cca ==SizeSelectIfGT &&(_fccd > _acac ||_fdec > _cge ))||(_cca ==SizeSelectIfLTE &&(_fccd <=_acac ||_fdec <=_cge ))||(_cca ==SizeSelectIfGTE &&(_fccd >=_acac ||_fdec >=_cge )){_aceb =1;
};case LocSelectIfBoth :if (_cca ==SizeSelectIfLT &&(_fccd < _acac &&_fdec < _cge ))||(_cca ==SizeSelectIfGT &&(_fccd > _acac &&_fdec > _cge ))||(_cca ==SizeSelectIfLTE &&(_fccd <=_acac &&_fdec <=_cge ))||(_cca ==SizeSelectIfGTE &&(_fccd >=_acac &&_fdec >=_cge )){_aceb =1;
};};_ebee .AddInt (_aceb );};return _ebee ;};type MorphOperation int ;func (_dec Points )GetIntX (i int )(int ,error ){if i >=len (_dec ){return 0,_f .Errorf ("\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047\u0065t\u0049\u006e\u0074\u0058","\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};return int (_dec [i ].X ),nil ;};func _egae (_gfaac int )int {if _gfaac < 0{return -_gfaac ;};return _gfaac ;};func DilateBrick (d ,s *Bitmap ,hSize ,vSize int )(*Bitmap ,error ){return _fdfd (d ,s ,hSize ,vSize )};func _egg ()(_dga []byte ){_dga =make ([]byte ,256);
for _aeea :=0;_aeea < 256;_aeea ++{_fab :=byte (_aeea );_dga [_fab ]=(_fab &0x01)|((_fab &0x04)>>1)|((_fab &0x10)>>2)|((_fab &0x40)>>3)|((_fab &0x02)<<3)|((_fab &0x08)<<2)|((_fab &0x20)<<1)|(_fab &0x80);};return _dga ;};func TstTSymbol (t *_c .T ,scale ...int )*Bitmap {_gbcdf ,_ddcg :=NewWithData (5,5,[]byte {0xF8,0x20,0x20,0x20,0x20});
_d .NoError (t ,_ddcg );return TstGetScaledSymbol (t ,_gbcdf ,scale ...);};var _bgd [256]uint8 ;func (_ggg *Bitmap )CountPixels ()int {return _ggg .countPixels ()};func (_dgadb *Bitmap )GetComponents (components Component ,maxWidth ,maxHeight int )(_faac *Bitmaps ,_bbcb *Boxes ,_edcc error ){const _gdaf ="B\u0069t\u006d\u0061\u0070\u002e\u0047\u0065\u0074\u0043o\u006d\u0070\u006f\u006een\u0074\u0073";
if _dgadb ==nil {return nil ,nil ,_f .Error (_gdaf ,"\u0073\u006f\u0075\u0072\u0063\u0065\u0020\u0042\u0069\u0074\u006da\u0070\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069n\u0065\u0064\u002e");};switch components {case ComponentConn ,ComponentCharacters ,ComponentWords :default:return nil ,nil ,_f .Error (_gdaf ,"\u0069\u006e\u0076\u0061l\u0069\u0064\u0020\u0063\u006f\u006d\u0070\u006f\u006e\u0065n\u0074s\u0020\u0070\u0061\u0072\u0061\u006d\u0065t\u0065\u0072");
};if _dgadb .Zero (){_bbcb =&Boxes {};_faac =&Bitmaps {};return _faac ,_bbcb ,nil ;};switch components {case ComponentConn :_faac =&Bitmaps {};if _bbcb ,_edcc =_dgadb .ConnComponents (_faac ,8);_edcc !=nil {return nil ,nil ,_f .Wrap (_edcc ,_gdaf ,"\u006e\u006f \u0070\u0072\u0065p\u0072\u006f\u0063\u0065\u0073\u0073\u0069\u006e\u0067");
};case ComponentCharacters :_feg ,_dfc :=MorphSequence (_dgadb ,MorphProcess {Operation :MopClosing ,Arguments :[]int {1,6}});if _dfc !=nil {return nil ,nil ,_f .Wrap (_dfc ,_gdaf ,"\u0063h\u0061\u0072\u0061\u0063\u0074\u0065\u0072\u0073\u0020\u0070\u0072e\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u0069\u006e\u0067");
};if _abc .Log .IsLogLevel (_abc .LogLevelTrace ){_abc .Log .Trace ("\u0043o\u006d\u0070o\u006e\u0065\u006e\u0074C\u0068\u0061\u0072a\u0063\u0074\u0065\u0072\u0073\u0020\u0062\u0069\u0074ma\u0070\u0020\u0061f\u0074\u0065r\u0020\u0063\u006c\u006f\u0073\u0069n\u0067\u003a \u0025\u0073",_feg .String ());
};_cgb :=&Bitmaps {};_bbcb ,_dfc =_feg .ConnComponents (_cgb ,8);if _dfc !=nil {return nil ,nil ,_f .Wrap (_dfc ,_gdaf ,"\u0063h\u0061\u0072\u0061\u0063\u0074\u0065\u0072\u0073\u0020\u0070\u0072e\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u0069\u006e\u0067");
};if _abc .Log .IsLogLevel (_abc .LogLevelTrace ){_abc .Log .Trace ("\u0043\u006f\u006d\u0070\u006f\u006ee\u006e\u0074\u0043\u0068\u0061\u0072\u0061\u0063\u0074\u0065\u0072\u0073\u0020\u0062\u0069\u0074\u006d\u0061\u0070\u0020a\u0066\u0074\u0065\u0072\u0020\u0063\u006f\u006e\u006e\u0065\u0063\u0074\u0069\u0076i\u0074y\u003a\u0020\u0025\u0073",_cgb .String ());
};if _faac ,_dfc =_cgb .ClipToBitmap (_dgadb );_dfc !=nil {return nil ,nil ,_f .Wrap (_dfc ,_gdaf ,"\u0063h\u0061\u0072\u0061\u0063\u0074\u0065\u0072\u0073\u0020\u0070\u0072e\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u0069\u006e\u0067");};case ComponentWords :_gdbb :=1;
var _abbg *Bitmap ;switch {case _dgadb .XResolution <=200:_abbg =_dgadb ;case _dgadb .XResolution <=400:_gdbb =2;_abbg ,_edcc =_aabf (_dgadb ,1,0,0,0);if _edcc !=nil {return nil ,nil ,_f .Wrap (_edcc ,_gdaf ,"w\u006f\u0072\u0064\u0020\u0070\u0072e\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u0020\u002d \u0078\u0072\u0065s\u003c=\u0034\u0030\u0030");
};default:_gdbb =4;_abbg ,_edcc =_aabf (_dgadb ,1,1,0,0);if _edcc !=nil {return nil ,nil ,_f .Wrap (_edcc ,_gdaf ,"\u0077\u006f\u0072\u0064 \u0070\u0072\u0065\u0070\u0072\u006f\u0063\u0065\u0073\u0073 \u002d \u0078\u0072\u0065\u0073\u0020\u003e\u00204\u0030\u0030");
};};_bgc ,_ ,_faee :=_gafdc (_abbg );if _faee !=nil {return nil ,nil ,_f .Wrap (_faee ,_gdaf ,"\u0077o\u0072d\u0020\u0070\u0072\u0065\u0070\u0072\u006f\u0063\u0065\u0073\u0073");};_abbf ,_faee :=_dfbbgb (_bgc ,_gdbb );if _faee !=nil {return nil ,nil ,_f .Wrap (_faee ,_gdaf ,"\u0077o\u0072d\u0020\u0070\u0072\u0065\u0070\u0072\u006f\u0063\u0065\u0073\u0073");
};_ffda :=&Bitmaps {};if _bbcb ,_faee =_abbf .ConnComponents (_ffda ,4);_faee !=nil {return nil ,nil ,_f .Wrap (_faee ,_gdaf ,"\u0077\u006f\u0072\u0064\u0020\u0070r\u0065\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u002c\u0020\u0063\u006f\u006en\u0065\u0063\u0074\u0020\u0065\u0078\u0070a\u006e\u0064\u0065\u0064");
};if _faac ,_faee =_ffda .ClipToBitmap (_dgadb );_faee !=nil {return nil ,nil ,_f .Wrap (_faee ,_gdaf ,"\u0077o\u0072d\u0020\u0070\u0072\u0065\u0070\u0072\u006f\u0063\u0065\u0073\u0073");};};_faac ,_edcc =_faac .SelectBySize (maxWidth ,maxHeight ,LocSelectIfBoth ,SizeSelectIfLTE );
if _edcc !=nil {return nil ,nil ,_f .Wrap (_edcc ,_gdaf ,"");};_bbcb ,_edcc =_bbcb .SelectBySize (maxWidth ,maxHeight ,LocSelectIfBoth ,SizeSelectIfLTE );if _edcc !=nil {return nil ,nil ,_f .Wrap (_edcc ,_gdaf ,"");};return _faac ,_bbcb ,nil ;};func (_gabg *Selection )setOrigin (_gbbf ,_cffda int ){_gabg .Cy ,_gabg .Cx =_gbbf ,_cffda };
func (_aadg *byHeight )Swap (i ,j int ){_aadg .Values [i ],_aadg .Values [j ]=_aadg .Values [j ],_aadg .Values [i ];if _aadg .Boxes !=nil {_aadg .Boxes [i ],_aadg .Boxes [j ]=_aadg .Boxes [j ],_aadg .Boxes [i ];};};func (_afgg *Bitmaps )ClipToBitmap (s *Bitmap )(*Bitmaps ,error ){const _dgdg ="B\u0069t\u006d\u0061\u0070\u0073\u002e\u0043\u006c\u0069p\u0054\u006f\u0042\u0069tm\u0061\u0070";
if _afgg ==nil {return nil ,_f .Error (_dgdg ,"\u0042\u0069\u0074\u006dap\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if s ==nil {return nil ,_f .Error (_dgdg ,"\u0073o\u0075\u0072\u0063\u0065 \u0062\u0069\u0074\u006d\u0061p\u0020n\u006ft\u0020\u0064\u0065\u0066\u0069\u006e\u0065d");
};_dgdc :=len (_afgg .Values );_ffaa :=&Bitmaps {Values :make ([]*Bitmap ,_dgdc ),Boxes :make ([]*_ab .Rectangle ,_dgdc )};var (_bccb ,_edfd *Bitmap ;_bgfdc *_ab .Rectangle ;_bgcg error ;);for _aeab :=0;_aeab < _dgdc ;_aeab ++{if _bccb ,_bgcg =_afgg .GetBitmap (_aeab );
_bgcg !=nil {return nil ,_f .Wrap (_bgcg ,_dgdg ,"");};if _bgfdc ,_bgcg =_afgg .GetBox (_aeab );_bgcg !=nil {return nil ,_f .Wrap (_bgcg ,_dgdg ,"");};if _edfd ,_bgcg =s .clipRectangle (_bgfdc ,nil );_bgcg !=nil {return nil ,_f .Wrap (_bgcg ,_dgdg ,"");
};if _edfd ,_bgcg =_edfd .And (_bccb );_bgcg !=nil {return nil ,_f .Wrap (_bgcg ,_dgdg ,"");};_ffaa .Values [_aeab ]=_edfd ;_ffaa .Boxes [_aeab ]=_bgfdc ;};return _ffaa ,nil ;};func Blit (src *Bitmap ,dst *Bitmap ,x ,y int ,op CombinationOperator )error {var _eeda ,_ffce int ;
_gfdb :=src .RowStride -1;if x < 0{_ffce =-x ;x =0;}else if x +src .Width > dst .Width {_gfdb -=src .Width +x -dst .Width ;};if y < 0{_eeda =-y ;y =0;_ffce +=src .RowStride ;_gfdb +=src .RowStride ;}else if y +src .Height > dst .Height {_eeda =src .Height +y -dst .Height ;
};var (_bfae int ;_bgbf error ;);_gace :=x &0x07;_bfgf :=8-_gace ;_aegg :=src .Width &0x07;_fae :=_bfgf -_aegg ;_deeb :=_bfgf &0x07!=0;_geb :=src .Width <=((_gfdb -_ffce )<<3)+_bfgf ;_gadd :=dst .GetByteIndex (x ,y );_acfe :=_eeda +dst .Height ;if src .Height > _acfe {_bfae =_acfe ;
}else {_bfae =src .Height ;};switch {case !_deeb :_bgbf =_aabg (src ,dst ,_eeda ,_bfae ,_gadd ,_ffce ,_gfdb ,op );case _geb :_bgbf =_ceed (src ,dst ,_eeda ,_bfae ,_gadd ,_ffce ,_gfdb ,_fae ,_gace ,_bfgf ,op );default:_bgbf =_eded (src ,dst ,_eeda ,_bfae ,_gadd ,_ffce ,_gfdb ,_fae ,_gace ,_bfgf ,op ,_aegg );
};return _bgbf ;};func _ebgd (_ebeg ,_eaed ,_cfae *Bitmap )(*Bitmap ,error ){const _gea ="\u0073\u0075\u0062\u0074\u0072\u0061\u0063\u0074";if _eaed ==nil {return nil ,_f .Error (_gea ,"'\u0073\u0031\u0027\u0020\u0069\u0073\u0020\u006e\u0069\u006c");};
if _cfae ==nil {return nil ,_f .Error (_gea ,"'\u0073\u0032\u0027\u0020\u0069\u0073\u0020\u006e\u0069\u006c");};var _gag error ;switch _ebeg {case _eaed :if _gag =_ebeg .RasterOperation (0,0,_eaed .Width ,_eaed .Height ,PixNotSrcAndDst ,_cfae ,0,0);_gag !=nil {return nil ,_f .Wrap (_gag ,_gea ,"\u0064 \u003d\u003d\u0020\u0073\u0031");
};case _cfae :if _gag =_ebeg .RasterOperation (0,0,_eaed .Width ,_eaed .Height ,PixNotSrcAndDst ,_eaed ,0,0);_gag !=nil {return nil ,_f .Wrap (_gag ,_gea ,"\u0064 \u003d\u003d\u0020\u0073\u0032");};default:_ebeg ,_gag =_bee (_ebeg ,_eaed );if _gag !=nil {return nil ,_f .Wrap (_gag ,_gea ,"");
};if _gag =_ebeg .RasterOperation (0,0,_eaed .Width ,_eaed .Height ,PixNotSrcAndDst ,_cfae ,0,0);_gag !=nil {return nil ,_f .Wrap (_gag ,_gea ,"\u0064e\u0066\u0061\u0075\u006c\u0074");};};return _ebeg ,nil ;};type byWidth Bitmaps ;func TstCSymbol (t *_c .T )*Bitmap {t .Helper ();
_eggf :=New (6,6);_d .NoError (t ,_eggf .SetPixel (1,0,1));_d .NoError (t ,_eggf .SetPixel (2,0,1));_d .NoError (t ,_eggf .SetPixel (3,0,1));_d .NoError (t ,_eggf .SetPixel (4,0,1));_d .NoError (t ,_eggf .SetPixel (0,1,1));_d .NoError (t ,_eggf .SetPixel (5,1,1));
_d .NoError (t ,_eggf .SetPixel (0,2,1));_d .NoError (t ,_eggf .SetPixel (0,3,1));_d .NoError (t ,_eggf .SetPixel (0,4,1));_d .NoError (t ,_eggf .SetPixel (5,4,1));_d .NoError (t ,_eggf .SetPixel (1,5,1));_d .NoError (t ,_eggf .SetPixel (2,5,1));_d .NoError (t ,_eggf .SetPixel (3,5,1));
_d .NoError (t ,_eggf .SetPixel (4,5,1));return _eggf ;};func CorrelationScore (bm1 ,bm2 *Bitmap ,area1 ,area2 int ,delX ,delY float32 ,maxDiffW ,maxDiffH int ,tab []int )(_dcbd float64 ,_bgdg error ){const _fbae ="\u0063\u006fr\u0072\u0065\u006ca\u0074\u0069\u006f\u006e\u0053\u0063\u006f\u0072\u0065";
if bm1 ==nil ||bm2 ==nil {return 0,_f .Error (_fbae ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0062\u0069\u0074ma\u0070\u0073");};if tab ==nil {return 0,_f .Error (_fbae ,"\u0027\u0074\u0061\u0062\u0027\u0020\u006e\u006f\u0074\u0020\u0064\u0065f\u0069\u006e\u0065\u0064");
};if area1 <=0||area2 <=0{return 0,_f .Error (_fbae ,"\u0061\u0072\u0065\u0061s\u0020\u006d\u0075\u0073\u0074\u0020\u0062\u0065\u0020\u0067r\u0065a\u0074\u0065\u0072\u0020\u0074\u0068\u0061n\u0020\u0030");};_fabd ,_fegd :=bm1 .Width ,bm1 .Height ;_bcd ,_cdag :=bm2 .Width ,bm2 .Height ;
_ggc :=_egae (_fabd -_bcd );if _ggc > maxDiffW {return 0,nil ;};_cgfe :=_egae (_fegd -_cdag );if _cgfe > maxDiffH {return 0,nil ;};var _fef ,_agcc int ;if delX >=0{_fef =int (delX +0.5);}else {_fef =int (delX -0.5);};if delY >=0{_agcc =int (delY +0.5);
}else {_agcc =int (delY -0.5);};_dcc :=_cce (_agcc ,0);_gbad :=_gffc (_cdag +_agcc ,_fegd );_dcfgg :=bm1 .RowStride *_dcc ;_abd :=bm2 .RowStride *(_dcc -_agcc );_eddbc :=_cce (_fef ,0);_age :=_gffc (_bcd +_fef ,_fabd );_cabb :=bm2 .RowStride ;var _cegc ,_gffdc int ;
if _fef >=8{_cegc =_fef >>3;_dcfgg +=_cegc ;_eddbc -=_cegc <<3;_age -=_cegc <<3;_fef &=7;}else if _fef <=-8{_gffdc =-((_fef +7)>>3);_abd +=_gffdc ;_cabb -=_gffdc ;_fef +=_gffdc <<3;};if _eddbc >=_age ||_dcc >=_gbad {return 0,nil ;};_eab :=(_age +7)>>3;
var (_gcbff ,_gfaga ,_ffcee byte ;_edgcf ,_aaeg ,_gbef int ;);switch {case _fef ==0:for _gbef =_dcc ;_gbef < _gbad ;_gbef ,_dcfgg ,_abd =_gbef +1,_dcfgg +bm1 .RowStride ,_abd +bm2 .RowStride {for _aaeg =0;_aaeg < _eab ;_aaeg ++{_ffcee =bm1 .Data [_dcfgg +_aaeg ]&bm2 .Data [_abd +_aaeg ];
_edgcf +=tab [_ffcee ];};};case _fef > 0:if _cabb < _eab {for _gbef =_dcc ;_gbef < _gbad ;_gbef ,_dcfgg ,_abd =_gbef +1,_dcfgg +bm1 .RowStride ,_abd +bm2 .RowStride {_gcbff ,_gfaga =bm1 .Data [_dcfgg ],bm2 .Data [_abd ]>>uint (_fef );_ffcee =_gcbff &_gfaga ;
_edgcf +=tab [_ffcee ];for _aaeg =1;_aaeg < _cabb ;_aaeg ++{_gcbff ,_gfaga =bm1 .Data [_dcfgg +_aaeg ],(bm2 .Data [_abd +_aaeg ]>>uint (_fef ))|(bm2 .Data [_abd +_aaeg -1]<<uint (8-_fef ));_ffcee =_gcbff &_gfaga ;_edgcf +=tab [_ffcee ];};_gcbff =bm1 .Data [_dcfgg +_aaeg ];
_gfaga =bm2 .Data [_abd +_aaeg -1]<<uint (8-_fef );_ffcee =_gcbff &_gfaga ;_edgcf +=tab [_ffcee ];};}else {for _gbef =_dcc ;_gbef < _gbad ;_gbef ,_dcfgg ,_abd =_gbef +1,_dcfgg +bm1 .RowStride ,_abd +bm2 .RowStride {_gcbff ,_gfaga =bm1 .Data [_dcfgg ],bm2 .Data [_abd ]>>uint (_fef );
_ffcee =_gcbff &_gfaga ;_edgcf +=tab [_ffcee ];for _aaeg =1;_aaeg < _eab ;_aaeg ++{_gcbff =bm1 .Data [_dcfgg +_aaeg ];_gfaga =(bm2 .Data [_abd +_aaeg ]>>uint (_fef ))|(bm2 .Data [_abd +_aaeg -1]<<uint (8-_fef ));_ffcee =_gcbff &_gfaga ;_edgcf +=tab [_ffcee ];
};};};default:if _eab < _cabb {for _gbef =_dcc ;_gbef < _gbad ;_gbef ,_dcfgg ,_abd =_gbef +1,_dcfgg +bm1 .RowStride ,_abd +bm2 .RowStride {for _aaeg =0;_aaeg < _eab ;_aaeg ++{_gcbff =bm1 .Data [_dcfgg +_aaeg ];_gfaga =bm2 .Data [_abd +_aaeg ]<<uint (-_fef );
_gfaga |=bm2 .Data [_abd +_aaeg +1]>>uint (8+_fef );_ffcee =_gcbff &_gfaga ;_edgcf +=tab [_ffcee ];};};}else {for _gbef =_dcc ;_gbef < _gbad ;_gbef ,_dcfgg ,_abd =_gbef +1,_dcfgg +bm1 .RowStride ,_abd +bm2 .RowStride {for _aaeg =0;_aaeg < _eab -1;_aaeg ++{_gcbff =bm1 .Data [_dcfgg +_aaeg ];
_gfaga =bm2 .Data [_abd +_aaeg ]<<uint (-_fef );_gfaga |=bm2 .Data [_abd +_aaeg +1]>>uint (8+_fef );_ffcee =_gcbff &_gfaga ;_edgcf +=tab [_ffcee ];};_gcbff =bm1 .Data [_dcfgg +_aaeg ];_gfaga =bm2 .Data [_abd +_aaeg ]<<uint (-_fef );_ffcee =_gcbff &_gfaga ;
_edgcf +=tab [_ffcee ];};};};_dcbd =float64 (_edgcf )*float64 (_edgcf )/(float64 (area1 )*float64 (area2 ));return _dcbd ,nil ;};func _dagdg (_gddc *Bitmap ,_fcdb ,_abace ,_egbc ,_dfee int ,_afac RasterOperator ,_cgfca *Bitmap ,_gbcdg ,_faeg int )error {const _ebac ="\u0072a\u0073t\u0065\u0072\u004f\u0070\u0065\u0072\u0061\u0074\u0069\u006f\u006e";
if _gddc ==nil {return _f .Error (_ebac ,"\u006e\u0069\u006c\u0020\u0027\u0064\u0065\u0073\u0074\u0027\u0020\u0042i\u0074\u006d\u0061\u0070");};if _afac ==PixDst {return nil ;};switch _afac {case PixClr ,PixSet ,PixNotDst :_beac (_gddc ,_fcdb ,_abace ,_egbc ,_dfee ,_afac );
return nil ;};if _cgfca ==nil {_abc .Log .Debug ("\u0052a\u0073\u0074e\u0072\u004f\u0070\u0065r\u0061\u0074\u0069o\u006e\u0020\u0073\u006f\u0075\u0072\u0063\u0065\u0020bi\u0074\u006d\u0061p\u0020\u0069s\u0020\u006e\u006f\u0074\u0020\u0064e\u0066\u0069n\u0065\u0064");
return _f .Error (_ebac ,"\u006e\u0069l\u0020\u0027\u0073r\u0063\u0027\u0020\u0062\u0069\u0074\u006d\u0061\u0070");};if _ebfb :=_ccef (_gddc ,_fcdb ,_abace ,_egbc ,_dfee ,_afac ,_cgfca ,_gbcdg ,_faeg );_ebfb !=nil {return _f .Wrap (_ebfb ,_ebac ,"");};
return nil ;};func _acb (_ae ,_ffe *Bitmap )(_dce error ){const _cg ="\u0065\u0078\u0070\u0061nd\u0042\u0069\u006e\u0061\u0072\u0079\u0046\u0061\u0063\u0074\u006f\u0072\u0032";_acbe :=_ffe .RowStride ;_ea :=_ae .RowStride ;var (_de byte ;_ee uint16 ;_ba ,_cb ,_baf ,_acd ,_cfb int ;
);for _baf =0;_baf < _ffe .Height ;_baf ++{_ba =_baf *_acbe ;_cb =2*_baf *_ea ;for _acd =0;_acd < _acbe ;_acd ++{_de =_ffe .Data [_ba +_acd ];_ee =_gcgd [_de ];_cfb =_cb +_acd *2;if _ae .RowStride !=_ffe .RowStride *2&&(_acd +1)*2> _ae .RowStride {_dce =_ae .SetByte (_cfb ,byte (_ee >>8));
}else {_dce =_ae .setTwoBytes (_cfb ,_ee );};if _dce !=nil {return _f .Wrap (_dce ,_cg ,"");};};for _acd =0;_acd < _ea ;_acd ++{_cfb =_cb +_ea +_acd ;_de =_ae .Data [_cb +_acd ];if _dce =_ae .SetByte (_cfb ,_de );_dce !=nil {return _f .Wrapf (_dce ,_cg ,"c\u006f\u0070\u0079\u0020\u0064\u006fu\u0062\u006c\u0065\u0064\u0020\u006ci\u006e\u0065\u003a\u0020\u0027\u0025\u0064'\u002c\u0020\u0042\u0079\u0074\u0065\u003a\u0020\u0027\u0025d\u0027",_cb +_acd ,_cb +_ea +_acd );
};};};return nil ;};func _bfb (_cafg ,_edf byte ,_dcg CombinationOperator )byte {switch _dcg {case CmbOpOr :return _edf |_cafg ;case CmbOpAnd :return _edf &_cafg ;case CmbOpXor :return _edf ^_cafg ;case CmbOpXNor :return ^(_edf ^_cafg );case CmbOpNot :return ^(_edf );
default:return _edf ;};};func RankHausTest (p1 ,p2 ,p3 ,p4 *Bitmap ,delX ,delY float32 ,maxDiffW ,maxDiffH ,area1 ,area3 int ,rank float32 ,tab8 []int )(_ggd bool ,_ecge error ){const _gae ="\u0052\u0061\u006ek\u0048\u0061\u0075\u0073\u0054\u0065\u0073\u0074";
_cafe ,_bada :=p1 .Width ,p1 .Height ;_gcbda ,_defe :=p3 .Width ,p3 .Height ;if _ed .Abs (_cafe -_gcbda )> maxDiffW {return false ,nil ;};if _ed .Abs (_bada -_defe )> maxDiffH {return false ,nil ;};_aefe :=int (float32 (area1 )*(1.0-rank )+0.5);_gfec :=int (float32 (area3 )*(1.0-rank )+0.5);
var _dbfe ,_dgfb int ;if delX >=0{_dbfe =int (delX +0.5);}else {_dbfe =int (delX -0.5);};if delY >=0{_dgfb =int (delY +0.5);}else {_dgfb =int (delY -0.5);};_gcfe :=p1 .CreateTemplate ();if _ecge =_gcfe .RasterOperation (0,0,_cafe ,_bada ,PixSrc ,p1 ,0,0);
_ecge !=nil {return false ,_f .Wrap (_ecge ,_gae ,"p\u0031\u0020\u002d\u0053\u0052\u0043\u002d\u003e\u0020\u0074");};if _ecge =_gcfe .RasterOperation (_dbfe ,_dgfb ,_cafe ,_bada ,PixNotSrcAndDst ,p4 ,0,0);_ecge !=nil {return false ,_f .Wrap (_ecge ,_gae ,"\u0074 \u0026\u0020\u0021\u0070\u0034");
};_ggd ,_ecge =_gcfe .ThresholdPixelSum (_aefe ,tab8 );if _ecge !=nil {return false ,_f .Wrap (_ecge ,_gae ,"\u0074\u002d\u003e\u0074\u0068\u0072\u0065\u0073\u0068\u0031");};if _ggd {return false ,nil ;};if _ecge =_gcfe .RasterOperation (_dbfe ,_dgfb ,_gcbda ,_defe ,PixSrc ,p3 ,0,0);
_ecge !=nil {return false ,_f .Wrap (_ecge ,_gae ,"p\u0033\u0020\u002d\u0053\u0052\u0043\u002d\u003e\u0020\u0074");};if _ecge =_gcfe .RasterOperation (0,0,_gcbda ,_defe ,PixNotSrcAndDst ,p2 ,0,0);_ecge !=nil {return false ,_f .Wrap (_ecge ,_gae ,"\u0074 \u0026\u0020\u0021\u0070\u0032");
};_ggd ,_ecge =_gcfe .ThresholdPixelSum (_gfec ,tab8 );if _ecge !=nil {return false ,_f .Wrap (_ecge ,_gae ,"\u0074\u002d\u003e\u0074\u0068\u0072\u0065\u0073\u0068\u0033");};return !_ggd ,nil ;};func _bcfe (_dbff ,_bcdc *Bitmap ,_faae *Selection )(*Bitmap ,error ){const _cccaa ="c\u006c\u006f\u0073\u0065\u0042\u0069\u0074\u006d\u0061\u0070";
var _dfge error ;if _dbff ,_dfge =_edce (_dbff ,_bcdc ,_faae );_dfge !=nil {return nil ,_dfge ;};_bdfb ,_dfge :=_faad (nil ,_bcdc ,_faae );if _dfge !=nil {return nil ,_f .Wrap (_dfge ,_cccaa ,"");};if _ ,_dfge =_acaab (_dbff ,_bdfb ,_faae );_dfge !=nil {return nil ,_f .Wrap (_dfge ,_cccaa ,"");
};return _dbff ,nil ;};func MakePixelCentroidTab8 ()[]int {return _dedb ()};type Color int ;func TstImageBitmapData ()[]byte {return _cfdg .Data };func (_gafd *Bitmap )clipRectangle (_efeg ,_fdfc *_ab .Rectangle )(_eeeb *Bitmap ,_ddb error ){const _edg ="\u0063\u006c\u0069\u0070\u0052\u0065\u0063\u0074\u0061\u006e\u0067\u006c\u0065";
if _efeg ==nil {return nil ,_f .Error (_edg ,"\u0070r\u006fv\u0069\u0064\u0065\u0064\u0020n\u0069\u006c \u0027\u0062\u006f\u0078\u0027");};_gcga ,_bbee :=_gafd .Width ,_gafd .Height ;_affc ,_ddb :=ClipBoxToRectangle (_efeg ,_gcga ,_bbee );if _ddb !=nil {_abc .Log .Warning ("\u0027\u0062ox\u0027\u0020\u0064o\u0065\u0073\u006e\u0027t o\u0076er\u006c\u0061\u0070\u0020\u0062\u0069\u0074ma\u0070\u0020\u0027\u0062\u0027\u003a\u0020%\u0076",_ddb );
return nil ,nil ;};_ceg ,_cdb :=_affc .Min .X ,_affc .Min .Y ;_fggf ,_eccf :=_affc .Max .X -_affc .Min .X ,_affc .Max .Y -_affc .Min .Y ;_eeeb =New (_fggf ,_eccf );_eeeb .Text =_gafd .Text ;if _ddb =_eeeb .RasterOperation (0,0,_fggf ,_eccf ,PixSrc ,_gafd ,_ceg ,_cdb );
_ddb !=nil {return nil ,_f .Wrap (_ddb ,_edg ,"");};if _fdfc !=nil {*_fdfc =*_affc ;};return _eeeb ,nil ;};func (_gdacc *byWidth )Less (i ,j int )bool {return _gdacc .Values [i ].Width < _gdacc .Values [j ].Width };func (_dba *Bitmap )GetVanillaData ()[]byte {if _dba .Color ==Chocolate {_dba .inverseData ();
};return _dba .Data ;};func _bba (_cde ,_gbb *Bitmap ,_ int ,_dab []byte ,_aga int )(_fcd error ){const _bdfd ="\u0072\u0065\u0064uc\u0065\u0052\u0061\u006e\u006b\u0042\u0069\u006e\u0061\u0072\u0079\u0032\u004c\u0065\u0076\u0065\u006c\u0031";var (_dge ,_fgf ,_bgg ,_dgb ,_bbca ,_cbc ,_ecf ,_fa int ;
_ccb ,_fgc uint32 ;_ad ,_ffb byte ;_cdf uint16 ;);_aebg :=make ([]byte ,4);_fd :=make ([]byte ,4);for _bgg =0;_bgg < _cde .Height -1;_bgg ,_dgb =_bgg +2,_dgb +1{_dge =_bgg *_cde .RowStride ;_fgf =_dgb *_gbb .RowStride ;for _bbca ,_cbc =0,0;_bbca < _aga ;
_bbca ,_cbc =_bbca +4,_cbc +1{for _ecf =0;_ecf < 4;_ecf ++{_fa =_dge +_bbca +_ecf ;if _fa <=len (_cde .Data )-1&&_fa < _dge +_cde .RowStride {_aebg [_ecf ]=_cde .Data [_fa ];}else {_aebg [_ecf ]=0x00;};_fa =_dge +_cde .RowStride +_bbca +_ecf ;if _fa <=len (_cde .Data )-1&&_fa < _dge +(2*_cde .RowStride ){_fd [_ecf ]=_cde .Data [_fa ];
}else {_fd [_ecf ]=0x00;};};_ccb =_b .BigEndian .Uint32 (_aebg );_fgc =_b .BigEndian .Uint32 (_fd );_fgc |=_ccb ;_fgc |=_fgc <<1;_fgc &=0xaaaaaaaa;_ccb =_fgc |(_fgc <<7);_ad =byte (_ccb >>24);_ffb =byte ((_ccb >>8)&0xff);_fa =_fgf +_cbc ;if _fa +1==len (_gbb .Data )-1||_fa +1>=_fgf +_gbb .RowStride {_gbb .Data [_fa ]=_dab [_ad ];
}else {_cdf =(uint16 (_dab [_ad ])<<8)|uint16 (_dab [_ffb ]);if _fcd =_gbb .setTwoBytes (_fa ,_cdf );_fcd !=nil {return _f .Wrapf (_fcd ,_bdfd ,"s\u0065\u0074\u0074\u0069\u006e\u0067 \u0074\u0077\u006f\u0020\u0062\u0079t\u0065\u0073\u0020\u0066\u0061\u0069\u006ce\u0064\u002c\u0020\u0069\u006e\u0064\u0065\u0078\u003a\u0020%\u0064",_fa );
};_cbc ++;};};};return nil ;};func _bee (_cbcc ,_abg *Bitmap )(*Bitmap ,error ){if _abg ==nil {return nil ,_f .Error ("\u0063\u006f\u0070\u0079\u0042\u0069\u0074\u006d\u0061\u0070","\u0073o\u0075r\u0063\u0065\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");
};if _abg ==_cbcc {return _cbcc ,nil ;};if _cbcc ==nil {_cbcc =_abg .createTemplate ();copy (_cbcc .Data ,_abg .Data );return _cbcc ,nil ;};_cada :=_cbcc .resizeImageData (_abg );if _cada !=nil {return nil ,_f .Wrap (_cada ,"\u0063\u006f\u0070\u0079\u0042\u0069\u0074\u006d\u0061\u0070","");
};_cbcc .Text =_abg .Text ;copy (_cbcc .Data ,_abg .Data );return _cbcc ,nil ;};func (_bdfc *Boxes )Add (box *_ab .Rectangle )error {if _bdfc ==nil {return _f .Error ("\u0042o\u0078\u0065\u0073\u002e\u0041\u0064d","\u0027\u0042\u006f\u0078es\u0027\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};*_bdfc =append (*_bdfc ,box );return nil ;};type SizeSelection int ;func (_acfgb *Bitmaps )AddBitmap (bm *Bitmap ){_acfgb .Values =append (_acfgb .Values ,bm )};func (_ecb *Bitmap )Zero ()bool {_ffee :=_ecb .Width /8;_cac :=_ecb .Width &7;var _ded byte ;
if _cac !=0{_ded =byte (0xff<<uint (8-_cac ));};var _cgde ,_affb ,_gad int ;for _affb =0;_affb < _ecb .Height ;_affb ++{_cgde =_ecb .RowStride *_affb ;for _gad =0;_gad < _ffee ;_gad ,_cgde =_gad +1,_cgde +1{if _ecb .Data [_cgde ]!=0{return false ;};};if _cac > 0{if _ecb .Data [_cgde ]&_ded !=0{return false ;
};};};return true ;};func (_cfe *Bitmap )RemoveBorder (borderSize int )(*Bitmap ,error ){if borderSize ==0{return _cfe .Copy (),nil ;};_fced ,_fffd :=_cfe .removeBorderGeneral (borderSize ,borderSize ,borderSize ,borderSize );if _fffd !=nil {return nil ,_f .Wrap (_fffd ,"\u0052\u0065\u006do\u0076\u0065\u0042\u006f\u0072\u0064\u0065\u0072","");
};return _fced ,nil ;};func (_aeeaa *Bitmap )CreateTemplate ()*Bitmap {return _aeeaa .createTemplate ()};func (_aegae CombinationOperator )String ()string {var _gaddb string ;switch _aegae {case CmbOpOr :_gaddb ="\u004f\u0052";case CmbOpAnd :_gaddb ="\u0041\u004e\u0044";
case CmbOpXor :_gaddb ="\u0058\u004f\u0052";case CmbOpXNor :_gaddb ="\u0058\u004e\u004f\u0052";case CmbOpReplace :_gaddb ="\u0052E\u0050\u004c\u0041\u0043\u0045";case CmbOpNot :_gaddb ="\u004e\u004f\u0054";};return _gaddb ;};func (_dbc *Bitmap )SizesEqual (s *Bitmap )bool {if _dbc ==s {return true ;
};if _dbc .Width !=s .Width ||_dbc .Height !=s .Height {return false ;};return true ;};func (_dbbg *Bitmaps )CountPixels ()*_ed .NumSlice {_gffdd :=&_ed .NumSlice {};for _ ,_befa :=range _dbbg .Values {_gffdd .AddInt (_befa .CountPixels ());};return _gffdd ;
};func _feabc (_eecgf *Bitmap ,_adba ...MorphProcess )(_effd *Bitmap ,_gabd error ){const _dcfgd ="\u006d\u006f\u0072\u0070\u0068\u0053\u0065\u0071\u0075\u0065\u006e\u0063\u0065";if _eecgf ==nil {return nil ,_f .Error (_dcfgd ,"\u006d\u006f\u0072\u0070\u0068\u0053\u0065\u0071\u0075\u0065\u006e\u0063\u0065 \u0073\u006f\u0075\u0072\u0063\u0065 \u0062\u0069\u0074\u006d\u0061\u0070\u0020\u006e\u006f\u0074\u0020\u0064\u0065f\u0069\u006e\u0065\u0064");
};if len (_adba )==0{return nil ,_f .Error (_dcfgd ,"m\u006f\u0072\u0070\u0068\u0053\u0065q\u0075\u0065\u006e\u0063\u0065\u002c \u0073\u0065\u0071\u0075\u0065\u006e\u0063e\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006ee\u0064");};if _gabd =_cbcd (_adba ...);
_gabd !=nil {return nil ,_f .Wrap (_gabd ,_dcfgd ,"");};var _abbfa ,_bgdd ,_cdeb int ;_effd =_eecgf .Copy ();for _ ,_aegbc :=range _adba {switch _aegbc .Operation {case MopDilation :_abbfa ,_bgdd =_aegbc .getWidthHeight ();_effd ,_gabd =DilateBrick (nil ,_effd ,_abbfa ,_bgdd );
if _gabd !=nil {return nil ,_f .Wrap (_gabd ,_dcfgd ,"");};case MopErosion :_abbfa ,_bgdd =_aegbc .getWidthHeight ();_effd ,_gabd =_ecbd (nil ,_effd ,_abbfa ,_bgdd );if _gabd !=nil {return nil ,_f .Wrap (_gabd ,_dcfgd ,"");};case MopOpening :_abbfa ,_bgdd =_aegbc .getWidthHeight ();
_effd ,_gabd =_fgbdc (nil ,_effd ,_abbfa ,_bgdd );if _gabd !=nil {return nil ,_f .Wrap (_gabd ,_dcfgd ,"");};case MopClosing :_abbfa ,_bgdd =_aegbc .getWidthHeight ();_effd ,_gabd =_bffd (nil ,_effd ,_abbfa ,_bgdd );if _gabd !=nil {return nil ,_f .Wrap (_gabd ,_dcfgd ,"");
};case MopRankBinaryReduction :_effd ,_gabd =_aabf (_effd ,_aegbc .Arguments ...);if _gabd !=nil {return nil ,_f .Wrap (_gabd ,_dcfgd ,"");};case MopReplicativeBinaryExpansion :_effd ,_gabd =_dfbbgb (_effd ,_aegbc .Arguments [0]);if _gabd !=nil {return nil ,_f .Wrap (_gabd ,_dcfgd ,"");
};case MopAddBorder :_cdeb =_aegbc .Arguments [0];_effd ,_gabd =_effd .AddBorder (_cdeb ,0);if _gabd !=nil {return nil ,_f .Wrap (_gabd ,_dcfgd ,"");};default:return nil ,_f .Error (_dcfgd ,"i\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006d\u006fr\u0070\u0068\u004f\u0070\u0065\u0072\u0061ti\u006f\u006e\u0020\u0070r\u006f\u0076\u0069\u0064\u0065\u0064\u0020\u0074\u006f t\u0068\u0065 \u0073\u0065\u0071\u0075\u0065\u006e\u0063\u0065");
};};if _cdeb > 0{_effd ,_gabd =_effd .RemoveBorder (_cdeb );if _gabd !=nil {return nil ,_f .Wrap (_gabd ,_dcfgd ,"\u0062\u006f\u0072\u0064\u0065\u0072\u0020\u003e\u0020\u0030");};};return _effd ,nil ;};func (_acdc *Bitmap )Equals (s *Bitmap )bool {if len (_acdc .Data )!=len (s .Data )||_acdc .Width !=s .Width ||_acdc .Height !=s .Height {return false ;
};for _daa :=0;_daa < _acdc .Height ;_daa ++{_gcbb :=_daa *_acdc .RowStride ;for _gfb :=0;_gfb < _acdc .RowStride ;_gfb ++{if _acdc .Data [_gcbb +_gfb ]!=s .Data [_gcbb +_gfb ]{return false ;};};};return true ;};func _dcde (_edfa *Bitmap ,_cfcc *_ed .Stack ,_bdfdg ,_ggfg ,_dgeg int )(_fcbb *_ab .Rectangle ,_bdgcf error ){const _gfee ="\u0073e\u0065d\u0046\u0069\u006c\u006c\u0053\u0074\u0061\u0063\u006b\u0042\u0042";
if _edfa ==nil {return nil ,_f .Error (_gfee ,"\u0070\u0072\u006fvi\u0064\u0065\u0064\u0020\u006e\u0069\u006c\u0020\u0027\u0073\u0027\u0020\u0042\u0069\u0074\u006d\u0061\u0070");};if _cfcc ==nil {return nil ,_f .Error (_gfee ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0027\u0073\u0074ac\u006b\u0027");
};switch _dgeg {case 4:if _fcbb ,_bdgcf =_ecac (_edfa ,_cfcc ,_bdfdg ,_ggfg );_bdgcf !=nil {return nil ,_f .Wrap (_bdgcf ,_gfee ,"");};return _fcbb ,nil ;case 8:if _fcbb ,_bdgcf =_eggdc (_edfa ,_cfcc ,_bdfdg ,_ggfg );_bdgcf !=nil {return nil ,_f .Wrap (_bdgcf ,_gfee ,"");
};return _fcbb ,nil ;default:return nil ,_f .Errorf (_gfee ,"\u0063\u006f\u006e\u006e\u0065\u0063\u0074\u0069\u0076\u0069\u0074\u0079\u0020\u0069\u0073 \u006eo\u0074\u0020\u0034\u0020\u006f\u0072\u0020\u0038\u003a\u0020\u0027\u0025\u0064\u0027",_dgeg );
};};type BoundaryCondition int ;func _egbbc (_bfab ,_feca ,_acbeg byte )byte {return (_bfab &^(_acbeg ))|(_feca &_acbeg )};func _ecbd (_fcgf ,_gcgda *Bitmap ,_cdac ,_bdcd int )(*Bitmap ,error ){const _dacf ="\u0065\u0072\u006f\u0064\u0065\u0042\u0072\u0069\u0063\u006b";
if _gcgda ==nil {return nil ,_f .Error (_dacf ,"\u0073o\u0075r\u0063\u0065\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");};if _cdac < 1||_bdcd < 1{return nil ,_f .Error (_dacf ,"\u0068\u0073\u0069\u007a\u0065\u0020\u0061\u006e\u0064\u0020\u0076\u0073\u0069\u007a\u0065\u0020\u0061\u0072e\u0020\u006e\u006f\u0074\u0020\u0067\u0072e\u0061\u0074\u0065\u0072\u0020\u0074\u0068\u0061\u006e\u0020\u006fr\u0020\u0065\u0071\u0075\u0061\u006c\u0020\u0074\u006f\u0020\u0031");
};if _cdac ==1&&_bdcd ==1{_cccf ,_eefab :=_bee (_fcgf ,_gcgda );if _eefab !=nil {return nil ,_f .Wrap (_eefab ,_dacf ,"\u0068S\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u0026\u0026 \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");
};return _cccf ,nil ;};if _cdac ==1||_bdcd ==1{_cccagb :=SelCreateBrick (_bdcd ,_cdac ,_bdcd /2,_cdac /2,SelHit );_gffa ,_cacd :=_acaab (_fcgf ,_gcgda ,_cccagb );if _cacd !=nil {return nil ,_f .Wrap (_cacd ,_dacf ,"\u0068S\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u007c\u007c \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");
};return _gffa ,nil ;};_deea :=SelCreateBrick (1,_cdac ,0,_cdac /2,SelHit );_ada :=SelCreateBrick (_bdcd ,1,_bdcd /2,0,SelHit );_gcad ,_cfc :=_acaab (nil ,_gcgda ,_deea );if _cfc !=nil {return nil ,_f .Wrap (_cfc ,_dacf ,"\u0031s\u0074\u0020\u0065\u0072\u006f\u0064e");
};_fcgf ,_cfc =_acaab (_fcgf ,_gcad ,_ada );if _cfc !=nil {return nil ,_f .Wrap (_cfc ,_dacf ,"\u0032n\u0064\u0020\u0065\u0072\u006f\u0064e");};return _fcgf ,nil ;};func _ffa ()(_ged [256]uint16 ){for _bfd :=0;_bfd < 256;_bfd ++{if _bfd &0x01!=0{_ged [_bfd ]|=0x3;
};if _bfd &0x02!=0{_ged [_bfd ]|=0xc;};if _bfd &0x04!=0{_ged [_bfd ]|=0x30;};if _bfd &0x08!=0{_ged [_bfd ]|=0xc0;};if _bfd &0x10!=0{_ged [_bfd ]|=0x300;};if _bfd &0x20!=0{_ged [_bfd ]|=0xc00;};if _bfd &0x40!=0{_ged [_bfd ]|=0x3000;};if _bfd &0x80!=0{_ged [_bfd ]|=0xc000;
};};return _ged ;};func _cce (_fbec ,_eafb int )int {if _fbec > _eafb {return _fbec ;};return _eafb ;};func _dedb ()[]int {_gfbc :=make ([]int ,256);_gfbc [0]=0;_gfbc [1]=7;var _dcdd int ;for _dcdd =2;_dcdd < 4;_dcdd ++{_gfbc [_dcdd ]=_gfbc [_dcdd -2]+6;
};for _dcdd =4;_dcdd < 8;_dcdd ++{_gfbc [_dcdd ]=_gfbc [_dcdd -4]+5;};for _dcdd =8;_dcdd < 16;_dcdd ++{_gfbc [_dcdd ]=_gfbc [_dcdd -8]+4;};for _dcdd =16;_dcdd < 32;_dcdd ++{_gfbc [_dcdd ]=_gfbc [_dcdd -16]+3;};for _dcdd =32;_dcdd < 64;_dcdd ++{_gfbc [_dcdd ]=_gfbc [_dcdd -32]+2;
};for _dcdd =64;_dcdd < 128;_dcdd ++{_gfbc [_dcdd ]=_gfbc [_dcdd -64]+1;};for _dcdd =128;_dcdd < 256;_dcdd ++{_gfbc [_dcdd ]=_gfbc [_dcdd -128];};return _gfbc ;};func _dfcf (_egag *Bitmap ,_gbce *Bitmap ,_gacae int )(_gaddf error ){const _ggcd ="\u0073\u0065\u0065\u0064\u0066\u0069\u006c\u006c\u0042\u0069\u006e\u0061r\u0079\u004c\u006f\u0077";
_cccc :=_gffc (_egag .Height ,_gbce .Height );_cdba :=_gffc (_egag .RowStride ,_gbce .RowStride );switch _gacae {case 4:_gaddf =_ecbb (_egag ,_gbce ,_cccc ,_cdba );case 8:_gaddf =_ceeb (_egag ,_gbce ,_cccc ,_cdba );default:return _f .Errorf (_ggcd ,"\u0063\u006f\u006e\u006e\u0065\u0063\u0074\u0069\u0076\u0069\u0074\u0079\u0020\u006d\u0075\u0073\u0074\u0020\u0062\u0065\u0020\u0034\u0020\u006fr\u0020\u0038\u0020\u002d\u0020i\u0073\u003a \u0027\u0025\u0064\u0027",_gacae );
};if _gaddf !=nil {return _f .Wrap (_gaddf ,_ggcd ,"");};return nil ;};func MorphSequence (src *Bitmap ,sequence ...MorphProcess )(*Bitmap ,error ){return _feabc (src ,sequence ...);};func _eggdc (_cbee *Bitmap ,_gdace *_ed .Stack ,_cbgf ,_adac int )(_deac *_ab .Rectangle ,_aegd error ){const _bfaa ="\u0073e\u0065d\u0046\u0069\u006c\u006c\u0053\u0074\u0061\u0063\u006b\u0042\u0042";
if _cbee ==nil {return nil ,_f .Error (_bfaa ,"\u0070\u0072\u006fvi\u0064\u0065\u0064\u0020\u006e\u0069\u006c\u0020\u0027\u0073\u0027\u0020\u0042\u0069\u0074\u006d\u0061\u0070");};if _gdace ==nil {return nil ,_f .Error (_bfaa ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0027\u0073\u0074ac\u006b\u0027");
};_feega ,_cdfb :=_cbee .Width ,_cbee .Height ;_accg :=_feega -1;_dagdgg :=_cdfb -1;if _cbgf < 0||_cbgf > _accg ||_adac < 0||_adac > _dagdgg ||!_cbee .GetPixel (_cbgf ,_adac ){return nil ,nil ;};_eabbc :=_ab .Rect (100000,100000,0,0);if _aegd =_dedd (_gdace ,_cbgf ,_cbgf ,_adac ,1,_dagdgg ,&_eabbc );
_aegd !=nil {return nil ,_f .Wrap (_aegd ,_bfaa ,"\u0069\u006e\u0069t\u0069\u0061\u006c\u0020\u0070\u0075\u0073\u0068");};if _aegd =_dedd (_gdace ,_cbgf ,_cbgf ,_adac +1,-1,_dagdgg ,&_eabbc );_aegd !=nil {return nil ,_f .Wrap (_aegd ,_bfaa ,"\u0032\u006ed\u0020\u0069\u006ei\u0074\u0069\u0061\u006c\u0020\u0070\u0075\u0073\u0068");
};_eabbc .Min .X ,_eabbc .Max .X =_cbgf ,_cbgf ;_eabbc .Min .Y ,_eabbc .Max .Y =_adac ,_adac ;var (_fdgd *fillSegment ;_cceb int ;);for _gdace .Len ()> 0{if _fdgd ,_aegd =_bfaeg (_gdace );_aegd !=nil {return nil ,_f .Wrap (_aegd ,_bfaa ,"");};_adac =_fdgd ._babe ;
for _cbgf =_fdgd ._aggb -1;_cbgf >=0&&_cbee .GetPixel (_cbgf ,_adac );_cbgf --{if _aegd =_cbee .SetPixel (_cbgf ,_adac ,0);_aegd !=nil {return nil ,_f .Wrap (_aegd ,_bfaa ,"\u0031s\u0074\u0020\u0073\u0065\u0074");};};if _cbgf >=_fdgd ._aggb -1{for {for _cbgf ++;
_cbgf <=_fdgd ._dabbg +1&&_cbgf <=_accg &&!_cbee .GetPixel (_cbgf ,_adac );_cbgf ++{};_cceb =_cbgf ;if _cbgf > _fdgd ._dabbg +1||_cbgf > _accg {break ;};for ;_cbgf <=_accg &&_cbee .GetPixel (_cbgf ,_adac );_cbgf ++{if _aegd =_cbee .SetPixel (_cbgf ,_adac ,0);
_aegd !=nil {return nil ,_f .Wrap (_aegd ,_bfaa ,"\u0032n\u0064\u0020\u0073\u0065\u0074");};};if _aegd =_dedd (_gdace ,_cceb ,_cbgf -1,_fdgd ._babe ,_fdgd ._dfabe ,_dagdgg ,&_eabbc );_aegd !=nil {return nil ,_f .Wrap (_aegd ,_bfaa ,"n\u006f\u0072\u006d\u0061\u006c\u0020\u0070\u0075\u0073\u0068");
};if _cbgf > _fdgd ._dabbg {if _aegd =_dedd (_gdace ,_fdgd ._dabbg +1,_cbgf -1,_fdgd ._babe ,-_fdgd ._dfabe ,_dagdgg ,&_eabbc );_aegd !=nil {return nil ,_f .Wrap (_aegd ,_bfaa ,"\u006ce\u0061k\u0020\u006f\u006e\u0020\u0072i\u0067\u0068t\u0020\u0073\u0069\u0064\u0065");
};};};continue ;};_cceb =_cbgf +1;if _cceb < _fdgd ._aggb {if _aegd =_dedd (_gdace ,_cceb ,_fdgd ._aggb -1,_fdgd ._babe ,-_fdgd ._dfabe ,_dagdgg ,&_eabbc );_aegd !=nil {return nil ,_f .Wrap (_aegd ,_bfaa ,"\u006c\u0065\u0061\u006b\u0020\u006f\u006e\u0020\u006c\u0065\u0066\u0074 \u0073\u0069\u0064\u0065");
};};_cbgf =_fdgd ._aggb ;for {for ;_cbgf <=_accg &&_cbee .GetPixel (_cbgf ,_adac );_cbgf ++{if _aegd =_cbee .SetPixel (_cbgf ,_adac ,0);_aegd !=nil {return nil ,_f .Wrap (_aegd ,_bfaa ,"\u0032n\u0064\u0020\u0073\u0065\u0074");};};if _aegd =_dedd (_gdace ,_cceb ,_cbgf -1,_fdgd ._babe ,_fdgd ._dfabe ,_dagdgg ,&_eabbc );
_aegd !=nil {return nil ,_f .Wrap (_aegd ,_bfaa ,"n\u006f\u0072\u006d\u0061\u006c\u0020\u0070\u0075\u0073\u0068");};if _cbgf > _fdgd ._dabbg {if _aegd =_dedd (_gdace ,_fdgd ._dabbg +1,_cbgf -1,_fdgd ._babe ,-_fdgd ._dfabe ,_dagdgg ,&_eabbc );_aegd !=nil {return nil ,_f .Wrap (_aegd ,_bfaa ,"\u006ce\u0061k\u0020\u006f\u006e\u0020\u0072i\u0067\u0068t\u0020\u0073\u0069\u0064\u0065");
};};for _cbgf ++;_cbgf <=_fdgd ._dabbg +1&&_cbgf <=_accg &&!_cbee .GetPixel (_cbgf ,_adac );_cbgf ++{};_cceb =_cbgf ;if _cbgf > _fdgd ._dabbg +1||_cbgf > _accg {break ;};};};_eabbc .Max .X ++;_eabbc .Max .Y ++;return &_eabbc ,nil ;};func MakePixelSumTab8 ()[]int {return _ddab ()};
func _gacfa (_eafca *Bitmap ,_gadc ,_egdc ,_eccd ,_bgab int ,_bbeef RasterOperator ,_adag *Bitmap ,_gaeb ,_bdac int )error {var (_ggde bool ;_dagdb bool ;_dbffc byte ;_gbgf int ;_gcdae int ;_bafb int ;_fefb int ;_cfef bool ;_aedc int ;_fabcf int ;_dbab int ;
_cddb bool ;_efgd byte ;_bdcaf int ;_afdf int ;_gcdb int ;_bbdb byte ;_fcaab int ;_dcge int ;_agfa uint ;_bfeb uint ;_cgfg byte ;_fcgfg shift ;_befdb bool ;_gdeb bool ;_ecca ,_fefc int ;);if _gaeb &7!=0{_dcge =8-(_gaeb &7);};if _gadc &7!=0{_gcdae =8-(_gadc &7);
};if _dcge ==0&&_gcdae ==0{_cgfg =_dgeaa [0];}else {if _gcdae > _dcge {_agfa =uint (_gcdae -_dcge );}else {_agfa =uint (8-(_dcge -_gcdae ));};_bfeb =8-_agfa ;_cgfg =_dgeaa [_agfa ];};if (_gadc &7)!=0{_ggde =true ;_gbgf =8-(_gadc &7);_dbffc =_dgeaa [_gbgf ];
_bafb =_eafca .RowStride *_egdc +(_gadc >>3);_fefb =_adag .RowStride *_bdac +(_gaeb >>3);_fcaab =8-(_gaeb &7);if _gbgf > _fcaab {_fcgfg =_cdeba ;if _eccd >=_dcge {_befdb =true ;};}else {_fcgfg =_efeed ;};};if _eccd < _gbgf {_dagdb =true ;_dbffc &=_abfdd [8-_gbgf +_eccd ];
};if !_dagdb {_aedc =(_eccd -_gbgf )>>3;if _aedc !=0{_cfef =true ;_fabcf =_eafca .RowStride *_egdc +((_gadc +_gcdae )>>3);_dbab =_adag .RowStride *_bdac +((_gaeb +_gcdae )>>3);};};_bdcaf =(_gadc +_eccd )&7;if !_dagdb &&_bdcaf !=0{_cddb =true ;_efgd =_abfdd [_bdcaf ];
_afdf =_eafca .RowStride *_egdc +((_gadc +_gcdae )>>3)+_aedc ;_gcdb =_adag .RowStride *_bdac +((_gaeb +_gcdae )>>3)+_aedc ;if _bdcaf > int (_bfeb ){_gdeb =true ;};};switch _bbeef {case PixSrc :if _ggde {for _ecca =0;_ecca < _bgab ;_ecca ++{if _fcgfg ==_cdeba {_bbdb =_adag .Data [_fefb ]<<_agfa ;
if _befdb {_bbdb =_egbbc (_bbdb ,_adag .Data [_fefb +1]>>_bfeb ,_cgfg );};}else {_bbdb =_adag .Data [_fefb ]>>_bfeb ;};_eafca .Data [_bafb ]=_egbbc (_eafca .Data [_bafb ],_bbdb ,_dbffc );_bafb +=_eafca .RowStride ;_fefb +=_adag .RowStride ;};};if _cfef {for _ecca =0;
_ecca < _bgab ;_ecca ++{for _fefc =0;_fefc < _aedc ;_fefc ++{_bbdb =_egbbc (_adag .Data [_dbab +_fefc ]<<_agfa ,_adag .Data [_dbab +_fefc +1]>>_bfeb ,_cgfg );_eafca .Data [_fabcf +_fefc ]=_bbdb ;};_fabcf +=_eafca .RowStride ;_dbab +=_adag .RowStride ;};
};if _cddb {for _ecca =0;_ecca < _bgab ;_ecca ++{_bbdb =_adag .Data [_gcdb ]<<_agfa ;if _gdeb {_bbdb =_egbbc (_bbdb ,_adag .Data [_gcdb +1]>>_bfeb ,_cgfg );};_eafca .Data [_afdf ]=_egbbc (_eafca .Data [_afdf ],_bbdb ,_efgd );_afdf +=_eafca .RowStride ;
_gcdb +=_adag .RowStride ;};};case PixNotSrc :if _ggde {for _ecca =0;_ecca < _bgab ;_ecca ++{if _fcgfg ==_cdeba {_bbdb =_adag .Data [_fefb ]<<_agfa ;if _befdb {_bbdb =_egbbc (_bbdb ,_adag .Data [_fefb +1]>>_bfeb ,_cgfg );};}else {_bbdb =_adag .Data [_fefb ]>>_bfeb ;
};_eafca .Data [_bafb ]=_egbbc (_eafca .Data [_bafb ],^_bbdb ,_dbffc );_bafb +=_eafca .RowStride ;_fefb +=_adag .RowStride ;};};if _cfef {for _ecca =0;_ecca < _bgab ;_ecca ++{for _fefc =0;_fefc < _aedc ;_fefc ++{_bbdb =_egbbc (_adag .Data [_dbab +_fefc ]<<_agfa ,_adag .Data [_dbab +_fefc +1]>>_bfeb ,_cgfg );
_eafca .Data [_fabcf +_fefc ]=^_bbdb ;};_fabcf +=_eafca .RowStride ;_dbab +=_adag .RowStride ;};};if _cddb {for _ecca =0;_ecca < _bgab ;_ecca ++{_bbdb =_adag .Data [_gcdb ]<<_agfa ;if _gdeb {_bbdb =_egbbc (_bbdb ,_adag .Data [_gcdb +1]>>_bfeb ,_cgfg );
};_eafca .Data [_afdf ]=_egbbc (_eafca .Data [_afdf ],^_bbdb ,_efgd );_afdf +=_eafca .RowStride ;_gcdb +=_adag .RowStride ;};};case PixSrcOrDst :if _ggde {for _ecca =0;_ecca < _bgab ;_ecca ++{if _fcgfg ==_cdeba {_bbdb =_adag .Data [_fefb ]<<_agfa ;if _befdb {_bbdb =_egbbc (_bbdb ,_adag .Data [_fefb +1]>>_bfeb ,_cgfg );
};}else {_bbdb =_adag .Data [_fefb ]>>_bfeb ;};_eafca .Data [_bafb ]=_egbbc (_eafca .Data [_bafb ],_bbdb |_eafca .Data [_bafb ],_dbffc );_bafb +=_eafca .RowStride ;_fefb +=_adag .RowStride ;};};if _cfef {for _ecca =0;_ecca < _bgab ;_ecca ++{for _fefc =0;
_fefc < _aedc ;_fefc ++{_bbdb =_egbbc (_adag .Data [_dbab +_fefc ]<<_agfa ,_adag .Data [_dbab +_fefc +1]>>_bfeb ,_cgfg );_eafca .Data [_fabcf +_fefc ]|=_bbdb ;};_fabcf +=_eafca .RowStride ;_dbab +=_adag .RowStride ;};};if _cddb {for _ecca =0;_ecca < _bgab ;
_ecca ++{_bbdb =_adag .Data [_gcdb ]<<_agfa ;if _gdeb {_bbdb =_egbbc (_bbdb ,_adag .Data [_gcdb +1]>>_bfeb ,_cgfg );};_eafca .Data [_afdf ]=_egbbc (_eafca .Data [_afdf ],_bbdb |_eafca .Data [_afdf ],_efgd );_afdf +=_eafca .RowStride ;_gcdb +=_adag .RowStride ;
};};case PixSrcAndDst :if _ggde {for _ecca =0;_ecca < _bgab ;_ecca ++{if _fcgfg ==_cdeba {_bbdb =_adag .Data [_fefb ]<<_agfa ;if _befdb {_bbdb =_egbbc (_bbdb ,_adag .Data [_fefb +1]>>_bfeb ,_cgfg );};}else {_bbdb =_adag .Data [_fefb ]>>_bfeb ;};_eafca .Data [_bafb ]=_egbbc (_eafca .Data [_bafb ],_bbdb &_eafca .Data [_bafb ],_dbffc );
_bafb +=_eafca .RowStride ;_fefb +=_adag .RowStride ;};};if _cfef {for _ecca =0;_ecca < _bgab ;_ecca ++{for _fefc =0;_fefc < _aedc ;_fefc ++{_bbdb =_egbbc (_adag .Data [_dbab +_fefc ]<<_agfa ,_adag .Data [_dbab +_fefc +1]>>_bfeb ,_cgfg );_eafca .Data [_fabcf +_fefc ]&=_bbdb ;
};_fabcf +=_eafca .RowStride ;_dbab +=_adag .RowStride ;};};if _cddb {for _ecca =0;_ecca < _bgab ;_ecca ++{_bbdb =_adag .Data [_gcdb ]<<_agfa ;if _gdeb {_bbdb =_egbbc (_bbdb ,_adag .Data [_gcdb +1]>>_bfeb ,_cgfg );};_eafca .Data [_afdf ]=_egbbc (_eafca .Data [_afdf ],_bbdb &_eafca .Data [_afdf ],_efgd );
_afdf +=_eafca .RowStride ;_gcdb +=_adag .RowStride ;};};case PixSrcXorDst :if _ggde {for _ecca =0;_ecca < _bgab ;_ecca ++{if _fcgfg ==_cdeba {_bbdb =_adag .Data [_fefb ]<<_agfa ;if _befdb {_bbdb =_egbbc (_bbdb ,_adag .Data [_fefb +1]>>_bfeb ,_cgfg );};
}else {_bbdb =_adag .Data [_fefb ]>>_bfeb ;};_eafca .Data [_bafb ]=_egbbc (_eafca .Data [_bafb ],_bbdb ^_eafca .Data [_bafb ],_dbffc );_bafb +=_eafca .RowStride ;_fefb +=_adag .RowStride ;};};if _cfef {for _ecca =0;_ecca < _bgab ;_ecca ++{for _fefc =0;
_fefc < _aedc ;_fefc ++{_bbdb =_egbbc (_adag .Data [_dbab +_fefc ]<<_agfa ,_adag .Data [_dbab +_fefc +1]>>_bfeb ,_cgfg );_eafca .Data [_fabcf +_fefc ]^=_bbdb ;};_fabcf +=_eafca .RowStride ;_dbab +=_adag .RowStride ;};};if _cddb {for _ecca =0;_ecca < _bgab ;
_ecca ++{_bbdb =_adag .Data [_gcdb ]<<_agfa ;if _gdeb {_bbdb =_egbbc (_bbdb ,_adag .Data [_gcdb +1]>>_bfeb ,_cgfg );};_eafca .Data [_afdf ]=_egbbc (_eafca .Data [_afdf ],_bbdb ^_eafca .Data [_afdf ],_efgd );_afdf +=_eafca .RowStride ;_gcdb +=_adag .RowStride ;
};};case PixNotSrcOrDst :if _ggde {for _ecca =0;_ecca < _bgab ;_ecca ++{if _fcgfg ==_cdeba {_bbdb =_adag .Data [_fefb ]<<_agfa ;if _befdb {_bbdb =_egbbc (_bbdb ,_adag .Data [_fefb +1]>>_bfeb ,_cgfg );};}else {_bbdb =_adag .Data [_fefb ]>>_bfeb ;};_eafca .Data [_bafb ]=_egbbc (_eafca .Data [_bafb ],^_bbdb |_eafca .Data [_bafb ],_dbffc );
_bafb +=_eafca .RowStride ;_fefb +=_adag .RowStride ;};};if _cfef {for _ecca =0;_ecca < _bgab ;_ecca ++{for _fefc =0;_fefc < _aedc ;_fefc ++{_bbdb =_egbbc (_adag .Data [_dbab +_fefc ]<<_agfa ,_adag .Data [_dbab +_fefc +1]>>_bfeb ,_cgfg );_eafca .Data [_fabcf +_fefc ]|=^_bbdb ;
};_fabcf +=_eafca .RowStride ;_dbab +=_adag .RowStride ;};};if _cddb {for _ecca =0;_ecca < _bgab ;_ecca ++{_bbdb =_adag .Data [_gcdb ]<<_agfa ;if _gdeb {_bbdb =_egbbc (_bbdb ,_adag .Data [_gcdb +1]>>_bfeb ,_cgfg );};_eafca .Data [_afdf ]=_egbbc (_eafca .Data [_afdf ],^_bbdb |_eafca .Data [_afdf ],_efgd );
_afdf +=_eafca .RowStride ;_gcdb +=_adag .RowStride ;};};case PixNotSrcAndDst :if _ggde {for _ecca =0;_ecca < _bgab ;_ecca ++{if _fcgfg ==_cdeba {_bbdb =_adag .Data [_fefb ]<<_agfa ;if _befdb {_bbdb =_egbbc (_bbdb ,_adag .Data [_fefb +1]>>_bfeb ,_cgfg );
};}else {_bbdb =_adag .Data [_fefb ]>>_bfeb ;};_eafca .Data [_bafb ]=_egbbc (_eafca .Data [_bafb ],^_bbdb &_eafca .Data [_bafb ],_dbffc );_bafb +=_eafca .RowStride ;_fefb +=_adag .RowStride ;};};if _cfef {for _ecca =0;_ecca < _bgab ;_ecca ++{for _fefc =0;
_fefc < _aedc ;_fefc ++{_bbdb =_egbbc (_adag .Data [_dbab +_fefc ]<<_agfa ,_adag .Data [_dbab +_fefc +1]>>_bfeb ,_cgfg );_eafca .Data [_fabcf +_fefc ]&=^_bbdb ;};_fabcf +=_eafca .RowStride ;_dbab +=_adag .RowStride ;};};if _cddb {for _ecca =0;_ecca < _bgab ;
_ecca ++{_bbdb =_adag .Data [_gcdb ]<<_agfa ;if _gdeb {_bbdb =_egbbc (_bbdb ,_adag .Data [_gcdb +1]>>_bfeb ,_cgfg );};_eafca .Data [_afdf ]=_egbbc (_eafca .Data [_afdf ],^_bbdb &_eafca .Data [_afdf ],_efgd );_afdf +=_eafca .RowStride ;_gcdb +=_adag .RowStride ;
};};case PixSrcOrNotDst :if _ggde {for _ecca =0;_ecca < _bgab ;_ecca ++{if _fcgfg ==_cdeba {_bbdb =_adag .Data [_fefb ]<<_agfa ;if _befdb {_bbdb =_egbbc (_bbdb ,_adag .Data [_fefb +1]>>_bfeb ,_cgfg );};}else {_bbdb =_adag .Data [_fefb ]>>_bfeb ;};_eafca .Data [_bafb ]=_egbbc (_eafca .Data [_bafb ],_bbdb |^_eafca .Data [_bafb ],_dbffc );
_bafb +=_eafca .RowStride ;_fefb +=_adag .RowStride ;};};if _cfef {for _ecca =0;_ecca < _bgab ;_ecca ++{for _fefc =0;_fefc < _aedc ;_fefc ++{_bbdb =_egbbc (_adag .Data [_dbab +_fefc ]<<_agfa ,_adag .Data [_dbab +_fefc +1]>>_bfeb ,_cgfg );_eafca .Data [_fabcf +_fefc ]=_bbdb |^_eafca .Data [_fabcf +_fefc ];
};_fabcf +=_eafca .RowStride ;_dbab +=_adag .RowStride ;};};if _cddb {for _ecca =0;_ecca < _bgab ;_ecca ++{_bbdb =_adag .Data [_gcdb ]<<_agfa ;if _gdeb {_bbdb =_egbbc (_bbdb ,_adag .Data [_gcdb +1]>>_bfeb ,_cgfg );};_eafca .Data [_afdf ]=_egbbc (_eafca .Data [_afdf ],_bbdb |^_eafca .Data [_afdf ],_efgd );
_afdf +=_eafca .RowStride ;_gcdb +=_adag .RowStride ;};};case PixSrcAndNotDst :if _ggde {for _ecca =0;_ecca < _bgab ;_ecca ++{if _fcgfg ==_cdeba {_bbdb =_adag .Data [_fefb ]<<_agfa ;if _befdb {_bbdb =_egbbc (_bbdb ,_adag .Data [_fefb +1]>>_bfeb ,_cgfg );
};}else {_bbdb =_adag .Data [_fefb ]>>_bfeb ;};_eafca .Data [_bafb ]=_egbbc (_eafca .Data [_bafb ],_bbdb &^_eafca .Data [_bafb ],_dbffc );_bafb +=_eafca .RowStride ;_fefb +=_adag .RowStride ;};};if _cfef {for _ecca =0;_ecca < _bgab ;_ecca ++{for _fefc =0;
_fefc < _aedc ;_fefc ++{_bbdb =_egbbc (_adag .Data [_dbab +_fefc ]<<_agfa ,_adag .Data [_dbab +_fefc +1]>>_bfeb ,_cgfg );_eafca .Data [_fabcf +_fefc ]=_bbdb &^_eafca .Data [_fabcf +_fefc ];};_fabcf +=_eafca .RowStride ;_dbab +=_adag .RowStride ;};};if _cddb {for _ecca =0;
_ecca < _bgab ;_ecca ++{_bbdb =_adag .Data [_gcdb ]<<_agfa ;if _gdeb {_bbdb =_egbbc (_bbdb ,_adag .Data [_gcdb +1]>>_bfeb ,_cgfg );};_eafca .Data [_afdf ]=_egbbc (_eafca .Data [_afdf ],_bbdb &^_eafca .Data [_afdf ],_efgd );_afdf +=_eafca .RowStride ;_gcdb +=_adag .RowStride ;
};};case PixNotPixSrcOrDst :if _ggde {for _ecca =0;_ecca < _bgab ;_ecca ++{if _fcgfg ==_cdeba {_bbdb =_adag .Data [_fefb ]<<_agfa ;if _befdb {_bbdb =_egbbc (_bbdb ,_adag .Data [_fefb +1]>>_bfeb ,_cgfg );};}else {_bbdb =_adag .Data [_fefb ]>>_bfeb ;};_eafca .Data [_bafb ]=_egbbc (_eafca .Data [_bafb ],^(_bbdb |_eafca .Data [_bafb ]),_dbffc );
_bafb +=_eafca .RowStride ;_fefb +=_adag .RowStride ;};};if _cfef {for _ecca =0;_ecca < _bgab ;_ecca ++{for _fefc =0;_fefc < _aedc ;_fefc ++{_bbdb =_egbbc (_adag .Data [_dbab +_fefc ]<<_agfa ,_adag .Data [_dbab +_fefc +1]>>_bfeb ,_cgfg );_eafca .Data [_fabcf +_fefc ]=^(_bbdb |_eafca .Data [_fabcf +_fefc ]);
};_fabcf +=_eafca .RowStride ;_dbab +=_adag .RowStride ;};};if _cddb {for _ecca =0;_ecca < _bgab ;_ecca ++{_bbdb =_adag .Data [_gcdb ]<<_agfa ;if _gdeb {_bbdb =_egbbc (_bbdb ,_adag .Data [_gcdb +1]>>_bfeb ,_cgfg );};_eafca .Data [_afdf ]=_egbbc (_eafca .Data [_afdf ],^(_bbdb |_eafca .Data [_afdf ]),_efgd );
_afdf +=_eafca .RowStride ;_gcdb +=_adag .RowStride ;};};case PixNotPixSrcAndDst :if _ggde {for _ecca =0;_ecca < _bgab ;_ecca ++{if _fcgfg ==_cdeba {_bbdb =_adag .Data [_fefb ]<<_agfa ;if _befdb {_bbdb =_egbbc (_bbdb ,_adag .Data [_fefb +1]>>_bfeb ,_cgfg );
};}else {_bbdb =_adag .Data [_fefb ]>>_bfeb ;};_eafca .Data [_bafb ]=_egbbc (_eafca .Data [_bafb ],^(_bbdb &_eafca .Data [_bafb ]),_dbffc );_bafb +=_eafca .RowStride ;_fefb +=_adag .RowStride ;};};if _cfef {for _ecca =0;_ecca < _bgab ;_ecca ++{for _fefc =0;
_fefc < _aedc ;_fefc ++{_bbdb =_egbbc (_adag .Data [_dbab +_fefc ]<<_agfa ,_adag .Data [_dbab +_fefc +1]>>_bfeb ,_cgfg );_eafca .Data [_fabcf +_fefc ]=^(_bbdb &_eafca .Data [_fabcf +_fefc ]);};_fabcf +=_eafca .RowStride ;_dbab +=_adag .RowStride ;};};if _cddb {for _ecca =0;
_ecca < _bgab ;_ecca ++{_bbdb =_adag .Data [_gcdb ]<<_agfa ;if _gdeb {_bbdb =_egbbc (_bbdb ,_adag .Data [_gcdb +1]>>_bfeb ,_cgfg );};_eafca .Data [_afdf ]=_egbbc (_eafca .Data [_afdf ],^(_bbdb &_eafca .Data [_afdf ]),_efgd );_afdf +=_eafca .RowStride ;
_gcdb +=_adag .RowStride ;};};case PixNotPixSrcXorDst :if _ggde {for _ecca =0;_ecca < _bgab ;_ecca ++{if _fcgfg ==_cdeba {_bbdb =_adag .Data [_fefb ]<<_agfa ;if _befdb {_bbdb =_egbbc (_bbdb ,_adag .Data [_fefb +1]>>_bfeb ,_cgfg );};}else {_bbdb =_adag .Data [_fefb ]>>_bfeb ;
};_eafca .Data [_bafb ]=_egbbc (_eafca .Data [_bafb ],^(_bbdb ^_eafca .Data [_bafb ]),_dbffc );_bafb +=_eafca .RowStride ;_fefb +=_adag .RowStride ;};};if _cfef {for _ecca =0;_ecca < _bgab ;_ecca ++{for _fefc =0;_fefc < _aedc ;_fefc ++{_bbdb =_egbbc (_adag .Data [_dbab +_fefc ]<<_agfa ,_adag .Data [_dbab +_fefc +1]>>_bfeb ,_cgfg );
_eafca .Data [_fabcf +_fefc ]=^(_bbdb ^_eafca .Data [_fabcf +_fefc ]);};_fabcf +=_eafca .RowStride ;_dbab +=_adag .RowStride ;};};if _cddb {for _ecca =0;_ecca < _bgab ;_ecca ++{_bbdb =_adag .Data [_gcdb ]<<_agfa ;if _gdeb {_bbdb =_egbbc (_bbdb ,_adag .Data [_gcdb +1]>>_bfeb ,_cgfg );
};_eafca .Data [_afdf ]=_egbbc (_eafca .Data [_afdf ],^(_bbdb ^_eafca .Data [_afdf ]),_efgd );_afdf +=_eafca .RowStride ;_gcdb +=_adag .RowStride ;};};default:_abc .Log .Debug ("\u004f\u0070e\u0072\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006e\u006f\u0074\u0020\u0070\u0065\u0072\u006d\u0069tt\u0065\u0064",_bbeef );
return _f .Error ("\u0072a\u0073t\u0065\u0072\u004f\u0070\u0047e\u006e\u0065r\u0061\u006c\u004c\u006f\u0077","\u0072\u0061\u0073\u0074\u0065\u0072\u0020\u006f\u0070\u0065r\u0061\u0074\u0069\u006f\u006e\u0020\u006eo\u0074\u0020\u0070\u0065\u0072\u006d\u0069\u0074\u0074\u0065\u0064");
};return nil ;};func _dabb (_afcg ,_dgbd *Bitmap ,_cgfd ,_degb ,_dgdd uint ,_acgg ,_eedc int ,_efec bool ,_afab ,_cdda int )error {for _ebdg :=_acgg ;_ebdg < _eedc ;_ebdg ++{if _afab +1< len (_afcg .Data ){_ecfa :=_ebdg +1==_eedc ;_ebab ,_abad :=_afcg .GetByte (_afab );
if _abad !=nil {return _abad ;};_afab ++;_ebab <<=_cgfd ;_acda ,_abad :=_afcg .GetByte (_afab );if _abad !=nil {return _abad ;};_acda >>=_degb ;_deff :=_ebab |_acda ;if _ecfa &&!_efec {_deff =_dca (_dgdd ,_deff );};_abad =_dgbd .SetByte (_cdda ,_deff );
if _abad !=nil {return _abad ;};_cdda ++;if _ecfa &&_efec {_cfeg ,_agaf :=_afcg .GetByte (_afab );if _agaf !=nil {return _agaf ;};_cfeg <<=_cgfd ;_deff =_dca (_dgdd ,_cfeg );if _agaf =_dgbd .SetByte (_cdda ,_deff );_agaf !=nil {return _agaf ;};};continue ;
};_dgdda ,_ebed :=_afcg .GetByte (_afab );if _ebed !=nil {_abc .Log .Debug ("G\u0065\u0074\u0074\u0069\u006e\u0067 \u0074\u0068\u0065\u0020\u0076\u0061l\u0075\u0065\u0020\u0061\u0074\u003a\u0020%\u0064\u0020\u0066\u0061\u0069\u006c\u0065\u0064\u003a\u0020%\u0073",_afab ,_ebed );
return _ebed ;};_dgdda <<=_cgfd ;_afab ++;_ebed =_dgbd .SetByte (_cdda ,_dgdda );if _ebed !=nil {return _ebed ;};_cdda ++;};return nil ;};func (_adae *byHeight )Len ()int {return len (_adae .Values )};func TstOSymbol (t *_c .T ,scale ...int )*Bitmap {_bcgec ,_ebgca :=NewWithData (4,5,[]byte {0xF0,0x90,0x90,0x90,0xF0});
_d .NoError (t ,_ebgca );return TstGetScaledSymbol (t ,_bcgec ,scale ...);};func Extract (roi _ab .Rectangle ,src *Bitmap )(*Bitmap ,error ){_ebbd :=New (roi .Dx (),roi .Dy ());_cgfa :=roi .Min .X &0x07;_eeecb :=8-_cgfa ;_ddcc :=uint (8-_ebbd .Width &0x07);
_ddbf :=src .GetByteIndex (roi .Min .X ,roi .Min .Y );_bbdg :=src .GetByteIndex (roi .Max .X -1,roi .Min .Y );_gbf :=_ebbd .RowStride ==_bbdg +1-_ddbf ;var _bae int ;for _gcfa :=roi .Min .Y ;_gcfa < roi .Max .Y ;_gcfa ++{_efbaa :=_ddbf ;_eaeb :=_bae ;switch {case _ddbf ==_bbdg :_fcce ,_eacb :=src .GetByte (_efbaa );
if _eacb !=nil {return nil ,_eacb ;};_fcce <<=uint (_cgfa );_eacb =_ebbd .SetByte (_eaeb ,_dca (_ddcc ,_fcce ));if _eacb !=nil {return nil ,_eacb ;};case _cgfa ==0:for _fbf :=_ddbf ;_fbf <=_bbdg ;_fbf ++{_dddf ,_aaaa :=src .GetByte (_efbaa );if _aaaa !=nil {return nil ,_aaaa ;
};_efbaa ++;if _fbf ==_bbdg &&_gbf {_dddf =_dca (_ddcc ,_dddf );};_aaaa =_ebbd .SetByte (_eaeb ,_dddf );if _aaaa !=nil {return nil ,_aaaa ;};_eaeb ++;};default:_ceedc :=_dabb (src ,_ebbd ,uint (_cgfa ),uint (_eeecb ),_ddcc ,_ddbf ,_bbdg ,_gbf ,_efbaa ,_eaeb );
if _ceedc !=nil {return nil ,_ceedc ;};};_ddbf +=src .RowStride ;_bbdg +=src .RowStride ;_bae +=_ebbd .RowStride ;};return _ebbd ,nil ;};func (_afg *Bitmap )addBorderGeneral (_bdb ,_fac ,_cefb ,_ffba int ,_bdc int )(*Bitmap ,error ){const _ffef ="\u0061\u0064d\u0042\u006f\u0072d\u0065\u0072\u0047\u0065\u006e\u0065\u0072\u0061\u006c";
if _bdb < 0||_fac < 0||_cefb < 0||_ffba < 0{return nil ,_f .Error (_ffef ,"n\u0065\u0067\u0061\u0074iv\u0065 \u0062\u006f\u0072\u0064\u0065r\u0020\u0061\u0064\u0064\u0065\u0064");};_edd ,_gge :=_afg .Width ,_afg .Height ;_afe :=_edd +_bdb +_fac ;_aaf :=_gge +_cefb +_ffba ;
_eba :=New (_afe ,_aaf );_eba .Color =_afg .Color ;_gcg :=PixClr ;if _bdc > 0{_gcg =PixSet ;};_aed :=_eba .RasterOperation (0,0,_bdb ,_aaf ,_gcg ,nil ,0,0);if _aed !=nil {return nil ,_f .Wrap (_aed ,_ffef ,"\u006c\u0065\u0066\u0074");};_aed =_eba .RasterOperation (_afe -_fac ,0,_fac ,_aaf ,_gcg ,nil ,0,0);
if _aed !=nil {return nil ,_f .Wrap (_aed ,_ffef ,"\u0072\u0069\u0067h\u0074");};_aed =_eba .RasterOperation (0,0,_afe ,_cefb ,_gcg ,nil ,0,0);if _aed !=nil {return nil ,_f .Wrap (_aed ,_ffef ,"\u0074\u006f\u0070");};_aed =_eba .RasterOperation (0,_aaf -_ffba ,_afe ,_ffba ,_gcg ,nil ,0,0);
if _aed !=nil {return nil ,_f .Wrap (_aed ,_ffef ,"\u0062\u006f\u0074\u0074\u006f\u006d");};_aed =_eba .RasterOperation (_bdb ,_cefb ,_edd ,_gge ,PixSrc ,_afg ,0,0);if _aed !=nil {return nil ,_f .Wrap (_aed ,_ffef ,"\u0063\u006f\u0070\u0079");};return _eba ,nil ;
};func (_cec *Bitmap )InverseData (){_cec .inverseData ()};func (_eaagee *ClassedPoints )GetIntYByClass (i int )(int ,error ){const _afcbd ="\u0043\u006c\u0061\u0073s\u0065\u0064\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047e\u0074I\u006e\u0074\u0059\u0042\u0079\u0043\u006ca\u0073\u0073";
if i >=_eaagee .IntSlice .Size (){return 0,_f .Errorf (_afcbd ,"\u0069\u003a\u0020\u0027\u0025\u0064\u0027 \u0069\u0073\u0020o\u0075\u0074\u0020\u006ff\u0020\u0074\u0068\u0065\u0020\u0072\u0061\u006e\u0067\u0065\u0020\u006f\u0066\u0020\u0074\u0068\u0065\u0020\u0049\u006e\u0074\u0053\u006c\u0069\u0063\u0065",i );
};return int (_eaagee .YAtIndex (i )),nil ;};func (_eegb *Bitmaps )String ()string {_geec :=_e .Builder {};for _ ,_fefce :=range _eegb .Values {_geec .WriteString (_fefce .String ());_geec .WriteRune ('\n');};return _geec .String ();};func TstPSymbol (t *_c .T )*Bitmap {t .Helper ();
_efdb :=New (5,8);_d .NoError (t ,_efdb .SetPixel (0,0,1));_d .NoError (t ,_efdb .SetPixel (1,0,1));_d .NoError (t ,_efdb .SetPixel (2,0,1));_d .NoError (t ,_efdb .SetPixel (3,0,1));_d .NoError (t ,_efdb .SetPixel (4,1,1));_d .NoError (t ,_efdb .SetPixel (0,1,1));
_d .NoError (t ,_efdb .SetPixel (4,2,1));_d .NoError (t ,_efdb .SetPixel (0,2,1));_d .NoError (t ,_efdb .SetPixel (4,3,1));_d .NoError (t ,_efdb .SetPixel (0,3,1));_d .NoError (t ,_efdb .SetPixel (0,4,1));_d .NoError (t ,_efdb .SetPixel (1,4,1));_d .NoError (t ,_efdb .SetPixel (2,4,1));
_d .NoError (t ,_efdb .SetPixel (3,4,1));_d .NoError (t ,_efdb .SetPixel (0,5,1));_d .NoError (t ,_efdb .SetPixel (0,6,1));_d .NoError (t ,_efdb .SetPixel (0,7,1));return _efdb ;};func SelCreateBrick (h ,w int ,cy ,cx int ,tp SelectionValue )*Selection {_gbff :=_cfege (h ,w ,"");
_gbff .setOrigin (cy ,cx );var _gdgc ,_gcdeb int ;for _gdgc =0;_gdgc < h ;_gdgc ++{for _gcdeb =0;_gcdeb < w ;_gcdeb ++{_gbff .Data [_gdgc ][_gcdeb ]=tp ;};};return _gbff ;};func _gffc (_afa ,_bgff int )int {if _afa < _bgff {return _afa ;};return _bgff ;
};func (_agc *Bitmap )SetByte (index int ,v byte )error {if index > len (_agc .Data )-1||index < 0{return _f .Errorf ("\u0053e\u0074\u0042\u0079\u0074\u0065","\u0069\u006e\u0064\u0065x \u006f\u0075\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065\u003a\u0020%\u0064",index );
};_agc .Data [index ]=v ;return nil ;};type ClassedPoints struct{*Points ;_ed .IntSlice ;_gebc func (_eddd ,_ccee int )bool ;};var _ _dc .Interface =&ClassedPoints {};func (_deae *Bitmaps )HeightSorter ()func (_ffbf ,_bddc int )bool {return func (_bbce ,_dcfba int )bool {_aaab :=_deae .Values [_bbce ].Height < _deae .Values [_dcfba ].Height ;
_abc .Log .Debug ("H\u0065i\u0067\u0068\u0074\u003a\u0020\u0025\u0076\u0020<\u0020\u0025\u0076\u0020= \u0025\u0076",_deae .Values [_bbce ].Height ,_deae .Values [_dcfba ].Height ,_aaab );return _aaab ;};};func Centroids (bms []*Bitmap )(*Points ,error ){_afdd :=make ([]Point ,len (bms ));
_bdfa :=_dedb ();_eacc :=_ddab ();var _ggef error ;for _eagcb ,_gbba :=range bms {_afdd [_eagcb ],_ggef =_gbba .centroid (_bdfa ,_eacc );if _ggef !=nil {return nil ,_ggef ;};};_bdbe :=Points (_afdd );return &_bdbe ,nil ;};func ClipBoxToRectangle (box *_ab .Rectangle ,wi ,hi int )(_bccd *_ab .Rectangle ,_fgab error ){const _acea ="\u0043l\u0069p\u0042\u006f\u0078\u0054\u006fR\u0065\u0063t\u0061\u006e\u0067\u006c\u0065";
if box ==nil {return nil ,_f .Error (_acea ,"\u0027\u0062\u006f\u0078\u0027\u0020\u006e\u006f\u0074\u0020\u0064\u0065f\u0069\u006e\u0065\u0064");};if box .Min .X >=wi ||box .Min .Y >=hi ||box .Max .X <=0||box .Max .Y <=0{return nil ,_f .Error (_acea ,"\u0027\u0062\u006fx'\u0020\u006f\u0075\u0074\u0073\u0069\u0064\u0065\u0020\u0072\u0065\u0063\u0074\u0061\u006e\u0067\u006c\u0065");
};_fbed :=*box ;_bccd =&_fbed ;if _bccd .Min .X < 0{_bccd .Max .X +=_bccd .Min .X ;_bccd .Min .X =0;};if _bccd .Min .Y < 0{_bccd .Max .Y +=_bccd .Min .Y ;_bccd .Min .Y =0;};if _bccd .Max .X > wi {_bccd .Max .X =wi ;};if _bccd .Max .Y > hi {_bccd .Max .Y =hi ;
};return _bccd ,nil ;};func (_ade *Bitmap )ThresholdPixelSum (thresh int ,tab8 []int )(_dee bool ,_gbd error ){const _ecab ="\u0042i\u0074\u006d\u0061\u0070\u002e\u0054\u0068\u0072\u0065\u0073\u0068o\u006c\u0064\u0050\u0069\u0078\u0065\u006c\u0053\u0075\u006d";
if tab8 ==nil {tab8 =_ddab ();};_fabc :=_ade .Width >>3;_fga :=_ade .Width &7;_cae :=byte (0xff<<uint (8-_fga ));var (_egc ,_aggc ,_gfag ,_bfa int ;_cab byte ;);for _egc =0;_egc < _ade .Height ;_egc ++{_gfag =_ade .RowStride *_egc ;for _aggc =0;_aggc < _fabc ;
_aggc ++{_cab ,_gbd =_ade .GetByte (_gfag +_aggc );if _gbd !=nil {return false ,_f .Wrap (_gbd ,_ecab ,"\u0066\u0075\u006c\u006c\u0042\u0079\u0074\u0065");};_bfa +=tab8 [_cab ];};if _fga !=0{_cab ,_gbd =_ade .GetByte (_gfag +_aggc );if _gbd !=nil {return false ,_f .Wrap (_gbd ,_ecab ,"p\u0061\u0072\u0074\u0069\u0061\u006c\u0042\u0079\u0074\u0065");
};_cab &=_cae ;_bfa +=tab8 [_cab ];};if _bfa > thresh {return true ,nil ;};};return _dee ,nil ;};func _ddab ()[]int {_cadg :=make ([]int ,256);for _afce :=0;_afce <=0xff;_afce ++{_fgga :=byte (_afce );_cadg [_fgga ]=int (_fgga &0x1)+(int (_fgga >>1)&0x1)+(int (_fgga >>2)&0x1)+(int (_fgga >>3)&0x1)+(int (_fgga >>4)&0x1)+(int (_fgga >>5)&0x1)+(int (_fgga >>6)&0x1)+(int (_fgga >>7)&0x1);
};return _cadg ;};func (_fecb *ClassedPoints )ySortFunction ()func (_abbb int ,_ecada int )bool {return func (_gggg ,_befdg int )bool {return _fecb .YAtIndex (_gggg )< _fecb .YAtIndex (_befdg )};};func _aabf (_acge *Bitmap ,_bga ...int )(_gac *Bitmap ,_dcec error ){const _aac ="\u0072\u0065\u0064uc\u0065\u0052\u0061\u006e\u006b\u0042\u0069\u006e\u0061\u0072\u0079\u0043\u0061\u0073\u0063\u0061\u0064\u0065";
if _acge ==nil {return nil ,_f .Error (_aac ,"\u0073o\u0075\u0072\u0063\u0065 \u0062\u0069\u0074\u006d\u0061p\u0020n\u006ft\u0020\u0064\u0065\u0066\u0069\u006e\u0065d");};if len (_bga )==0||len (_bga )> 4{return nil ,_f .Error (_aac ,"t\u0068\u0065\u0072\u0065\u0020\u006d\u0075\u0073\u0074 \u0062\u0065\u0020\u0061\u0074\u0020\u006cea\u0073\u0074\u0020\u006fn\u0065\u0020\u0061\u006e\u0064\u0020\u0061\u0074\u0020mo\u0073\u0074 \u0034\u0020\u006c\u0065\u0076\u0065\u006c\u0073");
};if _bga [0]<=0{_abc .Log .Debug ("\u006c\u0065\u0076\u0065\u006c\u0031\u0020\u003c\u003d\u0020\u0030 \u002d\u0020\u006e\u006f\u0020\u0072\u0065\u0064\u0075\u0063t\u0069\u006f\u006e");_gac ,_dcec =_bee (nil ,_acge );if _dcec !=nil {return nil ,_f .Wrap (_dcec ,_aac ,"l\u0065\u0076\u0065\u006c\u0031\u0020\u003c\u003d\u0020\u0030");
};return _gac ,nil ;};_bgf :=_egg ();_gac =_acge ;for _fgg ,_bdf :=range _bga {if _bdf <=0{break ;};_gac ,_dcec =_dbe (_gac ,_bdf ,_bgf );if _dcec !=nil {return nil ,_f .Wrapf (_dcec ,_aac ,"\u006c\u0065\u0076\u0065\u006c\u0025\u0064\u0020\u0072\u0065\u0064\u0075c\u0074\u0069\u006f\u006e",_fgg );
};};return _gac ,nil ;};const (ComponentConn Component =iota ;ComponentCharacters ;ComponentWords ;);const (Vanilla Color =iota ;Chocolate ;);func (_eece *Bitmap )ToImage ()_ab .Image {_adg ,_bdg :=_cf .NewImage (_eece .Width ,_eece .Height ,1,1,_eece .Data ,nil ,nil );
if _bdg !=nil {_abc .Log .Error ("\u0043\u006f\u006e\u0076\u0065\u0072\u0074\u0069\u006e\u0067\u0020j\u0062\u0069\u0067\u0032\u002e\u0042\u0069\u0074m\u0061p\u0020\u0074\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u0075\u0074\u0069\u006c\u002e\u0049\u006d\u0061\u0067e\u0020\u0066\u0061\u0069\u006c\u0065\u0064\u003a\u0020\u0025\u0076",_bdg );
};return _adg ;};func (_eceg *Bitmaps )SortByHeight (){_acfc :=(*byHeight )(_eceg );_dc .Sort (_acfc )};func (_bcdf *Bitmaps )selectByIndexes (_gdbc []int )(*Bitmaps ,error ){_gebcf :=&Bitmaps {};for _ ,_cbbf :=range _gdbc {_adgc ,_aafa :=_bcdf .GetBitmap (_cbbf );
if _aafa !=nil {return nil ,_f .Wrap (_aafa ,"\u0073e\u006ce\u0063\u0074\u0042\u0079\u0049\u006e\u0064\u0065\u0078\u0065\u0073","");};_gebcf .AddBitmap (_adgc );};return _gebcf ,nil ;};type fillSegment struct{_aggb int ;_dabbg int ;_babe int ;_dfabe int ;
};func TstASymbol (t *_c .T )*Bitmap {t .Helper ();_abff :=New (6,6);_d .NoError (t ,_abff .SetPixel (1,0,1));_d .NoError (t ,_abff .SetPixel (2,0,1));_d .NoError (t ,_abff .SetPixel (3,0,1));_d .NoError (t ,_abff .SetPixel (4,0,1));_d .NoError (t ,_abff .SetPixel (5,1,1));
_d .NoError (t ,_abff .SetPixel (1,2,1));_d .NoError (t ,_abff .SetPixel (2,2,1));_d .NoError (t ,_abff .SetPixel (3,2,1));_d .NoError (t ,_abff .SetPixel (4,2,1));_d .NoError (t ,_abff .SetPixel (5,2,1));_d .NoError (t ,_abff .SetPixel (0,3,1));_d .NoError (t ,_abff .SetPixel (5,3,1));
_d .NoError (t ,_abff .SetPixel (0,4,1));_d .NoError (t ,_abff .SetPixel (5,4,1));_d .NoError (t ,_abff .SetPixel (1,5,1));_d .NoError (t ,_abff .SetPixel (2,5,1));_d .NoError (t ,_abff .SetPixel (3,5,1));_d .NoError (t ,_abff .SetPixel (4,5,1));_d .NoError (t ,_abff .SetPixel (5,5,1));
return _abff ;};const (MopDilation MorphOperation =iota ;MopErosion ;MopOpening ;MopClosing ;MopRankBinaryReduction ;MopReplicativeBinaryExpansion ;MopAddBorder ;);func (_faag *Bitmap )setEightPartlyBytes (_ebd ,_eeab int ,_faf uint64 )(_eddb error ){var (_gece byte ;
_ebag int ;);const _bbbg ="\u0073\u0065\u0074\u0045ig\u0068\u0074\u0050\u0061\u0072\u0074\u006c\u0079\u0042\u0079\u0074\u0065\u0073";for _ffgf :=1;_ffgf <=_eeab ;_ffgf ++{_ebag =64-_ffgf *8;_gece =byte (_faf >>uint (_ebag )&0xff);_abc .Log .Trace ("\u0074\u0065\u006d\u0070\u003a\u0020\u0025\u0030\u0038\u0062\u002c\u0020\u0069\u006e\u0064\u0065\u0078\u003a %\u0064,\u0020\u0069\u0064\u0078\u003a\u0020\u0025\u0064\u002c\u0020\u0066\u0075l\u006c\u0042\u0079\u0074\u0065\u0073\u004e\u0075\u006d\u0062\u0065\u0072\u003a\u0020\u0025\u0064\u002c \u0073\u0068\u0069\u0066\u0074\u003a\u0020\u0025\u0064",_gece ,_ebd ,_ebd +_ffgf -1,_eeab ,_ebag );
if _eddb =_faag .SetByte (_ebd +_ffgf -1,_gece );_eddb !=nil {return _f .Wrap (_eddb ,_bbbg ,"\u0066\u0075\u006c\u006c\u0042\u0079\u0074\u0065");};};_ceea :=_faag .RowStride *8-_faag .Width ;if _ceea ==0{return nil ;};_ebag -=8;_gece =byte (_faf >>uint (_ebag )&0xff)<<uint (_ceea );
if _eddb =_faag .SetByte (_ebd +_eeab ,_gece );_eddb !=nil {return _f .Wrap (_eddb ,_bbbg ,"\u0070\u0061\u0064\u0064\u0065\u0064");};return nil ;};func TstFrameBitmapData ()[]byte {return _dbef .Data };type Getter interface{GetBitmap ()*Bitmap ;};func (_caff *ClassedPoints )SortByY (){_caff ._gebc =_caff .ySortFunction ();
_dc .Sort (_caff )};func CorrelationScoreSimple (bm1 ,bm2 *Bitmap ,area1 ,area2 int ,delX ,delY float32 ,maxDiffW ,maxDiffH int ,tab []int )(_defa float64 ,_fgfc error ){const _degba ="\u0043\u006f\u0072\u0072el\u0061\u0074\u0069\u006f\u006e\u0053\u0063\u006f\u0072\u0065\u0053\u0069\u006d\u0070l\u0065";
if bm1 ==nil ||bm2 ==nil {return _defa ,_f .Error (_degba ,"n\u0069l\u0020\u0062\u0069\u0074\u006d\u0061\u0070\u0073 \u0070\u0072\u006f\u0076id\u0065\u0064");};if tab ==nil {return _defa ,_f .Error (_degba ,"\u0074\u0061\u0062\u0020\u0075\u006e\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};if area1 ==0||area2 ==0{return _defa ,_f .Error (_degba ,"\u0070\u0072\u006f\u0076\u0069\u0064\u0065\u0064\u0020\u0061\u0072e\u0061\u0073\u0020\u006d\u0075\u0073\u0074\u0020\u0062\u0065 \u003e\u0020\u0030");};_cbb ,_adfg :=bm1 .Width ,bm1 .Height ;_bdegb ,_dbfdc :=bm2 .Width ,bm2 .Height ;
if _egae (_cbb -_bdegb )> maxDiffW {return 0,nil ;};if _egae (_adfg -_dbfdc )> maxDiffH {return 0,nil ;};var _fdc ,_bgca int ;if delX >=0{_fdc =int (delX +0.5);}else {_fdc =int (delX -0.5);};if delY >=0{_bgca =int (delY +0.5);}else {_bgca =int (delY -0.5);
};_dcag :=bm1 .createTemplate ();if _fgfc =_dcag .RasterOperation (_fdc ,_bgca ,_bdegb ,_dbfdc ,PixSrc ,bm2 ,0,0);_fgfc !=nil {return _defa ,_f .Wrap (_fgfc ,_degba ,"\u0062m\u0032 \u0074\u006f\u0020\u0054\u0065\u006d\u0070\u006c\u0061\u0074\u0065");};
if _fgfc =_dcag .RasterOperation (0,0,_cbb ,_adfg ,PixSrcAndDst ,bm1 ,0,0);_fgfc !=nil {return _defa ,_f .Wrap (_fgfc ,_degba ,"b\u006d\u0031\u0020\u0061\u006e\u0064\u0020\u0062\u006d\u0054");};_eabb :=_dcag .countPixels ();_defa =float64 (_eabb )*float64 (_eabb )/(float64 (area1 )*float64 (area2 ));
return _defa ,nil ;};func _ede (_g ,_df *Bitmap )(_ead error ){const _ef ="\u0065\u0078\u0070\u0061nd\u0042\u0069\u006e\u0061\u0072\u0079\u0046\u0061\u0063\u0074\u006f\u0072\u0034";_def :=_df .RowStride ;_cbd :=_g .RowStride ;_fb :=_df .RowStride *4-_g .RowStride ;
var (_abf ,_dd byte ;_fe uint32 ;_aa ,_ge ,_defg ,_eb ,_aab ,_ec ,_ddg int ;);for _defg =0;_defg < _df .Height ;_defg ++{_aa =_defg *_def ;_ge =4*_defg *_cbd ;for _eb =0;_eb < _def ;_eb ++{_abf =_df .Data [_aa +_eb ];_fe =_dacg [_abf ];_ec =_ge +_eb *4;
if _fb !=0&&(_eb +1)*4> _g .RowStride {for _aab =_fb ;_aab > 0;_aab --{_dd =byte ((_fe >>uint (_aab *8))&0xff);_ddg =_ec +(_fb -_aab );if _ead =_g .SetByte (_ddg ,_dd );_ead !=nil {return _f .Wrapf (_ead ,_ef ,"D\u0069\u0066\u0066\u0065\u0072\u0065n\u0074\u0020\u0072\u006f\u0077\u0073\u0074\u0072\u0069d\u0065\u0073\u002e \u004b:\u0020\u0025\u0064",_aab );
};};}else if _ead =_g .setFourBytes (_ec ,_fe );_ead !=nil {return _f .Wrap (_ead ,_ef ,"");};if _ead =_g .setFourBytes (_ge +_eb *4,_dacg [_df .Data [_aa +_eb ]]);_ead !=nil {return _f .Wrap (_ead ,_ef ,"");};};for _aab =1;_aab < 4;_aab ++{for _eb =0;
_eb < _cbd ;_eb ++{if _ead =_g .SetByte (_ge +_aab *_cbd +_eb ,_g .Data [_ge +_eb ]);_ead !=nil {return _f .Wrapf (_ead ,_ef ,"\u0063\u006f\u0070\u0079\u0020\u0027\u0071\u0075\u0061\u0064\u0072\u0061\u0062l\u0065\u0027\u0020\u006c\u0069\u006ee\u003a\u0020\u0027\u0025\u0064\u0027\u002c\u0020\u0062\u0079\u0074\u0065\u003a \u0027\u0025\u0064\u0027",_aab ,_eb );
};};};};return nil ;};func _bbe (_dfa ,_fagf *Bitmap ,_fge int ,_gca []byte ,_eac int )(_gfc error ){const _caf ="\u0072\u0065\u0064uc\u0065\u0052\u0061\u006e\u006b\u0042\u0069\u006e\u0061\u0072\u0079\u0032\u004c\u0065\u0076\u0065\u006c\u0034";var (_aege ,_cga ,_bff ,_efdf ,_aea ,_eacd ,_bed ,_fde int ;
_ebef ,_eee uint32 ;_edc ,_aae byte ;_eca uint16 ;);_gba :=make ([]byte ,4);_beb :=make ([]byte ,4);for _bff =0;_bff < _dfa .Height -1;_bff ,_efdf =_bff +2,_efdf +1{_aege =_bff *_dfa .RowStride ;_cga =_efdf *_fagf .RowStride ;for _aea ,_eacd =0,0;_aea < _eac ;
_aea ,_eacd =_aea +4,_eacd +1{for _bed =0;_bed < 4;_bed ++{_fde =_aege +_aea +_bed ;if _fde <=len (_dfa .Data )-1&&_fde < _aege +_dfa .RowStride {_gba [_bed ]=_dfa .Data [_fde ];}else {_gba [_bed ]=0x00;};_fde =_aege +_dfa .RowStride +_aea +_bed ;if _fde <=len (_dfa .Data )-1&&_fde < _aege +(2*_dfa .RowStride ){_beb [_bed ]=_dfa .Data [_fde ];
}else {_beb [_bed ]=0x00;};};_ebef =_b .BigEndian .Uint32 (_gba );_eee =_b .BigEndian .Uint32 (_beb );_eee &=_ebef ;_eee &=_eee <<1;_eee &=0xaaaaaaaa;_ebef =_eee |(_eee <<7);_edc =byte (_ebef >>24);_aae =byte ((_ebef >>8)&0xff);_fde =_cga +_eacd ;if _fde +1==len (_fagf .Data )-1||_fde +1>=_cga +_fagf .RowStride {_fagf .Data [_fde ]=_gca [_edc ];
if _gfc =_fagf .SetByte (_fde ,_gca [_edc ]);_gfc !=nil {return _f .Wrapf (_gfc ,_caf ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0025d",_fde );};}else {_eca =(uint16 (_gca [_edc ])<<8)|uint16 (_gca [_aae ]);if _gfc =_fagf .setTwoBytes (_fde ,_eca );_gfc !=nil {return _f .Wrapf (_gfc ,_caf ,"s\u0065\u0074\u0074\u0069\u006e\u0067 \u0074\u0077\u006f\u0020\u0062\u0079t\u0065\u0073\u0020\u0066\u0061\u0069\u006ce\u0064\u002c\u0020\u0069\u006e\u0064\u0065\u0078\u003a\u0020%\u0064",_fde );
};_eacd ++;};};};return nil ;};const (_ LocationFilter =iota ;LocSelectWidth ;LocSelectHeight ;LocSelectXVal ;LocSelectYVal ;LocSelectIfEither ;LocSelectIfBoth ;);func (_ceaba *ClassedPoints )validateIntSlice ()error {const _bacd ="\u0076\u0061l\u0069\u0064\u0061t\u0065\u0049\u006e\u0074\u0053\u006c\u0069\u0063\u0065";
for _ ,_cfdf :=range _ceaba .IntSlice {if _cfdf >=(_ceaba .Points .Size ()){return _f .Errorf (_bacd ,"c\u006c\u0061\u0073\u0073\u0020\u0069\u0064\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u0061\u0020\u0076\u0061\u006ci\u0064 \u0069\u006e\u0064\u0065x\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0070\u006f\u0069\u006e\u0074\u0073\u0020\u006f\u0066\u0020\u0073\u0069\u007a\u0065\u003a\u0020\u0025\u0064",_cfdf ,_ceaba .Points .Size ());
};};return nil ;};func Dilate (d *Bitmap ,s *Bitmap ,sel *Selection )(*Bitmap ,error ){return _faad (d ,s ,sel )};func (_bdfad *Bitmaps )GetBox (i int )(*_ab .Rectangle ,error ){const _bdgda ="\u0047\u0065\u0074\u0042\u006f\u0078";if _bdfad ==nil {return nil ,_f .Error (_bdgda ,"\u0070\u0072\u006f\u0076id\u0065\u0064\u0020\u006e\u0069\u006c\u0020\u0027\u0042\u0069\u0074\u006d\u0061\u0070s\u0027");
};if i > len (_bdfad .Boxes )-1{return nil ,_f .Errorf (_bdgda ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );};return _bdfad .Boxes [i ],nil ;};func (_fafg Points )Get (i int )(Point ,error ){if i > len (_fafg )-1{return Point {},_f .Errorf ("\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047\u0065\u0074","\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};return _fafg [i ],nil ;};type Point struct{X ,Y float32 ;};func _da (_bg ,_gd *Bitmap )(_bb error ){const _ag ="\u0065\u0078\u0070\u0061nd\u0042\u0069\u006e\u0061\u0072\u0079\u0046\u0061\u0063\u0074\u006f\u0072\u0038";_dfb :=_gd .RowStride ;_acg :=_bg .RowStride ;
var _ecc ,_dea ,_cgd ,_dac ,_eec int ;for _cgd =0;_cgd < _gd .Height ;_cgd ++{_ecc =_cgd *_dfb ;_dea =8*_cgd *_acg ;for _dac =0;_dac < _dfb ;_dac ++{if _bb =_bg .setEightBytes (_dea +_dac *8,_gaa [_gd .Data [_ecc +_dac ]]);_bb !=nil {return _f .Wrap (_bb ,_ag ,"");
};};for _eec =1;_eec < 8;_eec ++{for _dac =0;_dac < _acg ;_dac ++{if _bb =_bg .SetByte (_dea +_eec *_acg +_dac ,_bg .Data [_dea +_dac ]);_bb !=nil {return _f .Wrap (_bb ,_ag ,"");};};};};return nil ;};func (_gead *Bitmaps )GetBitmap (i int )(*Bitmap ,error ){const _bfdg ="\u0047e\u0074\u0042\u0069\u0074\u006d\u0061p";
if _gead ==nil {return nil ,_f .Error (_bfdg ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0042\u0069\u0074ma\u0070\u0073");};if i > len (_gead .Values )-1{return nil ,_f .Errorf (_bfdg ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};return _gead .Values [i ],nil ;};func (_bdeb Points )GetGeometry (i int )(_gcdec ,_fgfef float32 ,_gafef error ){if i > len (_bdeb )-1{return 0,0,_f .Errorf ("\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047\u0065\u0074","\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};_bdbcd :=_bdeb [i ];return _bdbcd .X ,_bdbcd .Y ,nil ;};type Points []Point ;func TstESymbol (t *_c .T ,scale ...int )*Bitmap {_ecfb ,_cfcg :=NewWithData (4,5,[]byte {0xF0,0x80,0xE0,0x80,0xF0});_d .NoError (t ,_cfcg );return TstGetScaledSymbol (t ,_ecfb ,scale ...);
};const _fcggg =5000;func (_cabdd *Bitmaps )WidthSorter ()func (_efbd ,_cdebf int )bool {return func (_faeag ,_dgba int )bool {return _cabdd .Values [_faeag ].Width < _cabdd .Values [_dgba ].Width };};func (_bcff *BitmapsArray )GetBitmaps (i int )(*Bitmaps ,error ){const _dfcd ="\u0042\u0069\u0074ma\u0070\u0073\u0041\u0072\u0072\u0061\u0079\u002e\u0047\u0065\u0074\u0042\u0069\u0074\u006d\u0061\u0070\u0073";
if _bcff ==nil {return nil ,_f .Error (_dfcd ,"p\u0072\u006f\u0076\u0069\u0064\u0065d\u0020\u006e\u0069\u006c\u0020\u0027\u0042\u0069\u0074m\u0061\u0070\u0073A\u0072r\u0061\u0079\u0027");};if i > len (_bcff .Values )-1{return nil ,_f .Errorf (_dfcd ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};return _bcff .Values [i ],nil ;};func New (width ,height int )*Bitmap {_agd :=_fffg (width ,height );_agd .Data =make ([]byte ,height *_agd .RowStride );return _agd ;};func (_dged *Bitmap )And (s *Bitmap )(_ace *Bitmap ,_gcaf error ){const _cdd ="\u0042\u0069\u0074\u006d\u0061\u0070\u002e\u0041\u006e\u0064";
if _dged ==nil {return nil ,_f .Error (_cdd ,"\u0027b\u0069t\u006d\u0061\u0070\u0020\u0027b\u0027\u0020i\u0073\u0020\u006e\u0069\u006c");};if s ==nil {return nil ,_f .Error (_cdd ,"\u0062\u0069\u0074\u006d\u0061\u0070\u0020\u0027\u0073\u0027\u0020\u0069s\u0020\u006e\u0069\u006c");
};if !_dged .SizesEqual (s ){_abc .Log .Debug ("\u0025\u0073\u0020-\u0020\u0042\u0069\u0074\u006d\u0061\u0070\u0020\u0027\u0073\u0027\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u0065\u0071\u0075\u0061\u006c\u0020\u0073\u0069\u007a\u0065 \u0077\u0069\u0074\u0068\u0020\u0027\u0062\u0027",_cdd );
};if _ace ,_gcaf =_bee (_ace ,_dged );_gcaf !=nil {return nil ,_f .Wrap (_gcaf ,_cdd ,"\u0063\u0061\u006e't\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0027\u0064\u0027\u0020\u0062\u0069\u0074\u006d\u0061\u0070");};if _gcaf =_ace .RasterOperation (0,0,_ace .Width ,_ace .Height ,PixSrcAndDst ,s ,0,0);
_gcaf !=nil {return nil ,_f .Wrap (_gcaf ,_cdd ,"");};return _ace ,nil ;};func (_bgfd *Bitmap )RemoveBorderGeneral (left ,right ,top ,bot int )(*Bitmap ,error ){return _bgfd .removeBorderGeneral (left ,right ,top ,bot );};func (_bebd Points )XSorter ()func (_abfa ,_baded int )bool {return func (_aaaag ,_daag int )bool {return _bebd [_aaaag ].X < _bebd [_daag ].X };
};func (_cad *Bitmap )SetPadBits (value int ){_cad .setPadBits (value )};func (_cgf *Bitmap )equivalent (_efa *Bitmap )bool {if _cgf ==_efa {return true ;};if !_cgf .SizesEqual (_efa ){return false ;};_cbe :=_gdg (_cgf ,_efa ,CmbOpXor );_dag :=_cgf .countPixels ();
_cdgd :=int (0.25*float32 (_dag ));if _cbe .thresholdPixelSum (_cdgd ){return false ;};var (_daba [9][9]int ;_daef [18][9]int ;_fada [9][18]int ;_dff int ;_aebgd int ;);_dda :=9;_ebb :=_cgf .Height /_dda ;_bfgc :=_cgf .Width /_dda ;_eccg ,_gdd :=_ebb /2,_bfgc /2;
if _ebb < _bfgc {_eccg =_bfgc /2;_gdd =_ebb /2;};_bgeg :=float64 (_eccg )*float64 (_gdd )*_ac .Pi ;_eaab :=int (float64 (_ebb *_bfgc /2)*0.9);_efba :=int (float64 (_bfgc *_ebb /2)*0.9);for _cfeb :=0;_cfeb < _dda ;_cfeb ++{_bdcb :=_bfgc *_cfeb +_dff ;var _ffd int ;
if _cfeb ==_dda -1{_dff =0;_ffd =_cgf .Width ;}else {_ffd =_bdcb +_bfgc ;if ((_cgf .Width -_dff )%_dda )> 0{_dff ++;_ffd ++;};};for _bea :=0;_bea < _dda ;_bea ++{_eaag :=_ebb *_bea +_aebgd ;var _gcbd int ;if _bea ==_dda -1{_aebgd =0;_gcbd =_cgf .Height ;
}else {_gcbd =_eaag +_ebb ;if (_cgf .Height -_aebgd )%_dda > 0{_aebgd ++;_gcbd ++;};};var _acfg ,_afc ,_fgdc ,_dffe int ;_bedb :=(_bdcb +_ffd )/2;_gffd :=(_eaag +_gcbd )/2;for _afdb :=_bdcb ;_afdb < _ffd ;_afdb ++{for _gcbf :=_eaag ;_gcbf < _gcbd ;_gcbf ++{if _cbe .GetPixel (_afdb ,_gcbf ){if _afdb < _bedb {_acfg ++;
}else {_afc ++;};if _gcbf < _gffd {_dffe ++;}else {_fgdc ++;};};};};_daba [_cfeb ][_bea ]=_acfg +_afc ;_daef [_cfeb *2][_bea ]=_acfg ;_daef [_cfeb *2+1][_bea ]=_afc ;_fada [_cfeb ][_bea *2]=_dffe ;_fada [_cfeb ][_bea *2+1]=_fgdc ;};};for _gce :=0;_gce < _dda *2-1;
_gce ++{for _gbda :=0;_gbda < (_dda -1);_gbda ++{var _edbb int ;for _cba :=0;_cba < 2;_cba ++{for _ffbg :=0;_ffbg < 2;_ffbg ++{_edbb +=_daef [_gce +_cba ][_gbda +_ffbg ];};};if _edbb > _efba {return false ;};};};for _dgad :=0;_dgad < (_dda -1);_dgad ++{for _edae :=0;
_edae < ((_dda *2)-1);_edae ++{var _aad int ;for _gbge :=0;_gbge < 2;_gbge ++{for _fbe :=0;_fbe < 2;_fbe ++{_aad +=_fada [_dgad +_gbge ][_edae +_fbe ];};};if _aad > _eaab {return false ;};};};for _gafe :=0;_gafe < (_dda -2);_gafe ++{for _dcfe :=0;_dcfe < (_dda -2);
_dcfe ++{var _adb ,_ebfa int ;for _cdce :=0;_cdce < 3;_cdce ++{for _gdcd :=0;_gdcd < 3;_gdcd ++{if _cdce ==_gdcd {_adb +=_daba [_gafe +_cdce ][_dcfe +_gdcd ];};if (2-_cdce )==_gdcd {_ebfa +=_daba [_gafe +_cdce ][_dcfe +_gdcd ];};};};if _adb > _efba ||_ebfa > _efba {return false ;
};};};for _gfeb :=0;_gfeb < (_dda -1);_gfeb ++{for _aca :=0;_aca < (_dda -1);_aca ++{var _cccd int ;for _eef :=0;_eef < 2;_eef ++{for _gbe :=0;_gbe < 2;_gbe ++{_cccd +=_daba [_gfeb +_eef ][_aca +_gbe ];};};if float64 (_cccd )> _bgeg {return false ;};};
};return true ;};const (PixSrc RasterOperator =0xc;PixDst RasterOperator =0xa;PixNotSrc RasterOperator =0x3;PixNotDst RasterOperator =0x5;PixClr RasterOperator =0x0;PixSet RasterOperator =0xf;PixSrcOrDst RasterOperator =0xe;PixSrcAndDst RasterOperator =0x8;
PixSrcXorDst RasterOperator =0x6;PixNotSrcOrDst RasterOperator =0xb;PixNotSrcAndDst RasterOperator =0x2;PixSrcOrNotDst RasterOperator =0xd;PixSrcAndNotDst RasterOperator =0x4;PixNotPixSrcOrDst RasterOperator =0x1;PixNotPixSrcAndDst RasterOperator =0x7;
PixNotPixSrcXorDst RasterOperator =0x9;PixPaint =PixSrcOrDst ;PixSubtract =PixNotSrcAndDst ;PixMask =PixSrcAndDst ;);func (_ffeeg *Bitmap )connComponentsBitmapsBB (_aggcb *Bitmaps ,_dgga int )(_aedf *Boxes ,_gggeg error ){const _fgfb ="\u0063\u006f\u006enC\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074\u0073\u0042\u0069\u0074\u006d\u0061\u0070\u0073\u0042\u0042";
if _dgga !=4&&_dgga !=8{return nil ,_f .Error (_fgfb ,"\u0063\u006f\u006e\u006e\u0065\u0063t\u0069\u0076\u0069\u0074\u0079\u0020\u006d\u0075\u0073\u0074\u0020\u0062\u0065 \u0061\u0020\u0027\u0034\u0027\u0020\u006fr\u0020\u0027\u0038\u0027");};if _aggcb ==nil {return nil ,_f .Error (_fgfb ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0042\u0069\u0074ma\u0070\u0073");
};if len (_aggcb .Values )> 0{return nil ,_f .Error (_fgfb ,"\u0070\u0072\u006f\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u006fn\u002d\u0065\u006d\u0070\u0074\u0079\u0020\u0042\u0069\u0074m\u0061\u0070\u0073");};if _ffeeg .Zero (){return &Boxes {},nil ;
};var (_eagb ,_abeb ,_eeaa ,_gbbd *Bitmap ;);_ffeeg .setPadBits (0);if _eagb ,_gggeg =_bee (nil ,_ffeeg );_gggeg !=nil {return nil ,_f .Wrap (_gggeg ,_fgfb ,"\u0062\u006d\u0031");};if _abeb ,_gggeg =_bee (nil ,_ffeeg );_gggeg !=nil {return nil ,_f .Wrap (_gggeg ,_fgfb ,"\u0062\u006d\u0032");
};_cacg :=&_ed .Stack {};_cacg .Aux =&_ed .Stack {};_aedf =&Boxes {};var (_bcec ,_gfcdf int ;_acff _ab .Point ;_fec bool ;_eagf *_ab .Rectangle ;);for {if _acff ,_fec ,_gggeg =_eagb .nextOnPixel (_bcec ,_gfcdf );_gggeg !=nil {return nil ,_f .Wrap (_gggeg ,_fgfb ,"");
};if !_fec {break ;};if _eagf ,_gggeg =_dcde (_eagb ,_cacg ,_acff .X ,_acff .Y ,_dgga );_gggeg !=nil {return nil ,_f .Wrap (_gggeg ,_fgfb ,"");};if _gggeg =_aedf .Add (_eagf );_gggeg !=nil {return nil ,_f .Wrap (_gggeg ,_fgfb ,"");};if _eeaa ,_gggeg =_eagb .clipRectangle (_eagf ,nil );
_gggeg !=nil {return nil ,_f .Wrap (_gggeg ,_fgfb ,"\u0062\u006d\u0033");};if _gbbd ,_gggeg =_abeb .clipRectangle (_eagf ,nil );_gggeg !=nil {return nil ,_f .Wrap (_gggeg ,_fgfb ,"\u0062\u006d\u0034");};if _ ,_gggeg =_gbdg (_eeaa ,_eeaa ,_gbbd );_gggeg !=nil {return nil ,_f .Wrap (_gggeg ,_fgfb ,"\u0062m\u0033\u0020\u005e\u0020\u0062\u006d4");
};if _gggeg =_abeb .RasterOperation (_eagf .Min .X ,_eagf .Min .Y ,_eagf .Dx (),_eagf .Dy (),PixSrcXorDst ,_eeaa ,0,0);_gggeg !=nil {return nil ,_f .Wrap (_gggeg ,_fgfb ,"\u0062\u006d\u0032\u0020\u002d\u0058\u004f\u0052\u002d>\u0020\u0062\u006d\u0033");
};_aggcb .AddBitmap (_eeaa );_bcec =_acff .X ;_gfcdf =_acff .Y ;};_aggcb .Boxes =*_aedf ;return _aedf ,nil ;};func (_gcda *Boxes )Get (i int )(*_ab .Rectangle ,error ){const _ccce ="\u0042o\u0078\u0065\u0073\u002e\u0047\u0065t";if _gcda ==nil {return nil ,_f .Error (_ccce ,"\u0027\u0042\u006f\u0078es\u0027\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};if i > len (*_gcda )-1{return nil ,_f .Errorf (_ccce ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );};return (*_gcda )[i ],nil ;};func (_dfdd Points )Size ()int {return len (_dfdd )};
var (_dbef *Bitmap ;_cfdg *Bitmap ;);func (_aega *Bitmap )setTwoBytes (_bdgce int ,_fabf uint16 )error {if _bdgce +1> len (_aega .Data )-1{return _f .Errorf ("s\u0065\u0074\u0054\u0077\u006f\u0042\u0079\u0074\u0065\u0073","\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",_bdgce );
};_aega .Data [_bdgce ]=byte ((_fabf &0xff00)>>8);_aega .Data [_bdgce +1]=byte (_fabf &0xff);return nil ;};var MorphBC BoundaryCondition ;func TstVSymbol (t *_c .T ,scale ...int )*Bitmap {_gbfb ,_gccfa :=NewWithData (5,5,[]byte {0x88,0x88,0x88,0x50,0x20});
_d .NoError (t ,_gccfa );return TstGetScaledSymbol (t ,_gbfb ,scale ...);};func _gbg ()(_dcb [256]uint64 ){for _fc :=0;_fc < 256;_fc ++{if _fc &0x01!=0{_dcb [_fc ]|=0xff;};if _fc &0x02!=0{_dcb [_fc ]|=0xff00;};if _fc &0x04!=0{_dcb [_fc ]|=0xff0000;};if _fc &0x08!=0{_dcb [_fc ]|=0xff000000;
};if _fc &0x10!=0{_dcb [_fc ]|=0xff00000000;};if _fc &0x20!=0{_dcb [_fc ]|=0xff0000000000;};if _fc &0x40!=0{_dcb [_fc ]|=0xff000000000000;};if _fc &0x80!=0{_dcb [_fc ]|=0xff00000000000000;};};return _dcb ;};func (_eeca *Bitmap )setAll ()error {_fdg :=_dagdg (_eeca ,0,0,_eeca .Width ,_eeca .Height ,PixSet ,nil ,0,0);
if _fdg !=nil {return _f .Wrap (_fdg ,"\u0073\u0065\u0074\u0041\u006c\u006c","");};return nil ;};const (CmbOpOr CombinationOperator =iota ;CmbOpAnd ;CmbOpXor ;CmbOpXNor ;CmbOpReplace ;CmbOpNot ;);func (_ebeec *ClassedPoints )Swap (i ,j int ){_ebeec .IntSlice [i ],_ebeec .IntSlice [j ]=_ebeec .IntSlice [j ],_ebeec .IntSlice [i ];
};func (_ddad *byWidth )Swap (i ,j int ){_ddad .Values [i ],_ddad .Values [j ]=_ddad .Values [j ],_ddad .Values [i ];if _ddad .Boxes !=nil {_ddad .Boxes [i ],_ddad .Boxes [j ]=_ddad .Boxes [j ],_ddad .Boxes [i ];};};func _eded (_gegg ,_gfbdc *Bitmap ,_bdcc ,_bceg ,_dcbb ,_gefb ,_dbae ,_eega ,_debb ,_abac int ,_bcega CombinationOperator ,_cdef int )error {var _aacf int ;
_gcde :=func (){_aacf ++;_dcbb +=_gfbdc .RowStride ;_gefb +=_gegg .RowStride ;_dbae +=_gegg .RowStride };for _aacf =_bdcc ;_aacf < _bceg ;_gcde (){var _bcge uint16 ;_aabd :=_dcbb ;for _cefe :=_gefb ;_cefe <=_dbae ;_cefe ++{_fdd ,_feae :=_gfbdc .GetByte (_aabd );
if _feae !=nil {return _feae ;};_cdae ,_feae :=_gegg .GetByte (_cefe );if _feae !=nil {return _feae ;};_bcge =(_bcge |(uint16 (_cdae )&0xff))<<uint (_abac );_cdae =byte (_bcge >>8);if _feae =_gfbdc .SetByte (_aabd ,_bfb (_fdd ,_cdae ,_bcega ));_feae !=nil {return _feae ;
};_aabd ++;_bcge <<=uint (_debb );if _cefe ==_dbae {_cdae =byte (_bcge >>(8-uint8 (_abac )));if _cdef !=0{_cdae =_dca (uint (8+_eega ),_cdae );};_fdd ,_feae =_gfbdc .GetByte (_aabd );if _feae !=nil {return _feae ;};if _feae =_gfbdc .SetByte (_aabd ,_bfb (_fdd ,_cdae ,_bcega ));
_feae !=nil {return _feae ;};};};};return nil ;};func (_dgd *Boxes )SelectBySize (width ,height int ,tp LocationFilter ,relation SizeComparison )(_geag *Boxes ,_dagd error ){const _gcf ="\u0042o\u0078e\u0073\u002e\u0053\u0065\u006ce\u0063\u0074B\u0079\u0053\u0069\u007a\u0065";
if _dgd ==nil {return nil ,_f .Error (_gcf ,"b\u006f\u0078\u0065\u0073 '\u0062'\u0020\u006e\u006f\u0074\u0020d\u0065\u0066\u0069\u006e\u0065\u0064");};if len (*_dgd )==0{return _dgd ,nil ;};switch tp {case LocSelectWidth ,LocSelectHeight ,LocSelectIfEither ,LocSelectIfBoth :default:return nil ,_f .Errorf (_gcf ,"\u0069\u006e\u0076al\u0069\u0064\u0020\u0066\u0069\u006c\u0074\u0065\u0072\u0020\u0074\u0079\u0070\u0065\u003a\u0020\u0025\u0064",tp );
};switch relation {case SizeSelectIfLT ,SizeSelectIfGT ,SizeSelectIfLTE ,SizeSelectIfGTE :default:return nil ,_f .Errorf (_gcf ,"i\u006e\u0076\u0061\u006c\u0069\u0064 \u0072\u0065\u006c\u0061\u0074\u0069\u006f\u006e\u0020t\u0079\u0070\u0065:\u0020'\u0025\u0064\u0027",tp );
};_gbbe :=_dgd .makeSizeIndicator (width ,height ,tp ,relation );_eaaae ,_dagd :=_dgd .selectWithIndicator (_gbbe );if _dagd !=nil {return nil ,_f .Wrap (_dagd ,_gcf ,"");};return _eaaae ,nil ;};func (_fgd *Bitmap )Equivalent (s *Bitmap )bool {return _fgd .equivalent (s )};
func (_dfd *Bitmap )ConnComponents (bms *Bitmaps ,connectivity int )(_bbab *Boxes ,_ddac error ){const _bgdb ="B\u0069\u0074\u006d\u0061p.\u0043o\u006e\u006e\u0043\u006f\u006dp\u006f\u006e\u0065\u006e\u0074\u0073";if _dfd ==nil {return nil ,_f .Error (_bgdb ,"\u0070r\u006f\u0076\u0069\u0064e\u0064\u0020\u0065\u006d\u0070t\u0079 \u0027b\u0027\u0020\u0062\u0069\u0074\u006d\u0061p");
};if connectivity !=4&&connectivity !=8{return nil ,_f .Error (_bgdb ,"\u0063\u006f\u006ene\u0063\u0074\u0069\u0076\u0069\u0074\u0079\u0020\u006e\u006f\u0074\u0020\u0034\u0020\u006f\u0072\u0020\u0038");};if bms ==nil {if _bbab ,_ddac =_dfd .connComponentsBB (connectivity );
_ddac !=nil {return nil ,_f .Wrap (_ddac ,_bgdb ,"");};}else {if _bbab ,_ddac =_dfd .connComponentsBitmapsBB (bms ,connectivity );_ddac !=nil {return nil ,_f .Wrap (_ddac ,_bgdb ,"");};};return _bbab ,nil ;};func _dfbbgb (_eabc *Bitmap ,_aebc int )(*Bitmap ,error ){const _bcaa ="\u0065x\u0070a\u006e\u0064\u0052\u0065\u0070\u006c\u0069\u0063\u0061\u0074\u0065";
if _eabc ==nil {return nil ,_f .Error (_bcaa ,"\u0073o\u0075r\u0063\u0065\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");};if _aebc <=0{return nil ,_f .Error (_bcaa ,"i\u006e\u0076\u0061\u006cid\u0020f\u0061\u0063\u0074\u006f\u0072 \u002d\u0020\u003c\u003d\u0020\u0030");
};if _aebc ==1{_gdfc ,_gagd :=_bee (nil ,_eabc );if _gagd !=nil {return nil ,_f .Wrap (_gagd ,_bcaa ,"\u0066\u0061\u0063\u0074\u006f\u0072\u0020\u003d\u0020\u0031");};return _gdfc ,nil ;};_gfca ,_ddbd :=_db (_eabc ,_aebc ,_aebc );if _ddbd !=nil {return nil ,_f .Wrap (_ddbd ,_bcaa ,"");
};return _gfca ,nil ;};func _edce (_cabd ,_fbbf *Bitmap ,_ceedce *Selection )(*Bitmap ,error ){const _cgg ="\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u004d\u006f\u0072\u0070\u0068A\u0072\u0067\u0073\u0032";var _ecbf ,_agaa int ;if _fbbf ==nil {return nil ,_f .Error (_cgg ,"s\u006fu\u0072\u0063\u0065\u0020\u0062\u0069\u0074\u006da\u0070\u0020\u0069\u0073 n\u0069\u006c");
};if _ceedce ==nil {return nil ,_f .Error (_cgg ,"\u0073e\u006c \u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};_ecbf =_ceedce .Width ;_agaa =_ceedce .Height ;if _ecbf ==0||_agaa ==0{return nil ,_f .Error (_cgg ,"\u0073\u0065\u006c\u0020\u006f\u0066\u0020\u0073\u0069\u007a\u0065\u0020\u0030");
};if _cabd ==nil {return _fbbf .createTemplate (),nil ;};if _egbae :=_cabd .resizeImageData (_fbbf );_egbae !=nil {return nil ,_egbae ;};return _cabd ,nil ;};func (_dagf *ClassedPoints )XAtIndex (i int )float32 {return (*_dagf .Points )[_dagf .IntSlice [i ]].X };
func NewWithUnpaddedData (width ,height int ,data []byte )(*Bitmap ,error ){const _gfad ="\u004e\u0065\u0077\u0057it\u0068\u0055\u006e\u0070\u0061\u0064\u0064\u0065\u0064\u0044\u0061\u0074\u0061";_eda :=_fffg (width ,height );_eda .Data =data ;if _eegd :=((width *height )+7)>>3;
len (data )< _eegd {return nil ,_f .Errorf (_gfad ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0064a\u0074\u0061\u0020\u006c\u0065\u006e\u0067\u0074\u0068\u003a\u0020\u0027\u0025\u0064\u0027\u002e\u0020\u0054\u0068\u0065\u0020\u0064\u0061t\u0061\u0020s\u0068\u006fu\u006c\u0064\u0020\u0063\u006f\u006e\u0074\u0061\u0069\u006e\u0020\u0061\u0074 l\u0065\u0061\u0073\u0074\u003a\u0020\u0027\u0025\u0064'\u0020\u0062\u0079\u0074\u0065\u0073",len (data ),_eegd );
};if _gec :=_eda .addPadBits ();_gec !=nil {return nil ,_f .Wrap (_gec ,_gfad ,"");};return _eda ,nil ;};func _dca (_gga uint ,_eaaa byte )byte {return _eaaa >>_gga <<_gga };const (_ SizeComparison =iota ;SizeSelectIfLT ;SizeSelectIfGT ;SizeSelectIfLTE ;
SizeSelectIfGTE ;SizeSelectIfEQ ;);func (_ffdab *Bitmaps )SelectByIndexes (idx []int )(*Bitmaps ,error ){const _geeg ="B\u0069\u0074\u006d\u0061\u0070\u0073.\u0053\u006f\u0072\u0074\u0049\u006e\u0064\u0065\u0078e\u0073\u0042\u0079H\u0065i\u0067\u0068\u0074";
_ddeb ,_abgab :=_ffdab .selectByIndexes (idx );if _abgab !=nil {return nil ,_f .Wrap (_abgab ,_geeg ,"");};return _ddeb ,nil ;};func (_aaea *Bitmap )RasterOperation (dx ,dy ,dw ,dh int ,op RasterOperator ,src *Bitmap ,sx ,sy int )error {return _dagdg (_aaea ,dx ,dy ,dw ,dh ,op ,src ,sx ,sy );
};func (_gaf *Bitmap )GetUnpaddedData ()([]byte ,error ){_eag :=uint (_gaf .Width &0x07);if _eag ==0{return _gaf .Data ,nil ;};_bgb :=_gaf .Width *_gaf .Height ;if _bgb %8!=0{_bgb >>=3;_bgb ++;}else {_bgb >>=3;};_gff :=make ([]byte ,_bgb );_cfa :=_ff .NewWriterMSB (_gff );
const _cffgb ="\u0047e\u0074U\u006e\u0070\u0061\u0064\u0064\u0065\u0064\u0044\u0061\u0074\u0061";for _bfeg :=0;_bfeg < _gaf .Height ;_bfeg ++{for _baba :=0;_baba < _gaf .RowStride ;_baba ++{_ebf :=_gaf .Data [_bfeg *_gaf .RowStride +_baba ];if _baba !=_gaf .RowStride -1{_bbcfg :=_cfa .WriteByte (_ebf );
if _bbcfg !=nil {return nil ,_f .Wrap (_bbcfg ,_cffgb ,"");};continue ;};for _fba :=uint (0);_fba < _eag ;_fba ++{_deab :=_cfa .WriteBit (int (_ebf >>(7-_fba )&0x01));if _deab !=nil {return nil ,_f .Wrap (_deab ,_cffgb ,"");};};};};return _gff ,nil ;};
func (_abce *Bitmaps )GroupByHeight ()(*BitmapsArray ,error ){const _fdcb ="\u0047\u0072\u006f\u0075\u0070\u0042\u0079\u0048\u0065\u0069\u0067\u0068\u0074";if len (_abce .Values )==0{return nil ,_f .Error (_fdcb ,"\u006eo\u0020v\u0061\u006c\u0075\u0065\u0073 \u0070\u0072o\u0076\u0069\u0064\u0065\u0064");
};_ddae :=&BitmapsArray {};_abce .SortByHeight ();_feaa :=-1;_fbge :=-1;for _afbb :=0;_afbb < len (_abce .Values );_afbb ++{_acgbg :=_abce .Values [_afbb ].Height ;if _acgbg > _feaa {_feaa =_acgbg ;_fbge ++;_ddae .Values =append (_ddae .Values ,&Bitmaps {});
};_ddae .Values [_fbge ].AddBitmap (_abce .Values [_afbb ]);};return _ddae ,nil ;};func TstWriteSymbols (t *_c .T ,bms *Bitmaps ,src *Bitmap ){for _gdea :=0;_gdea < bms .Size ();_gdea ++{_begb :=bms .Values [_gdea ];_fegdc :=bms .Boxes [_gdea ];_dbabe :=src .RasterOperation (_fegdc .Min .X ,_fegdc .Min .Y ,_begb .Width ,_begb .Height ,PixSrc ,_begb ,0,0);
_d .NoError (t ,_dbabe );};};func TstImageBitmap ()*Bitmap {return _cfdg .Copy ()};const (SelDontCare SelectionValue =iota ;SelHit ;SelMiss ;);type MorphProcess struct{Operation MorphOperation ;Arguments []int ;};type SizeComparison int ;func (_gafdcd *Bitmap )centroid (_acdad ,_gaga []int )(Point ,error ){_ecee :=Point {};
_gafdcd .setPadBits (0);if len (_acdad )==0{_acdad =_dedb ();};if len (_gaga )==0{_gaga =_ddab ();};var _edaeg ,_gdab ,_edab ,_beed ,_cfd ,_dcbc int ;var _beaa byte ;for _cfd =0;_cfd < _gafdcd .Height ;_cfd ++{_bffc :=_gafdcd .RowStride *_cfd ;_beed =0;
for _dcbc =0;_dcbc < _gafdcd .RowStride ;_dcbc ++{_beaa =_gafdcd .Data [_bffc +_dcbc ];if _beaa !=0{_beed +=_gaga [_beaa ];_edaeg +=_acdad [_beaa ]+_dcbc *8*_gaga [_beaa ];};};_edab +=_beed ;_gdab +=_beed *_cfd ;};if _edab !=0{_ecee .X =float32 (_edaeg )/float32 (_edab );
_ecee .Y =float32 (_gdab )/float32 (_edab );};return _ecee ,nil ;};func (_eeeeg *ClassedPoints )GetIntXByClass (i int )(int ,error ){const _ccab ="\u0043\u006c\u0061\u0073s\u0065\u0064\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047e\u0074I\u006e\u0074\u0059\u0042\u0079\u0043\u006ca\u0073\u0073";
if i >=_eeeeg .IntSlice .Size (){return 0,_f .Errorf (_ccab ,"\u0069\u003a\u0020\u0027\u0025\u0064\u0027 \u0069\u0073\u0020o\u0075\u0074\u0020\u006ff\u0020\u0074\u0068\u0065\u0020\u0072\u0061\u006e\u0067\u0065\u0020\u006f\u0066\u0020\u0074\u0068\u0065\u0020\u0049\u006e\u0074\u0053\u006c\u0069\u0063\u0065",i );
};return int (_eeeeg .XAtIndex (i )),nil ;};func (_dfcg *Bitmap )connComponentsBB (_edde int )(_cag *Boxes ,_dead error ){const _fcgd ="\u0042\u0069\u0074ma\u0070\u002e\u0063\u006f\u006e\u006e\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074\u0073\u0042\u0042";
if _edde !=4&&_edde !=8{return nil ,_f .Error (_fcgd ,"\u0063\u006f\u006e\u006e\u0065\u0063t\u0069\u0076\u0069\u0074\u0079\u0020\u006d\u0075\u0073\u0074\u0020\u0062\u0065 \u0061\u0020\u0027\u0034\u0027\u0020\u006fr\u0020\u0027\u0038\u0027");};if _dfcg .Zero (){return &Boxes {},nil ;
};_dfcg .setPadBits (0);_aegb ,_dead :=_bee (nil ,_dfcg );if _dead !=nil {return nil ,_f .Wrap (_dead ,_fcgd ,"\u0062\u006d\u0031");};_ceee :=&_ed .Stack {};_ceee .Aux =&_ed .Stack {};_cag =&Boxes {};var (_bdgd ,_ddfg int ;_eggd _ab .Point ;_dcaa bool ;
_gbcd *_ab .Rectangle ;);for {if _eggd ,_dcaa ,_dead =_aegb .nextOnPixel (_ddfg ,_bdgd );_dead !=nil {return nil ,_f .Wrap (_dead ,_fcgd ,"");};if !_dcaa {break ;};if _gbcd ,_dead =_dcde (_aegb ,_ceee ,_eggd .X ,_eggd .Y ,_edde );_dead !=nil {return nil ,_f .Wrap (_dead ,_fcgd ,"");
};if _dead =_cag .Add (_gbcd );_dead !=nil {return nil ,_f .Wrap (_dead ,_fcgd ,"");};_ddfg =_eggd .X ;_bdgd =_eggd .Y ;};return _cag ,nil ;};func _fgbdc (_ffff ,_dfbc *Bitmap ,_debf ,_ddec int )(*Bitmap ,error ){const _cgfaf ="\u006fp\u0065\u006e\u0042\u0072\u0069\u0063k";
if _dfbc ==nil {return nil ,_f .Error (_cgfaf ,"\u0073o\u0075\u0072\u0063\u0065 \u0062\u0069\u0074\u006d\u0061p\u0020n\u006ft\u0020\u0064\u0065\u0066\u0069\u006e\u0065d");};if _debf < 1&&_ddec < 1{return nil ,_f .Error (_cgfaf ,"\u0068\u0053\u0069\u007ae \u003c\u0020\u0031\u0020\u0026\u0026\u0020\u0076\u0053\u0069\u007a\u0065\u0020\u003c \u0031");
};if _debf ==1&&_ddec ==1{return _dfbc .Copy (),nil ;};if _debf ==1||_ddec ==1{var _dgddd error ;_agafb :=SelCreateBrick (_ddec ,_debf ,_ddec /2,_debf /2,SelHit );_ffff ,_dgddd =_bagb (_ffff ,_dfbc ,_agafb );if _dgddd !=nil {return nil ,_f .Wrap (_dgddd ,_cgfaf ,"\u0068S\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u007c\u007c \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");
};return _ffff ,nil ;};_deef :=SelCreateBrick (1,_debf ,0,_debf /2,SelHit );_dgbec :=SelCreateBrick (_ddec ,1,_ddec /2,0,SelHit );_adfa ,_adfe :=_acaab (nil ,_dfbc ,_deef );if _adfe !=nil {return nil ,_f .Wrap (_adfe ,_cgfaf ,"\u0031s\u0074\u0020\u0065\u0072\u006f\u0064e");
};_ffff ,_adfe =_acaab (_ffff ,_adfa ,_dgbec );if _adfe !=nil {return nil ,_f .Wrap (_adfe ,_cgfaf ,"\u0032n\u0064\u0020\u0065\u0072\u006f\u0064e");};_ ,_adfe =_faad (_adfa ,_ffff ,_deef );if _adfe !=nil {return nil ,_f .Wrap (_adfe ,_cgfaf ,"\u0031\u0073\u0074\u0020\u0064\u0069\u006c\u0061\u0074\u0065");
};_ ,_adfe =_faad (_ffff ,_adfa ,_dgbec );if _adfe !=nil {return nil ,_f .Wrap (_adfe ,_cgfaf ,"\u0032\u006e\u0064\u0020\u0064\u0069\u006c\u0061\u0074\u0065");};return _ffff ,nil ;};func _faad (_faea *Bitmap ,_gfgg *Bitmap ,_fafc *Selection )(*Bitmap ,error ){var (_ccbf *Bitmap ;
_eaagf error ;);_faea ,_eaagf =_cacgf (_faea ,_gfgg ,_fafc ,&_ccbf );if _eaagf !=nil {return nil ,_eaagf ;};if _eaagf =_faea .clearAll ();_eaagf !=nil {return nil ,_eaagf ;};var _bbgb SelectionValue ;for _fedd :=0;_fedd < _fafc .Height ;_fedd ++{for _fcda :=0;
_fcda < _fafc .Width ;_fcda ++{_bbgb =_fafc .Data [_fedd ][_fcda ];if _bbgb ==SelHit {if _eaagf =_faea .RasterOperation (_fcda -_fafc .Cx ,_fedd -_fafc .Cy ,_gfgg .Width ,_gfgg .Height ,PixSrcOrDst ,_ccbf ,0,0);_eaagf !=nil {return nil ,_eaagf ;};};};};
return _faea ,nil ;};func _aabg (_adeb ,_bfff *Bitmap ,_eefa ,_fabe ,_fgb ,_acdd ,_gaca int ,_aaee CombinationOperator )error {var _faef int ;_bafa :=func (){_faef ++;_fgb +=_bfff .RowStride ;_acdd +=_adeb .RowStride ;_gaca +=_adeb .RowStride };for _faef =_eefa ;
_faef < _fabe ;_bafa (){_geg :=_fgb ;for _gcc :=_acdd ;_gcc <=_gaca ;_gcc ++{_defc ,_ebaa :=_bfff .GetByte (_geg );if _ebaa !=nil {return _ebaa ;};_bbba ,_ebaa :=_adeb .GetByte (_gcc );if _ebaa !=nil {return _ebaa ;};if _ebaa =_bfff .SetByte (_geg ,_bfb (_defc ,_bbba ,_aaee ));
_ebaa !=nil {return _ebaa ;};_geg ++;};};return nil ;};func _aedff (_cadfa ,_beeda ,_beg *Bitmap ,_geee int )(*Bitmap ,error ){const _acae ="\u0073\u0065\u0065\u0064\u0046\u0069\u006c\u006c\u0042i\u006e\u0061\u0072\u0079";if _beeda ==nil {return nil ,_f .Error (_acae ,"s\u006fu\u0072\u0063\u0065\u0020\u0062\u0069\u0074\u006da\u0070\u0020\u0069\u0073 n\u0069\u006c");
};if _beg ==nil {return nil ,_f .Error (_acae ,"'\u006da\u0073\u006b\u0027\u0020\u0062\u0069\u0074\u006da\u0070\u0020\u0069\u0073 n\u0069\u006c");};if _geee !=4&&_geee !=8{return nil ,_f .Error (_acae ,"\u0063\u006f\u006en\u0065\u0063\u0074\u0069v\u0069\u0074\u0079\u0020\u006e\u006f\u0074 \u0069\u006e\u0020\u0072\u0061\u006e\u0067\u0065\u0020\u007b\u0034\u002c\u0038\u007d");
};var _ecdb error ;_cadfa ,_ecdb =_bee (_cadfa ,_beeda );if _ecdb !=nil {return nil ,_f .Wrap (_ecdb ,_acae ,"\u0063o\u0070y\u0020\u0073\u006f\u0075\u0072c\u0065\u0020t\u006f\u0020\u0027\u0064\u0027");};_cccdc :=_beeda .createTemplate ();_beg .setPadBits (0);
for _defb :=0;_defb < _fcggg ;_defb ++{_cccdc ,_ecdb =_bee (_cccdc ,_cadfa );if _ecdb !=nil {return nil ,_f .Wrapf (_ecdb ,_acae ,"\u0069\u0074\u0065\u0072\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0025\u0064",_defb );};if _ecdb =_dfcf (_cadfa ,_beg ,_geee );
_ecdb !=nil {return nil ,_f .Wrapf (_ecdb ,_acae ,"\u0069\u0074\u0065\u0072\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0025\u0064",_defb );};if _cccdc .Equals (_cadfa ){break ;};};return _cadfa ,nil ;};func (_ebfd *Bitmap )SetDefaultPixel (){for _dbgga :=range _ebfd .Data {_ebfd .Data [_dbgga ]=byte (0xff);
};};func (_efaa *Bitmap )removeBorderGeneral (_afcc ,_bdeg ,_bdba ,_fee int )(*Bitmap ,error ){const _beba ="\u0072\u0065\u006d\u006fve\u0042\u006f\u0072\u0064\u0065\u0072\u0047\u0065\u006e\u0065\u0072\u0061\u006c";if _afcc < 0||_bdeg < 0||_bdba < 0||_fee < 0{return nil ,_f .Error (_beba ,"\u006e\u0065g\u0061\u0074\u0069\u0076\u0065\u0020\u0062\u0072\u006f\u0064\u0065\u0072\u0020\u0072\u0065\u006d\u006f\u0076\u0065\u0020\u0076\u0061lu\u0065\u0073");
};_bdca ,_feag :=_efaa .Width ,_efaa .Height ;_bbb :=_bdca -_afcc -_bdeg ;_ega :=_feag -_bdba -_fee ;if _bbb <=0{return nil ,_f .Errorf (_beba ,"w\u0069\u0064\u0074\u0068: \u0025d\u0020\u006d\u0075\u0073\u0074 \u0062\u0065\u0020\u003e\u0020\u0030",_bbb );
};if _ega <=0{return nil ,_f .Errorf (_beba ,"\u0068\u0065\u0069\u0067ht\u003a\u0020\u0025\u0064\u0020\u006d\u0075\u0073\u0074\u0020\u0062\u0065\u0020\u003e \u0030",_ega );};_egfc :=New (_bbb ,_ega );_egfc .Color =_efaa .Color ;_ecbc :=_egfc .RasterOperation (0,0,_bbb ,_ega ,PixSrc ,_efaa ,_afcc ,_bdba );
if _ecbc !=nil {return nil ,_f .Wrap (_ecbc ,_beba ,"");};return _egfc ,nil ;};func _cbcd (_dgef ...MorphProcess )(_afag error ){const _gabbd ="v\u0065r\u0069\u0066\u0079\u004d\u006f\u0072\u0070\u0068P\u0072\u006f\u0063\u0065ss\u0065\u0073";var _ebbe ,_cgcf int ;
for _fcfaf ,_fcba :=range _dgef {if _afag =_fcba .verify (_fcfaf ,&_ebbe ,&_cgcf );_afag !=nil {return _f .Wrap (_afag ,_gabbd ,"");};};if _cgcf !=0&&_ebbe !=0{return _f .Error (_gabbd ,"\u004d\u006f\u0072\u0070\u0068\u0020\u0073\u0065\u0071\u0075\u0065n\u0063\u0065\u0020\u002d\u0020\u0062\u006f\u0072d\u0065r\u0020\u0061\u0064\u0064\u0065\u0064\u0020\u0062\u0075\u0074\u0020\u006e\u0065\u0074\u0020\u0072\u0065\u0064u\u0063\u0074\u0069\u006f\u006e\u0020\u006e\u006f\u0074\u0020\u0030");
};return nil ;};func _dedd (_gede *_ed .Stack ,_gggc ,_ceecf ,_dgade ,_aggf ,_edecf int ,_ffcb *_ab .Rectangle )(_beeb error ){const _gacd ="\u0070\u0075\u0073\u0068\u0046\u0069\u006c\u006c\u0053\u0065\u0067m\u0065\u006e\u0074\u0042\u006f\u0075\u006e\u0064\u0069\u006eg\u0042\u006f\u0078";
if _gede ==nil {return _f .Error (_gacd ,"\u006ei\u006c \u0073\u0074\u0061\u0063\u006b \u0070\u0072o\u0076\u0069\u0064\u0065\u0064");};if _ffcb ==nil {return _f .Error (_gacd ,"\u0070\u0072\u006f\u0076i\u0064\u0065\u0064\u0020\u006e\u0069\u006c\u0020\u0069\u006da\u0067e\u002e\u0052\u0065\u0063\u0074\u0061\u006eg\u006c\u0065");
};_ffcb .Min .X =_ed .Min (_ffcb .Min .X ,_gggc );_ffcb .Max .X =_ed .Max (_ffcb .Max .X ,_ceecf );_ffcb .Min .Y =_ed .Min (_ffcb .Min .Y ,_dgade );_ffcb .Max .Y =_ed .Max (_ffcb .Max .Y ,_dgade );if _dgade +_aggf < 0||_dgade +_aggf > _edecf {return nil ;
};if _gede .Aux ==nil {return _f .Error (_gacd ,"a\u0075x\u0053\u0074\u0061\u0063\u006b\u0020\u006e\u006ft\u0020\u0064\u0065\u0066in\u0065\u0064");};var _abgac *fillSegment ;_adbd ,_cecg :=_gede .Aux .Pop ();if _cecg {if _abgac ,_cecg =_adbd .(*fillSegment );
!_cecg {return _f .Error (_gacd ,"a\u0075\u0078\u0053\u0074\u0061\u0063k\u0020\u0064\u0061\u0074\u0061\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0061 \u002a\u0066\u0069\u006c\u006c\u0053\u0065\u0067\u006d\u0065n\u0074");};}else {_abgac =&fillSegment {};
};_abgac ._aggb =_gggc ;_abgac ._dabbg =_ceecf ;_abgac ._babe =_dgade ;_abgac ._dfabe =_aggf ;_gede .Push (_abgac );return nil ;};type Bitmap struct{Width ,Height int ;BitmapNumber int ;RowStride int ;Data []byte ;Color Color ;Special int ;Text string ;
XResolution ,YResolution int ;};func (_fgea *byHeight )Less (i ,j int )bool {return _fgea .Values [i ].Height < _fgea .Values [j ].Height };type Boxes []*_ab .Rectangle ;func _eaa (_gb *Bitmap ,_ebg *Bitmap ,_eecd int )(_ecd error ){const _bc ="e\u0078\u0070\u0061\u006edB\u0069n\u0061\u0072\u0079\u0050\u006fw\u0065\u0072\u0032\u004c\u006f\u0077";
switch _eecd {case 2:_ecd =_acb (_gb ,_ebg );case 4:_ecd =_ede (_gb ,_ebg );case 8:_ecd =_da (_gb ,_ebg );default:return _f .Error (_bc ,"\u0065\u0078p\u0061\u006e\u0073\u0069o\u006e\u0020f\u0061\u0063\u0074\u006f\u0072\u0020\u006e\u006ft\u0020\u0069\u006e\u0020\u007b\u0032\u002c\u0034\u002c\u0038\u007d\u0020r\u0061\u006e\u0067\u0065");
};if _ecd !=nil {_ecd =_f .Wrap (_ecd ,_bc ,"");};return _ecd ;};func (_dagb *ClassedPoints )SortByX (){_dagb ._gebc =_dagb .xSortFunction ();_dc .Sort (_dagb )};func _ecac (_dad *Bitmap ,_fgbde *_ed .Stack ,_cbed ,_dcca int )(_ecbfe *_ab .Rectangle ,_cefa error ){const _gfff ="\u0073e\u0065d\u0046\u0069\u006c\u006c\u0053\u0074\u0061\u0063\u006b\u0042\u0042";
if _dad ==nil {return nil ,_f .Error (_gfff ,"\u0070\u0072\u006fvi\u0064\u0065\u0064\u0020\u006e\u0069\u006c\u0020\u0027\u0073\u0027\u0020\u0042\u0069\u0074\u006d\u0061\u0070");};if _fgbde ==nil {return nil ,_f .Error (_gfff ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0027\u0073\u0074ac\u006b\u0027");
};_ggbf ,_egbbe :=_dad .Width ,_dad .Height ;_fafa :=_ggbf -1;_aafd :=_egbbe -1;if _cbed < 0||_cbed > _fafa ||_dcca < 0||_dcca > _aafd ||!_dad .GetPixel (_cbed ,_dcca ){return nil ,nil ;};var _dbcf *_ab .Rectangle ;_dbcf ,_cefa =Rect (100000,100000,0,0);
if _cefa !=nil {return nil ,_f .Wrap (_cefa ,_gfff ,"");};if _cefa =_dedd (_fgbde ,_cbed ,_cbed ,_dcca ,1,_aafd ,_dbcf );_cefa !=nil {return nil ,_f .Wrap (_cefa ,_gfff ,"\u0069\u006e\u0069t\u0069\u0061\u006c\u0020\u0070\u0075\u0073\u0068");};if _cefa =_dedd (_fgbde ,_cbed ,_cbed ,_dcca +1,-1,_aafd ,_dbcf );
_cefa !=nil {return nil ,_f .Wrap (_cefa ,_gfff ,"\u0032\u006ed\u0020\u0069\u006ei\u0074\u0069\u0061\u006c\u0020\u0070\u0075\u0073\u0068");};_dbcf .Min .X ,_dbcf .Max .X =_cbed ,_cbed ;_dbcf .Min .Y ,_dbcf .Max .Y =_dcca ,_dcca ;var (_ggab *fillSegment ;
_egdf int ;);for _fgbde .Len ()> 0{if _ggab ,_cefa =_bfaeg (_fgbde );_cefa !=nil {return nil ,_f .Wrap (_cefa ,_gfff ,"");};_dcca =_ggab ._babe ;for _cbed =_ggab ._aggb ;_cbed >=0&&_dad .GetPixel (_cbed ,_dcca );_cbed --{if _cefa =_dad .SetPixel (_cbed ,_dcca ,0);
_cefa !=nil {return nil ,_f .Wrap (_cefa ,_gfff ,"");};};if _cbed >=_ggab ._aggb {for _cbed ++;_cbed <=_ggab ._dabbg &&_cbed <=_fafa &&!_dad .GetPixel (_cbed ,_dcca );_cbed ++{};_egdf =_cbed ;if _cbed > _ggab ._dabbg ||_cbed > _fafa {continue ;};}else {_egdf =_cbed +1;
if _egdf < _ggab ._aggb -1{if _cefa =_dedd (_fgbde ,_egdf ,_ggab ._aggb -1,_ggab ._babe ,-_ggab ._dfabe ,_aafd ,_dbcf );_cefa !=nil {return nil ,_f .Wrap (_cefa ,_gfff ,"\u006c\u0065\u0061\u006b\u0020\u006f\u006e\u0020\u006c\u0065\u0066\u0074 \u0073\u0069\u0064\u0065");
};};_cbed =_ggab ._aggb +1;};for {for ;_cbed <=_fafa &&_dad .GetPixel (_cbed ,_dcca );_cbed ++{if _cefa =_dad .SetPixel (_cbed ,_dcca ,0);_cefa !=nil {return nil ,_f .Wrap (_cefa ,_gfff ,"\u0032n\u0064\u0020\u0073\u0065\u0074");};};if _cefa =_dedd (_fgbde ,_egdf ,_cbed -1,_ggab ._babe ,_ggab ._dfabe ,_aafd ,_dbcf );
_cefa !=nil {return nil ,_f .Wrap (_cefa ,_gfff ,"n\u006f\u0072\u006d\u0061\u006c\u0020\u0070\u0075\u0073\u0068");};if _cbed > _ggab ._dabbg +1{if _cefa =_dedd (_fgbde ,_ggab ._dabbg +1,_cbed -1,_ggab ._babe ,-_ggab ._dfabe ,_aafd ,_dbcf );_cefa !=nil {return nil ,_f .Wrap (_cefa ,_gfff ,"\u006ce\u0061k\u0020\u006f\u006e\u0020\u0072i\u0067\u0068t\u0020\u0073\u0069\u0064\u0065");
};};for _cbed ++;_cbed <=_ggab ._dabbg &&_cbed <=_fafa &&!_dad .GetPixel (_cbed ,_dcca );_cbed ++{};_egdf =_cbed ;if _cbed > _ggab ._dabbg ||_cbed > _fafa {break ;};};};_dbcf .Max .X ++;_dbcf .Max .Y ++;return _dbcf ,nil ;};func (_cbdc *Bitmap )resizeImageData (_ceab *Bitmap )error {if _ceab ==nil {return _f .Error ("\u0072e\u0073i\u007a\u0065\u0049\u006d\u0061\u0067\u0065\u0044\u0061\u0074\u0061","\u0073r\u0063 \u0069\u0073\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");
};if _cbdc .SizesEqual (_ceab ){return nil ;};_cbdc .Data =make ([]byte ,len (_ceab .Data ));_cbdc .Width =_ceab .Width ;_cbdc .Height =_ceab .Height ;_cbdc .RowStride =_ceab .RowStride ;return nil ;};type shift int ;func _gafdc (_eefe *Bitmap )(_fgee *Bitmap ,_fgcc int ,_bbcc error ){const _gadf ="\u0042i\u0074\u006d\u0061\u0070.\u0077\u006f\u0072\u0064\u004da\u0073k\u0042y\u0044\u0069\u006c\u0061\u0074\u0069\u006fn";
if _eefe ==nil {return nil ,0,_f .Errorf (_gadf ,"\u0027\u0073\u0027\u0020bi\u0074\u006d\u0061\u0070\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006ee\u0064");};var _aefd ,_eddbb *Bitmap ;if _aefd ,_bbcc =_bee (nil ,_eefe );_bbcc !=nil {return nil ,0,_f .Wrap (_bbcc ,_gadf ,"\u0063\u006f\u0070\u0079\u0020\u0027\u0073\u0027");
};var (_eddef [13]int ;_gbgef ,_egbg int ;);_efaaa :=12;_ceca :=_ed .NewNumSlice (_efaaa +1);_bcb :=_ed .NewNumSlice (_efaaa +1);var _eedd *Boxes ;for _eefc :=0;_eefc <=_efaaa ;_eefc ++{if _eefc ==0{if _eddbb ,_bbcc =_bee (nil ,_aefd );_bbcc !=nil {return nil ,0,_f .Wrap (_bbcc ,_gadf ,"\u0066i\u0072\u0073\u0074\u0020\u0062\u006d2");
};}else {if _eddbb ,_bbcc =_feabc (_aefd ,MorphProcess {Operation :MopDilation ,Arguments :[]int {2,1}});_bbcc !=nil {return nil ,0,_f .Wrap (_bbcc ,_gadf ,"\u0064\u0069\u006ca\u0074\u0069\u006f\u006e\u0020\u0062\u006d\u0032");};};if _eedd ,_bbcc =_eddbb .connComponentsBB (4);
_bbcc !=nil {return nil ,0,_f .Wrap (_bbcc ,_gadf ,"");};_eddef [_eefc ]=len (*_eedd );_ceca .AddInt (_eddef [_eefc ]);switch _eefc {case 0:_gbgef =_eddef [0];default:_egbg =_eddef [_eefc -1]-_eddef [_eefc ];_bcb .AddInt (_egbg );};_aefd =_eddbb ;};_efc :=true ;
_bdd :=2;var _abef ,_gdgd int ;for _acebd :=1;_acebd < len (*_bcb );_acebd ++{if _abef ,_bbcc =_ceca .GetInt (_acebd );_bbcc !=nil {return nil ,0,_f .Wrap (_bbcc ,_gadf ,"\u0043\u0068\u0065\u0063ki\u006e\u0067\u0020\u0062\u0065\u0073\u0074\u0020\u0064\u0069\u006c\u0061\u0074\u0069o\u006e");
};if _efc &&_abef < int (0.3*float32 (_gbgef )){_bdd =_acebd +1;_efc =false ;};if _egbg ,_bbcc =_bcb .GetInt (_acebd );_bbcc !=nil {return nil ,0,_f .Wrap (_bbcc ,_gadf ,"\u0067\u0065\u0074\u0074\u0069\u006e\u0067\u0020\u006ea\u0044\u0069\u0066\u0066");
};if _egbg > _gdgd {_gdgd =_egbg ;};};_fgec :=_eefe .XResolution ;if _fgec ==0{_fgec =150;};if _fgec > 110{_bdd ++;};if _bdd < 2{_abc .Log .Trace ("J\u0042\u0049\u0047\u0032\u0020\u0073\u0065\u0074\u0074\u0069\u006e\u0067\u0020\u0069\u0042\u0065\u0073\u0074 \u0074\u006f\u0020\u006d\u0069\u006e\u0069\u006d\u0075\u006d a\u006c\u006c\u006fw\u0061b\u006c\u0065");
_bdd =2;};_fgcc =_bdd +1;if _fgee ,_bbcc =_cdaf (nil ,_eefe ,_bdd +1,1);_bbcc !=nil {return nil ,0,_f .Wrap (_bbcc ,_gadf ,"\u0067\u0065\u0074\u0074in\u0067\u0020\u006d\u0061\u0073\u006b\u0020\u0066\u0061\u0069\u006c\u0065\u0064");};return _fgee ,_fgcc ,nil ;
};func _cdaf (_bgfc ,_eagcf *Bitmap ,_fbaa ,_ebae int )(*Bitmap ,error ){const _eeee ="\u0063\u006c\u006f\u0073\u0065\u0042\u0072\u0069\u0063\u006b";if _eagcf ==nil {return nil ,_f .Error (_eeee ,"\u0073o\u0075r\u0063\u0065\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");
};if _fbaa < 1||_ebae < 1{return nil ,_f .Error (_eeee ,"\u0068S\u0069\u007a\u0065\u0020\u0061\u006e\u0064\u0020\u0076\u0053\u0069z\u0065\u0020\u006e\u006f\u0074\u0020\u003e\u003d\u0020\u0031");};if _fbaa ==1&&_ebae ==1{return _eagcf .Copy (),nil ;};if _fbaa ==1||_ebae ==1{_agdf :=SelCreateBrick (_ebae ,_fbaa ,_ebae /2,_fbaa /2,SelHit );
var _bcbd error ;_bgfc ,_bcbd =_bcfe (_bgfc ,_eagcf ,_agdf );if _bcbd !=nil {return nil ,_f .Wrap (_bcbd ,_eeee ,"\u0068S\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u007c\u007c \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");};
return _bgfc ,nil ;};_ebge :=SelCreateBrick (1,_fbaa ,0,_fbaa /2,SelHit );_ggedc :=SelCreateBrick (_ebae ,1,_ebae /2,0,SelHit );_cccag ,_gabe :=_faad (nil ,_eagcf ,_ebge );if _gabe !=nil {return nil ,_f .Wrap (_gabe ,_eeee ,"\u0031\u0073\u0074\u0020\u0064\u0069\u006c\u0061\u0074\u0065");
};if _bgfc ,_gabe =_faad (_bgfc ,_cccag ,_ggedc );_gabe !=nil {return nil ,_f .Wrap (_gabe ,_eeee ,"\u0032\u006e\u0064\u0020\u0064\u0069\u006c\u0061\u0074\u0065");};if _ ,_gabe =_acaab (_cccag ,_bgfc ,_ebge );_gabe !=nil {return nil ,_f .Wrap (_gabe ,_eeee ,"\u0031s\u0074\u0020\u0065\u0072\u006f\u0064e");
};if _ ,_gabe =_acaab (_bgfc ,_cccag ,_ggedc );_gabe !=nil {return nil ,_f .Wrap (_gabe ,_eeee ,"\u0032n\u0064\u0020\u0065\u0072\u006f\u0064e");};return _bgfc ,nil ;};func TstWSymbol (t *_c .T ,scale ...int )*Bitmap {_ffca ,_eacg :=NewWithData (5,5,[]byte {0x88,0x88,0xA8,0xD8,0x88});
_d .NoError (t ,_eacg );return TstGetScaledSymbol (t ,_ffca ,scale ...);};func _bffd (_afff ,_cceg *Bitmap ,_gfgb ,_edec int )(*Bitmap ,error ){const _dbca ="\u0063\u006c\u006f\u0073\u0065\u0053\u0061\u0066\u0065B\u0072\u0069\u0063\u006b";if _cceg ==nil {return nil ,_f .Error (_dbca ,"\u0073\u006f\u0075\u0072\u0063\u0065\u0020\u0069\u0073\u0020\u006e\u0069\u006c");
};if _gfgb < 1||_edec < 1{return nil ,_f .Error (_dbca ,"\u0068s\u0069\u007a\u0065\u0020\u0061\u006e\u0064\u0020\u0076\u0073\u0069z\u0065\u0020\u006e\u006f\u0074\u0020\u003e\u003d\u0020\u0031");};if _gfgb ==1&&_edec ==1{return _bee (_afff ,_cceg );};if MorphBC ==SymmetricMorphBC {_fdba ,_ffdd :=_cdaf (_afff ,_cceg ,_gfgb ,_edec );
if _ffdd !=nil {return nil ,_f .Wrap (_ffdd ,_dbca ,"\u0053\u0079m\u006d\u0065\u0074r\u0069\u0063\u004d\u006f\u0072\u0070\u0068\u0042\u0043");};return _fdba ,nil ;};_aecg :=_cce (_gfgb /2,_edec /2);_cfaeb :=8*((_aecg +7)/8);_acaa ,_bbaf :=_cceg .AddBorder (_cfaeb ,0);
if _bbaf !=nil {return nil ,_f .Wrapf (_bbaf ,_dbca ,"\u0042\u006f\u0072\u0064\u0065\u0072\u0053\u0069\u007ae\u003a\u0020\u0025\u0064",_cfaeb );};var _faacg ,_gbgec *Bitmap ;if _gfgb ==1||_edec ==1{_bbg :=SelCreateBrick (_edec ,_gfgb ,_edec /2,_gfgb /2,SelHit );
_faacg ,_bbaf =_bcfe (nil ,_acaa ,_bbg );if _bbaf !=nil {return nil ,_f .Wrap (_bbaf ,_dbca ,"\u0068S\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u007c\u007c \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");};}else {_eggc :=SelCreateBrick (1,_gfgb ,0,_gfgb /2,SelHit );
_bacb ,_bdbag :=_faad (nil ,_acaa ,_eggc );if _bdbag !=nil {return nil ,_f .Wrap (_bdbag ,_dbca ,"\u0072\u0065\u0067\u0075la\u0072\u0020\u002d\u0020\u0066\u0069\u0072\u0073\u0074\u0020\u0064\u0069\u006c\u0061t\u0065");};_dfab :=SelCreateBrick (_edec ,1,_edec /2,0,SelHit );
_faacg ,_bdbag =_faad (nil ,_bacb ,_dfab );if _bdbag !=nil {return nil ,_f .Wrap (_bdbag ,_dbca ,"\u0072\u0065\u0067ul\u0061\u0072\u0020\u002d\u0020\u0073\u0065\u0063\u006f\u006e\u0064\u0020\u0064\u0069\u006c\u0061\u0074\u0065");};if _ ,_bdbag =_acaab (_bacb ,_faacg ,_eggc );
_bdbag !=nil {return nil ,_f .Wrap (_bdbag ,_dbca ,"r\u0065\u0067\u0075\u006car\u0020-\u0020\u0066\u0069\u0072\u0073t\u0020\u0065\u0072\u006f\u0064\u0065");};if _ ,_bdbag =_acaab (_faacg ,_bacb ,_dfab );_bdbag !=nil {return nil ,_f .Wrap (_bdbag ,_dbca ,"\u0072\u0065\u0067\u0075la\u0072\u0020\u002d\u0020\u0073\u0065\u0063\u006f\u006e\u0064\u0020\u0065\u0072\u006fd\u0065");
};};if _gbgec ,_bbaf =_faacg .RemoveBorder (_cfaeb );_bbaf !=nil {return nil ,_f .Wrap (_bbaf ,_dbca ,"\u0072e\u0067\u0075\u006c\u0061\u0072");};if _afff ==nil {return _gbgec ,nil ;};if _ ,_bbaf =_bee (_afff ,_gbgec );_bbaf !=nil {return nil ,_bbaf ;};
return _afff ,nil ;};func (_fabg *Bitmaps )Size ()int {return len (_fabg .Values )};func (_cdge *byWidth )Len ()int {return len (_cdge .Values )};type Component int ;func (_fdgc *ClassedPoints )YAtIndex (i int )float32 {return (*_fdgc .Points )[_fdgc .IntSlice [i ]].Y };
func (_cbef *Bitmap )thresholdPixelSum (_ffgc int )bool {var (_ecga int ;_eeac uint8 ;_affbe byte ;_gdac int ;);_abb :=_cbef .RowStride ;_gdcc :=uint (_cbef .Width &0x07);if _gdcc !=0{_eeac =uint8 ((0xff<<(8-_gdcc ))&0xff);_abb --;};for _eed :=0;_eed < _cbef .Height ;
_eed ++{for _gdac =0;_gdac < _abb ;_gdac ++{_affbe =_cbef .Data [_eed *_cbef .RowStride +_gdac ];_ecga +=int (_bgd [_affbe ]);};if _gdcc !=0{_affbe =_cbef .Data [_eed *_cbef .RowStride +_gdac ]&_eeac ;_ecga +=int (_bgd [_affbe ]);};if _ecga > _ffgc {return true ;
};};return false ;};func TstAddSymbol (t *_c .T ,bms *Bitmaps ,sym *Bitmap ,x *int ,y int ,space int ){bms .AddBitmap (sym );_dadg :=_ab .Rect (*x ,y ,*x +sym .Width ,y +sym .Height );bms .AddBox (&_dadg );*x +=sym .Width +space ;};func NewClassedPoints (points *Points ,classes _ed .IntSlice )(*ClassedPoints ,error ){const _cega ="\u004e\u0065w\u0043\u006c\u0061s\u0073\u0065\u0064\u0050\u006f\u0069\u006e\u0074\u0073";
if points ==nil {return nil ,_f .Error (_cega ,"\u0070\u0072\u006f\u0076id\u0065\u0064\u0020\u006e\u0069\u006c\u0020\u0070\u006f\u0069\u006e\u0074\u0073");};if classes ==nil {return nil ,_f .Error (_cega ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0063\u006c\u0061ss\u0065\u0073");
};_cbdf :=&ClassedPoints {Points :points ,IntSlice :classes };if _abdd :=_cbdf .validateIntSlice ();_abdd !=nil {return nil ,_f .Wrap (_abdd ,_cega ,"");};return _cbdf ,nil ;};type SelectionValue int ;func CombineBytes (oldByte ,newByte byte ,op CombinationOperator )byte {return _bfb (oldByte ,newByte ,op );
};func (_befe *Bitmaps )makeSizeIndicator (_cadff ,_cbda int ,_cfebbb LocationFilter ,_ggcdg SizeComparison )(_dfdeb *_ed .NumSlice ,_ecgac error ){const _dbeg ="\u0042i\u0074\u006d\u0061\u0070s\u002e\u006d\u0061\u006b\u0065S\u0069z\u0065I\u006e\u0064\u0069\u0063\u0061\u0074\u006fr";
if _befe ==nil {return nil ,_f .Error (_dbeg ,"\u0062\u0069\u0074ma\u0070\u0073\u0020\u0027\u0062\u0027\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};switch _cfebbb {case LocSelectWidth ,LocSelectHeight ,LocSelectIfEither ,LocSelectIfBoth :default:return nil ,_f .Errorf (_dbeg ,"\u0070\u0072\u006f\u0076\u0069d\u0065\u0064\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006c\u006fc\u0061\u0074\u0069\u006f\u006e\u0020\u0066\u0069\u006c\u0074\u0065\u0072\u0020\u0074\u0079\u0070\u0065\u003a\u0020\u0025\u0064",_cfebbb );
};switch _ggcdg {case SizeSelectIfLT ,SizeSelectIfGT ,SizeSelectIfLTE ,SizeSelectIfGTE ,SizeSelectIfEQ :default:return nil ,_f .Errorf (_dbeg ,"\u0069\u006e\u0076\u0061li\u0064\u0020\u0072\u0065\u006c\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0027\u0025d\u0027",_ggcdg );
};_dfdeb =&_ed .NumSlice {};var (_cfdef ,_dbbe ,_deaa int ;_dbccd *Bitmap ;);for _ ,_dbccd =range _befe .Values {_cfdef =0;_dbbe ,_deaa =_dbccd .Width ,_dbccd .Height ;switch _cfebbb {case LocSelectWidth :if (_ggcdg ==SizeSelectIfLT &&_dbbe < _cadff )||(_ggcdg ==SizeSelectIfGT &&_dbbe > _cadff )||(_ggcdg ==SizeSelectIfLTE &&_dbbe <=_cadff )||(_ggcdg ==SizeSelectIfGTE &&_dbbe >=_cadff )||(_ggcdg ==SizeSelectIfEQ &&_dbbe ==_cadff ){_cfdef =1;
};case LocSelectHeight :if (_ggcdg ==SizeSelectIfLT &&_deaa < _cbda )||(_ggcdg ==SizeSelectIfGT &&_deaa > _cbda )||(_ggcdg ==SizeSelectIfLTE &&_deaa <=_cbda )||(_ggcdg ==SizeSelectIfGTE &&_deaa >=_cbda )||(_ggcdg ==SizeSelectIfEQ &&_deaa ==_cbda ){_cfdef =1;
};case LocSelectIfEither :if (_ggcdg ==SizeSelectIfLT &&(_dbbe < _cadff ||_deaa < _cbda ))||(_ggcdg ==SizeSelectIfGT &&(_dbbe > _cadff ||_deaa > _cbda ))||(_ggcdg ==SizeSelectIfLTE &&(_dbbe <=_cadff ||_deaa <=_cbda ))||(_ggcdg ==SizeSelectIfGTE &&(_dbbe >=_cadff ||_deaa >=_cbda ))||(_ggcdg ==SizeSelectIfEQ &&(_dbbe ==_cadff ||_deaa ==_cbda )){_cfdef =1;
};case LocSelectIfBoth :if (_ggcdg ==SizeSelectIfLT &&(_dbbe < _cadff &&_deaa < _cbda ))||(_ggcdg ==SizeSelectIfGT &&(_dbbe > _cadff &&_deaa > _cbda ))||(_ggcdg ==SizeSelectIfLTE &&(_dbbe <=_cadff &&_deaa <=_cbda ))||(_ggcdg ==SizeSelectIfGTE &&(_dbbe >=_cadff &&_deaa >=_cbda ))||(_ggcdg ==SizeSelectIfEQ &&(_dbbe ==_cadff &&_deaa ==_cbda )){_cfdef =1;
};};_dfdeb .AddInt (_cfdef );};return _dfdeb ,nil ;};func _cc (_bd *Bitmap ,_bbc int )(*Bitmap ,error ){const _aeb ="\u0065x\u0070a\u006e\u0064\u0042\u0069\u006ea\u0072\u0079P\u006f\u0077\u0065\u0072\u0032";if _bd ==nil {return nil ,_f .Error (_aeb ,"\u0073o\u0075r\u0063\u0065\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");
};if _bbc ==1{return _bee (nil ,_bd );};if _bbc !=2&&_bbc !=4&&_bbc !=8{return nil ,_f .Error (_aeb ,"\u0066\u0061\u0063t\u006f\u0072\u0020\u006du\u0073\u0074\u0020\u0062\u0065\u0020\u0069n\u0020\u007b\u0032\u002c\u0034\u002c\u0038\u007d\u0020\u0072\u0061\u006e\u0067\u0065");
};_dceg :=_bbc *_bd .Width ;_bag :=_bbc *_bd .Height ;_af :=New (_dceg ,_bag );var _efd error ;switch _bbc {case 2:_efd =_acb (_af ,_bd );case 4:_efd =_ede (_af ,_bd );case 8:_efd =_da (_af ,_bd );};if _efd !=nil {return nil ,_f .Wrap (_efd ,_aeb ,"");
};return _af ,nil ;};type BitmapsArray struct{Values []*Bitmaps ;Boxes []*_ab .Rectangle ;};func (_bfbg *BitmapsArray )GetBox (i int )(*_ab .Rectangle ,error ){const _aadb ="\u0042\u0069\u0074\u006dap\u0073\u0041\u0072\u0072\u0061\u0079\u002e\u0047\u0065\u0074\u0042\u006f\u0078";
if _bfbg ==nil {return nil ,_f .Error (_aadb ,"p\u0072\u006f\u0076\u0069\u0064\u0065d\u0020\u006e\u0069\u006c\u0020\u0027\u0042\u0069\u0074m\u0061\u0070\u0073A\u0072r\u0061\u0079\u0027");};if i > len (_bfbg .Boxes )-1{return nil ,_f .Errorf (_aadb ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};return _bfbg .Boxes [i ],nil ;};func _bec (_daf *Bitmap ,_bbde ,_bgee int ,_dbd ,_cfga int ,_beeg RasterOperator ){var (_fdce int ;_gfcdg byte ;_faegc ,_bdgcc int ;_ebbce int ;);_fdga :=_dbd >>3;_bbaa :=_dbd &7;if _bbaa > 0{_gfcdg =_abfdd [_bbaa ];};
_fdce =_daf .RowStride *_bgee +(_bbde >>3);switch _beeg {case PixClr :for _faegc =0;_faegc < _cfga ;_faegc ++{_ebbce =_fdce +_faegc *_daf .RowStride ;for _bdgcc =0;_bdgcc < _fdga ;_bdgcc ++{_daf .Data [_ebbce ]=0x0;_ebbce ++;};if _bbaa > 0{_daf .Data [_ebbce ]=_egbbc (_daf .Data [_ebbce ],0x0,_gfcdg );
};};case PixSet :for _faegc =0;_faegc < _cfga ;_faegc ++{_ebbce =_fdce +_faegc *_daf .RowStride ;for _bdgcc =0;_bdgcc < _fdga ;_bdgcc ++{_daf .Data [_ebbce ]=0xff;_ebbce ++;};if _bbaa > 0{_daf .Data [_ebbce ]=_egbbc (_daf .Data [_ebbce ],0xff,_gfcdg );
};};case PixNotDst :for _faegc =0;_faegc < _cfga ;_faegc ++{_ebbce =_fdce +_faegc *_daf .RowStride ;for _bdgcc =0;_bdgcc < _fdga ;_bdgcc ++{_daf .Data [_ebbce ]=^_daf .Data [_ebbce ];_ebbce ++;};if _bbaa > 0{_daf .Data [_ebbce ]=_egbbc (_daf .Data [_ebbce ],^_daf .Data [_ebbce ],_gfcdg );
};};};};func (_gdabf *Bitmaps )GroupByWidth ()(*BitmapsArray ,error ){const _dede ="\u0047\u0072\u006fu\u0070\u0042\u0079\u0057\u0069\u0064\u0074\u0068";if len (_gdabf .Values )==0{return nil ,_f .Error (_dede ,"\u006eo\u0020v\u0061\u006c\u0075\u0065\u0073 \u0070\u0072o\u0076\u0069\u0064\u0065\u0064");
};_dbdb :=&BitmapsArray {};_gdabf .SortByWidth ();_cddbg :=-1;_faeb :=-1;for _dbcc :=0;_dbcc < len (_gdabf .Values );_dbcc ++{_affa :=_gdabf .Values [_dbcc ].Width ;if _affa > _cddbg {_cddbg =_affa ;_faeb ++;_dbdb .Values =append (_dbdb .Values ,&Bitmaps {});
};_dbdb .Values [_faeb ].AddBitmap (_gdabf .Values [_dbcc ]);};return _dbdb ,nil ;};func _bfaeg (_cedd *_ed .Stack )(_cbcdc *fillSegment ,_fgeeb error ){const _eecff ="\u0070\u006f\u0070\u0046\u0069\u006c\u006c\u0053\u0065g\u006d\u0065\u006e\u0074";if _cedd ==nil {return nil ,_f .Error (_eecff ,"\u006ei\u006c \u0073\u0074\u0061\u0063\u006b \u0070\u0072o\u0076\u0069\u0064\u0065\u0064");
};if _cedd .Aux ==nil {return nil ,_f .Error (_eecff ,"a\u0075x\u0053\u0074\u0061\u0063\u006b\u0020\u006e\u006ft\u0020\u0064\u0065\u0066in\u0065\u0064");};_bbdf ,_gfgf :=_cedd .Pop ();if !_gfgf {return nil ,nil ;};_eefcf ,_gfgf :=_bbdf .(*fillSegment );
if !_gfgf {return nil ,_f .Error (_eecff ,"\u0073\u0074\u0061ck\u0020\u0064\u006f\u0065\u0073\u006e\u0027\u0074\u0020c\u006fn\u0074a\u0069n\u0020\u002a\u0066\u0069\u006c\u006c\u0053\u0065\u0067\u006d\u0065\u006e\u0074");};_cbcdc =&fillSegment {_eefcf ._aggb ,_eefcf ._dabbg ,_eefcf ._babe +_eefcf ._dfabe ,_eefcf ._dfabe };
_cedd .Aux .Push (_eefcf );return _cbcdc ,nil ;};const (AsymmetricMorphBC BoundaryCondition =iota ;SymmetricMorphBC ;);type Bitmaps struct{Values []*Bitmap ;Boxes []*_ab .Rectangle ;};func (_gabb *Boxes )selectWithIndicator (_eegef *_ed .NumSlice )(_cfac *Boxes ,_gdfe error ){const _ebda ="\u0042o\u0078\u0065\u0073\u002es\u0065\u006c\u0065\u0063\u0074W\u0069t\u0068I\u006e\u0064\u0069\u0063\u0061\u0074\u006fr";
if _gabb ==nil {return nil ,_f .Error (_ebda ,"b\u006f\u0078\u0065\u0073 '\u0062'\u0020\u006e\u006f\u0074\u0020d\u0065\u0066\u0069\u006e\u0065\u0064");};if _eegef ==nil {return nil ,_f .Error (_ebda ,"\u0027\u006ea\u0027\u0020\u006eo\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};if len (*_eegef )!=len (*_gabb ){return nil ,_f .Error (_ebda ,"\u0062\u006f\u0078\u0065\u0073\u0020\u0027\u0062\u0027\u0020\u0068\u0061\u0073\u0020\u0064\u0069\u0066\u0066\u0065\u0072\u0065\u006e\u0074\u0020s\u0069\u007a\u0065\u0020\u0074h\u0061\u006e \u0027\u006e\u0061\u0027");
};var _fbc ,_cadb int ;for _cadf :=0;_cadf < len (*_eegef );_cadf ++{if _fbc ,_gdfe =_eegef .GetInt (_cadf );_gdfe !=nil {return nil ,_f .Wrap (_gdfe ,_ebda ,"\u0063\u0068\u0065\u0063\u006b\u0069\u006e\u0067\u0020c\u006f\u0075\u006e\u0074");};if _fbc ==1{_cadb ++;
};};if _cadb ==len (*_gabb ){return _gabb ,nil ;};_eddbd :=Boxes {};for _ccca :=0;_ccca < len (*_eegef );_ccca ++{_fbc =int ((*_eegef )[_ccca ]);if _fbc ==0{continue ;};_eddbd =append (_eddbd ,(*_gabb )[_ccca ]);};_cfac =&_eddbd ;return _cfac ,nil ;};func CorrelationScoreThresholded (bm1 ,bm2 *Bitmap ,area1 ,area2 int ,delX ,delY float32 ,maxDiffW ,maxDiffH int ,tab ,downcount []int ,scoreThreshold float32 )(bool ,error ){const _gebg ="C\u006f\u0072\u0072\u0065\u006c\u0061t\u0069\u006f\u006e\u0053\u0063\u006f\u0072\u0065\u0054h\u0072\u0065\u0073h\u006fl\u0064\u0065\u0064";
if bm1 ==nil {return false ,_f .Error (_gebg ,"\u0063\u006f\u0072\u0072\u0065\u006c\u0061\u0074\u0069\u006f\u006e\u0053\u0063\u006f\u0072\u0065\u0054\u0068\u0072\u0065\u0073\u0068\u006f\u006cd\u0065\u0064\u0020\u0062\u006d1\u0020\u0069s\u0020\u006e\u0069\u006c");
};if bm2 ==nil {return false ,_f .Error (_gebg ,"\u0063\u006f\u0072\u0072\u0065\u006c\u0061\u0074\u0069\u006f\u006e\u0053\u0063\u006f\u0072\u0065\u0054\u0068\u0072\u0065\u0073\u0068\u006f\u006cd\u0065\u0064\u0020\u0062\u006d2\u0020\u0069s\u0020\u006e\u0069\u006c");
};if area1 <=0||area2 <=0{return false ,_f .Error (_gebg ,"c\u006f\u0072\u0072\u0065\u006c\u0061\u0074\u0069\u006fn\u0053\u0063\u006f\u0072\u0065\u0054\u0068re\u0073\u0068\u006f\u006cd\u0065\u0064\u0020\u002d\u0020\u0061\u0072\u0065\u0061s \u006d\u0075s\u0074\u0020\u0062\u0065\u0020\u003e\u0020\u0030");
};if downcount ==nil {return false ,_f .Error (_gebg ,"\u0070\u0072\u006fvi\u0064\u0065\u0064\u0020\u006e\u006f\u0020\u0027\u0064\u006f\u0077\u006e\u0063\u006f\u0075\u006e\u0074\u0027");};if tab ==nil {return false ,_f .Error (_gebg ,"p\u0072\u006f\u0076\u0069de\u0064 \u006e\u0069\u006c\u0020\u0027s\u0075\u006d\u0074\u0061\u0062\u0027");
};_abfe ,_bgde :=bm1 .Width ,bm1 .Height ;_ccf ,_fbfa :=bm2 .Width ,bm2 .Height ;if _ed .Abs (_abfe -_ccf )> maxDiffW {return false ,nil ;};if _ed .Abs (_bgde -_fbfa )> maxDiffH {return false ,nil ;};_cdea :=int (delX +_ed .Sign (delX )*0.5);_bebb :=int (delY +_ed .Sign (delY )*0.5);
_eeb :=int (_ac .Ceil (_ac .Sqrt (float64 (scoreThreshold )*float64 (area1 )*float64 (area2 ))));_dcd :=bm2 .RowStride ;_deba :=_cce (_bebb ,0);_dcbac :=_gffc (_fbfa +_bebb ,_bgde );_geac :=bm1 .RowStride *_deba ;_efg :=bm2 .RowStride *(_deba -_bebb );
var _ecfe int ;if _dcbac <=_bgde {_ecfe =downcount [_dcbac -1];};_eacdb :=_cce (_cdea ,0);_accb :=_gffc (_ccf +_cdea ,_abfe );var _fddf ,_bade int ;if _cdea >=8{_fddf =_cdea >>3;_geac +=_fddf ;_eacdb -=_fddf <<3;_accb -=_fddf <<3;_cdea &=7;}else if _cdea <=-8{_bade =-((_cdea +7)>>3);
_efg +=_bade ;_dcd -=_bade ;_cdea +=_bade <<3;};var (_acgd ,_gdfg ,_aaga int ;_egbd ,_egd ,_dfed byte ;);if _eacdb >=_accb ||_deba >=_dcbac {return false ,nil ;};_defge :=(_accb +7)>>3;switch {case _cdea ==0:for _gdfg =_deba ;_gdfg < _dcbac ;_gdfg ,_geac ,_efg =_gdfg +1,_geac +bm1 .RowStride ,_efg +bm2 .RowStride {for _aaga =0;
_aaga < _defge ;_aaga ++{_egbd =bm1 .Data [_geac +_aaga ]&bm2 .Data [_efg +_aaga ];_acgd +=tab [_egbd ];};if _acgd >=_eeb {return true ,nil ;};if _fgbd :=_acgd +downcount [_gdfg ]-_ecfe ;_fgbd < _eeb {return false ,nil ;};};case _cdea > 0&&_dcd < _defge :for _gdfg =_deba ;
_gdfg < _dcbac ;_gdfg ,_geac ,_efg =_gdfg +1,_geac +bm1 .RowStride ,_efg +bm2 .RowStride {_egd =bm1 .Data [_geac ];_dfed =bm2 .Data [_efg ]>>uint (_cdea );_egbd =_egd &_dfed ;_acgd +=tab [_egbd ];for _aaga =1;_aaga < _dcd ;_aaga ++{_egd =bm1 .Data [_geac +_aaga ];
_dfed =bm2 .Data [_efg +_aaga ]>>uint (_cdea )|bm2 .Data [_efg +_aaga -1]<<uint (8-_cdea );_egbd =_egd &_dfed ;_acgd +=tab [_egbd ];};_egd =bm1 .Data [_geac +_aaga ];_dfed =bm2 .Data [_efg +_aaga -1]<<uint (8-_cdea );_egbd =_egd &_dfed ;_acgd +=tab [_egbd ];
if _acgd >=_eeb {return true ,nil ;}else if _acgd +downcount [_gdfg ]-_ecfe < _eeb {return false ,nil ;};};case _cdea > 0&&_dcd >=_defge :for _gdfg =_deba ;_gdfg < _dcbac ;_gdfg ,_geac ,_efg =_gdfg +1,_geac +bm1 .RowStride ,_efg +bm2 .RowStride {_egd =bm1 .Data [_geac ];
_dfed =bm2 .Data [_efg ]>>uint (_cdea );_egbd =_egd &_dfed ;_acgd +=tab [_egbd ];for _aaga =1;_aaga < _defge ;_aaga ++{_egd =bm1 .Data [_geac +_aaga ];_dfed =bm2 .Data [_efg +_aaga ]>>uint (_cdea );_dfed |=bm2 .Data [_efg +_aaga -1]<<uint (8-_cdea );_egbd =_egd &_dfed ;
_acgd +=tab [_egbd ];};if _acgd >=_eeb {return true ,nil ;}else if _acgd +downcount [_gdfg ]-_ecfe < _eeb {return false ,nil ;};};case _defge < _dcd :for _gdfg =_deba ;_gdfg < _dcbac ;_gdfg ,_geac ,_efg =_gdfg +1,_geac +bm1 .RowStride ,_efg +bm2 .RowStride {for _aaga =0;
_aaga < _defge ;_aaga ++{_egd =bm1 .Data [_geac +_aaga ];_dfed =bm2 .Data [_efg +_aaga ]<<uint (-_cdea );_dfed |=bm2 .Data [_efg +_aaga +1]>>uint (8+_cdea );_egbd =_egd &_dfed ;_acgd +=tab [_egbd ];};if _acgd >=_eeb {return true ,nil ;}else if _bef :=_acgd +downcount [_gdfg ]-_ecfe ;
_bef < _eeb {return false ,nil ;};};case _dcd >=_defge :for _gdfg =_deba ;_gdfg < _dcbac ;_gdfg ,_geac ,_efg =_gdfg +1,_geac +bm1 .RowStride ,_efg +bm2 .RowStride {for _aaga =0;_aaga < _defge ;_aaga ++{_egd =bm1 .Data [_geac +_aaga ];_dfed =bm2 .Data [_efg +_aaga ]<<uint (-_cdea );
_dfed |=bm2 .Data [_efg +_aaga +1]>>uint (8+_cdea );_egbd =_egd &_dfed ;_acgd +=tab [_egbd ];};_egd =bm1 .Data [_geac +_aaga ];_dfed =bm2 .Data [_efg +_aaga ]<<uint (-_cdea );_egbd =_egd &_dfed ;_acgd +=tab [_egbd ];if _acgd >=_eeb {return true ,nil ;}else if _acgd +downcount [_gdfg ]-_ecfe < _eeb {return false ,nil ;
};};};_cfaef :=float32 (_acgd )*float32 (_acgd )/(float32 (area1 )*float32 (area2 ));if _cfaef >=scoreThreshold {_abc .Log .Trace ("\u0063\u006f\u0075\u006e\u0074\u003a\u0020\u0025\u0064\u0020\u003c\u0020\u0074\u0068\u0072\u0065\u0073\u0068\u006f\u006cd\u0020\u0025\u0064\u0020\u0062\u0075\u0074\u0020\u0073c\u006f\u0072\u0065\u0020\u0025\u0066\u0020\u003e\u003d\u0020\u0073\u0063\u006fr\u0065\u0054\u0068\u0072\u0065\u0073h\u006f\u006c\u0064 \u0025\u0066",_acgd ,_eeb ,_cfaef ,scoreThreshold );
};return false ,nil ;};func (_dafd *Selection )findMaxTranslations ()(_gcca ,_caed ,_agag ,_ecgb int ){for _ccdd :=0;_ccdd < _dafd .Height ;_ccdd ++{for _aeac :=0;_aeac < _dafd .Width ;_aeac ++{if _dafd .Data [_ccdd ][_aeac ]==SelHit {_gcca =_cce (_gcca ,_dafd .Cx -_aeac );
_caed =_cce (_caed ,_dafd .Cy -_ccdd );_agag =_cce (_agag ,_aeac -_dafd .Cx );_ecgb =_cce (_ecgb ,_ccdd -_dafd .Cy );};};};return _gcca ,_caed ,_agag ,_ecgb ;};func _ceeb (_fdea ,_bege *Bitmap ,_bbbc ,_gafcc int )(_edabf error ){const _bggb ="\u0073e\u0065d\u0066\u0069\u006c\u006c\u0042i\u006e\u0061r\u0079\u004c\u006f\u0077\u0038";
var (_gecf ,_ffde ,_ggbc ,_afbd int ;_bdec ,_aefde ,_dedad ,_aacg ,_cgbf ,_agcb ,_ebce ,_bbcbd byte ;);for _gecf =0;_gecf < _bbbc ;_gecf ++{_ggbc =_gecf *_fdea .RowStride ;_afbd =_gecf *_bege .RowStride ;for _ffde =0;_ffde < _gafcc ;_ffde ++{if _bdec ,_edabf =_fdea .GetByte (_ggbc +_ffde );
_edabf !=nil {return _f .Wrap (_edabf ,_bggb ,"\u0067e\u0074 \u0073\u006f\u0075\u0072\u0063\u0065\u0020\u0062\u0079\u0074\u0065");};if _aefde ,_edabf =_bege .GetByte (_afbd +_ffde );_edabf !=nil {return _f .Wrap (_edabf ,_bggb ,"\u0067\u0065\u0074\u0020\u006d\u0061\u0073\u006b\u0020\u0062\u0079\u0074\u0065");
};if _gecf > 0{if _dedad ,_edabf =_fdea .GetByte (_ggbc -_fdea .RowStride +_ffde );_edabf !=nil {return _f .Wrap (_edabf ,_bggb ,"\u0069\u0020\u003e\u0020\u0030\u0020\u0062\u0079\u0074\u0065");};_bdec |=_dedad |(_dedad <<1)|(_dedad >>1);if _ffde > 0{if _bbcbd ,_edabf =_fdea .GetByte (_ggbc -_fdea .RowStride +_ffde -1);
_edabf !=nil {return _f .Wrap (_edabf ,_bggb ,"\u0069\u0020\u003e\u00200 \u0026\u0026\u0020\u006a\u0020\u003e\u0020\u0030\u0020\u0062\u0079\u0074\u0065");};_bdec |=_bbcbd <<7;};if _ffde < _gafcc -1{if _bbcbd ,_edabf =_fdea .GetByte (_ggbc -_fdea .RowStride +_ffde +1);
_edabf !=nil {return _f .Wrap (_edabf ,_bggb ,"\u006a\u0020<\u0020\u0077\u0070l\u0020\u002d\u0020\u0031\u0020\u0062\u0079\u0074\u0065");};_bdec |=_bbcbd >>7;};};if _ffde > 0{if _aacg ,_edabf =_fdea .GetByte (_ggbc +_ffde -1);_edabf !=nil {return _f .Wrap (_edabf ,_bggb ,"\u006a\u0020\u003e \u0030");
};_bdec |=_aacg <<7;};_bdec &=_aefde ;if _bdec ==0||^_bdec ==0{if _edabf =_fdea .SetByte (_ggbc +_ffde ,_bdec );_edabf !=nil {return _f .Wrap (_edabf ,_bggb ,"\u0073e\u0074t\u0069\u006e\u0067\u0020\u0065m\u0070\u0074y\u0020\u0062\u0079\u0074\u0065");};
};for {_ebce =_bdec ;_bdec =(_bdec |(_bdec >>1)|(_bdec <<1))&_aefde ;if (_bdec ^_ebce )==0{if _edabf =_fdea .SetByte (_ggbc +_ffde ,_bdec );_edabf !=nil {return _f .Wrap (_edabf ,_bggb ,"\u0073\u0065\u0074\u0074\u0069\u006e\u0067\u0020\u0070\u0072\u0065\u0076 \u0062\u0079\u0074\u0065");
};break ;};};};};for _gecf =_bbbc -1;_gecf >=0;_gecf --{_ggbc =_gecf *_fdea .RowStride ;_afbd =_gecf *_bege .RowStride ;for _ffde =_gafcc -1;_ffde >=0;_ffde --{if _bdec ,_edabf =_fdea .GetByte (_ggbc +_ffde );_edabf !=nil {return _f .Wrap (_edabf ,_bggb ,"\u0072\u0065\u0076er\u0073\u0065\u0020\u0067\u0065\u0074\u0020\u0073\u006f\u0075\u0072\u0063\u0065\u0020\u0062\u0079\u0074\u0065");
};if _aefde ,_edabf =_bege .GetByte (_afbd +_ffde );_edabf !=nil {return _f .Wrap (_edabf ,_bggb ,"r\u0065\u0076\u0065\u0072se\u0020g\u0065\u0074\u0020\u006d\u0061s\u006b\u0020\u0062\u0079\u0074\u0065");};if _gecf < _bbbc -1{if _cgbf ,_edabf =_fdea .GetByte (_ggbc +_fdea .RowStride +_ffde );
_edabf !=nil {return _f .Wrap (_edabf ,_bggb ,"\u0069\u0020\u003c\u0020h\u0020\u002d\u0020\u0031\u0020\u002d\u003e\u0020\u0067\u0065t\u0020s\u006f\u0075\u0072\u0063\u0065\u0020\u0062y\u0074\u0065");};_bdec |=_cgbf |(_cgbf <<1)|_cgbf >>1;if _ffde > 0{if _bbcbd ,_edabf =_fdea .GetByte (_ggbc +_fdea .RowStride +_ffde -1);
_edabf !=nil {return _f .Wrap (_edabf ,_bggb ,"\u0069\u0020\u003c h\u002d\u0031\u0020\u0026\u0020\u006a\u0020\u003e\u00200\u0020-\u003e \u0067e\u0074\u0020\u0073\u006f\u0075\u0072\u0063\u0065\u0020\u0062\u0079\u0074\u0065");};_bdec |=_bbcbd <<7;};if _ffde < _gafcc -1{if _bbcbd ,_edabf =_fdea .GetByte (_ggbc +_fdea .RowStride +_ffde +1);
_edabf !=nil {return _f .Wrap (_edabf ,_bggb ,"\u0069\u0020\u003c\u0020\u0068\u002d\u0031\u0020\u0026\u0026\u0020\u006a\u0020\u003c\u0077\u0070\u006c\u002d\u0031\u0020\u002d\u003e\u0020\u0067e\u0074\u0020\u0073\u006f\u0075r\u0063\u0065 \u0062\u0079\u0074\u0065");
};_bdec |=_bbcbd >>7;};};if _ffde < _gafcc -1{if _agcb ,_edabf =_fdea .GetByte (_ggbc +_ffde +1);_edabf !=nil {return _f .Wrap (_edabf ,_bggb ,"\u006a\u0020<\u0020\u0077\u0070\u006c\u0020\u002d\u0031\u0020\u002d\u003e\u0020\u0067\u0065\u0074\u0020\u0073\u006f\u0075\u0072\u0063\u0065\u0020by\u0074\u0065");
};_bdec |=_agcb >>7;};_bdec &=_aefde ;if _bdec ==0||(^_bdec )==0{if _edabf =_fdea .SetByte (_ggbc +_ffde ,_bdec );_edabf !=nil {return _f .Wrap (_edabf ,_bggb ,"\u0073e\u0074 \u006d\u0061\u0073\u006b\u0065\u0064\u0020\u0062\u0079\u0074\u0065");};};for {_ebce =_bdec ;
_bdec =(_bdec |(_bdec >>1)|(_bdec <<1))&_aefde ;if (_bdec ^_ebce )==0{if _edabf =_fdea .SetByte (_ggbc +_ffde ,_bdec );_edabf !=nil {return _f .Wrap (_edabf ,_bggb ,"r\u0065\u0076\u0065\u0072se\u0020s\u0065\u0074\u0020\u0070\u0072e\u0076\u0020\u0062\u0079\u0074\u0065");
};break ;};};};};return nil ;};func (_dbgg *Bitmap )SetPixel (x ,y int ,pixel byte )error {_fgdb :=_dbgg .GetByteIndex (x ,y );if _fgdb > len (_dbgg .Data )-1{return _f .Errorf ("\u0053\u0065\u0074\u0050\u0069\u0078\u0065\u006c","\u0069\u006e\u0064\u0065x \u006f\u0075\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065\u003a\u0020%\u0064",_fgdb );
};_ccc :=_dbgg .GetBitOffset (x );_ddf :=uint (7-_ccc );_acf :=_dbgg .Data [_fgdb ];var _eecf byte ;if pixel ==1{_eecf =_acf |(pixel &0x01<<_ddf );}else {_eecf =_acf &^(1<<_ddf );};_dbgg .Data [_fgdb ]=_eecf ;return nil ;};func TstGetScaledSymbol (t *_c .T ,sm *Bitmap ,scale ...int )*Bitmap {if len (scale )==0{return sm ;
};if scale [0]==1{return sm ;};_cfgd ,_afcbg :=MorphSequence (sm ,MorphProcess {Operation :MopReplicativeBinaryExpansion ,Arguments :scale });_d .NoError (t ,_afcbg );return _cfgd ;};func _dbe (_dg *Bitmap ,_egbb int ,_bgaa []byte )(_bfe *Bitmap ,_fea error ){const _ca ="\u0072\u0065\u0064\u0075\u0063\u0065\u0052\u0061\u006e\u006b\u0042\u0069n\u0061\u0072\u0079\u0032";
if _dg ==nil {return nil ,_f .Error (_ca ,"\u0073o\u0075\u0072\u0063\u0065 \u0062\u0069\u0074\u006d\u0061p\u0020n\u006ft\u0020\u0064\u0065\u0066\u0069\u006e\u0065d");};if _egbb < 1||_egbb > 4{return nil ,_f .Error (_ca ,"\u006c\u0065\u0076\u0065\u006c\u0020\u006d\u0075\u0073\u0074 \u0062\u0065\u0020\u0069\u006e\u0020\u0073e\u0074\u0020\u007b\u0031\u002c\u0032\u002c\u0033\u002c\u0034\u007d");
};if _dg .Height <=1{return nil ,_f .Errorf (_ca ,"\u0073o\u0075\u0072c\u0065\u0020\u0068e\u0069\u0067\u0068\u0074\u0020\u006d\u0075s\u0074\u0020\u0062\u0065\u0020\u0061t\u0020\u006c\u0065\u0061\u0073\u0074\u0020\u0027\u0032\u0027\u0020-\u0020\u0069\u0073\u003a\u0020\u0027\u0025\u0064\u0027",_dg .Height );
};_bfe =New (_dg .Width /2,_dg .Height /2);if _bgaa ==nil {_bgaa =_egg ();};_aeg :=_gffc (_dg .RowStride ,2*_bfe .RowStride );switch _egbb {case 1:_fea =_bba (_dg ,_bfe ,_egbb ,_bgaa ,_aeg );case 2:_fea =_fgcd (_dg ,_bfe ,_egbb ,_bgaa ,_aeg );case 3:_fea =_cffg (_dg ,_bfe ,_egbb ,_bgaa ,_aeg );
case 4:_fea =_bbe (_dg ,_bfe ,_egbb ,_bgaa ,_aeg );};if _fea !=nil {return nil ,_fea ;};return _bfe ,nil ;};func (_gcd *Bitmap )GetByteIndex (x ,y int )int {return y *_gcd .RowStride +(x >>3)};func (_gbed *Bitmap )nextOnPixelLow (_gfde ,_gef ,_dabe ,_dcba ,_fbad int )(_dacc _ab .Point ,_gddg bool ,_eacf error ){const _fcaa ="B\u0069\u0074\u006d\u0061p.\u006ee\u0078\u0074\u004f\u006e\u0050i\u0078\u0065\u006c\u004c\u006f\u0077";
var (_aeag int ;_dfbb byte ;);_adfc :=_fbad *_dabe ;_feab :=_adfc +(_dcba /8);if _dfbb ,_eacf =_gbed .GetByte (_feab );_eacf !=nil {return _dacc ,false ,_f .Wrap (_eacf ,_fcaa ,"\u0078\u0053\u0074\u0061\u0072\u0074\u0020\u0061\u006e\u0064 \u0079\u0053\u0074\u0061\u0072\u0074\u0020o\u0075\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065");
};if _dfbb !=0{_egff :=_dcba -(_dcba %8)+7;for _aeag =_dcba ;_aeag <=_egff &&_aeag < _gfde ;_aeag ++{if _gbed .GetPixel (_aeag ,_fbad ){_dacc .X =_aeag ;_dacc .Y =_fbad ;return _dacc ,true ,nil ;};};};_faab :=(_dcba /8)+1;_aeag =8*_faab ;var _dfbbg int ;
for _feab =_adfc +_faab ;_aeag < _gfde ;_feab ,_aeag =_feab +1,_aeag +8{if _dfbb ,_eacf =_gbed .GetByte (_feab );_eacf !=nil {return _dacc ,false ,_f .Wrap (_eacf ,_fcaa ,"r\u0065\u0073\u0074\u0020of\u0020t\u0068\u0065\u0020\u006c\u0069n\u0065\u0020\u0062\u0079\u0074\u0065");
};if _dfbb ==0{continue ;};for _dfbbg =0;_dfbbg < 8&&_aeag < _gfde ;_dfbbg ,_aeag =_dfbbg +1,_aeag +1{if _gbed .GetPixel (_aeag ,_fbad ){_dacc .X =_aeag ;_dacc .Y =_fbad ;return _dacc ,true ,nil ;};};};for _aeeg :=_fbad +1;_aeeg < _gef ;_aeeg ++{_adfc =_aeeg *_dabe ;
for _feab ,_aeag =_adfc ,0;_aeag < _gfde ;_feab ,_aeag =_feab +1,_aeag +8{if _dfbb ,_eacf =_gbed .GetByte (_feab );_eacf !=nil {return _dacc ,false ,_f .Wrap (_eacf ,_fcaa ,"\u0066o\u006cl\u006f\u0077\u0069\u006e\u0067\u0020\u006c\u0069\u006e\u0065\u0073");
};if _dfbb ==0{continue ;};for _dfbbg =0;_dfbbg < 8&&_aeag < _gfde ;_dfbbg ,_aeag =_dfbbg +1,_aeag +1{if _gbed .GetPixel (_aeag ,_aeeg ){_dacc .X =_aeag ;_dacc .Y =_aeeg ;return _dacc ,true ,nil ;};};};};return _dacc ,false ,nil ;};func _cfege (_fabdd ,_bggd int ,_ecaa string )*Selection {_fecg :=&Selection {Height :_fabdd ,Width :_bggd ,Name :_ecaa };
_fecg .Data =make ([][]SelectionValue ,_fabdd );for _dfbg :=0;_dfbg < _fabdd ;_dfbg ++{_fecg .Data [_dfbg ]=make ([]SelectionValue ,_bggd );};return _fecg ;};func _db (_cd *Bitmap ,_efe ,_gf int )(*Bitmap ,error ){const _aaa ="e\u0078\u0070\u0061\u006edB\u0069n\u0061\u0072\u0079\u0052\u0065p\u006c\u0069\u0063\u0061\u0074\u0065";
if _cd ==nil {return nil ,_f .Error (_aaa ,"\u0073o\u0075r\u0063\u0065\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");};if _efe <=0||_gf <=0{return nil ,_f .Error (_aaa ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0073\u0063\u0061l\u0065\u0020\u0066\u0061\u0063\u0074\u006f\u0072\u003a\u0020<\u003d\u0020\u0030");
};if _efe ==_gf {if _efe ==1{_dcf ,_ga :=_bee (nil ,_cd );if _ga !=nil {return nil ,_f .Wrap (_ga ,_aaa ,"\u0078\u0046\u0061\u0063\u0074\u0020\u003d\u003d\u0020y\u0046\u0061\u0063\u0074");};return _dcf ,nil ;};if _efe ==2||_efe ==4||_efe ==8{_aff ,_ce :=_cc (_cd ,_efe );
if _ce !=nil {return nil ,_f .Wrap (_ce ,_aaa ,"\u0078\u0046a\u0063\u0074\u0020i\u006e\u0020\u007b\u0032\u002c\u0034\u002c\u0038\u007d");};return _aff ,nil ;};};_bab :=_efe *_cd .Width ;_ffg :=_gf *_cd .Height ;_cee :=New (_bab ,_ffg );_dde :=_cee .RowStride ;
var (_gdc ,_bcc ,_gfa ,_eg ,_bf int ;_cff byte ;_cbf error ;);for _bcc =0;_bcc < _cd .Height ;_bcc ++{_gdc =_gf *_bcc *_dde ;for _gfa =0;_gfa < _cd .Width ;_gfa ++{if _dfg :=_cd .GetPixel (_gfa ,_bcc );_dfg {_bf =_efe *_gfa ;for _eg =0;_eg < _efe ;_eg ++{_cee .setBit (_gdc *8+_bf +_eg );
};};};for _eg =1;_eg < _gf ;_eg ++{_egb :=_gdc +_eg *_dde ;for _cfff :=0;_cfff < _dde ;_cfff ++{if _cff ,_cbf =_cee .GetByte (_gdc +_cfff );_cbf !=nil {return nil ,_f .Wrapf (_cbf ,_aaa ,"\u0072\u0065\u0070\u006cic\u0061\u0074\u0069\u006e\u0067\u0020\u006c\u0069\u006e\u0065\u003a\u0020\u0027\u0025d\u0027",_eg );
};if _cbf =_cee .SetByte (_egb +_cfff ,_cff );_cbf !=nil {return nil ,_f .Wrap (_cbf ,_aaa ,"\u0053\u0065\u0074\u0074in\u0067\u0020\u0062\u0079\u0074\u0065\u0020\u0066\u0061\u0069\u006c\u0065\u0064");};};};};return _cee ,nil ;};func (_gedb *Bitmap )Copy ()*Bitmap {_acgc :=make ([]byte ,len (_gedb .Data ));
copy (_acgc ,_gedb .Data );return &Bitmap {Width :_gedb .Width ,Height :_gedb .Height ,RowStride :_gedb .RowStride ,Data :_acgc ,Color :_gedb .Color ,Text :_gedb .Text ,BitmapNumber :_gedb .BitmapNumber ,Special :_gedb .Special };};const (_cdeba shift =iota ;
_efeed ;);func _fdfd (_efde ,_eaae *Bitmap ,_fgcb ,_abgb int )(*Bitmap ,error ){const _dfbe ="d\u0069\u006c\u0061\u0074\u0065\u0042\u0072\u0069\u0063\u006b";if _eaae ==nil {_abc .Log .Debug ("\u0064\u0069\u006c\u0061\u0074\u0065\u0042\u0072\u0069\u0063k\u0020\u0073\u006f\u0075\u0072\u0063\u0065 \u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
return nil ,_f .Error (_dfbe ,"\u0073o\u0075\u0072\u0063\u0065 \u0062\u0069\u0074\u006d\u0061p\u0020n\u006ft\u0020\u0064\u0065\u0066\u0069\u006e\u0065d");};if _fgcb < 1||_abgb < 1{return nil ,_f .Error (_dfbe ,"\u0068\u0053\u007a\u0069\u0065 \u0061\u006e\u0064\u0020\u0076\u0053\u0069\u007a\u0065\u0020\u0061\u0072\u0065 \u006e\u006f\u0020\u0067\u0072\u0065\u0061\u0074\u0065\u0072\u0020\u0065\u0071\u0075\u0061\u006c\u0020\u0074\u006f\u0020\u0031");
};if _fgcb ==1&&_abgb ==1{_fdca ,_addd :=_bee (_efde ,_eaae );if _addd !=nil {return nil ,_f .Wrap (_addd ,_dfbe ,"\u0068S\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u0026\u0026 \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");
};return _fdca ,nil ;};if _fgcb ==1||_abgb ==1{_bgege :=SelCreateBrick (_abgb ,_fgcb ,_abgb /2,_fgcb /2,SelHit );_beaag ,_edccd :=_faad (_efde ,_eaae ,_bgege );if _edccd !=nil {return nil ,_f .Wrap (_edccd ,_dfbe ,"\u0068s\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u007c\u007c \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");
};return _beaag ,nil ;};_egfb :=SelCreateBrick (1,_fgcb ,0,_fgcb /2,SelHit );_fcceb :=SelCreateBrick (_abgb ,1,_abgb /2,0,SelHit );_dacgb ,_fcbd :=_faad (nil ,_eaae ,_egfb );if _fcbd !=nil {return nil ,_f .Wrap (_fcbd ,_dfbe ,"\u0031\u0073\u0074\u0020\u0064\u0069\u006c\u0061\u0074\u0065");
};_efde ,_fcbd =_faad (_efde ,_dacgb ,_fcceb );if _fcbd !=nil {return nil ,_f .Wrap (_fcbd ,_dfbe ,"\u0032\u006e\u0064\u0020\u0064\u0069\u006c\u0061\u0074\u0065");};return _efde ,nil ;};const (_ SizeSelection =iota ;SizeSelectByWidth ;SizeSelectByHeight ;
SizeSelectByMaxDimension ;SizeSelectByArea ;SizeSelectByPerimeter ;);func TstDSymbol (t *_c .T ,scale ...int )*Bitmap {_ebefd ,_aeggg :=NewWithData (4,5,[]byte {0xf0,0x90,0x90,0x90,0xE0});_d .NoError (t ,_aeggg );return TstGetScaledSymbol (t ,_ebefd ,scale ...);
};func (_fdee *Bitmaps )SelectBySize (width ,height int ,tp LocationFilter ,relation SizeComparison )(_dfedg *Bitmaps ,_eadc error ){const _ecgbc ="B\u0069t\u006d\u0061\u0070\u0073\u002e\u0053\u0065\u006ce\u0063\u0074\u0042\u0079Si\u007a\u0065";if _fdee ==nil {return nil ,_f .Error (_ecgbc ,"\u0027\u0062\u0027 B\u0069\u0074\u006d\u0061\u0070\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};switch tp {case LocSelectWidth ,LocSelectHeight ,LocSelectIfEither ,LocSelectIfBoth :default:return nil ,_f .Errorf (_ecgbc ,"\u0070\u0072\u006f\u0076\u0069d\u0065\u0064\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006c\u006fc\u0061\u0074\u0069\u006f\u006e\u0020\u0066\u0069\u006c\u0074\u0065\u0072\u0020\u0074\u0079\u0070\u0065\u003a\u0020\u0025\u0064",tp );
};switch relation {case SizeSelectIfLT ,SizeSelectIfGT ,SizeSelectIfLTE ,SizeSelectIfGTE ,SizeSelectIfEQ :default:return nil ,_f .Errorf (_ecgbc ,"\u0069\u006e\u0076\u0061li\u0064\u0020\u0072\u0065\u006c\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0027\u0025d\u0027",relation );
};_ggfd ,_eadc :=_fdee .makeSizeIndicator (width ,height ,tp ,relation );if _eadc !=nil {return nil ,_f .Wrap (_eadc ,_ecgbc ,"");};_dfedg ,_eadc =_fdee .selectByIndicator (_ggfd );if _eadc !=nil {return nil ,_f .Wrap (_eadc ,_ecgbc ,"");};return _dfedg ,nil ;
};type CombinationOperator int ;func _bagb (_dbb ,_acbg *Bitmap ,_deed *Selection )(*Bitmap ,error ){const _dgdf ="\u006f\u0070\u0065\u006e";var _fcef error ;_dbb ,_fcef =_edce (_dbb ,_acbg ,_deed );if _fcef !=nil {return nil ,_f .Wrap (_fcef ,_dgdf ,"");
};_egba ,_fcef :=_acaab (nil ,_acbg ,_deed );if _fcef !=nil {return nil ,_f .Wrap (_fcef ,_dgdf ,"");};_ ,_fcef =_faad (_dbb ,_egba ,_deed );if _fcef !=nil {return nil ,_f .Wrap (_fcef ,_dgdf ,"");};return _dbb ,nil ;};func (_dbfb *Bitmap )GetChocolateData ()[]byte {if _dbfb .Color ==Vanilla {_dbfb .inverseData ();
};return _dbfb .Data ;};func (_dbfbg *Bitmap )createTemplate ()*Bitmap {return &Bitmap {Width :_dbfbg .Width ,Height :_dbfbg .Height ,RowStride :_dbfbg .RowStride ,Color :_dbfbg .Color ,Text :_dbfbg .Text ,BitmapNumber :_dbfbg .BitmapNumber ,Special :_dbfbg .Special ,Data :make ([]byte ,len (_dbfbg .Data ))};
};var _fdag =[5]int {1,2,3,0,4};func _gdg (_ggge ,_cbfg *Bitmap ,_eagc CombinationOperator )*Bitmap {_edgcc :=New (_ggge .Width ,_ggge .Height );for _eafc :=0;_eafc < len (_edgcc .Data );_eafc ++{_edgcc .Data [_eafc ]=_bfb (_ggge .Data [_eafc ],_cbfg .Data [_eafc ],_eagc );
};return _edgcc ;};func HausTest (p1 ,p2 ,p3 ,p4 *Bitmap ,delX ,delY float32 ,maxDiffW ,maxDiffH int )(bool ,error ){const _geda ="\u0048\u0061\u0075\u0073\u0054\u0065\u0073\u0074";_bca ,_bfega :=p1 .Width ,p1 .Height ;_gegc ,_cgbc :=p3 .Width ,p3 .Height ;
if _ed .Abs (_bca -_gegc )> maxDiffW {return false ,nil ;};if _ed .Abs (_bfega -_cgbc )> maxDiffH {return false ,nil ;};_edaa :=int (delX +_ed .Sign (delX )*0.5);_fbb :=int (delY +_ed .Sign (delY )*0.5);var _efcg error ;_dedc :=p1 .CreateTemplate ();if _efcg =_dedc .RasterOperation (0,0,_bca ,_bfega ,PixSrc ,p1 ,0,0);
_efcg !=nil {return false ,_f .Wrap (_efcg ,_geda ,"p\u0031\u0020\u002d\u0053\u0052\u0043\u002d\u003e\u0020\u0074");};if _efcg =_dedc .RasterOperation (_edaa ,_fbb ,_bca ,_bfega ,PixNotSrcAndDst ,p4 ,0,0);_efcg !=nil {return false ,_f .Wrap (_efcg ,_geda ,"\u0021p\u0034\u0020\u0026\u0020\u0074");
};if _dedc .Zero (){return false ,nil ;};if _efcg =_dedc .RasterOperation (_edaa ,_fbb ,_gegc ,_cgbc ,PixSrc ,p3 ,0,0);_efcg !=nil {return false ,_f .Wrap (_efcg ,_geda ,"p\u0033\u0020\u002d\u0053\u0052\u0043\u002d\u003e\u0020\u0074");};if _efcg =_dedc .RasterOperation (0,0,_gegc ,_cgbc ,PixNotSrcAndDst ,p2 ,0,0);
_efcg !=nil {return false ,_f .Wrap (_efcg ,_geda ,"\u0021p\u0032\u0020\u0026\u0020\u0074");};return _dedc .Zero (),nil ;};func RasterOperation (dest *Bitmap ,dx ,dy ,dw ,dh int ,op RasterOperator ,src *Bitmap ,sx ,sy int )error {return _dagdg (dest ,dx ,dy ,dw ,dh ,op ,src ,sx ,sy );
};func TstWordBitmap (t *_c .T ,scale ...int )*Bitmap {_agac :=1;if len (scale )> 0{_agac =scale [0];};_geae :=3;_egbe :=9+7+15+2*_geae ;_cfec :=5+_geae +5;_dgcb :=New (_egbe *_agac ,_cfec *_agac );_eefff :=&Bitmaps {};var _bcea *int ;_geae *=_agac ;_gbfg :=0;
_bcea =&_gbfg ;_cabbb :=0;_gcgg :=TstDSymbol (t ,scale ...);TstAddSymbol (t ,_eefff ,_gcgg ,_bcea ,_cabbb ,1*_agac );_gcgg =TstOSymbol (t ,scale ...);TstAddSymbol (t ,_eefff ,_gcgg ,_bcea ,_cabbb ,_geae );_gcgg =TstISymbol (t ,scale ...);TstAddSymbol (t ,_eefff ,_gcgg ,_bcea ,_cabbb ,1*_agac );
_gcgg =TstTSymbol (t ,scale ...);TstAddSymbol (t ,_eefff ,_gcgg ,_bcea ,_cabbb ,_geae );_gcgg =TstNSymbol (t ,scale ...);TstAddSymbol (t ,_eefff ,_gcgg ,_bcea ,_cabbb ,1*_agac );_gcgg =TstOSymbol (t ,scale ...);TstAddSymbol (t ,_eefff ,_gcgg ,_bcea ,_cabbb ,1*_agac );
_gcgg =TstWSymbol (t ,scale ...);TstAddSymbol (t ,_eefff ,_gcgg ,_bcea ,_cabbb ,0);*_bcea =0;_cabbb =5*_agac +_geae ;_gcgg =TstOSymbol (t ,scale ...);TstAddSymbol (t ,_eefff ,_gcgg ,_bcea ,_cabbb ,1*_agac );_gcgg =TstRSymbol (t ,scale ...);TstAddSymbol (t ,_eefff ,_gcgg ,_bcea ,_cabbb ,_geae );
_gcgg =TstNSymbol (t ,scale ...);TstAddSymbol (t ,_eefff ,_gcgg ,_bcea ,_cabbb ,1*_agac );_gcgg =TstESymbol (t ,scale ...);TstAddSymbol (t ,_eefff ,_gcgg ,_bcea ,_cabbb ,1*_agac );_gcgg =TstVSymbol (t ,scale ...);TstAddSymbol (t ,_eefff ,_gcgg ,_bcea ,_cabbb ,1*_agac );
_gcgg =TstESymbol (t ,scale ...);TstAddSymbol (t ,_eefff ,_gcgg ,_bcea ,_cabbb ,1*_agac );_gcgg =TstRSymbol (t ,scale ...);TstAddSymbol (t ,_eefff ,_gcgg ,_bcea ,_cabbb ,0);TstWriteSymbols (t ,_eefff ,_dgcb );return _dgcb ;};func (_dgea *Bitmap )AddBorderGeneral (left ,right ,top ,bot int ,val int )(*Bitmap ,error ){return _dgea .addBorderGeneral (left ,right ,top ,bot ,val );
};func (_eged *Bitmaps )selectByIndicator (_gdgdd *_ed .NumSlice )(_aaeee *Bitmaps ,_fgdbb error ){const _edcd ="\u0042i\u0074\u006d\u0061\u0070s\u002e\u0073\u0065\u006c\u0065c\u0074B\u0079I\u006e\u0064\u0069\u0063\u0061\u0074\u006fr";if _eged ==nil {return nil ,_f .Error (_edcd ,"\u0027\u0062\u0027 b\u0069\u0074\u006d\u0061\u0070\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};if _gdgdd ==nil {return nil ,_f .Error (_edcd ,"'\u006e\u0061\u0027\u0020\u0069\u006ed\u0069\u0063\u0061\u0074\u006f\u0072\u0073\u0020\u006eo\u0074\u0020\u0064e\u0066i\u006e\u0065\u0064");};if len (_eged .Values )==0{return _eged ,nil ;};if len (*_gdgdd )!=len (_eged .Values ){return nil ,_f .Errorf (_edcd ,"\u006ea\u0020\u006ce\u006e\u0067\u0074\u0068:\u0020\u0025\u0064,\u0020\u0069\u0073\u0020\u0064\u0069\u0066\u0066\u0065re\u006e\u0074\u0020t\u0068\u0061n\u0020\u0062\u0069\u0074\u006d\u0061p\u0073\u003a \u0025\u0064",len (*_gdgdd ),len (_eged .Values ));
};var _dcfc ,_affg ,_bbgf int ;for _affg =0;_affg < len (*_gdgdd );_affg ++{if _dcfc ,_fgdbb =_gdgdd .GetInt (_affg );_fgdbb !=nil {return nil ,_f .Wrap (_fgdbb ,_edcd ,"f\u0069\u0072\u0073\u0074\u0020\u0063\u0068\u0065\u0063\u006b");};if _dcfc ==1{_bbgf ++;
};};if _bbgf ==len (_eged .Values ){return _eged ,nil ;};_aaeee =&Bitmaps {};_adfec :=len (_eged .Values )==len (_eged .Boxes );for _affg =0;_affg < len (*_gdgdd );_affg ++{if _dcfc =int ((*_gdgdd )[_affg ]);_dcfc ==0{continue ;};_aaeee .Values =append (_aaeee .Values ,_eged .Values [_affg ]);
if _adfec {_aaeee .Boxes =append (_aaeee .Boxes ,_eged .Boxes [_affg ]);};};return _aaeee ,nil ;};func (_cdfd *ClassedPoints )Len ()int {return _cdfd .IntSlice .Size ()};func (_bde *Bitmap )clearAll ()error {return _bde .RasterOperation (0,0,_bde .Width ,_bde .Height ,PixClr ,nil ,0,0);
};func (_dfe *Bitmap )setEightBytes (_dbfd int ,_gfbd uint64 )error {_abe :=_dfe .RowStride -(_dbfd %_dfe .RowStride );if _dfe .RowStride !=_dfe .Width >>3{_abe --;};if _abe >=8{return _dfe .setEightFullBytes (_dbfd ,_gfbd );};return _dfe .setEightPartlyBytes (_dbfd ,_abe ,_gfbd );
};func (_ffad MorphProcess )verify (_fdgg int ,_daccc ,_adbg *int )error {const _befg ="\u004d\u006f\u0072\u0070hP\u0072\u006f\u0063\u0065\u0073\u0073\u002e\u0076\u0065\u0072\u0069\u0066\u0079";switch _ffad .Operation {case MopDilation ,MopErosion ,MopOpening ,MopClosing :if len (_ffad .Arguments )!=2{return _f .Error (_befg ,"\u004f\u0070\u0065\u0072\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0027\u0064\u0027\u002c\u0020\u0027\u0065\u0027\u002c \u0027\u006f\u0027\u002c\u0020\u0027\u0063\u0027\u0020\u0072\u0065\u0071\u0075\u0069\u0072\u0065\u0073\u0020\u0061\u0074\u0020\u006c\u0065\u0061\u0073\u0074\u0020\u0032\u0020\u0061r\u0067\u0075\u006d\u0065\u006et\u0073");
};_eaage ,_fegdf :=_ffad .getWidthHeight ();if _eaage <=0||_fegdf <=0{return _f .Error (_befg ,"O\u0070er\u0061t\u0069o\u006e\u003a\u0020\u0027\u0064'\u002c\u0020\u0027e\u0027\u002c\u0020\u0027\u006f'\u002c\u0020\u0027c\u0027\u0020\u0020\u0072\u0065\u0071\u0075\u0069\u0072\u0065\u0073 \u0062\u006f\u0074h w\u0069\u0064\u0074\u0068\u0020\u0061n\u0064\u0020\u0068\u0065\u0069\u0067\u0068\u0074\u0020\u0074\u006f\u0020b\u0065 \u003e\u003d\u0020\u0030");
};case MopRankBinaryReduction :_cffa :=len (_ffad .Arguments );*_daccc +=_cffa ;if _cffa < 1||_cffa > 4{return _f .Error (_befg ,"\u004f\u0070\u0065\u0072\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0027\u0072\u0027\u0020\u0072\u0065\u0071\u0075\u0069r\u0065\u0073\u0020\u0061\u0074\u0020\u006c\u0065\u0061s\u0074\u0020\u0031\u0020\u0061\u006e\u0064\u0020\u0061\u0074\u0020\u006d\u006fs\u0074\u0020\u0034\u0020\u0061\u0072g\u0075\u006d\u0065n\u0074\u0073");
};for _dgfc :=0;_dgfc < _cffa ;_dgfc ++{if _ffad .Arguments [_dgfc ]< 1||_ffad .Arguments [_dgfc ]> 4{return _f .Error (_befg ,"\u0052\u0061\u006e\u006b\u0042\u0069n\u0061\u0072\u0079\u0052\u0065\u0064\u0075\u0063\u0074\u0069\u006f\u006e\u0020\u006c\u0065\u0076\u0065\u006c\u0020\u006du\u0073\u0074\u0020\u0062\u0065\u0020\u0069\u006e\u0020\u0072\u0061\u006e\u0067\u0065 \u00280\u002c\u0020\u0034\u003e");
};};case MopReplicativeBinaryExpansion :if len (_ffad .Arguments )==0{return _f .Error (_befg ,"\u0052\u0065\u0070\u006c\u0069\u0063\u0061\u0074i\u0076\u0065\u0042in\u0061\u0072\u0079\u0045\u0078\u0070a\u006e\u0073\u0069\u006f\u006e\u0020\u0072\u0065\u0071\u0075\u0069\u0072\u0065\u0073\u0020o\u006e\u0065\u0020\u0061\u0072\u0067\u0075\u006de\u006e\u0074");
};_abag :=_ffad .Arguments [0];if _abag !=2&&_abag !=4&&_abag !=8{return _f .Error (_befg ,"R\u0065\u0070\u006c\u0069\u0063\u0061\u0074\u0069\u0076\u0065\u0042\u0069\u006e\u0061\u0072\u0079\u0045\u0078\u0070\u0061\u006e\u0073\u0069\u006f\u006e\u0020m\u0075s\u0074\u0020\u0062\u0065 \u006f\u0066 \u0066\u0061\u0063\u0074\u006f\u0072\u0020\u0069\u006e\u0020\u0072\u0061\u006e\u0067\u0065\u0020\u007b\u0032\u002c\u0034\u002c\u0038\u007d");
};*_daccc -=_fdag [_abag /4];case MopAddBorder :if len (_ffad .Arguments )==0{return _f .Error (_befg ,"\u0041\u0064\u0064B\u006f\u0072\u0064\u0065r\u0020\u0072\u0065\u0071\u0075\u0069\u0072e\u0073\u0020\u006f\u006e\u0065\u0020\u0061\u0072\u0067\u0075\u006d\u0065\u006e\u0074");
};_addb :=_ffad .Arguments [0];if _fdgg > 0{return _f .Error (_befg ,"\u0041\u0064\u0064\u0042\u006f\u0072\u0064\u0065\u0072\u0020\u006d\u0075\u0073t\u0020\u0062\u0065\u0020\u0061\u0020f\u0069\u0072\u0073\u0074\u0020\u006d\u006f\u0072\u0070\u0068\u0020\u0070\u0072o\u0063\u0065\u0073\u0073");
};if _addb < 1{return _f .Error (_befg ,"\u0041\u0064\u0064\u0042o\u0072\u0064\u0065\u0072\u0020\u0076\u0061\u006c\u0075\u0065 \u006co\u0077\u0065\u0072\u0020\u0074\u0068\u0061n\u0020\u0030");};*_adbg =_addb ;};return nil ;};func _acaab (_gbada ,_feeg *Bitmap ,_fbag *Selection )(*Bitmap ,error ){const _bda ="\u0065\u0072\u006fd\u0065";
var (_fdgb error ;_ebbc *Bitmap ;);_gbada ,_fdgb =_cacgf (_gbada ,_feeg ,_fbag ,&_ebbc );if _fdgb !=nil {return nil ,_f .Wrap (_fdgb ,_bda ,"");};if _fdgb =_gbada .setAll ();_fdgb !=nil {return nil ,_f .Wrap (_fdgb ,_bda ,"");};var _cebd SelectionValue ;
for _gccf :=0;_gccf < _fbag .Height ;_gccf ++{for _cbfgd :=0;_cbfgd < _fbag .Width ;_cbfgd ++{_cebd =_fbag .Data [_gccf ][_cbfgd ];if _cebd ==SelHit {_fdgb =_dagdg (_gbada ,_fbag .Cx -_cbfgd ,_fbag .Cy -_gccf ,_feeg .Width ,_feeg .Height ,PixSrcAndDst ,_ebbc ,0,0);
if _fdgb !=nil {return nil ,_f .Wrap (_fdgb ,_bda ,"");};};};};if MorphBC ==SymmetricMorphBC {return _gbada ,nil ;};_bcce ,_cbfe ,_cffgg ,_ccdf :=_fbag .findMaxTranslations ();if _bcce > 0{if _fdgb =_gbada .RasterOperation (0,0,_bcce ,_feeg .Height ,PixClr ,nil ,0,0);
_fdgb !=nil {return nil ,_f .Wrap (_fdgb ,_bda ,"\u0078\u0070\u0020\u003e\u0020\u0030");};};if _cffgg > 0{if _fdgb =_gbada .RasterOperation (_feeg .Width -_cffgg ,0,_cffgg ,_feeg .Height ,PixClr ,nil ,0,0);_fdgb !=nil {return nil ,_f .Wrap (_fdgb ,_bda ,"\u0078\u006e\u0020\u003e\u0020\u0030");
};};if _cbfe > 0{if _fdgb =_gbada .RasterOperation (0,0,_feeg .Width ,_cbfe ,PixClr ,nil ,0,0);_fdgb !=nil {return nil ,_f .Wrap (_fdgb ,_bda ,"\u0079\u0070\u0020\u003e\u0020\u0030");};};if _ccdf > 0{if _fdgb =_gbada .RasterOperation (0,_feeg .Height -_ccdf ,_feeg .Width ,_ccdf ,PixClr ,nil ,0,0);
_fdgb !=nil {return nil ,_f .Wrap (_fdgb ,_bda ,"\u0079\u006e\u0020\u003e\u0020\u0030");};};return _gbada ,nil ;};func TstImageBitmapInverseData ()[]byte {_bacc :=_cfdg .Copy ();_bacc .InverseData ();return _bacc .Data ;};func _fgcd (_cbg ,_fcb *Bitmap ,_ int ,_gfg []byte ,_dfba int )(_aba error ){const _dcegc ="\u0072\u0065\u0064uc\u0065\u0052\u0061\u006e\u006b\u0042\u0069\u006e\u0061\u0072\u0079\u0032\u004c\u0065\u0076\u0065\u006c\u0032";
var (_fad ,_be ,_ebe ,_bfg ,_bagf ,_eecg ,_aag ,_gg int ;_gc ,_bbf ,_ege ,_cea uint32 ;_gdcg ,_bbcf byte ;_gcb uint16 ;);_cef :=make ([]byte ,4);_gdf :=make ([]byte ,4);for _ebe =0;_ebe < _cbg .Height -1;_ebe ,_bfg =_ebe +2,_bfg +1{_fad =_ebe *_cbg .RowStride ;
_be =_bfg *_fcb .RowStride ;for _bagf ,_eecg =0,0;_bagf < _dfba ;_bagf ,_eecg =_bagf +4,_eecg +1{for _aag =0;_aag < 4;_aag ++{_gg =_fad +_bagf +_aag ;if _gg <=len (_cbg .Data )-1&&_gg < _fad +_cbg .RowStride {_cef [_aag ]=_cbg .Data [_gg ];}else {_cef [_aag ]=0x00;
};_gg =_fad +_cbg .RowStride +_bagf +_aag ;if _gg <=len (_cbg .Data )-1&&_gg < _fad +(2*_cbg .RowStride ){_gdf [_aag ]=_cbg .Data [_gg ];}else {_gdf [_aag ]=0x00;};};_gc =_b .BigEndian .Uint32 (_cef );_bbf =_b .BigEndian .Uint32 (_gdf );_ege =_gc &_bbf ;
_ege |=_ege <<1;_cea =_gc |_bbf ;_cea &=_cea <<1;_bbf =_ege |_cea ;_bbf &=0xaaaaaaaa;_gc =_bbf |(_bbf <<7);_gdcg =byte (_gc >>24);_bbcf =byte ((_gc >>8)&0xff);_gg =_be +_eecg ;if _gg +1==len (_fcb .Data )-1||_gg +1>=_be +_fcb .RowStride {if _aba =_fcb .SetByte (_gg ,_gfg [_gdcg ]);
_aba !=nil {return _f .Wrapf (_aba ,_dcegc ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0025d",_gg );};}else {_gcb =(uint16 (_gfg [_gdcg ])<<8)|uint16 (_gfg [_bbcf ]);if _aba =_fcb .setTwoBytes (_gg ,_gcb );_aba !=nil {return _f .Wrapf (_aba ,_dcegc ,"s\u0065\u0074\u0074\u0069\u006e\u0067 \u0074\u0077\u006f\u0020\u0062\u0079t\u0065\u0073\u0020\u0066\u0061\u0069\u006ce\u0064\u002c\u0020\u0069\u006e\u0064\u0065\u0078\u003a\u0020%\u0064",_gg );
};_eecg ++;};};};return nil ;};func Copy (d ,s *Bitmap )(*Bitmap ,error ){return _bee (d ,s )};var (_gcgd =_ffa ();_dacg =_gda ();_gaa =_gbg (););func _aabfd (_abadc *Bitmap ,_gcce ,_fgfeg ,_aabb ,_acgb int ,_bffe RasterOperator ,_bggge *Bitmap ,_gafc ,_bbcg int )error {var (_eeff byte ;
_aeeeb int ;_feb int ;_dfef ,_abba int ;_egce ,_dcab int ;);_ggb :=_aabb >>3;_aecc :=_aabb &7;if _aecc > 0{_eeff =_abfdd [_aecc ];};_aeeeb =_bggge .RowStride *_bbcg +(_gafc >>3);_feb =_abadc .RowStride *_fgfeg +(_gcce >>3);switch _bffe {case PixSrc :for _egce =0;
_egce < _acgb ;_egce ++{_dfef =_aeeeb +_egce *_bggge .RowStride ;_abba =_feb +_egce *_abadc .RowStride ;for _dcab =0;_dcab < _ggb ;_dcab ++{_abadc .Data [_abba ]=_bggge .Data [_dfef ];_abba ++;_dfef ++;};if _aecc > 0{_abadc .Data [_abba ]=_egbbc (_abadc .Data [_abba ],_bggge .Data [_dfef ],_eeff );
};};case PixNotSrc :for _egce =0;_egce < _acgb ;_egce ++{_dfef =_aeeeb +_egce *_bggge .RowStride ;_abba =_feb +_egce *_abadc .RowStride ;for _dcab =0;_dcab < _ggb ;_dcab ++{_abadc .Data [_abba ]=^(_bggge .Data [_dfef ]);_abba ++;_dfef ++;};if _aecc > 0{_abadc .Data [_abba ]=_egbbc (_abadc .Data [_abba ],^_bggge .Data [_dfef ],_eeff );
};};case PixSrcOrDst :for _egce =0;_egce < _acgb ;_egce ++{_dfef =_aeeeb +_egce *_bggge .RowStride ;_abba =_feb +_egce *_abadc .RowStride ;for _dcab =0;_dcab < _ggb ;_dcab ++{_abadc .Data [_abba ]|=_bggge .Data [_dfef ];_abba ++;_dfef ++;};if _aecc > 0{_abadc .Data [_abba ]=_egbbc (_abadc .Data [_abba ],_bggge .Data [_dfef ]|_abadc .Data [_abba ],_eeff );
};};case PixSrcAndDst :for _egce =0;_egce < _acgb ;_egce ++{_dfef =_aeeeb +_egce *_bggge .RowStride ;_abba =_feb +_egce *_abadc .RowStride ;for _dcab =0;_dcab < _ggb ;_dcab ++{_abadc .Data [_abba ]&=_bggge .Data [_dfef ];_abba ++;_dfef ++;};if _aecc > 0{_abadc .Data [_abba ]=_egbbc (_abadc .Data [_abba ],_bggge .Data [_dfef ]&_abadc .Data [_abba ],_eeff );
};};case PixSrcXorDst :for _egce =0;_egce < _acgb ;_egce ++{_dfef =_aeeeb +_egce *_bggge .RowStride ;_abba =_feb +_egce *_abadc .RowStride ;for _dcab =0;_dcab < _ggb ;_dcab ++{_abadc .Data [_abba ]^=_bggge .Data [_dfef ];_abba ++;_dfef ++;};if _aecc > 0{_abadc .Data [_abba ]=_egbbc (_abadc .Data [_abba ],_bggge .Data [_dfef ]^_abadc .Data [_abba ],_eeff );
};};case PixNotSrcOrDst :for _egce =0;_egce < _acgb ;_egce ++{_dfef =_aeeeb +_egce *_bggge .RowStride ;_abba =_feb +_egce *_abadc .RowStride ;for _dcab =0;_dcab < _ggb ;_dcab ++{_abadc .Data [_abba ]|=^(_bggge .Data [_dfef ]);_abba ++;_dfef ++;};if _aecc > 0{_abadc .Data [_abba ]=_egbbc (_abadc .Data [_abba ],^(_bggge .Data [_dfef ])|_abadc .Data [_abba ],_eeff );
};};case PixNotSrcAndDst :for _egce =0;_egce < _acgb ;_egce ++{_dfef =_aeeeb +_egce *_bggge .RowStride ;_abba =_feb +_egce *_abadc .RowStride ;for _dcab =0;_dcab < _ggb ;_dcab ++{_abadc .Data [_abba ]&=^(_bggge .Data [_dfef ]);_abba ++;_dfef ++;};if _aecc > 0{_abadc .Data [_abba ]=_egbbc (_abadc .Data [_abba ],^(_bggge .Data [_dfef ])&_abadc .Data [_abba ],_eeff );
};};case PixSrcOrNotDst :for _egce =0;_egce < _acgb ;_egce ++{_dfef =_aeeeb +_egce *_bggge .RowStride ;_abba =_feb +_egce *_abadc .RowStride ;for _dcab =0;_dcab < _ggb ;_dcab ++{_abadc .Data [_abba ]=_bggge .Data [_dfef ]|^(_abadc .Data [_abba ]);_abba ++;
_dfef ++;};if _aecc > 0{_abadc .Data [_abba ]=_egbbc (_abadc .Data [_abba ],_bggge .Data [_dfef ]|^(_abadc .Data [_abba ]),_eeff );};};case PixSrcAndNotDst :for _egce =0;_egce < _acgb ;_egce ++{_dfef =_aeeeb +_egce *_bggge .RowStride ;_abba =_feb +_egce *_abadc .RowStride ;
for _dcab =0;_dcab < _ggb ;_dcab ++{_abadc .Data [_abba ]=_bggge .Data [_dfef ]&^(_abadc .Data [_abba ]);_abba ++;_dfef ++;};if _aecc > 0{_abadc .Data [_abba ]=_egbbc (_abadc .Data [_abba ],_bggge .Data [_dfef ]&^(_abadc .Data [_abba ]),_eeff );};};case PixNotPixSrcOrDst :for _egce =0;
_egce < _acgb ;_egce ++{_dfef =_aeeeb +_egce *_bggge .RowStride ;_abba =_feb +_egce *_abadc .RowStride ;for _dcab =0;_dcab < _ggb ;_dcab ++{_abadc .Data [_abba ]=^(_bggge .Data [_dfef ]|_abadc .Data [_abba ]);_abba ++;_dfef ++;};if _aecc > 0{_abadc .Data [_abba ]=_egbbc (_abadc .Data [_abba ],^(_bggge .Data [_dfef ]|_abadc .Data [_abba ]),_eeff );
};};case PixNotPixSrcAndDst :for _egce =0;_egce < _acgb ;_egce ++{_dfef =_aeeeb +_egce *_bggge .RowStride ;_abba =_feb +_egce *_abadc .RowStride ;for _dcab =0;_dcab < _ggb ;_dcab ++{_abadc .Data [_abba ]=^(_bggge .Data [_dfef ]&_abadc .Data [_abba ]);_abba ++;
_dfef ++;};if _aecc > 0{_abadc .Data [_abba ]=_egbbc (_abadc .Data [_abba ],^(_bggge .Data [_dfef ]&_abadc .Data [_abba ]),_eeff );};};case PixNotPixSrcXorDst :for _egce =0;_egce < _acgb ;_egce ++{_dfef =_aeeeb +_egce *_bggge .RowStride ;_abba =_feb +_egce *_abadc .RowStride ;
for _dcab =0;_dcab < _ggb ;_dcab ++{_abadc .Data [_abba ]=^(_bggge .Data [_dfef ]^_abadc .Data [_abba ]);_abba ++;_dfef ++;};if _aecc > 0{_abadc .Data [_abba ]=_egbbc (_abadc .Data [_abba ],^(_bggge .Data [_dfef ]^_abadc .Data [_abba ]),_eeff );};};default:_abc .Log .Debug ("\u0050\u0072ov\u0069\u0064\u0065d\u0020\u0069\u006e\u0076ali\u0064 r\u0061\u0073\u0074\u0065\u0072\u0020\u006fpe\u0072\u0061\u0074\u006f\u0072\u003a\u0020%\u0076",_bffe );
return _f .Error ("\u0072\u0061\u0073\u0074er\u004f\u0070\u0042\u0079\u0074\u0065\u0041\u006c\u0069\u0067\u006e\u0065\u0064\u004co\u0077","\u0069\u006e\u0076al\u0069\u0064\u0020\u0072\u0061\u0073\u0074\u0065\u0072\u0020\u006f\u0070\u0065\u0072\u0061\u0074\u006f\u0072");
};return nil ;};func (_gaedb *BitmapsArray )AddBitmaps (bm *Bitmaps ){_gaedb .Values =append (_gaedb .Values ,bm )};func (_bbfa *BitmapsArray )AddBox (box *_ab .Rectangle ){_bbfa .Boxes =append (_bbfa .Boxes ,box )};type Selection struct{Height ,Width int ;
Cx ,Cy int ;Name string ;Data [][]SelectionValue ;};func (_gafdd Points )YSorter ()func (_cfg ,_fcgg int )bool {return func (_deffc ,_fbaab int )bool {return _gafdd [_deffc ].Y < _gafdd [_fbaab ].Y };};func (_bbad Points )GetIntY (i int )(int ,error ){if i >=len (_bbad ){return 0,_f .Errorf ("\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047\u0065t\u0049\u006e\u0074\u0059","\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};return int (_bbad [i ].Y ),nil ;};func TstISymbol (t *_c .T ,scale ...int )*Bitmap {_bbdc ,_bcdcf :=NewWithData (1,5,[]byte {0x80,0x80,0x80,0x80,0x80});_d .NoError (t ,_bcdcf );return TstGetScaledSymbol (t ,_bbdc ,scale ...);};func (_bcaag *Points )AddPoint (x ,y float32 ){*_bcaag =append (*_bcaag ,Point {x ,y })};
func TstRSymbol (t *_c .T ,scale ...int )*Bitmap {_fadb ,_gdfeb :=NewWithData (4,5,[]byte {0xF0,0x90,0xF0,0xA0,0x90});_d .NoError (t ,_gdfeb );return TstGetScaledSymbol (t ,_fadb ,scale ...);};func (_eead *Bitmap )GetByte (index int )(byte ,error ){if index > len (_eead .Data )-1||index < 0{return 0,_f .Errorf ("\u0047e\u0074\u0042\u0079\u0074\u0065","\u0069\u006e\u0064\u0065x:\u0020\u0025\u0064\u0020\u006f\u0075\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006eg\u0065",index );
};return _eead .Data [index ],nil ;};func init (){const _ccg ="\u0062\u0069\u0074\u006dap\u0073\u002e\u0069\u006e\u0069\u0074\u0069\u0061\u006c\u0069\u007a\u0061\u0074\u0069o\u006e";_dbef =New (50,40);var _ggdb error ;_dbef ,_ggdb =_dbef .AddBorder (2,1);
if _ggdb !=nil {panic (_f .Wrap (_ggdb ,_ccg ,"f\u0072\u0061\u006d\u0065\u0042\u0069\u0074\u006d\u0061\u0070"));};_cfdg ,_ggdb =NewWithData (50,22,_egbdd );if _ggdb !=nil {panic (_f .Wrap (_ggdb ,_ccg ,"i\u006d\u0061\u0067\u0065\u0042\u0069\u0074\u006d\u0061\u0070"));
};};func _cffg (_cgc ,_aee *Bitmap ,_efb int ,_eeg []byte ,_afd int )(_fff error ){const _ceec ="\u0072\u0065\u0064uc\u0065\u0052\u0061\u006e\u006b\u0042\u0069\u006e\u0061\u0072\u0079\u0032\u004c\u0065\u0076\u0065\u006c\u0033";var (_cda ,_eae ,_fdf ,_cffd ,_deg ,_fcc ,_dgbe ,_gfaa int ;
_adf ,_ebc ,_gfe ,_ffc uint32 ;_fag ,_bad byte ;_cdc uint16 ;);_fce :=make ([]byte ,4);_fdfb :=make ([]byte ,4);for _fdf =0;_fdf < _cgc .Height -1;_fdf ,_cffd =_fdf +2,_cffd +1{_cda =_fdf *_cgc .RowStride ;_eae =_cffd *_aee .RowStride ;for _deg ,_fcc =0,0;
_deg < _afd ;_deg ,_fcc =_deg +4,_fcc +1{for _dgbe =0;_dgbe < 4;_dgbe ++{_gfaa =_cda +_deg +_dgbe ;if _gfaa <=len (_cgc .Data )-1&&_gfaa < _cda +_cgc .RowStride {_fce [_dgbe ]=_cgc .Data [_gfaa ];}else {_fce [_dgbe ]=0x00;};_gfaa =_cda +_cgc .RowStride +_deg +_dgbe ;
if _gfaa <=len (_cgc .Data )-1&&_gfaa < _cda +(2*_cgc .RowStride ){_fdfb [_dgbe ]=_cgc .Data [_gfaa ];}else {_fdfb [_dgbe ]=0x00;};};_adf =_b .BigEndian .Uint32 (_fce );_ebc =_b .BigEndian .Uint32 (_fdfb );_gfe =_adf &_ebc ;_gfe |=_gfe <<1;_ffc =_adf |_ebc ;
_ffc &=_ffc <<1;_ebc =_gfe &_ffc ;_ebc &=0xaaaaaaaa;_adf =_ebc |(_ebc <<7);_fag =byte (_adf >>24);_bad =byte ((_adf >>8)&0xff);_gfaa =_eae +_fcc ;if _gfaa +1==len (_aee .Data )-1||_gfaa +1>=_eae +_aee .RowStride {if _fff =_aee .SetByte (_gfaa ,_eeg [_fag ]);
_fff !=nil {return _f .Wrapf (_fff ,_ceec ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0025d",_gfaa );};}else {_cdc =(uint16 (_eeg [_fag ])<<8)|uint16 (_eeg [_bad ]);if _fff =_aee .setTwoBytes (_gfaa ,_cdc );_fff !=nil {return _f .Wrapf (_fff ,_ceec ,"s\u0065\u0074\u0074\u0069\u006e\u0067 \u0074\u0077\u006f\u0020\u0062\u0079t\u0065\u0073\u0020\u0066\u0061\u0069\u006ce\u0064\u002c\u0020\u0069\u006e\u0064\u0065\u0078\u003a\u0020%\u0064",_gfaa );
};_fcc ++;};};};return nil ;};func _ecbb (_affd ,_gfcc *Bitmap ,_gfebb ,_agb int )(_egcf error ){const _adeg ="\u0073e\u0065d\u0066\u0069\u006c\u006c\u0042i\u006e\u0061r\u0079\u004c\u006f\u0077\u0034";var (_fcec ,_gggb ,_dbbf ,_daaa int ;_ddba ,_acgcb ,_ffefc ,_cgfgd ,_eedad ,_edff ,_bdff byte ;
);for _fcec =0;_fcec < _gfebb ;_fcec ++{_dbbf =_fcec *_affd .RowStride ;_daaa =_fcec *_gfcc .RowStride ;for _gggb =0;_gggb < _agb ;_gggb ++{_ddba ,_egcf =_affd .GetByte (_dbbf +_gggb );if _egcf !=nil {return _f .Wrap (_egcf ,_adeg ,"\u0066i\u0072\u0073\u0074\u0020\u0067\u0065t");
};_acgcb ,_egcf =_gfcc .GetByte (_daaa +_gggb );if _egcf !=nil {return _f .Wrap (_egcf ,_adeg ,"\u0073\u0065\u0063\u006f\u006e\u0064\u0020\u0067\u0065\u0074");};if _fcec > 0{_ffefc ,_egcf =_affd .GetByte (_dbbf -_affd .RowStride +_gggb );if _egcf !=nil {return _f .Wrap (_egcf ,_adeg ,"\u0069\u0020\u003e \u0030");
};_ddba |=_ffefc ;};if _gggb > 0{_cgfgd ,_egcf =_affd .GetByte (_dbbf +_gggb -1);if _egcf !=nil {return _f .Wrap (_egcf ,_adeg ,"\u006a\u0020\u003e \u0030");};_ddba |=_cgfgd <<7;};_ddba &=_acgcb ;if _ddba ==0||(^_ddba )==0{if _egcf =_affd .SetByte (_dbbf +_gggb ,_ddba );
_egcf !=nil {return _f .Wrap (_egcf ,_adeg ,"b\u0074\u0020\u003d\u003d 0\u0020|\u007c\u0020\u0028\u005e\u0062t\u0029\u0020\u003d\u003d\u0020\u0030");};continue ;};for {_bdff =_ddba ;_ddba =(_ddba |(_ddba >>1)|(_ddba <<1))&_acgcb ;if (_ddba ^_bdff )==0{if _egcf =_affd .SetByte (_dbbf +_gggb ,_ddba );
_egcf !=nil {return _f .Wrap (_egcf ,_adeg ,"\u0073\u0065\u0074\u0074\u0069\u006e\u0067\u0020\u0070\u0072\u0065\u0076 \u0062\u0079\u0074\u0065");};break ;};};};};for _fcec =_gfebb -1;_fcec >=0;_fcec --{_dbbf =_fcec *_affd .RowStride ;_daaa =_fcec *_gfcc .RowStride ;
for _gggb =_agb -1;_gggb >=0;_gggb --{if _ddba ,_egcf =_affd .GetByte (_dbbf +_gggb );_egcf !=nil {return _f .Wrap (_egcf ,_adeg ,"\u0072\u0065\u0076\u0065\u0072\u0073\u0065\u0020\u0066\u0069\u0072\u0073t\u0020\u0067\u0065\u0074");};if _acgcb ,_egcf =_gfcc .GetByte (_daaa +_gggb );
_egcf !=nil {return _f .Wrap (_egcf ,_adeg ,"r\u0065\u0076\u0065\u0072se\u0020g\u0065\u0074\u0020\u006d\u0061s\u006b\u0020\u0062\u0079\u0074\u0065");};if _fcec < _gfebb -1{if _eedad ,_egcf =_affd .GetByte (_dbbf +_affd .RowStride +_gggb );_egcf !=nil {return _f .Wrap (_egcf ,_adeg ,"\u0072\u0065v\u0065\u0072\u0073e\u0020\u0069\u0020\u003c\u0020\u0068\u0020\u002d\u0031");
};_ddba |=_eedad ;};if _gggb < _agb -1{if _edff ,_egcf =_affd .GetByte (_dbbf +_gggb +1);_egcf !=nil {return _f .Wrap (_egcf ,_adeg ,"\u0072\u0065\u0076\u0065rs\u0065\u0020\u006a\u0020\u003c\u0020\u0077\u0070\u006c\u0020\u002d\u0020\u0031");};_ddba |=_edff >>7;
};_ddba &=_acgcb ;if _ddba ==0||(^_ddba )==0{if _egcf =_affd .SetByte (_dbbf +_gggb ,_ddba );_egcf !=nil {return _f .Wrap (_egcf ,_adeg ,"\u0073\u0065\u0074\u0074\u0069\u006e\u0067\u0020\u006d\u0061\u0073k\u0065\u0064\u0020\u0062\u0079\u0074\u0065\u0020\u0066\u0061i\u006c\u0065\u0064");
};continue ;};for {_bdff =_ddba ;_ddba =(_ddba |(_ddba >>1)|(_ddba <<1))&_acgcb ;if (_ddba ^_bdff )==0{if _egcf =_affd .SetByte (_dbbf +_gggb ,_ddba );_egcf !=nil {return _f .Wrap (_egcf ,_adeg ,"\u0072e\u0076\u0065\u0072\u0073e\u0020\u0073\u0065\u0074\u0074i\u006eg\u0020p\u0072\u0065\u0076\u0020\u0062\u0079\u0074e");
};break ;};};};};return nil ;};func (_ccd *Bitmap )ClipRectangle (box *_ab .Rectangle )(_fca *Bitmap ,_dbg *_ab .Rectangle ,_gdb error ){const _faa ="\u0043\u006c\u0069\u0070\u0052\u0065\u0063\u0074\u0061\u006e\u0067\u006c\u0065";if box ==nil {return nil ,nil ,_f .Error (_faa ,"\u0062o\u0078 \u0069\u0073\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");
};_dae ,_ddd :=_ccd .Width ,_ccd .Height ;_cdg :=_ab .Rect (0,0,_dae ,_ddd );if !box .Overlaps (_cdg ){return nil ,nil ,_f .Error (_faa ,"b\u006f\u0078\u0020\u0064oe\u0073n\u0027\u0074\u0020\u006f\u0076e\u0072\u006c\u0061\u0070\u0020\u0062");};_edb :=box .Intersect (_cdg );
_agg ,_gfce :=_edb .Min .X ,_edb .Min .Y ;_gab ,_bce :=_edb .Dx (),_edb .Dy ();_fca =New (_gab ,_bce );_fca .Text =_ccd .Text ;if _gdb =_fca .RasterOperation (0,0,_gab ,_bce ,PixSrc ,_ccd ,_agg ,_gfce );_gdb !=nil {return nil ,nil ,_f .Wrap (_gdb ,_faa ,"\u0050\u0069\u0078\u0053\u0072\u0063\u0020\u0074\u006f\u0020\u0063\u006ci\u0070\u0070\u0065\u0064");
};_dbg =&_edb ;return _fca ,_dbg ,nil ;};func _gbdg (_ebba ,_ddgg ,_cgfc *Bitmap )(*Bitmap ,error ){const _aabc ="\u0062\u0069\u0074\u006d\u0061\u0070\u002e\u0078\u006f\u0072";if _ddgg ==nil {return nil ,_f .Error (_aabc ,"'\u0062\u0031\u0027\u0020\u0069\u0073\u0020\u006e\u0069\u006c");
};if _cgfc ==nil {return nil ,_f .Error (_aabc ,"'\u0062\u0032\u0027\u0020\u0069\u0073\u0020\u006e\u0069\u006c");};if _ebba ==_cgfc {return nil ,_f .Error (_aabc ,"'\u0064\u0027\u0020\u003d\u003d\u0020\u0027\u0062\u0032\u0027");};if !_ddgg .SizesEqual (_cgfc ){_abc .Log .Debug ("\u0025s\u0020\u002d \u0042\u0069\u0074\u006da\u0070\u0020\u0027b\u0031\u0027\u0020\u0069\u0073\u0020\u006e\u006f\u0074 e\u0071\u0075\u0061l\u0020\u0073i\u007a\u0065\u0020\u0077\u0069\u0074h\u0020\u0027b\u0032\u0027",_aabc );
};var _edeb error ;if _ebba ,_edeb =_bee (_ebba ,_ddgg );_edeb !=nil {return nil ,_f .Wrap (_edeb ,_aabc ,"\u0063\u0061n\u0027\u0074\u0020c\u0072\u0065\u0061\u0074\u0065\u0020\u0027\u0064\u0027");};if _edeb =_ebba .RasterOperation (0,0,_ebba .Width ,_ebba .Height ,PixSrcXorDst ,_cgfc ,0,0);
_edeb !=nil {return nil ,_f .Wrap (_edeb ,_aabc ,"");};return _ebba ,nil ;};func (_fecc *Points )Add (pt *Points )error {const _cfffg ="\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0041\u0064\u0064";if _fecc ==nil {return _f .Error (_cfffg ,"\u0070o\u0069n\u0074\u0073\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");
};if pt ==nil {return _f .Error (_cfffg ,"a\u0072\u0067\u0075\u006d\u0065\u006et\u0020\u0070\u006f\u0069\u006e\u0074\u0073\u0020\u006eo\u0074\u0020\u0064e\u0066i\u006e\u0065\u0064");};*_fecc =append (*_fecc ,*pt ...);return nil ;};var _egbdd =[]byte {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3E,0x78,0x27,0xC2,0x27,0x91,0x00,0x22,0x48,0x21,0x03,0x24,0x91,0x00,0x22,0x48,0x21,0x02,0xA4,0x95,0x00,0x22,0x48,0x21,0x02,0x64,0x9B,0x00,0x3C,0x78,0x21,0x02,0x27,0x91,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0xF8,0x00,0x00,0x00,0x00,0x00,0x7F,0xF8,0x00,0x00,0x00,0x00,0x00,0x63,0x18,0x00,0x00,0x00,0x00,0x00,0x63,0x18,0x00,0x00,0x00,0x00,0x00,0x63,0x18,0x00,0x00,0x00,0x00,0x00,0x7F,0xF8,0x00,0x00,0x00,0x00,0x00,0x15,0x50,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
func (_aef *Bitmap )setEightFullBytes (_gbc int ,_dgc uint64 )error {if _gbc +7> len (_aef .Data )-1{return _f .Error ("\u0073\u0065\u0074\u0045\u0069\u0067\u0068\u0074\u0042\u0079\u0074\u0065\u0073","\u0069n\u0064e\u0078\u0020\u006f\u0075\u0074 \u006f\u0066 \u0072\u0061\u006e\u0067\u0065");
};_aef .Data [_gbc ]=byte ((_dgc &0xff00000000000000)>>56);_aef .Data [_gbc +1]=byte ((_dgc &0xff000000000000)>>48);_aef .Data [_gbc +2]=byte ((_dgc &0xff0000000000)>>40);_aef .Data [_gbc +3]=byte ((_dgc &0xff00000000)>>32);_aef .Data [_gbc +4]=byte ((_dgc &0xff000000)>>24);
_aef .Data [_gbc +5]=byte ((_dgc &0xff0000)>>16);_aef .Data [_gbc +6]=byte ((_dgc &0xff00)>>8);_aef .Data [_gbc +7]=byte (_dgc &0xff);return nil ;};func (_cfegb *Bitmaps )SortByWidth (){_acfeb :=(*byWidth )(_cfegb );_dc .Sort (_acfeb )};func TstNSymbol (t *_c .T ,scale ...int )*Bitmap {_gfaea ,_debfa :=NewWithData (4,5,[]byte {0x90,0xD0,0xB0,0x90,0x90});
_d .NoError (t ,_debfa );return TstGetScaledSymbol (t ,_gfaea ,scale ...);};func (_cefg MorphProcess )getWidthHeight ()(_fbedd ,_fgaac int ){return _cefg .Arguments [0],_cefg .Arguments [1];};func (_eaf *Bitmap )countPixels ()int {var (_add int ;_dfbf uint8 ;
_dbce byte ;_gcae int ;);_cfbb :=_eaf .RowStride ;_edgc :=uint (_eaf .Width &0x07);if _edgc !=0{_dfbf =uint8 ((0xff<<(8-_edgc ))&0xff);_cfbb --;};for _bbd :=0;_bbd < _eaf .Height ;_bbd ++{for _gcae =0;_gcae < _cfbb ;_gcae ++{_dbce =_eaf .Data [_bbd *_eaf .RowStride +_gcae ];
_add +=int (_bgd [_dbce ]);};if _edgc !=0{_add +=int (_bgd [_eaf .Data [_bbd *_eaf .RowStride +_gcae ]&_dfbf ]);};};return _add ;};func _gda ()(_fg [256]uint32 ){for _bage :=0;_bage < 256;_bage ++{if _bage &0x01!=0{_fg [_bage ]|=0xf;};if _bage &0x02!=0{_fg [_bage ]|=0xf0;
};if _bage &0x04!=0{_fg [_bage ]|=0xf00;};if _bage &0x08!=0{_fg [_bage ]|=0xf000;};if _bage &0x10!=0{_fg [_bage ]|=0xf0000;};if _bage &0x20!=0{_fg [_bage ]|=0xf00000;};if _bage &0x40!=0{_fg [_bage ]|=0xf000000;};if _bage &0x80!=0{_fg [_bage ]|=0xf0000000;
};};return _fg ;};func (_ecad *ClassedPoints )Less (i ,j int )bool {return _ecad ._gebc (i ,j )};func TstWordBitmapWithSpaces (t *_c .T ,scale ...int )*Bitmap {_fbfe :=1;if len (scale )> 0{_fbfe =scale [0];};_dfeee :=3;_baef :=9+7+15+2*_dfeee +2*_dfeee ;
_fgfg :=5+_dfeee +5+2*_dfeee ;_dedac :=New (_baef *_fbfe ,_fgfg *_fbfe );_egbgg :=&Bitmaps {};var _ddea *int ;_dfeee *=_fbfe ;_gfgc :=_dfeee ;_ddea =&_gfgc ;_dega :=_dfeee ;_cbca :=TstDSymbol (t ,scale ...);TstAddSymbol (t ,_egbgg ,_cbca ,_ddea ,_dega ,1*_fbfe );
_cbca =TstOSymbol (t ,scale ...);TstAddSymbol (t ,_egbgg ,_cbca ,_ddea ,_dega ,_dfeee );_cbca =TstISymbol (t ,scale ...);TstAddSymbol (t ,_egbgg ,_cbca ,_ddea ,_dega ,1*_fbfe );_cbca =TstTSymbol (t ,scale ...);TstAddSymbol (t ,_egbgg ,_cbca ,_ddea ,_dega ,_dfeee );
_cbca =TstNSymbol (t ,scale ...);TstAddSymbol (t ,_egbgg ,_cbca ,_ddea ,_dega ,1*_fbfe );_cbca =TstOSymbol (t ,scale ...);TstAddSymbol (t ,_egbgg ,_cbca ,_ddea ,_dega ,1*_fbfe );_cbca =TstWSymbol (t ,scale ...);TstAddSymbol (t ,_egbgg ,_cbca ,_ddea ,_dega ,0);
*_ddea =_dfeee ;_dega =5*_fbfe +_dfeee ;_cbca =TstOSymbol (t ,scale ...);TstAddSymbol (t ,_egbgg ,_cbca ,_ddea ,_dega ,1*_fbfe );_cbca =TstRSymbol (t ,scale ...);TstAddSymbol (t ,_egbgg ,_cbca ,_ddea ,_dega ,_dfeee );_cbca =TstNSymbol (t ,scale ...);TstAddSymbol (t ,_egbgg ,_cbca ,_ddea ,_dega ,1*_fbfe );
_cbca =TstESymbol (t ,scale ...);TstAddSymbol (t ,_egbgg ,_cbca ,_ddea ,_dega ,1*_fbfe );_cbca =TstVSymbol (t ,scale ...);TstAddSymbol (t ,_egbgg ,_cbca ,_ddea ,_dega ,1*_fbfe );_cbca =TstESymbol (t ,scale ...);TstAddSymbol (t ,_egbgg ,_cbca ,_ddea ,_dega ,1*_fbfe );
_cbca =TstRSymbol (t ,scale ...);TstAddSymbol (t ,_egbgg ,_cbca ,_ddea ,_dega ,0);TstWriteSymbols (t ,_egbgg ,_dedac );return _dedac ;};func (_gfcd *Bitmap )setPadBits (_cbde int ){_aeee :=8-_gfcd .Width %8;if _aeee ==8{return ;};_ddbc :=_gfcd .Width /8;
_acga :=_dgeaa [_aeee ];if _cbde ==0{_acga ^=_acga ;};var _fdae int ;for _dcfec :=0;_dcfec < _gfcd .Height ;_dcfec ++{_fdae =_dcfec *_gfcd .RowStride +_ddbc ;if _cbde ==0{_gfcd .Data [_fdae ]&=_acga ;}else {_gfcd .Data [_fdae ]|=_acga ;};};};type byHeight Bitmaps ;
func (_becf *Bitmaps )AddBox (box *_ab .Rectangle ){_becf .Boxes =append (_becf .Boxes ,box )};func _gadae (_cabc *Bitmap ,_cdeag ,_efece ,_feff ,_abga int ,_cfda RasterOperator ,_bdbg *Bitmap ,_aaac ,_ggf int )error {var (_dcfb bool ;_bbbaa bool ;_ecda int ;
_bbbd int ;_gbbac int ;_bdgg bool ;_bbed byte ;_cffdd int ;_eagbg int ;_abfb int ;_gfbg ,_ceda int ;);_daeg :=8-(_cdeag &7);_adfeg :=_dgeaa [_daeg ];_adebb :=_cabc .RowStride *_efece +(_cdeag >>3);_cfde :=_bdbg .RowStride *_ggf +(_aaac >>3);if _feff < _daeg {_dcfb =true ;
_adfeg &=_abfdd [8-_daeg +_feff ];};if !_dcfb {_ecda =(_feff -_daeg )>>3;if _ecda > 0{_bbbaa =true ;_bbbd =_adebb +1;_gbbac =_cfde +1;};};_cffdd =(_cdeag +_feff )&7;if !_dcfb &&_cffdd !=0{_bdgg =true ;_bbed =_abfdd [_cffdd ];_eagbg =_adebb +1+_ecda ;_abfb =_cfde +1+_ecda ;
};switch _cfda {case PixSrc :for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_adebb ]=_egbbc (_cabc .Data [_adebb ],_bdbg .Data [_cfde ],_adfeg );_adebb +=_cabc .RowStride ;_cfde +=_bdbg .RowStride ;};if _bbbaa {for _gfbg =0;_gfbg < _abga ;_gfbg ++{for _ceda =0;
_ceda < _ecda ;_ceda ++{_cabc .Data [_bbbd +_ceda ]=_bdbg .Data [_gbbac +_ceda ];};_bbbd +=_cabc .RowStride ;_gbbac +=_bdbg .RowStride ;};};if _bdgg {for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_eagbg ]=_egbbc (_cabc .Data [_eagbg ],_bdbg .Data [_abfb ],_bbed );
_eagbg +=_cabc .RowStride ;_abfb +=_bdbg .RowStride ;};};case PixNotSrc :for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_adebb ]=_egbbc (_cabc .Data [_adebb ],^_bdbg .Data [_cfde ],_adfeg );_adebb +=_cabc .RowStride ;_cfde +=_bdbg .RowStride ;};if _bbbaa {for _gfbg =0;
_gfbg < _abga ;_gfbg ++{for _ceda =0;_ceda < _ecda ;_ceda ++{_cabc .Data [_bbbd +_ceda ]=^_bdbg .Data [_gbbac +_ceda ];};_bbbd +=_cabc .RowStride ;_gbbac +=_bdbg .RowStride ;};};if _bdgg {for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_eagbg ]=_egbbc (_cabc .Data [_eagbg ],^_bdbg .Data [_abfb ],_bbed );
_eagbg +=_cabc .RowStride ;_abfb +=_bdbg .RowStride ;};};case PixSrcOrDst :for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_adebb ]=_egbbc (_cabc .Data [_adebb ],_bdbg .Data [_cfde ]|_cabc .Data [_adebb ],_adfeg );_adebb +=_cabc .RowStride ;_cfde +=_bdbg .RowStride ;
};if _bbbaa {for _gfbg =0;_gfbg < _abga ;_gfbg ++{for _ceda =0;_ceda < _ecda ;_ceda ++{_cabc .Data [_bbbd +_ceda ]|=_bdbg .Data [_gbbac +_ceda ];};_bbbd +=_cabc .RowStride ;_gbbac +=_bdbg .RowStride ;};};if _bdgg {for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_eagbg ]=_egbbc (_cabc .Data [_eagbg ],_bdbg .Data [_abfb ]|_cabc .Data [_eagbg ],_bbed );
_eagbg +=_cabc .RowStride ;_abfb +=_bdbg .RowStride ;};};case PixSrcAndDst :for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_adebb ]=_egbbc (_cabc .Data [_adebb ],_bdbg .Data [_cfde ]&_cabc .Data [_adebb ],_adfeg );_adebb +=_cabc .RowStride ;_cfde +=_bdbg .RowStride ;
};if _bbbaa {for _gfbg =0;_gfbg < _abga ;_gfbg ++{for _ceda =0;_ceda < _ecda ;_ceda ++{_cabc .Data [_bbbd +_ceda ]&=_bdbg .Data [_gbbac +_ceda ];};_bbbd +=_cabc .RowStride ;_gbbac +=_bdbg .RowStride ;};};if _bdgg {for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_eagbg ]=_egbbc (_cabc .Data [_eagbg ],_bdbg .Data [_abfb ]&_cabc .Data [_eagbg ],_bbed );
_eagbg +=_cabc .RowStride ;_abfb +=_bdbg .RowStride ;};};case PixSrcXorDst :for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_adebb ]=_egbbc (_cabc .Data [_adebb ],_bdbg .Data [_cfde ]^_cabc .Data [_adebb ],_adfeg );_adebb +=_cabc .RowStride ;_cfde +=_bdbg .RowStride ;
};if _bbbaa {for _gfbg =0;_gfbg < _abga ;_gfbg ++{for _ceda =0;_ceda < _ecda ;_ceda ++{_cabc .Data [_bbbd +_ceda ]^=_bdbg .Data [_gbbac +_ceda ];};_bbbd +=_cabc .RowStride ;_gbbac +=_bdbg .RowStride ;};};if _bdgg {for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_eagbg ]=_egbbc (_cabc .Data [_eagbg ],_bdbg .Data [_abfb ]^_cabc .Data [_eagbg ],_bbed );
_eagbg +=_cabc .RowStride ;_abfb +=_bdbg .RowStride ;};};case PixNotSrcOrDst :for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_adebb ]=_egbbc (_cabc .Data [_adebb ],^(_bdbg .Data [_cfde ])|_cabc .Data [_adebb ],_adfeg );_adebb +=_cabc .RowStride ;_cfde +=_bdbg .RowStride ;
};if _bbbaa {for _gfbg =0;_gfbg < _abga ;_gfbg ++{for _ceda =0;_ceda < _ecda ;_ceda ++{_cabc .Data [_bbbd +_ceda ]|=^(_bdbg .Data [_gbbac +_ceda ]);};_bbbd +=_cabc .RowStride ;_gbbac +=_bdbg .RowStride ;};};if _bdgg {for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_eagbg ]=_egbbc (_cabc .Data [_eagbg ],^(_bdbg .Data [_abfb ])|_cabc .Data [_eagbg ],_bbed );
_eagbg +=_cabc .RowStride ;_abfb +=_bdbg .RowStride ;};};case PixNotSrcAndDst :for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_adebb ]=_egbbc (_cabc .Data [_adebb ],^(_bdbg .Data [_cfde ])&_cabc .Data [_adebb ],_adfeg );_adebb +=_cabc .RowStride ;_cfde +=_bdbg .RowStride ;
};if _bbbaa {for _gfbg =0;_gfbg < _abga ;_gfbg ++{for _ceda =0;_ceda < _ecda ;_ceda ++{_cabc .Data [_bbbd +_ceda ]&=^_bdbg .Data [_gbbac +_ceda ];};_bbbd +=_cabc .RowStride ;_gbbac +=_bdbg .RowStride ;};};if _bdgg {for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_eagbg ]=_egbbc (_cabc .Data [_eagbg ],^(_bdbg .Data [_abfb ])&_cabc .Data [_eagbg ],_bbed );
_eagbg +=_cabc .RowStride ;_abfb +=_bdbg .RowStride ;};};case PixSrcOrNotDst :for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_adebb ]=_egbbc (_cabc .Data [_adebb ],_bdbg .Data [_cfde ]|^(_cabc .Data [_adebb ]),_adfeg );_adebb +=_cabc .RowStride ;_cfde +=_bdbg .RowStride ;
};if _bbbaa {for _gfbg =0;_gfbg < _abga ;_gfbg ++{for _ceda =0;_ceda < _ecda ;_ceda ++{_cabc .Data [_bbbd +_ceda ]=_bdbg .Data [_gbbac +_ceda ]|^(_cabc .Data [_bbbd +_ceda ]);};_bbbd +=_cabc .RowStride ;_gbbac +=_bdbg .RowStride ;};};if _bdgg {for _gfbg =0;
_gfbg < _abga ;_gfbg ++{_cabc .Data [_eagbg ]=_egbbc (_cabc .Data [_eagbg ],_bdbg .Data [_abfb ]|^(_cabc .Data [_eagbg ]),_bbed );_eagbg +=_cabc .RowStride ;_abfb +=_bdbg .RowStride ;};};case PixSrcAndNotDst :for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_adebb ]=_egbbc (_cabc .Data [_adebb ],_bdbg .Data [_cfde ]&^(_cabc .Data [_adebb ]),_adfeg );
_adebb +=_cabc .RowStride ;_cfde +=_bdbg .RowStride ;};if _bbbaa {for _gfbg =0;_gfbg < _abga ;_gfbg ++{for _ceda =0;_ceda < _ecda ;_ceda ++{_cabc .Data [_bbbd +_ceda ]=_bdbg .Data [_gbbac +_ceda ]&^(_cabc .Data [_bbbd +_ceda ]);};_bbbd +=_cabc .RowStride ;
_gbbac +=_bdbg .RowStride ;};};if _bdgg {for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_eagbg ]=_egbbc (_cabc .Data [_eagbg ],_bdbg .Data [_abfb ]&^(_cabc .Data [_eagbg ]),_bbed );_eagbg +=_cabc .RowStride ;_abfb +=_bdbg .RowStride ;};};case PixNotPixSrcOrDst :for _gfbg =0;
_gfbg < _abga ;_gfbg ++{_cabc .Data [_adebb ]=_egbbc (_cabc .Data [_adebb ],^(_bdbg .Data [_cfde ]|_cabc .Data [_adebb ]),_adfeg );_adebb +=_cabc .RowStride ;_cfde +=_bdbg .RowStride ;};if _bbbaa {for _gfbg =0;_gfbg < _abga ;_gfbg ++{for _ceda =0;_ceda < _ecda ;
_ceda ++{_cabc .Data [_bbbd +_ceda ]=^(_bdbg .Data [_gbbac +_ceda ]|_cabc .Data [_bbbd +_ceda ]);};_bbbd +=_cabc .RowStride ;_gbbac +=_bdbg .RowStride ;};};if _bdgg {for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_eagbg ]=_egbbc (_cabc .Data [_eagbg ],^(_bdbg .Data [_abfb ]|_cabc .Data [_eagbg ]),_bbed );
_eagbg +=_cabc .RowStride ;_abfb +=_bdbg .RowStride ;};};case PixNotPixSrcAndDst :for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_adebb ]=_egbbc (_cabc .Data [_adebb ],^(_bdbg .Data [_cfde ]&_cabc .Data [_adebb ]),_adfeg );_adebb +=_cabc .RowStride ;
_cfde +=_bdbg .RowStride ;};if _bbbaa {for _gfbg =0;_gfbg < _abga ;_gfbg ++{for _ceda =0;_ceda < _ecda ;_ceda ++{_cabc .Data [_bbbd +_ceda ]=^(_bdbg .Data [_gbbac +_ceda ]&_cabc .Data [_bbbd +_ceda ]);};_bbbd +=_cabc .RowStride ;_gbbac +=_bdbg .RowStride ;
};};if _bdgg {for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_eagbg ]=_egbbc (_cabc .Data [_eagbg ],^(_bdbg .Data [_abfb ]&_cabc .Data [_eagbg ]),_bbed );_eagbg +=_cabc .RowStride ;_abfb +=_bdbg .RowStride ;};};case PixNotPixSrcXorDst :for _gfbg =0;
_gfbg < _abga ;_gfbg ++{_cabc .Data [_adebb ]=_egbbc (_cabc .Data [_adebb ],^(_bdbg .Data [_cfde ]^_cabc .Data [_adebb ]),_adfeg );_adebb +=_cabc .RowStride ;_cfde +=_bdbg .RowStride ;};if _bbbaa {for _gfbg =0;_gfbg < _abga ;_gfbg ++{for _ceda =0;_ceda < _ecda ;
_ceda ++{_cabc .Data [_bbbd +_ceda ]=^(_bdbg .Data [_gbbac +_ceda ]^_cabc .Data [_bbbd +_ceda ]);};_bbbd +=_cabc .RowStride ;_gbbac +=_bdbg .RowStride ;};};if _bdgg {for _gfbg =0;_gfbg < _abga ;_gfbg ++{_cabc .Data [_eagbg ]=_egbbc (_cabc .Data [_eagbg ],^(_bdbg .Data [_abfb ]^_cabc .Data [_eagbg ]),_bbed );
_eagbg +=_cabc .RowStride ;_abfb +=_bdbg .RowStride ;};};default:_abc .Log .Debug ("I\u006e\u0076\u0061\u006c\u0069\u0064 \u0072\u0061\u0073\u0074\u0065\u0072\u0020\u006f\u0070e\u0072\u0061\u0074o\u0072:\u0020\u0025\u0064",_cfda );return _f .Error ("\u0072\u0061\u0073\u0074er\u004f\u0070\u0056\u0041\u006c\u0069\u0067\u006e\u0065\u0064\u004c\u006f\u0077","\u0069\u006e\u0076al\u0069\u0064\u0020\u0072\u0061\u0073\u0074\u0065\u0072\u0020\u006f\u0070\u0065\u0072\u0061\u0074\u006f\u0072");
};return nil ;};func _ccef (_afba *Bitmap ,_gada ,_gaed int ,_ddcf ,_agfd int ,_dced RasterOperator ,_ced *Bitmap ,_abfd ,_gdccc int )error {var _bgea ,_bdfg ,_ecag ,_gdgg int ;if _gada < 0{_abfd -=_gada ;_ddcf +=_gada ;_gada =0;};if _abfd < 0{_gada -=_abfd ;
_ddcf +=_abfd ;_abfd =0;};_bgea =_gada +_ddcf -_afba .Width ;if _bgea > 0{_ddcf -=_bgea ;};_bdfg =_abfd +_ddcf -_ced .Width ;if _bdfg > 0{_ddcf -=_bdfg ;};if _gaed < 0{_gdccc -=_gaed ;_agfd +=_gaed ;_gaed =0;};if _gdccc < 0{_gaed -=_gdccc ;_agfd +=_gdccc ;
_gdccc =0;};_ecag =_gaed +_agfd -_afba .Height ;if _ecag > 0{_agfd -=_ecag ;};_gdgg =_gdccc +_agfd -_ced .Height ;if _gdgg > 0{_agfd -=_gdgg ;};if _ddcf <=0||_agfd <=0{return nil ;};var _dfce error ;switch {case _gada &7==0&&_abfd &7==0:_dfce =_aabfd (_afba ,_gada ,_gaed ,_ddcf ,_agfd ,_dced ,_ced ,_abfd ,_gdccc );
case _gada &7==_abfd &7:_dfce =_gadae (_afba ,_gada ,_gaed ,_ddcf ,_agfd ,_dced ,_ced ,_abfd ,_gdccc );default:_dfce =_gacfa (_afba ,_gada ,_gaed ,_ddcf ,_agfd ,_dced ,_ced ,_abfd ,_gdccc );};if _dfce !=nil {return _f .Wrap (_dfce ,"r\u0061\u0073\u0074\u0065\u0072\u004f\u0070\u004c\u006f\u0077","");
};return nil ;};func (_bcf *Bitmap )String ()string {var _dgbf ="\u000a";for _daab :=0;_daab < _bcf .Height ;_daab ++{var _dcfg string ;for _bcg :=0;_bcg < _bcf .Width ;_bcg ++{_efed :=_bcf .GetPixel (_bcg ,_daab );if _efed {_dcfg +="\u0031";}else {_dcfg +="\u0030";
};};_dgbf +=_dcfg +"\u000a";};return _dgbf ;};func (_fcf *Bitmap )nextOnPixel (_bdgc ,_ebfc int )(_dbea _ab .Point ,_fcfd bool ,_fbeb error ){const _fcg ="n\u0065\u0078\u0074\u004f\u006e\u0050\u0069\u0078\u0065\u006c";_dbea ,_fcfd ,_fbeb =_fcf .nextOnPixelLow (_fcf .Width ,_fcf .Height ,_fcf .RowStride ,_bdgc ,_ebfc );
if _fbeb !=nil {return _dbea ,false ,_f .Wrap (_fbeb ,_fcg ,"");};return _dbea ,_fcfd ,nil ;};func Centroid (bm *Bitmap ,centTab ,sumTab []int )(Point ,error ){return bm .centroid (centTab ,sumTab )};