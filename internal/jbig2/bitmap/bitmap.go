//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package bitmap ;import (_fg "encoding/binary";_a "github.com/stretchr/testify/require";_ca "github.com/unidoc/unipdf/v4/common";_fd "github.com/unidoc/unipdf/v4/internal/bitwise";_f "github.com/unidoc/unipdf/v4/internal/imageutil";_ab "github.com/unidoc/unipdf/v4/internal/jbig2/basic";
_b "github.com/unidoc/unipdf/v4/internal/jbig2/errors";_dc "image";_ae "math";_gc "sort";_d "strings";_c "testing";);type LocationFilter int ;func _ffgc (_bdcb ,_ebed byte ,_gebd CombinationOperator )byte {switch _gebd {case CmbOpOr :return _ebed |_bdcb ;
case CmbOpAnd :return _ebed &_bdcb ;case CmbOpXor :return _ebed ^_bdcb ;case CmbOpXNor :return ^(_ebed ^_bdcb );case CmbOpNot :return ^(_ebed );default:return _ebed ;};};func _cdg (_ffcf *Bitmap ,_gdg ...int )(_gfa *Bitmap ,_fed error ){const _ge ="\u0072\u0065\u0064uc\u0065\u0052\u0061\u006e\u006b\u0042\u0069\u006e\u0061\u0072\u0079\u0043\u0061\u0073\u0063\u0061\u0064\u0065";
if _ffcf ==nil {return nil ,_b .Error (_ge ,"\u0073o\u0075\u0072\u0063\u0065 \u0062\u0069\u0074\u006d\u0061p\u0020n\u006ft\u0020\u0064\u0065\u0066\u0069\u006e\u0065d");};if len (_gdg )==0||len (_gdg )> 4{return nil ,_b .Error (_ge ,"t\u0068\u0065\u0072\u0065\u0020\u006d\u0075\u0073\u0074 \u0062\u0065\u0020\u0061\u0074\u0020\u006cea\u0073\u0074\u0020\u006fn\u0065\u0020\u0061\u006e\u0064\u0020\u0061\u0074\u0020mo\u0073\u0074 \u0034\u0020\u006c\u0065\u0076\u0065\u006c\u0073");
};if _gdg [0]<=0{_ca .Log .Debug ("\u006c\u0065\u0076\u0065\u006c\u0031\u0020\u003c\u003d\u0020\u0030 \u002d\u0020\u006e\u006f\u0020\u0072\u0065\u0064\u0075\u0063t\u0069\u006f\u006e");_gfa ,_fed =_dged (nil ,_ffcf );if _fed !=nil {return nil ,_b .Wrap (_fed ,_ge ,"l\u0065\u0076\u0065\u006c\u0031\u0020\u003c\u003d\u0020\u0030");
};return _gfa ,nil ;};_gfg :=_ebc ();_gfa =_ffcf ;for _gg ,_cba :=range _gdg {if _cba <=0{break ;};_gfa ,_fed =_gbd (_gfa ,_cba ,_gfg );if _fed !=nil {return nil ,_b .Wrapf (_fed ,_ge ,"\u006c\u0065\u0076\u0065\u006c\u0025\u0064\u0020\u0072\u0065\u0064\u0075c\u0074\u0069\u006f\u006e",_gg );
};};return _gfa ,nil ;};func (_ceba *Boxes )Get (i int )(*_dc .Rectangle ,error ){const _dbab ="\u0042o\u0078\u0065\u0073\u002e\u0047\u0065t";if _ceba ==nil {return nil ,_b .Error (_dbab ,"\u0027\u0042\u006f\u0078es\u0027\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};if i > len (*_ceba )-1{return nil ,_b .Errorf (_dbab ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );};return (*_ceba )[i ],nil ;};func (_bee *Bitmap )SizesEqual (s *Bitmap )bool {if _bee ==s {return true ;
};if _bee .Width !=s .Width ||_bee .Height !=s .Height {return false ;};return true ;};func (_gec *Bitmap )setEightBytes (_fbdg int ,_abda uint64 )error {_aeaf :=_gec .RowStride -(_fbdg %_gec .RowStride );if _gec .RowStride !=_gec .Width >>3{_aeaf --;};
if _aeaf >=8{return _gec .setEightFullBytes (_fbdg ,_abda );};return _gec .setEightPartlyBytes (_fbdg ,_aeaf ,_abda );};func New (width ,height int )*Bitmap {_dae :=_gcd (width ,height );_dae .Data =make ([]byte ,height *_dae .RowStride );return _dae ;
};func _gcd (_gce ,_gdd int )*Bitmap {return &Bitmap {Width :_gce ,Height :_gdd ,RowStride :(_gce +7)>>3};};func _adfbc (_fceb ,_dffe *Bitmap ,_agae *Selection )(*Bitmap ,error ){const _ccgc ="\u0065\u0072\u006fd\u0065";var (_aeeg error ;_becg *Bitmap ;
);_fceb ,_aeeg =_ddde (_fceb ,_dffe ,_agae ,&_becg );if _aeeg !=nil {return nil ,_b .Wrap (_aeeg ,_ccgc ,"");};if _aeeg =_fceb .setAll ();_aeeg !=nil {return nil ,_b .Wrap (_aeeg ,_ccgc ,"");};var _ffagbc SelectionValue ;for _gbea :=0;_gbea < _agae .Height ;
_gbea ++{for _fddad :=0;_fddad < _agae .Width ;_fddad ++{_ffagbc =_agae .Data [_gbea ][_fddad ];if _ffagbc ==SelHit {_aeeg =_beeg (_fceb ,_agae .Cx -_fddad ,_agae .Cy -_gbea ,_dffe .Width ,_dffe .Height ,PixSrcAndDst ,_becg ,0,0);if _aeeg !=nil {return nil ,_b .Wrap (_aeeg ,_ccgc ,"");
};};};};if MorphBC ==SymmetricMorphBC {return _fceb ,nil ;};_fdee ,_ecgaa ,_aacc ,_cgega :=_agae .findMaxTranslations ();if _fdee > 0{if _aeeg =_fceb .RasterOperation (0,0,_fdee ,_dffe .Height ,PixClr ,nil ,0,0);_aeeg !=nil {return nil ,_b .Wrap (_aeeg ,_ccgc ,"\u0078\u0070\u0020\u003e\u0020\u0030");
};};if _aacc > 0{if _aeeg =_fceb .RasterOperation (_dffe .Width -_aacc ,0,_aacc ,_dffe .Height ,PixClr ,nil ,0,0);_aeeg !=nil {return nil ,_b .Wrap (_aeeg ,_ccgc ,"\u0078\u006e\u0020\u003e\u0020\u0030");};};if _ecgaa > 0{if _aeeg =_fceb .RasterOperation (0,0,_dffe .Width ,_ecgaa ,PixClr ,nil ,0,0);
_aeeg !=nil {return nil ,_b .Wrap (_aeeg ,_ccgc ,"\u0079\u0070\u0020\u003e\u0020\u0030");};};if _cgega > 0{if _aeeg =_fceb .RasterOperation (0,_dffe .Height -_cgega ,_dffe .Width ,_cgega ,PixClr ,nil ,0,0);_aeeg !=nil {return nil ,_b .Wrap (_aeeg ,_ccgc ,"\u0079\u006e\u0020\u003e\u0020\u0030");
};};return _fceb ,nil ;};func (_ffdd *Bitmap )SetDefaultPixel (){for _ccd :=range _ffdd .Data {_ffdd .Data [_ccd ]=byte (0xff);};};func (_edeb *Boxes )SelectBySize (width ,height int ,tp LocationFilter ,relation SizeComparison )(_cagc *Boxes ,_abff error ){const _cfca ="\u0042o\u0078e\u0073\u002e\u0053\u0065\u006ce\u0063\u0074B\u0079\u0053\u0069\u007a\u0065";
if _edeb ==nil {return nil ,_b .Error (_cfca ,"b\u006f\u0078\u0065\u0073 '\u0062'\u0020\u006e\u006f\u0074\u0020d\u0065\u0066\u0069\u006e\u0065\u0064");};if len (*_edeb )==0{return _edeb ,nil ;};switch tp {case LocSelectWidth ,LocSelectHeight ,LocSelectIfEither ,LocSelectIfBoth :default:return nil ,_b .Errorf (_cfca ,"\u0069\u006e\u0076al\u0069\u0064\u0020\u0066\u0069\u006c\u0074\u0065\u0072\u0020\u0074\u0079\u0070\u0065\u003a\u0020\u0025\u0064",tp );
};switch relation {case SizeSelectIfLT ,SizeSelectIfGT ,SizeSelectIfLTE ,SizeSelectIfGTE :default:return nil ,_b .Errorf (_cfca ,"i\u006e\u0076\u0061\u006c\u0069\u0064 \u0072\u0065\u006c\u0061\u0074\u0069\u006f\u006e\u0020t\u0079\u0070\u0065:\u0020'\u0025\u0064\u0027",tp );
};_gaad :=_edeb .makeSizeIndicator (width ,height ,tp ,relation );_daeae ,_abff :=_edeb .selectWithIndicator (_gaad );if _abff !=nil {return nil ,_b .Wrap (_abff ,_cfca ,"");};return _daeae ,nil ;};func (_agdd *byHeight )Len ()int {return len (_agdd .Values )};
func CorrelationScore (bm1 ,bm2 *Bitmap ,area1 ,area2 int ,delX ,delY float32 ,maxDiffW ,maxDiffH int ,tab []int )(_baef float64 ,_beec error ){const _agcd ="\u0063\u006fr\u0072\u0065\u006ca\u0074\u0069\u006f\u006e\u0053\u0063\u006f\u0072\u0065";if bm1 ==nil ||bm2 ==nil {return 0,_b .Error (_agcd ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0062\u0069\u0074ma\u0070\u0073");
};if tab ==nil {return 0,_b .Error (_agcd ,"\u0027\u0074\u0061\u0062\u0027\u0020\u006e\u006f\u0074\u0020\u0064\u0065f\u0069\u006e\u0065\u0064");};if area1 <=0||area2 <=0{return 0,_b .Error (_agcd ,"\u0061\u0072\u0065\u0061s\u0020\u006d\u0075\u0073\u0074\u0020\u0062\u0065\u0020\u0067r\u0065a\u0074\u0065\u0072\u0020\u0074\u0068\u0061n\u0020\u0030");
};_gbaa ,_abfeb :=bm1 .Width ,bm1 .Height ;_gbaff ,_feeb :=bm2 .Width ,bm2 .Height ;_eedd :=_gaag (_gbaa -_gbaff );if _eedd > maxDiffW {return 0,nil ;};_ffdg :=_gaag (_abfeb -_feeb );if _ffdg > maxDiffH {return 0,nil ;};var _cbce ,_adb int ;if delX >=0{_cbce =int (delX +0.5);
}else {_cbce =int (delX -0.5);};if delY >=0{_adb =int (delY +0.5);}else {_adb =int (delY -0.5);};_dacfb :=_cebc (_adb ,0);_ffef :=_deeg (_feeb +_adb ,_abfeb );_acac :=bm1 .RowStride *_dacfb ;_bfcf :=bm2 .RowStride *(_dacfb -_adb );_bdcad :=_cebc (_cbce ,0);
_dfe :=_deeg (_gbaff +_cbce ,_gbaa );_acff :=bm2 .RowStride ;var _geff ,_dadbe int ;if _cbce >=8{_geff =_cbce >>3;_acac +=_geff ;_bdcad -=_geff <<3;_dfe -=_geff <<3;_cbce &=7;}else if _cbce <=-8{_dadbe =-((_cbce +7)>>3);_bfcf +=_dadbe ;_acff -=_dadbe ;
_cbce +=_dadbe <<3;};if _bdcad >=_dfe ||_dacfb >=_ffef {return 0,nil ;};_aaba :=(_dfe +7)>>3;var (_ceedf ,_bdff ,_fdef byte ;_ecga ,_edbd ,_daacg int ;);switch {case _cbce ==0:for _daacg =_dacfb ;_daacg < _ffef ;_daacg ,_acac ,_bfcf =_daacg +1,_acac +bm1 .RowStride ,_bfcf +bm2 .RowStride {for _edbd =0;
_edbd < _aaba ;_edbd ++{_fdef =bm1 .Data [_acac +_edbd ]&bm2 .Data [_bfcf +_edbd ];_ecga +=tab [_fdef ];};};case _cbce > 0:if _acff < _aaba {for _daacg =_dacfb ;_daacg < _ffef ;_daacg ,_acac ,_bfcf =_daacg +1,_acac +bm1 .RowStride ,_bfcf +bm2 .RowStride {_ceedf ,_bdff =bm1 .Data [_acac ],bm2 .Data [_bfcf ]>>uint (_cbce );
_fdef =_ceedf &_bdff ;_ecga +=tab [_fdef ];for _edbd =1;_edbd < _acff ;_edbd ++{_ceedf ,_bdff =bm1 .Data [_acac +_edbd ],(bm2 .Data [_bfcf +_edbd ]>>uint (_cbce ))|(bm2 .Data [_bfcf +_edbd -1]<<uint (8-_cbce ));_fdef =_ceedf &_bdff ;_ecga +=tab [_fdef ];
};_ceedf =bm1 .Data [_acac +_edbd ];_bdff =bm2 .Data [_bfcf +_edbd -1]<<uint (8-_cbce );_fdef =_ceedf &_bdff ;_ecga +=tab [_fdef ];};}else {for _daacg =_dacfb ;_daacg < _ffef ;_daacg ,_acac ,_bfcf =_daacg +1,_acac +bm1 .RowStride ,_bfcf +bm2 .RowStride {_ceedf ,_bdff =bm1 .Data [_acac ],bm2 .Data [_bfcf ]>>uint (_cbce );
_fdef =_ceedf &_bdff ;_ecga +=tab [_fdef ];for _edbd =1;_edbd < _aaba ;_edbd ++{_ceedf =bm1 .Data [_acac +_edbd ];_bdff =(bm2 .Data [_bfcf +_edbd ]>>uint (_cbce ))|(bm2 .Data [_bfcf +_edbd -1]<<uint (8-_cbce ));_fdef =_ceedf &_bdff ;_ecga +=tab [_fdef ];
};};};default:if _aaba < _acff {for _daacg =_dacfb ;_daacg < _ffef ;_daacg ,_acac ,_bfcf =_daacg +1,_acac +bm1 .RowStride ,_bfcf +bm2 .RowStride {for _edbd =0;_edbd < _aaba ;_edbd ++{_ceedf =bm1 .Data [_acac +_edbd ];_bdff =bm2 .Data [_bfcf +_edbd ]<<uint (-_cbce );
_bdff |=bm2 .Data [_bfcf +_edbd +1]>>uint (8+_cbce );_fdef =_ceedf &_bdff ;_ecga +=tab [_fdef ];};};}else {for _daacg =_dacfb ;_daacg < _ffef ;_daacg ,_acac ,_bfcf =_daacg +1,_acac +bm1 .RowStride ,_bfcf +bm2 .RowStride {for _edbd =0;_edbd < _aaba -1;_edbd ++{_ceedf =bm1 .Data [_acac +_edbd ];
_bdff =bm2 .Data [_bfcf +_edbd ]<<uint (-_cbce );_bdff |=bm2 .Data [_bfcf +_edbd +1]>>uint (8+_cbce );_fdef =_ceedf &_bdff ;_ecga +=tab [_fdef ];};_ceedf =bm1 .Data [_acac +_edbd ];_bdff =bm2 .Data [_bfcf +_edbd ]<<uint (-_cbce );_fdef =_ceedf &_bdff ;
_ecga +=tab [_fdef ];};};};_baef =float64 (_ecga )*float64 (_ecga )/(float64 (area1 )*float64 (area2 ));return _baef ,nil ;};func (_cgagf *Points )AddPoint (x ,y float32 ){*_cgagf =append (*_cgagf ,Point {x ,y })};func _gbd (_efg *Bitmap ,_abd int ,_bca []byte )(_dcb *Bitmap ,_gfc error ){const _bgg ="\u0072\u0065\u0064\u0075\u0063\u0065\u0052\u0061\u006e\u006b\u0042\u0069n\u0061\u0072\u0079\u0032";
if _efg ==nil {return nil ,_b .Error (_bgg ,"\u0073o\u0075\u0072\u0063\u0065 \u0062\u0069\u0074\u006d\u0061p\u0020n\u006ft\u0020\u0064\u0065\u0066\u0069\u006e\u0065d");};if _abd < 1||_abd > 4{return nil ,_b .Error (_bgg ,"\u006c\u0065\u0076\u0065\u006c\u0020\u006d\u0075\u0073\u0074 \u0062\u0065\u0020\u0069\u006e\u0020\u0073e\u0074\u0020\u007b\u0031\u002c\u0032\u002c\u0033\u002c\u0034\u007d");
};if _efg .Height <=1{return nil ,_b .Errorf (_bgg ,"\u0073o\u0075\u0072c\u0065\u0020\u0068e\u0069\u0067\u0068\u0074\u0020\u006d\u0075s\u0074\u0020\u0062\u0065\u0020\u0061t\u0020\u006c\u0065\u0061\u0073\u0074\u0020\u0027\u0032\u0027\u0020-\u0020\u0069\u0073\u003a\u0020\u0027\u0025\u0064\u0027",_efg .Height );
};_dcb =New (_efg .Width /2,_efg .Height /2);if _bca ==nil {_bca =_ebc ();};_cfd :=_deeg (_efg .RowStride ,2*_dcb .RowStride );switch _abd {case 1:_gfc =_agd (_efg ,_dcb ,_abd ,_bca ,_cfd );case 2:_gfc =_eae (_efg ,_dcb ,_abd ,_bca ,_cfd );case 3:_gfc =_eea (_efg ,_dcb ,_abd ,_bca ,_cfd );
case 4:_gfc =_cef (_efg ,_dcb ,_abd ,_bca ,_cfd );};if _gfc !=nil {return nil ,_gfc ;};return _dcb ,nil ;};func (_adff *Bitmaps )SelectBySize (width ,height int ,tp LocationFilter ,relation SizeComparison )(_bbfee *Bitmaps ,_fbcff error ){const _efgcf ="B\u0069t\u006d\u0061\u0070\u0073\u002e\u0053\u0065\u006ce\u0063\u0074\u0042\u0079Si\u007a\u0065";
if _adff ==nil {return nil ,_b .Error (_efgcf ,"\u0027\u0062\u0027 B\u0069\u0074\u006d\u0061\u0070\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};switch tp {case LocSelectWidth ,LocSelectHeight ,LocSelectIfEither ,LocSelectIfBoth :default:return nil ,_b .Errorf (_efgcf ,"\u0070\u0072\u006f\u0076\u0069d\u0065\u0064\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006c\u006fc\u0061\u0074\u0069\u006f\u006e\u0020\u0066\u0069\u006c\u0074\u0065\u0072\u0020\u0074\u0079\u0070\u0065\u003a\u0020\u0025\u0064",tp );
};switch relation {case SizeSelectIfLT ,SizeSelectIfGT ,SizeSelectIfLTE ,SizeSelectIfGTE ,SizeSelectIfEQ :default:return nil ,_b .Errorf (_efgcf ,"\u0069\u006e\u0076\u0061li\u0064\u0020\u0072\u0065\u006c\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0027\u0025d\u0027",relation );
};_cceb ,_fbcff :=_adff .makeSizeIndicator (width ,height ,tp ,relation );if _fbcff !=nil {return nil ,_b .Wrap (_fbcff ,_efgcf ,"");};_bbfee ,_fbcff =_adff .selectByIndicator (_cceb );if _fbcff !=nil {return nil ,_b .Wrap (_fbcff ,_efgcf ,"");};return _bbfee ,nil ;
};func _cbda ()[]int {_ggfe :=make ([]int ,256);_ggfe [0]=0;_ggfe [1]=7;var _faef int ;for _faef =2;_faef < 4;_faef ++{_ggfe [_faef ]=_ggfe [_faef -2]+6;};for _faef =4;_faef < 8;_faef ++{_ggfe [_faef ]=_ggfe [_faef -4]+5;};for _faef =8;_faef < 16;_faef ++{_ggfe [_faef ]=_ggfe [_faef -8]+4;
};for _faef =16;_faef < 32;_faef ++{_ggfe [_faef ]=_ggfe [_faef -16]+3;};for _faef =32;_faef < 64;_faef ++{_ggfe [_faef ]=_ggfe [_faef -32]+2;};for _faef =64;_faef < 128;_faef ++{_ggfe [_faef ]=_ggfe [_faef -64]+1;};for _faef =128;_faef < 256;_faef ++{_ggfe [_faef ]=_ggfe [_faef -128];
};return _ggfe ;};func init (){for _fcg :=0;_fcg < 256;_fcg ++{_adf [_fcg ]=uint8 (_fcg &0x1)+(uint8 (_fcg >>1)&0x1)+(uint8 (_fcg >>2)&0x1)+(uint8 (_fcg >>3)&0x1)+(uint8 (_fcg >>4)&0x1)+(uint8 (_fcg >>5)&0x1)+(uint8 (_fcg >>6)&0x1)+(uint8 (_fcg >>7)&0x1);
};};func (_cga *Bitmap )GetBitOffset (x int )int {return x &0x07};func (_eebaf *ClassedPoints )GetIntXByClass (i int )(int ,error ){const _dgcf ="\u0043\u006c\u0061\u0073s\u0065\u0064\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047e\u0074I\u006e\u0074\u0059\u0042\u0079\u0043\u006ca\u0073\u0073";
if i >=_eebaf .IntSlice .Size (){return 0,_b .Errorf (_dgcf ,"\u0069\u003a\u0020\u0027\u0025\u0064\u0027 \u0069\u0073\u0020o\u0075\u0074\u0020\u006ff\u0020\u0074\u0068\u0065\u0020\u0072\u0061\u006e\u0067\u0065\u0020\u006f\u0066\u0020\u0074\u0068\u0065\u0020\u0049\u006e\u0074\u0053\u006c\u0069\u0063\u0065",i );
};return int (_eebaf .XAtIndex (i )),nil ;};func _ebdf (_afb *Bitmap ,_dfgbe ,_ddcd int ,_cdcc ,_cgeb int ,_dfcdc RasterOperator ){var (_ebgb int ;_ceeb byte ;_bdag ,_afce int ;_ebef int ;);_bbdg :=_cdcc >>3;_adaa :=_cdcc &7;if _adaa > 0{_ceeb =_bgabd [_adaa ];
};_ebgb =_afb .RowStride *_ddcd +(_dfgbe >>3);switch _dfcdc {case PixClr :for _bdag =0;_bdag < _cgeb ;_bdag ++{_ebef =_ebgb +_bdag *_afb .RowStride ;for _afce =0;_afce < _bbdg ;_afce ++{_afb .Data [_ebef ]=0x0;_ebef ++;};if _adaa > 0{_afb .Data [_ebef ]=_eeaef (_afb .Data [_ebef ],0x0,_ceeb );
};};case PixSet :for _bdag =0;_bdag < _cgeb ;_bdag ++{_ebef =_ebgb +_bdag *_afb .RowStride ;for _afce =0;_afce < _bbdg ;_afce ++{_afb .Data [_ebef ]=0xff;_ebef ++;};if _adaa > 0{_afb .Data [_ebef ]=_eeaef (_afb .Data [_ebef ],0xff,_ceeb );};};case PixNotDst :for _bdag =0;
_bdag < _cgeb ;_bdag ++{_ebef =_ebgb +_bdag *_afb .RowStride ;for _afce =0;_afce < _bbdg ;_afce ++{_afb .Data [_ebef ]=^_afb .Data [_ebef ];_ebef ++;};if _adaa > 0{_afb .Data [_ebef ]=_eeaef (_afb .Data [_ebef ],^_afb .Data [_ebef ],_ceeb );};};};};type SelectionValue int ;
func (_gddg *Bitmap )InverseData (){_gddg .inverseData ()};func (_bdbf Points )Size ()int {return len (_bdbf )};var _adf [256]uint8 ;func (_fdgg *Bitmap )setFourBytes (_ccdb int ,_edfd uint32 )error {if _ccdb +3> len (_fdgg .Data )-1{return _b .Errorf ("\u0073\u0065\u0074F\u006f\u0075\u0072\u0042\u0079\u0074\u0065\u0073","\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",_ccdb );
};_fdgg .Data [_ccdb ]=byte ((_edfd &0xff000000)>>24);_fdgg .Data [_ccdb +1]=byte ((_edfd &0xff0000)>>16);_fdgg .Data [_ccdb +2]=byte ((_edfd &0xff00)>>8);_fdgg .Data [_ccdb +3]=byte (_edfd &0xff);return nil ;};func _deeg (_baae ,_fbec int )int {if _baae < _fbec {return _baae ;
};return _fbec ;};func Dilate (d *Bitmap ,s *Bitmap ,sel *Selection )(*Bitmap ,error ){return _ffdc (d ,s ,sel )};func (_dgae *Bitmap )Copy ()*Bitmap {_fgcf :=make ([]byte ,len (_dgae .Data ));copy (_fgcf ,_dgae .Data );return &Bitmap {Width :_dgae .Width ,Height :_dgae .Height ,RowStride :_dgae .RowStride ,Data :_fgcf ,Color :_dgae .Color ,Text :_dgae .Text ,BitmapNumber :_dgae .BitmapNumber ,Special :_dgae .Special };
};func TstWriteSymbols (t *_c .T ,bms *Bitmaps ,src *Bitmap ){for _fdfga :=0;_fdfga < bms .Size ();_fdfga ++{_bedb :=bms .Values [_fdfga ];_gagg :=bms .Boxes [_fdfga ];_gafc :=src .RasterOperation (_gagg .Min .X ,_gagg .Min .Y ,_bedb .Width ,_bedb .Height ,PixSrc ,_bedb ,0,0);
_a .NoError (t ,_gafc );};};func (_ggfb *byWidth )Swap (i ,j int ){_ggfb .Values [i ],_ggfb .Values [j ]=_ggfb .Values [j ],_ggfb .Values [i ];if _ggfb .Boxes !=nil {_ggfb .Boxes [i ],_ggfb .Boxes [j ]=_ggfb .Boxes [j ],_ggfb .Boxes [i ];};};func (_caf *Bitmap )addPadBits ()(_fecd error ){const _gbab ="\u0062\u0069\u0074\u006d\u0061\u0070\u002e\u0061\u0064\u0064\u0050\u0061d\u0042\u0069\u0074\u0073";
_dabd :=_caf .Width %8;if _dabd ==0{return nil ;};_gffg :=_caf .Width /8;_cefe :=_fd .NewReader (_caf .Data );_cffa :=make ([]byte ,_caf .Height *_caf .RowStride );_cbac :=_fd .NewWriterMSB (_cffa );_aabb :=make ([]byte ,_gffg );var (_gfcb int ;_aecd uint64 ;
);for _gfcb =0;_gfcb < _caf .Height ;_gfcb ++{if _ ,_fecd =_cefe .Read (_aabb );_fecd !=nil {return _b .Wrap (_fecd ,_gbab ,"\u0066u\u006c\u006c\u0020\u0062\u0079\u0074e");};if _ ,_fecd =_cbac .Write (_aabb );_fecd !=nil {return _b .Wrap (_fecd ,_gbab ,"\u0066\u0075\u006c\u006c\u0020\u0062\u0079\u0074\u0065\u0073");
};if _aecd ,_fecd =_cefe .ReadBits (byte (_dabd ));_fecd !=nil {return _b .Wrap (_fecd ,_gbab ,"\u0073\u006b\u0069\u0070\u0070\u0069\u006e\u0067\u0020\u0062\u0069\u0074\u0073");};if _fecd =_cbac .WriteByte (byte (_aecd )<<uint (8-_dabd ));_fecd !=nil {return _b .Wrap (_fecd ,_gbab ,"\u006ca\u0073\u0074\u0020\u0062\u0079\u0074e");
};};_caf .Data =_cbac .Data ();return nil ;};func ClipBoxToRectangle (box *_dc .Rectangle ,wi ,hi int )(_bgga *_dc .Rectangle ,_daaf error ){const _ccda ="\u0043l\u0069p\u0042\u006f\u0078\u0054\u006fR\u0065\u0063t\u0061\u006e\u0067\u006c\u0065";if box ==nil {return nil ,_b .Error (_ccda ,"\u0027\u0062\u006f\u0078\u0027\u0020\u006e\u006f\u0074\u0020\u0064\u0065f\u0069\u006e\u0065\u0064");
};if box .Min .X >=wi ||box .Min .Y >=hi ||box .Max .X <=0||box .Max .Y <=0{return nil ,_b .Error (_ccda ,"\u0027\u0062\u006fx'\u0020\u006f\u0075\u0074\u0073\u0069\u0064\u0065\u0020\u0072\u0065\u0063\u0074\u0061\u006e\u0067\u006c\u0065");};_egg :=*box ;
_bgga =&_egg ;if _bgga .Min .X < 0{_bgga .Max .X +=_bgga .Min .X ;_bgga .Min .X =0;};if _bgga .Min .Y < 0{_bgga .Max .Y +=_bgga .Min .Y ;_bgga .Min .Y =0;};if _bgga .Max .X > wi {_bgga .Max .X =wi ;};if _bgga .Max .Y > hi {_bgga .Max .Y =hi ;};return _bgga ,nil ;
};func (_bgddg *ClassedPoints )SortByY (){_bgddg ._faffb =_bgddg .ySortFunction ();_gc .Sort (_bgddg )};func (_gbff *Bitmap )ConnComponents (bms *Bitmaps ,connectivity int )(_ceed *Boxes ,_daab error ){const _abfg ="B\u0069\u0074\u006d\u0061p.\u0043o\u006e\u006e\u0043\u006f\u006dp\u006f\u006e\u0065\u006e\u0074\u0073";
if _gbff ==nil {return nil ,_b .Error (_abfg ,"\u0070r\u006f\u0076\u0069\u0064e\u0064\u0020\u0065\u006d\u0070t\u0079 \u0027b\u0027\u0020\u0062\u0069\u0074\u006d\u0061p");};if connectivity !=4&&connectivity !=8{return nil ,_b .Error (_abfg ,"\u0063\u006f\u006ene\u0063\u0074\u0069\u0076\u0069\u0074\u0079\u0020\u006e\u006f\u0074\u0020\u0034\u0020\u006f\u0072\u0020\u0038");
};if bms ==nil {if _ceed ,_daab =_gbff .connComponentsBB (connectivity );_daab !=nil {return nil ,_b .Wrap (_daab ,_abfg ,"");};}else {if _ceed ,_daab =_gbff .connComponentsBitmapsBB (bms ,connectivity );_daab !=nil {return nil ,_b .Wrap (_daab ,_abfg ,"");
};};return _ceed ,nil ;};func _ebbe (_cfff *Bitmap ,_edcfe ,_gbgd int ,_edec ,_gaegg int ,_bcgdc RasterOperator ){var (_fbgb bool ;_gdgf bool ;_ecacb int ;_eaac int ;_gadg int ;_ebcf int ;_abgf bool ;_eagb byte ;);_fbfa :=8-(_edcfe &7);_agaf :=_gbdf [_fbfa ];
_acgb :=_cfff .RowStride *_gbgd +(_edcfe >>3);if _edec < _fbfa {_fbgb =true ;_agaf &=_bgabd [8-_fbfa +_edec ];};if !_fbgb {_ecacb =(_edec -_fbfa )>>3;if _ecacb !=0{_gdgf =true ;_eaac =_acgb +1;};};_gadg =(_edcfe +_edec )&7;if !_fbgb &&_gadg !=0{_abgf =true ;
_eagb =_bgabd [_gadg ];_ebcf =_acgb +1+_ecacb ;};var _eadc ,_deb int ;switch _bcgdc {case PixClr :for _eadc =0;_eadc < _gaegg ;_eadc ++{_cfff .Data [_acgb ]=_eeaef (_cfff .Data [_acgb ],0x0,_agaf );_acgb +=_cfff .RowStride ;};if _gdgf {for _eadc =0;_eadc < _gaegg ;
_eadc ++{for _deb =0;_deb < _ecacb ;_deb ++{_cfff .Data [_eaac +_deb ]=0x0;};_eaac +=_cfff .RowStride ;};};if _abgf {for _eadc =0;_eadc < _gaegg ;_eadc ++{_cfff .Data [_ebcf ]=_eeaef (_cfff .Data [_ebcf ],0x0,_eagb );_ebcf +=_cfff .RowStride ;};};case PixSet :for _eadc =0;
_eadc < _gaegg ;_eadc ++{_cfff .Data [_acgb ]=_eeaef (_cfff .Data [_acgb ],0xff,_agaf );_acgb +=_cfff .RowStride ;};if _gdgf {for _eadc =0;_eadc < _gaegg ;_eadc ++{for _deb =0;_deb < _ecacb ;_deb ++{_cfff .Data [_eaac +_deb ]=0xff;};_eaac +=_cfff .RowStride ;
};};if _abgf {for _eadc =0;_eadc < _gaegg ;_eadc ++{_cfff .Data [_ebcf ]=_eeaef (_cfff .Data [_ebcf ],0xff,_eagb );_ebcf +=_cfff .RowStride ;};};case PixNotDst :for _eadc =0;_eadc < _gaegg ;_eadc ++{_cfff .Data [_acgb ]=_eeaef (_cfff .Data [_acgb ],^_cfff .Data [_acgb ],_agaf );
_acgb +=_cfff .RowStride ;};if _gdgf {for _eadc =0;_eadc < _gaegg ;_eadc ++{for _deb =0;_deb < _ecacb ;_deb ++{_cfff .Data [_eaac +_deb ]=^(_cfff .Data [_eaac +_deb ]);};_eaac +=_cfff .RowStride ;};};if _abgf {for _eadc =0;_eadc < _gaegg ;_eadc ++{_cfff .Data [_ebcf ]=_eeaef (_cfff .Data [_ebcf ],^_cfff .Data [_ebcf ],_eagb );
_ebcf +=_cfff .RowStride ;};};};};func RasterOperation (dest *Bitmap ,dx ,dy ,dw ,dh int ,op RasterOperator ,src *Bitmap ,sx ,sy int )error {return _beeg (dest ,dx ,dy ,dw ,dh ,op ,src ,sx ,sy );};func TstAddSymbol (t *_c .T ,bms *Bitmaps ,sym *Bitmap ,x *int ,y int ,space int ){bms .AddBitmap (sym );
_babfb :=_dc .Rect (*x ,y ,*x +sym .Width ,y +sym .Height );bms .AddBox (&_babfb );*x +=sym .Width +space ;};func _cbca (_gcee ,_ddf ,_ddbe *Bitmap )(*Bitmap ,error ){const _geec ="\u0073\u0075\u0062\u0074\u0072\u0061\u0063\u0074";if _ddf ==nil {return nil ,_b .Error (_geec ,"'\u0073\u0031\u0027\u0020\u0069\u0073\u0020\u006e\u0069\u006c");
};if _ddbe ==nil {return nil ,_b .Error (_geec ,"'\u0073\u0032\u0027\u0020\u0069\u0073\u0020\u006e\u0069\u006c");};var _deege error ;switch _gcee {case _ddf :if _deege =_gcee .RasterOperation (0,0,_ddf .Width ,_ddf .Height ,PixNotSrcAndDst ,_ddbe ,0,0);
_deege !=nil {return nil ,_b .Wrap (_deege ,_geec ,"\u0064 \u003d\u003d\u0020\u0073\u0031");};case _ddbe :if _deege =_gcee .RasterOperation (0,0,_ddf .Width ,_ddf .Height ,PixNotSrcAndDst ,_ddf ,0,0);_deege !=nil {return nil ,_b .Wrap (_deege ,_geec ,"\u0064 \u003d\u003d\u0020\u0073\u0032");
};default:_gcee ,_deege =_dged (_gcee ,_ddf );if _deege !=nil {return nil ,_b .Wrap (_deege ,_geec ,"");};if _deege =_gcee .RasterOperation (0,0,_ddf .Width ,_ddf .Height ,PixNotSrcAndDst ,_ddbe ,0,0);_deege !=nil {return nil ,_b .Wrap (_deege ,_geec ,"\u0064e\u0066\u0061\u0075\u006c\u0074");
};};return _gcee ,nil ;};func (_ecd *Boxes )Add (box *_dc .Rectangle )error {if _ecd ==nil {return _b .Error ("\u0042o\u0078\u0065\u0073\u002e\u0041\u0064d","\u0027\u0042\u006f\u0078es\u0027\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};*_ecd =append (*_ecd ,box );return nil ;};var MorphBC BoundaryCondition ;func (_afcg *Bitmap )equivalent (_gfgg *Bitmap )bool {if _afcg ==_gfgg {return true ;};if !_afcg .SizesEqual (_gfgg ){return false ;};_bae :=_beef (_afcg ,_gfgg ,CmbOpXor );_ebf :=_afcg .countPixels ();
_bge :=int (0.25*float32 (_ebf ));if _bae .thresholdPixelSum (_bge ){return false ;};var (_dddg [9][9]int ;_cfdd [18][9]int ;_cecc [9][18]int ;_ddeb int ;_fef int ;);_fae :=9;_bbaf :=_afcg .Height /_fae ;_fded :=_afcg .Width /_fae ;_dacf ,_edcd :=_bbaf /2,_fded /2;
if _bbaf < _fded {_dacf =_fded /2;_edcd =_bbaf /2;};_dbd :=float64 (_dacf )*float64 (_edcd )*_ae .Pi ;_fbg :=int (float64 (_bbaf *_fded /2)*0.9);_ecfa :=int (float64 (_fded *_bbaf /2)*0.9);for _bdgg :=0;_bdgg < _fae ;_bdgg ++{_dbcg :=_fded *_bdgg +_ddeb ;
var _cffg int ;if _bdgg ==_fae -1{_ddeb =0;_cffg =_afcg .Width ;}else {_cffg =_dbcg +_fded ;if ((_afcg .Width -_ddeb )%_fae )> 0{_ddeb ++;_cffg ++;};};for _bag :=0;_bag < _fae ;_bag ++{_dff :=_bbaf *_bag +_fef ;var _efb int ;if _bag ==_fae -1{_fef =0;_efb =_afcg .Height ;
}else {_efb =_dff +_bbaf ;if (_afcg .Height -_fef )%_fae > 0{_fef ++;_efb ++;};};var _add ,_gaa ,_ebfa ,_befa int ;_aca :=(_dbcg +_cffg )/2;_acd :=(_dff +_efb )/2;for _ebee :=_dbcg ;_ebee < _cffg ;_ebee ++{for _bga :=_dff ;_bga < _efb ;_bga ++{if _bae .GetPixel (_ebee ,_bga ){if _ebee < _aca {_add ++;
}else {_gaa ++;};if _bga < _acd {_befa ++;}else {_ebfa ++;};};};};_dddg [_bdgg ][_bag ]=_add +_gaa ;_cfdd [_bdgg *2][_bag ]=_add ;_cfdd [_bdgg *2+1][_bag ]=_gaa ;_cecc [_bdgg ][_bag *2]=_befa ;_cecc [_bdgg ][_bag *2+1]=_ebfa ;};};for _bfc :=0;_bfc < _fae *2-1;
_bfc ++{for _dbba :=0;_dbba < (_fae -1);_dbba ++{var _acc int ;for _efec :=0;_efec < 2;_efec ++{for _def :=0;_def < 2;_def ++{_acc +=_cfdd [_bfc +_efec ][_dbba +_def ];};};if _acc > _ecfa {return false ;};};};for _acde :=0;_acde < (_fae -1);_acde ++{for _bbd :=0;
_bbd < ((_fae *2)-1);_bbd ++{var _dee int ;for _ffag :=0;_ffag < 2;_ffag ++{for _dbg :=0;_dbg < 2;_dbg ++{_dee +=_cecc [_acde +_ffag ][_bbd +_dbg ];};};if _dee > _fbg {return false ;};};};for _bfba :=0;_bfba < (_fae -2);_bfba ++{for _gdda :=0;_gdda < (_fae -2);
_gdda ++{var _agbc ,_baa int ;for _aea :=0;_aea < 3;_aea ++{for _edfb :=0;_edfb < 3;_edfb ++{if _aea ==_edfb {_agbc +=_dddg [_bfba +_aea ][_gdda +_edfb ];};if (2-_aea )==_edfb {_baa +=_dddg [_bfba +_aea ][_gdda +_edfb ];};};};if _agbc > _ecfa ||_baa > _ecfa {return false ;
};};};for _cbcf :=0;_cbcf < (_fae -1);_cbcf ++{for _fag :=0;_fag < (_fae -1);_fag ++{var _gffd int ;for _ccfa :=0;_ccfa < 2;_ccfa ++{for _ecb :=0;_ecb < 2;_ecb ++{_gffd +=_dddg [_cbcf +_ccfa ][_fag +_ecb ];};};if float64 (_gffd )> _dbd {return false ;};
};};return true ;};type CombinationOperator int ;func (_cegd *Bitmap )removeBorderGeneral (_gcg ,_gddf ,_ccfb ,_febe int )(*Bitmap ,error ){const _dcfc ="\u0072\u0065\u006d\u006fve\u0042\u006f\u0072\u0064\u0065\u0072\u0047\u0065\u006e\u0065\u0072\u0061\u006c";
if _gcg < 0||_gddf < 0||_ccfb < 0||_febe < 0{return nil ,_b .Error (_dcfc ,"\u006e\u0065g\u0061\u0074\u0069\u0076\u0065\u0020\u0062\u0072\u006f\u0064\u0065\u0072\u0020\u0072\u0065\u006d\u006f\u0076\u0065\u0020\u0076\u0061lu\u0065\u0073");};_fcd ,_bdea :=_cegd .Width ,_cegd .Height ;
_aad :=_fcd -_gcg -_gddf ;_dffg :=_bdea -_ccfb -_febe ;if _aad <=0{return nil ,_b .Errorf (_dcfc ,"w\u0069\u0064\u0074\u0068: \u0025d\u0020\u006d\u0075\u0073\u0074 \u0062\u0065\u0020\u003e\u0020\u0030",_aad );};if _dffg <=0{return nil ,_b .Errorf (_dcfc ,"\u0068\u0065\u0069\u0067ht\u003a\u0020\u0025\u0064\u0020\u006d\u0075\u0073\u0074\u0020\u0062\u0065\u0020\u003e \u0030",_dffg );
};_bfgc :=New (_aad ,_dffg );_bfgc .Color =_cegd .Color ;_faeb :=_bfgc .RasterOperation (0,0,_aad ,_dffg ,PixSrc ,_cegd ,_gcg ,_ccfb );if _faeb !=nil {return nil ,_b .Wrap (_faeb ,_dcfc ,"");};return _bfgc ,nil ;};type Bitmap struct{Width ,Height int ;
BitmapNumber int ;RowStride int ;Data []byte ;Color Color ;Special int ;Text string ;XResolution ,YResolution int ;};func TstCSymbol (t *_c .T )*Bitmap {t .Helper ();_acgg :=New (6,6);_a .NoError (t ,_acgg .SetPixel (1,0,1));_a .NoError (t ,_acgg .SetPixel (2,0,1));
_a .NoError (t ,_acgg .SetPixel (3,0,1));_a .NoError (t ,_acgg .SetPixel (4,0,1));_a .NoError (t ,_acgg .SetPixel (0,1,1));_a .NoError (t ,_acgg .SetPixel (5,1,1));_a .NoError (t ,_acgg .SetPixel (0,2,1));_a .NoError (t ,_acgg .SetPixel (0,3,1));_a .NoError (t ,_acgg .SetPixel (0,4,1));
_a .NoError (t ,_acgg .SetPixel (5,4,1));_a .NoError (t ,_acgg .SetPixel (1,5,1));_a .NoError (t ,_acgg .SetPixel (2,5,1));_a .NoError (t ,_acgg .SetPixel (3,5,1));_a .NoError (t ,_acgg .SetPixel (4,5,1));return _acgg ;};func (_abfdd *Bitmaps )selectByIndicator (_bfec *_ab .NumSlice )(_fdfc *Bitmaps ,_dggaa error ){const _eeac ="\u0042i\u0074\u006d\u0061\u0070s\u002e\u0073\u0065\u006c\u0065c\u0074B\u0079I\u006e\u0064\u0069\u0063\u0061\u0074\u006fr";
if _abfdd ==nil {return nil ,_b .Error (_eeac ,"\u0027\u0062\u0027 b\u0069\u0074\u006d\u0061\u0070\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if _bfec ==nil {return nil ,_b .Error (_eeac ,"'\u006e\u0061\u0027\u0020\u0069\u006ed\u0069\u0063\u0061\u0074\u006f\u0072\u0073\u0020\u006eo\u0074\u0020\u0064e\u0066i\u006e\u0065\u0064");
};if len (_abfdd .Values )==0{return _abfdd ,nil ;};if len (*_bfec )!=len (_abfdd .Values ){return nil ,_b .Errorf (_eeac ,"\u006ea\u0020\u006ce\u006e\u0067\u0074\u0068:\u0020\u0025\u0064,\u0020\u0069\u0073\u0020\u0064\u0069\u0066\u0066\u0065re\u006e\u0074\u0020t\u0068\u0061n\u0020\u0062\u0069\u0074\u006d\u0061p\u0073\u003a \u0025\u0064",len (*_bfec ),len (_abfdd .Values ));
};var _gcdff ,_efgb ,_fbde int ;for _efgb =0;_efgb < len (*_bfec );_efgb ++{if _gcdff ,_dggaa =_bfec .GetInt (_efgb );_dggaa !=nil {return nil ,_b .Wrap (_dggaa ,_eeac ,"f\u0069\u0072\u0073\u0074\u0020\u0063\u0068\u0065\u0063\u006b");};if _gcdff ==1{_fbde ++;
};};if _fbde ==len (_abfdd .Values ){return _abfdd ,nil ;};_fdfc =&Bitmaps {};_caed :=len (_abfdd .Values )==len (_abfdd .Boxes );for _efgb =0;_efgb < len (*_bfec );_efgb ++{if _gcdff =int ((*_bfec )[_efgb ]);_gcdff ==0{continue ;};_fdfc .Values =append (_fdfc .Values ,_abfdd .Values [_efgb ]);
if _caed {_fdfc .Boxes =append (_fdfc .Boxes ,_abfdd .Boxes [_efgb ]);};};return _fdfc ,nil ;};func (_geg *Bitmap )RemoveBorder (borderSize int )(*Bitmap ,error ){if borderSize ==0{return _geg .Copy (),nil ;};_gde ,_cgea :=_geg .removeBorderGeneral (borderSize ,borderSize ,borderSize ,borderSize );
if _cgea !=nil {return nil ,_b .Wrap (_cgea ,"\u0052\u0065\u006do\u0076\u0065\u0042\u006f\u0072\u0064\u0065\u0072","");};return _gde ,nil ;};const (Vanilla Color =iota ;Chocolate ;);func TstISymbol (t *_c .T ,scale ...int )*Bitmap {_cbfg ,_fcfb :=NewWithData (1,5,[]byte {0x80,0x80,0x80,0x80,0x80});
_a .NoError (t ,_fcfb );return TstGetScaledSymbol (t ,_cbfg ,scale ...);};const (AsymmetricMorphBC BoundaryCondition =iota ;SymmetricMorphBC ;);func (_dddf *Bitmap )CreateTemplate ()*Bitmap {return _dddf .createTemplate ()};func MakePixelCentroidTab8 ()[]int {return _cbda ()};
const (ComponentConn Component =iota ;ComponentCharacters ;ComponentWords ;);const (_ SizeComparison =iota ;SizeSelectIfLT ;SizeSelectIfGT ;SizeSelectIfLTE ;SizeSelectIfGTE ;SizeSelectIfEQ ;);func Extract (roi _dc .Rectangle ,src *Bitmap )(*Bitmap ,error ){_dgfb :=New (roi .Dx (),roi .Dy ());
_gffa :=roi .Min .X &0x07;_agcb :=8-_gffa ;_ccgg :=uint (8-_dgfb .Width &0x07);_cbe :=src .GetByteIndex (roi .Min .X ,roi .Min .Y );_dagb :=src .GetByteIndex (roi .Max .X -1,roi .Min .Y );_dccg :=_dgfb .RowStride ==_dagb +1-_cbe ;var _dbaa int ;for _fbaf :=roi .Min .Y ;
_fbaf < roi .Max .Y ;_fbaf ++{_eeae :=_cbe ;_eebf :=_dbaa ;switch {case _cbe ==_dagb :_bbfa ,_bfbc :=src .GetByte (_eeae );if _bfbc !=nil {return nil ,_bfbc ;};_bbfa <<=uint (_gffa );_bfbc =_dgfb .SetByte (_eebf ,_dgce (_ccgg ,_bbfa ));if _bfbc !=nil {return nil ,_bfbc ;
};case _gffa ==0:for _fcef :=_cbe ;_fcef <=_dagb ;_fcef ++{_abdcf ,_edad :=src .GetByte (_eeae );if _edad !=nil {return nil ,_edad ;};_eeae ++;if _fcef ==_dagb &&_dccg {_abdcf =_dgce (_ccgg ,_abdcf );};_edad =_dgfb .SetByte (_eebf ,_abdcf );if _edad !=nil {return nil ,_edad ;
};_eebf ++;};default:_adfb :=_dadb (src ,_dgfb ,uint (_gffa ),uint (_agcb ),_ccgg ,_cbe ,_dagb ,_dccg ,_eeae ,_eebf );if _adfb !=nil {return nil ,_adfb ;};};_cbe +=src .RowStride ;_dagb +=src .RowStride ;_dbaa +=_dgfb .RowStride ;};return _dgfb ,nil ;};
func (_dcbe *Bitmap )inverseData (){if _edcf :=_dcbe .RasterOperation (0,0,_dcbe .Width ,_dcbe .Height ,PixNotDst ,nil ,0,0);_edcf !=nil {_ca .Log .Debug ("\u0049n\u0076\u0065\u0072\u0073e\u0020\u0064\u0061\u0074\u0061 \u0066a\u0069l\u0065\u0064\u003a\u0020\u0027\u0025\u0076'",_edcf );
};if _dcbe .Color ==Chocolate {_dcbe .Color =Vanilla ;}else {_dcbe .Color =Chocolate ;};};var _eece =[5]int {1,2,3,0,4};type byWidth Bitmaps ;func NewClassedPoints (points *Points ,classes _ab .IntSlice )(*ClassedPoints ,error ){const _fbcf ="\u004e\u0065w\u0043\u006c\u0061s\u0073\u0065\u0064\u0050\u006f\u0069\u006e\u0074\u0073";
if points ==nil {return nil ,_b .Error (_fbcf ,"\u0070\u0072\u006f\u0076id\u0065\u0064\u0020\u006e\u0069\u006c\u0020\u0070\u006f\u0069\u006e\u0074\u0073");};if classes ==nil {return nil ,_b .Error (_fbcf ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0063\u006c\u0061ss\u0065\u0073");
};_bgeg :=&ClassedPoints {Points :points ,IntSlice :classes };if _fcgf :=_bgeg .validateIntSlice ();_fcgf !=nil {return nil ,_b .Wrap (_fcgf ,_fbcf ,"");};return _bgeg ,nil ;};func _dadb (_bggac ,_cfcc *Bitmap ,_fgb ,_egb ,_fafa uint ,_fagc ,_cead int ,_eebb bool ,_caea ,_daeg int )error {for _eabe :=_fagc ;
_eabe < _cead ;_eabe ++{if _caea +1< len (_bggac .Data ){_accf :=_eabe +1==_cead ;_acfc ,_dgga :=_bggac .GetByte (_caea );if _dgga !=nil {return _dgga ;};_caea ++;_acfc <<=_fgb ;_eabg ,_dgga :=_bggac .GetByte (_caea );if _dgga !=nil {return _dgga ;};_eabg >>=_egb ;
_dcfe :=_acfc |_eabg ;if _accf &&!_eebb {_dcfe =_dgce (_fafa ,_dcfe );};_dgga =_cfcc .SetByte (_daeg ,_dcfe );if _dgga !=nil {return _dgga ;};_daeg ++;if _accf &&_eebb {_dabdf ,_fdfa :=_bggac .GetByte (_caea );if _fdfa !=nil {return _fdfa ;};_dabdf <<=_fgb ;
_dcfe =_dgce (_fafa ,_dabdf );if _fdfa =_cfcc .SetByte (_daeg ,_dcfe );_fdfa !=nil {return _fdfa ;};};continue ;};_gbgg ,_ffdda :=_bggac .GetByte (_caea );if _ffdda !=nil {_ca .Log .Debug ("G\u0065\u0074\u0074\u0069\u006e\u0067 \u0074\u0068\u0065\u0020\u0076\u0061l\u0075\u0065\u0020\u0061\u0074\u003a\u0020%\u0064\u0020\u0066\u0061\u0069\u006c\u0065\u0064\u003a\u0020%\u0073",_caea ,_ffdda );
return _ffdda ;};_gbgg <<=_fgb ;_caea ++;_ffdda =_cfcc .SetByte (_daeg ,_gbgg );if _ffdda !=nil {return _ffdda ;};_daeg ++;};return nil ;};type Getter interface{GetBitmap ()*Bitmap ;};type SizeComparison int ;func _fgba (_ddgb ,_fbab *Bitmap ,_bdd *Selection )(*Bitmap ,error ){const _dbfgg ="\u006f\u0070\u0065\u006e";
var _gcff error ;_ddgb ,_gcff =_adec (_ddgb ,_fbab ,_bdd );if _gcff !=nil {return nil ,_b .Wrap (_gcff ,_dbfgg ,"");};_aaga ,_gcff :=_adfbc (nil ,_fbab ,_bdd );if _gcff !=nil {return nil ,_b .Wrap (_gcff ,_dbfgg ,"");};_ ,_gcff =_ffdc (_ddgb ,_aaga ,_bdd );
if _gcff !=nil {return nil ,_b .Wrap (_gcff ,_dbfgg ,"");};return _ddgb ,nil ;};const (PixSrc RasterOperator =0xc;PixDst RasterOperator =0xa;PixNotSrc RasterOperator =0x3;PixNotDst RasterOperator =0x5;PixClr RasterOperator =0x0;PixSet RasterOperator =0xf;
PixSrcOrDst RasterOperator =0xe;PixSrcAndDst RasterOperator =0x8;PixSrcXorDst RasterOperator =0x6;PixNotSrcOrDst RasterOperator =0xb;PixNotSrcAndDst RasterOperator =0x2;PixSrcOrNotDst RasterOperator =0xd;PixSrcAndNotDst RasterOperator =0x4;PixNotPixSrcOrDst RasterOperator =0x1;
PixNotPixSrcAndDst RasterOperator =0x7;PixNotPixSrcXorDst RasterOperator =0x9;PixPaint =PixSrcOrDst ;PixSubtract =PixNotSrcAndDst ;PixMask =PixSrcAndDst ;);type shift int ;var (_bdfc *Bitmap ;_dcfcf *Bitmap ;);func _fgdg (_fge *Bitmap ,_eabgb int )(*Bitmap ,error ){const _acda ="\u0065x\u0070a\u006e\u0064\u0052\u0065\u0070\u006c\u0069\u0063\u0061\u0074\u0065";
if _fge ==nil {return nil ,_b .Error (_acda ,"\u0073o\u0075r\u0063\u0065\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");};if _eabgb <=0{return nil ,_b .Error (_acda ,"i\u006e\u0076\u0061\u006cid\u0020f\u0061\u0063\u0074\u006f\u0072 \u002d\u0020\u003c\u003d\u0020\u0030");
};if _eabgb ==1{_cbf ,_eeba :=_dged (nil ,_fge );if _eeba !=nil {return nil ,_b .Wrap (_eeba ,_acda ,"\u0066\u0061\u0063\u0074\u006f\u0072\u0020\u003d\u0020\u0031");};return _cbf ,nil ;};_geagc ,_cbd :=_db (_fge ,_eabgb ,_eabgb );if _cbd !=nil {return nil ,_b .Wrap (_cbd ,_acda ,"");
};return _geagc ,nil ;};func (_addb *ClassedPoints )GetIntYByClass (i int )(int ,error ){const _fddfg ="\u0043\u006c\u0061\u0073s\u0065\u0064\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047e\u0074I\u006e\u0074\u0059\u0042\u0079\u0043\u006ca\u0073\u0073";
if i >=_addb .IntSlice .Size (){return 0,_b .Errorf (_fddfg ,"\u0069\u003a\u0020\u0027\u0025\u0064\u0027 \u0069\u0073\u0020o\u0075\u0074\u0020\u006ff\u0020\u0074\u0068\u0065\u0020\u0072\u0061\u006e\u0067\u0065\u0020\u006f\u0066\u0020\u0074\u0068\u0065\u0020\u0049\u006e\u0074\u0053\u006c\u0069\u0063\u0065",i );
};return int (_addb .YAtIndex (i )),nil ;};func (_ecc Points )YSorter ()func (_fffg ,_cadc int )bool {return func (_feed ,_aeab int )bool {return _ecc [_feed ].Y < _ecc [_aeab ].Y };};func TstASymbol (t *_c .T )*Bitmap {t .Helper ();_gaea :=New (6,6);_a .NoError (t ,_gaea .SetPixel (1,0,1));
_a .NoError (t ,_gaea .SetPixel (2,0,1));_a .NoError (t ,_gaea .SetPixel (3,0,1));_a .NoError (t ,_gaea .SetPixel (4,0,1));_a .NoError (t ,_gaea .SetPixel (5,1,1));_a .NoError (t ,_gaea .SetPixel (1,2,1));_a .NoError (t ,_gaea .SetPixel (2,2,1));_a .NoError (t ,_gaea .SetPixel (3,2,1));
_a .NoError (t ,_gaea .SetPixel (4,2,1));_a .NoError (t ,_gaea .SetPixel (5,2,1));_a .NoError (t ,_gaea .SetPixel (0,3,1));_a .NoError (t ,_gaea .SetPixel (5,3,1));_a .NoError (t ,_gaea .SetPixel (0,4,1));_a .NoError (t ,_gaea .SetPixel (5,4,1));_a .NoError (t ,_gaea .SetPixel (1,5,1));
_a .NoError (t ,_gaea .SetPixel (2,5,1));_a .NoError (t ,_gaea .SetPixel (3,5,1));_a .NoError (t ,_gaea .SetPixel (4,5,1));_a .NoError (t ,_gaea .SetPixel (5,5,1));return _gaea ;};func _gaag (_gefa int )int {if _gefa < 0{return -_gefa ;};return _gefa ;
};func (_gddfb *Bitmap )RasterOperation (dx ,dy ,dw ,dh int ,op RasterOperator ,src *Bitmap ,sx ,sy int )error {return _beeg (_gddfb ,dx ,dy ,dw ,dh ,op ,src ,sx ,sy );};func _fdd (_bbg *Bitmap ,_dce int )(*Bitmap ,error ){const _cecd ="\u0065x\u0070a\u006e\u0064\u0042\u0069\u006ea\u0072\u0079P\u006f\u0077\u0065\u0072\u0032";
if _bbg ==nil {return nil ,_b .Error (_cecd ,"\u0073o\u0075r\u0063\u0065\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");};if _dce ==1{return _dged (nil ,_bbg );};if _dce !=2&&_dce !=4&&_dce !=8{return nil ,_b .Error (_cecd ,"\u0066\u0061\u0063t\u006f\u0072\u0020\u006du\u0073\u0074\u0020\u0062\u0065\u0020\u0069n\u0020\u007b\u0032\u002c\u0034\u002c\u0038\u007d\u0020\u0072\u0061\u006e\u0067\u0065");
};_dfae :=_dce *_bbg .Width ;_aec :=_dce *_bbg .Height ;_eeg :=New (_dfae ,_aec );var _dd error ;switch _dce {case 2:_dd =_gb (_eeg ,_bbg );case 4:_dd =_dg (_eeg ,_bbg );case 8:_dd =_cd (_eeg ,_bbg );};if _dd !=nil {return nil ,_b .Wrap (_dd ,_cecd ,"");
};return _eeg ,nil ;};func (_fdfaf *byHeight )Less (i ,j int )bool {return _fdfaf .Values [i ].Height < _fdfaf .Values [j ].Height };func (_fbag Points )XSorter ()func (_ffaa ,_cebgf int )bool {return func (_egbf ,_eage int )bool {return _fbag [_egbf ].X < _fbag [_eage ].X };
};func _cd (_faf ,_bf *Bitmap )(_faa error ){const _gfb ="\u0065\u0078\u0070\u0061nd\u0042\u0069\u006e\u0061\u0072\u0079\u0046\u0061\u0063\u0074\u006f\u0072\u0038";_ec :=_bf .RowStride ;_aeb :=_faf .RowStride ;var _cec ,_ff ,_efd ,_dfa ,_fb int ;for _efd =0;
_efd < _bf .Height ;_efd ++{_cec =_efd *_ec ;_ff =8*_efd *_aeb ;for _dfa =0;_dfa < _ec ;_dfa ++{if _faa =_faf .setEightBytes (_ff +_dfa *8,_gbbc [_bf .Data [_cec +_dfa ]]);_faa !=nil {return _b .Wrap (_faa ,_gfb ,"");};};for _fb =1;_fb < 8;_fb ++{for _dfa =0;
_dfa < _aeb ;_dfa ++{if _faa =_faf .SetByte (_ff +_fb *_aeb +_dfa ,_faf .Data [_ff +_dfa ]);_faa !=nil {return _b .Wrap (_faa ,_gfb ,"");};};};};return nil ;};func (_fcac *Bitmap )RemoveBorderGeneral (left ,right ,top ,bot int )(*Bitmap ,error ){return _fcac .removeBorderGeneral (left ,right ,top ,bot );
};func _gadc (_aagee ,_faab *Bitmap ,_bdba ,_efce int )(*Bitmap ,error ){const _dceg ="\u0063\u006c\u006f\u0073\u0065\u0042\u0072\u0069\u0063\u006b";if _faab ==nil {return nil ,_b .Error (_dceg ,"\u0073o\u0075r\u0063\u0065\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");
};if _bdba < 1||_efce < 1{return nil ,_b .Error (_dceg ,"\u0068S\u0069\u007a\u0065\u0020\u0061\u006e\u0064\u0020\u0076\u0053\u0069z\u0065\u0020\u006e\u006f\u0074\u0020\u003e\u003d\u0020\u0031");};if _bdba ==1&&_efce ==1{return _faab .Copy (),nil ;};if _bdba ==1||_efce ==1{_dgfe :=SelCreateBrick (_efce ,_bdba ,_efce /2,_bdba /2,SelHit );
var _dggac error ;_aagee ,_dggac =_afag (_aagee ,_faab ,_dgfe );if _dggac !=nil {return nil ,_b .Wrap (_dggac ,_dceg ,"\u0068S\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u007c\u007c \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");
};return _aagee ,nil ;};_daafd :=SelCreateBrick (1,_bdba ,0,_bdba /2,SelHit );_abbf :=SelCreateBrick (_efce ,1,_efce /2,0,SelHit );_cdcg ,_bbca :=_ffdc (nil ,_faab ,_daafd );if _bbca !=nil {return nil ,_b .Wrap (_bbca ,_dceg ,"\u0031\u0073\u0074\u0020\u0064\u0069\u006c\u0061\u0074\u0065");
};if _aagee ,_bbca =_ffdc (_aagee ,_cdcg ,_abbf );_bbca !=nil {return nil ,_b .Wrap (_bbca ,_dceg ,"\u0032\u006e\u0064\u0020\u0064\u0069\u006c\u0061\u0074\u0065");};if _ ,_bbca =_adfbc (_cdcg ,_aagee ,_daafd );_bbca !=nil {return nil ,_b .Wrap (_bbca ,_dceg ,"\u0031s\u0074\u0020\u0065\u0072\u006f\u0064e");
};if _ ,_bbca =_adfbc (_aagee ,_cdcg ,_abbf );_bbca !=nil {return nil ,_b .Wrap (_bbca ,_dceg ,"\u0032n\u0064\u0020\u0065\u0072\u006f\u0064e");};return _aagee ,nil ;};func (_ffbe *Bitmap )SetByte (index int ,v byte )error {if index > len (_ffbe .Data )-1||index < 0{return _b .Errorf ("\u0053e\u0074\u0042\u0079\u0074\u0065","\u0069\u006e\u0064\u0065x \u006f\u0075\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065\u003a\u0020%\u0064",index );
};_ffbe .Data [index ]=v ;return nil ;};type Bitmaps struct{Values []*Bitmap ;Boxes []*_dc .Rectangle ;};func (_eaf *Bitmap )setPadBits (_cbb int ){_edag :=8-_eaf .Width %8;if _edag ==8{return ;};_bebg :=_eaf .Width /8;_gcb :=_gbdf [_edag ];if _cbb ==0{_gcb ^=_gcb ;
};var _eed int ;for _efgc :=0;_efgc < _eaf .Height ;_efgc ++{_eed =_efgc *_eaf .RowStride +_bebg ;if _cbb ==0{_eaf .Data [_eed ]&=_gcb ;}else {_eaf .Data [_eed ]|=_gcb ;};};};func Copy (d ,s *Bitmap )(*Bitmap ,error ){return _dged (d ,s )};func _decg (_gecg *Bitmap ,_gfca *Bitmap ,_fgdb int )(_eefc error ){const _cbff ="\u0073\u0065\u0065\u0064\u0066\u0069\u006c\u006c\u0042\u0069\u006e\u0061r\u0079\u004c\u006f\u0077";
_fgbg :=_deeg (_gecg .Height ,_gfca .Height );_bgbb :=_deeg (_gecg .RowStride ,_gfca .RowStride );switch _fgdb {case 4:_eefc =_daabe (_gecg ,_gfca ,_fgbg ,_bgbb );case 8:_eefc =_cgb (_gecg ,_gfca ,_fgbg ,_bgbb );default:return _b .Errorf (_cbff ,"\u0063\u006f\u006e\u006e\u0065\u0063\u0074\u0069\u0076\u0069\u0074\u0079\u0020\u006d\u0075\u0073\u0074\u0020\u0062\u0065\u0020\u0034\u0020\u006fr\u0020\u0038\u0020\u002d\u0020i\u0073\u003a \u0027\u0025\u0064\u0027",_fgdb );
};if _eefc !=nil {return _b .Wrap (_eefc ,_cbff ,"");};return nil ;};func (_fbc *Bitmap )thresholdPixelSum (_bgd int )bool {var (_ffed int ;_gcbc uint8 ;_ffgd byte ;_cffd int ;);_fcgd :=_fbc .RowStride ;_fdf :=uint (_fbc .Width &0x07);if _fdf !=0{_gcbc =uint8 ((0xff<<(8-_fdf ))&0xff);
_fcgd --;};for _acfb :=0;_acfb < _fbc .Height ;_acfb ++{for _cffd =0;_cffd < _fcgd ;_cffd ++{_ffgd =_fbc .Data [_acfb *_fbc .RowStride +_cffd ];_ffed +=int (_adf [_ffgd ]);};if _fdf !=0{_ffgd =_fbc .Data [_acfb *_fbc .RowStride +_cffd ]&_gcbc ;_ffed +=int (_adf [_ffgd ]);
};if _ffed > _bgd {return true ;};};return false ;};func (_fdad *Bitmap )resizeImageData (_aafa *Bitmap )error {if _aafa ==nil {return _b .Error ("\u0072e\u0073i\u007a\u0065\u0049\u006d\u0061\u0067\u0065\u0044\u0061\u0074\u0061","\u0073r\u0063 \u0069\u0073\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");
};if _fdad .SizesEqual (_aafa ){return nil ;};_fdad .Data =make ([]byte ,len (_aafa .Data ));_fdad .Width =_aafa .Width ;_fdad .Height =_aafa .Height ;_fdad .RowStride =_aafa .RowStride ;return nil ;};type BitmapsArray struct{Values []*Bitmaps ;Boxes []*_dc .Rectangle ;
};type BoundaryCondition int ;func (_ebca *ClassedPoints )SortByX (){_ebca ._faffb =_ebca .xSortFunction ();_gc .Sort (_ebca )};func _eaee (_bcb *_ab .Stack ,_bdge ,_ggec ,_adfe ,_baba ,_fcefg int ,_eged *_dc .Rectangle )(_daae error ){const _abccc ="\u0070\u0075\u0073\u0068\u0046\u0069\u006c\u006c\u0053\u0065\u0067m\u0065\u006e\u0074\u0042\u006f\u0075\u006e\u0064\u0069\u006eg\u0042\u006f\u0078";
if _bcb ==nil {return _b .Error (_abccc ,"\u006ei\u006c \u0073\u0074\u0061\u0063\u006b \u0070\u0072o\u0076\u0069\u0064\u0065\u0064");};if _eged ==nil {return _b .Error (_abccc ,"\u0070\u0072\u006f\u0076i\u0064\u0065\u0064\u0020\u006e\u0069\u006c\u0020\u0069\u006da\u0067e\u002e\u0052\u0065\u0063\u0074\u0061\u006eg\u006c\u0065");
};_eged .Min .X =_ab .Min (_eged .Min .X ,_bdge );_eged .Max .X =_ab .Max (_eged .Max .X ,_ggec );_eged .Min .Y =_ab .Min (_eged .Min .Y ,_adfe );_eged .Max .Y =_ab .Max (_eged .Max .Y ,_adfe );if _adfe +_baba < 0||_adfe +_baba > _fcefg {return nil ;};
if _bcb .Aux ==nil {return _b .Error (_abccc ,"a\u0075x\u0053\u0074\u0061\u0063\u006b\u0020\u006e\u006ft\u0020\u0064\u0065\u0066in\u0065\u0064");};var _effc *fillSegment ;_efgcc ,_ceggg :=_bcb .Aux .Pop ();if _ceggg {if _effc ,_ceggg =_efgcc .(*fillSegment );
!_ceggg {return _b .Error (_abccc ,"a\u0075\u0078\u0053\u0074\u0061\u0063k\u0020\u0064\u0061\u0074\u0061\u0020i\u0073\u0020\u006e\u006f\u0074\u0020\u0061 \u002a\u0066\u0069\u006c\u006c\u0053\u0065\u0067\u006d\u0065n\u0074");};}else {_effc =&fillSegment {};
};_effc ._bbccg =_bdge ;_effc ._fabg =_ggec ;_effc ._cffc =_adfe ;_effc ._fbcc =_baba ;_bcb .Push (_effc );return nil ;};func (_acf *Bitmap )countPixels ()int {var (_abfe int ;_agb uint8 ;_bda byte ;_ebag int ;);_egcag :=_acf .RowStride ;_cfa :=uint (_acf .Width &0x07);
if _cfa !=0{_agb =uint8 ((0xff<<(8-_cfa ))&0xff);_egcag --;};for _cbg :=0;_cbg < _acf .Height ;_cbg ++{for _ebag =0;_ebag < _egcag ;_ebag ++{_bda =_acf .Data [_cbg *_acf .RowStride +_ebag ];_abfe +=int (_adf [_bda ]);};if _cfa !=0{_abfe +=int (_adf [_acf .Data [_cbg *_acf .RowStride +_ebag ]&_agb ]);
};};return _abfe ;};func (_gcgf *Bitmap )centroid (_fdcee ,_gefba []int )(Point ,error ){_faba :=Point {};_gcgf .setPadBits (0);if len (_fdcee )==0{_fdcee =_cbda ();};if len (_gefba )==0{_gefba =_acaf ();};var _ddbd ,_ebfg ,_agdb ,_eaba ,_bgaac ,_fcba int ;
var _eegde byte ;for _bgaac =0;_bgaac < _gcgf .Height ;_bgaac ++{_bbb :=_gcgf .RowStride *_bgaac ;_eaba =0;for _fcba =0;_fcba < _gcgf .RowStride ;_fcba ++{_eegde =_gcgf .Data [_bbb +_fcba ];if _eegde !=0{_eaba +=_gefba [_eegde ];_ddbd +=_fdcee [_eegde ]+_fcba *8*_gefba [_eegde ];
};};_agdb +=_eaba ;_ebfg +=_eaba *_bgaac ;};if _agdb !=0{_faba .X =float32 (_ddbd )/float32 (_agdb );_faba .Y =float32 (_ebfg )/float32 (_agdb );};return _faba ,nil ;};func _db (_bd *Bitmap ,_be ,_aba int )(*Bitmap ,error ){const _ag ="e\u0078\u0070\u0061\u006edB\u0069n\u0061\u0072\u0079\u0052\u0065p\u006c\u0069\u0063\u0061\u0074\u0065";
if _bd ==nil {return nil ,_b .Error (_ag ,"\u0073o\u0075r\u0063\u0065\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");};if _be <=0||_aba <=0{return nil ,_b .Error (_ag ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0073\u0063\u0061l\u0065\u0020\u0066\u0061\u0063\u0074\u006f\u0072\u003a\u0020<\u003d\u0020\u0030");
};if _be ==_aba {if _be ==1{_abf ,_bef :=_dged (nil ,_bd );if _bef !=nil {return nil ,_b .Wrap (_bef ,_ag ,"\u0078\u0046\u0061\u0063\u0074\u0020\u003d\u003d\u0020y\u0046\u0061\u0063\u0074");};return _abf ,nil ;};if _be ==2||_be ==4||_be ==8{_fbd ,_eg :=_fdd (_bd ,_be );
if _eg !=nil {return nil ,_b .Wrap (_eg ,_ag ,"\u0078\u0046a\u0063\u0074\u0020i\u006e\u0020\u007b\u0032\u002c\u0034\u002c\u0038\u007d");};return _fbd ,nil ;};};_aag :=_be *_bd .Width ;_ea :=_aba *_bd .Height ;_aaa :=New (_aag ,_ea );_abfd :=_aaa .RowStride ;
var (_beg ,_bg ,_fba ,_fda ,_feb int ;_dgc byte ;_aage error ;);for _bg =0;_bg < _bd .Height ;_bg ++{_beg =_aba *_bg *_abfd ;for _fba =0;_fba < _bd .Width ;_fba ++{if _cb :=_bd .GetPixel (_fba ,_bg );_cb {_feb =_be *_fba ;for _fda =0;_fda < _be ;_fda ++{_aaa .setBit (_beg *8+_feb +_fda );
};};};for _fda =1;_fda < _aba ;_fda ++{_ccf :=_beg +_fda *_abfd ;for _gdb :=0;_gdb < _abfd ;_gdb ++{if _dgc ,_aage =_aaa .GetByte (_beg +_gdb );_aage !=nil {return nil ,_b .Wrapf (_aage ,_ag ,"\u0072\u0065\u0070\u006cic\u0061\u0074\u0069\u006e\u0067\u0020\u006c\u0069\u006e\u0065\u003a\u0020\u0027\u0025d\u0027",_fda );
};if _aage =_aaa .SetByte (_ccf +_gdb ,_dgc );_aage !=nil {return nil ,_b .Wrap (_aage ,_ag ,"\u0053\u0065\u0074\u0074in\u0067\u0020\u0062\u0079\u0074\u0065\u0020\u0066\u0061\u0069\u006c\u0065\u0064");};};};};return _aaa ,nil ;};var (_fbce =_dgd ();_bgfg =_ffc ();
_gbbc =_cfb (););const (CmbOpOr CombinationOperator =iota ;CmbOpAnd ;CmbOpXor ;CmbOpXNor ;CmbOpReplace ;CmbOpNot ;);func _afag (_aeaa ,_efdc *Bitmap ,_deabb *Selection )(*Bitmap ,error ){const _dbeb ="c\u006c\u006f\u0073\u0065\u0042\u0069\u0074\u006d\u0061\u0070";
var _eabba error ;if _aeaa ,_eabba =_adec (_aeaa ,_efdc ,_deabb );_eabba !=nil {return nil ,_eabba ;};_acacc ,_eabba :=_ffdc (nil ,_efdc ,_deabb );if _eabba !=nil {return nil ,_b .Wrap (_eabba ,_dbeb ,"");};if _ ,_eabba =_adfbc (_aeaa ,_acacc ,_deabb );
_eabba !=nil {return nil ,_b .Wrap (_eabba ,_dbeb ,"");};return _aeaa ,nil ;};func _abab (_fcdg ,_aace ,_ebeg *Bitmap )(*Bitmap ,error ){const _efac ="\u0062\u0069\u0074\u006d\u0061\u0070\u002e\u0078\u006f\u0072";if _aace ==nil {return nil ,_b .Error (_efac ,"'\u0062\u0031\u0027\u0020\u0069\u0073\u0020\u006e\u0069\u006c");
};if _ebeg ==nil {return nil ,_b .Error (_efac ,"'\u0062\u0032\u0027\u0020\u0069\u0073\u0020\u006e\u0069\u006c");};if _fcdg ==_ebeg {return nil ,_b .Error (_efac ,"'\u0064\u0027\u0020\u003d\u003d\u0020\u0027\u0062\u0032\u0027");};if !_aace .SizesEqual (_ebeg ){_ca .Log .Debug ("\u0025s\u0020\u002d \u0042\u0069\u0074\u006da\u0070\u0020\u0027b\u0031\u0027\u0020\u0069\u0073\u0020\u006e\u006f\u0074 e\u0071\u0075\u0061l\u0020\u0073i\u007a\u0065\u0020\u0077\u0069\u0074h\u0020\u0027b\u0032\u0027",_efac );
};var _aff error ;if _fcdg ,_aff =_dged (_fcdg ,_aace );_aff !=nil {return nil ,_b .Wrap (_aff ,_efac ,"\u0063\u0061n\u0027\u0074\u0020c\u0072\u0065\u0061\u0074\u0065\u0020\u0027\u0064\u0027");};if _aff =_fcdg .RasterOperation (0,0,_fcdg .Width ,_fcdg .Height ,PixSrcXorDst ,_ebeg ,0,0);
_aff !=nil {return nil ,_b .Wrap (_aff ,_efac ,"");};return _fcdg ,nil ;};func _gffc (_bdc ,_fedg *Bitmap ,_aaaga ,_fbf ,_gab ,_fad ,_gafg int ,_dad CombinationOperator )error {var _efee int ;_geaa :=func (){_efee ++;_gab +=_fedg .RowStride ;_fad +=_bdc .RowStride ;
_gafg +=_bdc .RowStride };for _efee =_aaaga ;_efee < _fbf ;_geaa (){_cac :=_gab ;for _bdac :=_fad ;_bdac <=_gafg ;_bdac ++{_eeff ,_eaea :=_fedg .GetByte (_cac );if _eaea !=nil {return _eaea ;};_dadd ,_eaea :=_bdc .GetByte (_bdac );if _eaea !=nil {return _eaea ;
};if _eaea =_fedg .SetByte (_cac ,_ffgc (_eeff ,_dadd ,_dad ));_eaea !=nil {return _eaea ;};_cac ++;};};return nil ;};func _adec (_edcg ,_fgbf *Bitmap ,_caad *Selection )(*Bitmap ,error ){const _cdde ="\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u004d\u006f\u0072\u0070\u0068A\u0072\u0067\u0073\u0032";
var _gecc ,_cebga int ;if _fgbf ==nil {return nil ,_b .Error (_cdde ,"s\u006fu\u0072\u0063\u0065\u0020\u0062\u0069\u0074\u006da\u0070\u0020\u0069\u0073 n\u0069\u006c");};if _caad ==nil {return nil ,_b .Error (_cdde ,"\u0073e\u006c \u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};_gecc =_caad .Width ;_cebga =_caad .Height ;if _gecc ==0||_cebga ==0{return nil ,_b .Error (_cdde ,"\u0073\u0065\u006c\u0020\u006f\u0066\u0020\u0073\u0069\u007a\u0065\u0020\u0030");};if _edcg ==nil {return _fgbf .createTemplate (),nil ;};if _bgdd :=_edcg .resizeImageData (_fgbf );
_bgdd !=nil {return nil ,_bgdd ;};return _edcg ,nil ;};func (_bec *Bitmap )ClipRectangle (box *_dc .Rectangle )(_aab *Bitmap ,_egcf *_dc .Rectangle ,_dggd error ){const _ecg ="\u0043\u006c\u0069\u0070\u0052\u0065\u0063\u0074\u0061\u006e\u0067\u006c\u0065";
if box ==nil {return nil ,nil ,_b .Error (_ecg ,"\u0062o\u0078 \u0069\u0073\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");};_ceb ,_feda :=_bec .Width ,_bec .Height ;_ceg :=_dc .Rect (0,0,_ceb ,_feda );if !box .Overlaps (_ceg ){return nil ,nil ,_b .Error (_ecg ,"b\u006f\u0078\u0020\u0064oe\u0073n\u0027\u0074\u0020\u006f\u0076e\u0072\u006c\u0061\u0070\u0020\u0062");
};_gbac :=box .Intersect (_ceg );_fdb ,_eec :=_gbac .Min .X ,_gbac .Min .Y ;_gdfe ,_bgb :=_gbac .Dx (),_gbac .Dy ();_aab =New (_gdfe ,_bgb );_aab .Text =_bec .Text ;if _dggd =_aab .RasterOperation (0,0,_gdfe ,_bgb ,PixSrc ,_bec ,_fdb ,_eec );_dggd !=nil {return nil ,nil ,_b .Wrap (_dggd ,_ecg ,"\u0050\u0069\u0078\u0053\u0072\u0063\u0020\u0074\u006f\u0020\u0063\u006ci\u0070\u0070\u0065\u0064");
};_egcf =&_gbac ;return _aab ,_egcf ,nil ;};func (_cgag *Bitmap )connComponentsBitmapsBB (_bdca *Bitmaps ,_accg int )(_daac *Boxes ,_dbfg error ){const _daed ="\u0063\u006f\u006enC\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074\u0073\u0042\u0069\u0074\u006d\u0061\u0070\u0073\u0042\u0042";
if _accg !=4&&_accg !=8{return nil ,_b .Error (_daed ,"\u0063\u006f\u006e\u006e\u0065\u0063t\u0069\u0076\u0069\u0074\u0079\u0020\u006d\u0075\u0073\u0074\u0020\u0062\u0065 \u0061\u0020\u0027\u0034\u0027\u0020\u006fr\u0020\u0027\u0038\u0027");};if _bdca ==nil {return nil ,_b .Error (_daed ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0042\u0069\u0074ma\u0070\u0073");
};if len (_bdca .Values )> 0{return nil ,_b .Error (_daed ,"\u0070\u0072\u006f\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u006fn\u002d\u0065\u006d\u0070\u0074\u0079\u0020\u0042\u0069\u0074m\u0061\u0070\u0073");};if _cgag .Zero (){return &Boxes {},nil ;};
var (_bggbc ,_gefd ,_eca ,_dfag *Bitmap ;);_cgag .setPadBits (0);if _bggbc ,_dbfg =_dged (nil ,_cgag );_dbfg !=nil {return nil ,_b .Wrap (_dbfg ,_daed ,"\u0062\u006d\u0031");};if _gefd ,_dbfg =_dged (nil ,_cgag );_dbfg !=nil {return nil ,_b .Wrap (_dbfg ,_daed ,"\u0062\u006d\u0032");
};_aaed :=&_ab .Stack {};_aaed .Aux =&_ab .Stack {};_daac =&Boxes {};var (_ced ,_dcd int ;_bgfd _dc .Point ;_geag bool ;_ddaf *_dc .Rectangle ;);for {if _bgfd ,_geag ,_dbfg =_bggbc .nextOnPixel (_ced ,_dcd );_dbfg !=nil {return nil ,_b .Wrap (_dbfg ,_daed ,"");
};if !_geag {break ;};if _ddaf ,_dbfg =_ceaa (_bggbc ,_aaed ,_bgfd .X ,_bgfd .Y ,_accg );_dbfg !=nil {return nil ,_b .Wrap (_dbfg ,_daed ,"");};if _dbfg =_daac .Add (_ddaf );_dbfg !=nil {return nil ,_b .Wrap (_dbfg ,_daed ,"");};if _eca ,_dbfg =_bggbc .clipRectangle (_ddaf ,nil );
_dbfg !=nil {return nil ,_b .Wrap (_dbfg ,_daed ,"\u0062\u006d\u0033");};if _dfag ,_dbfg =_gefd .clipRectangle (_ddaf ,nil );_dbfg !=nil {return nil ,_b .Wrap (_dbfg ,_daed ,"\u0062\u006d\u0034");};if _ ,_dbfg =_abab (_eca ,_eca ,_dfag );_dbfg !=nil {return nil ,_b .Wrap (_dbfg ,_daed ,"\u0062m\u0033\u0020\u005e\u0020\u0062\u006d4");
};if _dbfg =_gefd .RasterOperation (_ddaf .Min .X ,_ddaf .Min .Y ,_ddaf .Dx (),_ddaf .Dy (),PixSrcXorDst ,_eca ,0,0);_dbfg !=nil {return nil ,_b .Wrap (_dbfg ,_daed ,"\u0062\u006d\u0032\u0020\u002d\u0058\u004f\u0052\u002d>\u0020\u0062\u006d\u0033");};_bdca .AddBitmap (_eca );
_ced =_bgfd .X ;_dcd =_bgfd .Y ;};_bdca .Boxes =*_daac ;return _daac ,nil ;};func _dged (_edge ,_cefg *Bitmap )(*Bitmap ,error ){if _cefg ==nil {return nil ,_b .Error ("\u0063\u006f\u0070\u0079\u0042\u0069\u0074\u006d\u0061\u0070","\u0073o\u0075r\u0063\u0065\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");
};if _cefg ==_edge {return _edge ,nil ;};if _edge ==nil {_edge =_cefg .createTemplate ();copy (_edge .Data ,_cefg .Data );return _edge ,nil ;};_ggb :=_edge .resizeImageData (_cefg );if _ggb !=nil {return nil ,_b .Wrap (_ggb ,"\u0063\u006f\u0070\u0079\u0042\u0069\u0074\u006d\u0061\u0070","");
};_edge .Text =_cefg .Text ;copy (_edge .Data ,_cefg .Data );return _edge ,nil ;};func _eeaef (_afeb ,_aabg ,_dgfd byte )byte {return (_afeb &^(_dgfd ))|(_aabg &_dgfd )};func _dgbea (_dcgge *Bitmap ,_acae *_ab .Stack ,_bgebc ,_acdab int )(_beeda *_dc .Rectangle ,_aacg error ){const _cegg ="\u0073e\u0065d\u0046\u0069\u006c\u006c\u0053\u0074\u0061\u0063\u006b\u0042\u0042";
if _dcgge ==nil {return nil ,_b .Error (_cegg ,"\u0070\u0072\u006fvi\u0064\u0065\u0064\u0020\u006e\u0069\u006c\u0020\u0027\u0073\u0027\u0020\u0042\u0069\u0074\u006d\u0061\u0070");};if _acae ==nil {return nil ,_b .Error (_cegg ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0027\u0073\u0074ac\u006b\u0027");
};_bccg ,_fcgff :=_dcgge .Width ,_dcgge .Height ;_cgdc :=_bccg -1;_eagcc :=_fcgff -1;if _bgebc < 0||_bgebc > _cgdc ||_acdab < 0||_acdab > _eagcc ||!_dcgge .GetPixel (_bgebc ,_acdab ){return nil ,nil ;};_afef :=_dc .Rect (100000,100000,0,0);if _aacg =_eaee (_acae ,_bgebc ,_bgebc ,_acdab ,1,_eagcc ,&_afef );
_aacg !=nil {return nil ,_b .Wrap (_aacg ,_cegg ,"\u0069\u006e\u0069t\u0069\u0061\u006c\u0020\u0070\u0075\u0073\u0068");};if _aacg =_eaee (_acae ,_bgebc ,_bgebc ,_acdab +1,-1,_eagcc ,&_afef );_aacg !=nil {return nil ,_b .Wrap (_aacg ,_cegg ,"\u0032\u006ed\u0020\u0069\u006ei\u0074\u0069\u0061\u006c\u0020\u0070\u0075\u0073\u0068");
};_afef .Min .X ,_afef .Max .X =_bgebc ,_bgebc ;_afef .Min .Y ,_afef .Max .Y =_acdab ,_acdab ;var (_cgce *fillSegment ;_dffb int ;);for _acae .Len ()> 0{if _cgce ,_aacg =_fcfe (_acae );_aacg !=nil {return nil ,_b .Wrap (_aacg ,_cegg ,"");};_acdab =_cgce ._cffc ;
for _bgebc =_cgce ._bbccg -1;_bgebc >=0&&_dcgge .GetPixel (_bgebc ,_acdab );_bgebc --{if _aacg =_dcgge .SetPixel (_bgebc ,_acdab ,0);_aacg !=nil {return nil ,_b .Wrap (_aacg ,_cegg ,"\u0031s\u0074\u0020\u0073\u0065\u0074");};};if _bgebc >=_cgce ._bbccg -1{for {for _bgebc ++;
_bgebc <=_cgce ._fabg +1&&_bgebc <=_cgdc &&!_dcgge .GetPixel (_bgebc ,_acdab );_bgebc ++{};_dffb =_bgebc ;if _bgebc > _cgce ._fabg +1||_bgebc > _cgdc {break ;};for ;_bgebc <=_cgdc &&_dcgge .GetPixel (_bgebc ,_acdab );_bgebc ++{if _aacg =_dcgge .SetPixel (_bgebc ,_acdab ,0);
_aacg !=nil {return nil ,_b .Wrap (_aacg ,_cegg ,"\u0032n\u0064\u0020\u0073\u0065\u0074");};};if _aacg =_eaee (_acae ,_dffb ,_bgebc -1,_cgce ._cffc ,_cgce ._fbcc ,_eagcc ,&_afef );_aacg !=nil {return nil ,_b .Wrap (_aacg ,_cegg ,"n\u006f\u0072\u006d\u0061\u006c\u0020\u0070\u0075\u0073\u0068");
};if _bgebc > _cgce ._fabg {if _aacg =_eaee (_acae ,_cgce ._fabg +1,_bgebc -1,_cgce ._cffc ,-_cgce ._fbcc ,_eagcc ,&_afef );_aacg !=nil {return nil ,_b .Wrap (_aacg ,_cegg ,"\u006ce\u0061k\u0020\u006f\u006e\u0020\u0072i\u0067\u0068t\u0020\u0073\u0069\u0064\u0065");
};};};continue ;};_dffb =_bgebc +1;if _dffb < _cgce ._bbccg {if _aacg =_eaee (_acae ,_dffb ,_cgce ._bbccg -1,_cgce ._cffc ,-_cgce ._fbcc ,_eagcc ,&_afef );_aacg !=nil {return nil ,_b .Wrap (_aacg ,_cegg ,"\u006c\u0065\u0061\u006b\u0020\u006f\u006e\u0020\u006c\u0065\u0066\u0074 \u0073\u0069\u0064\u0065");
};};_bgebc =_cgce ._bbccg ;for {for ;_bgebc <=_cgdc &&_dcgge .GetPixel (_bgebc ,_acdab );_bgebc ++{if _aacg =_dcgge .SetPixel (_bgebc ,_acdab ,0);_aacg !=nil {return nil ,_b .Wrap (_aacg ,_cegg ,"\u0032n\u0064\u0020\u0073\u0065\u0074");};};if _aacg =_eaee (_acae ,_dffb ,_bgebc -1,_cgce ._cffc ,_cgce ._fbcc ,_eagcc ,&_afef );
_aacg !=nil {return nil ,_b .Wrap (_aacg ,_cegg ,"n\u006f\u0072\u006d\u0061\u006c\u0020\u0070\u0075\u0073\u0068");};if _bgebc > _cgce ._fabg {if _aacg =_eaee (_acae ,_cgce ._fabg +1,_bgebc -1,_cgce ._cffc ,-_cgce ._fbcc ,_eagcc ,&_afef );_aacg !=nil {return nil ,_b .Wrap (_aacg ,_cegg ,"\u006ce\u0061k\u0020\u006f\u006e\u0020\u0072i\u0067\u0068t\u0020\u0073\u0069\u0064\u0065");
};};for _bgebc ++;_bgebc <=_cgce ._fabg +1&&_bgebc <=_cgdc &&!_dcgge .GetPixel (_bgebc ,_acdab );_bgebc ++{};_dffb =_bgebc ;if _bgebc > _cgce ._fabg +1||_bgebc > _cgdc {break ;};};};_afef .Max .X ++;_afef .Max .Y ++;return &_afef ,nil ;};func (_eefcf *Bitmaps )selectByIndexes (_adcgf []int )(*Bitmaps ,error ){_cfcf :=&Bitmaps {};
for _ ,_faad :=range _adcgf {_fcacc ,_eaad :=_eefcf .GetBitmap (_faad );if _eaad !=nil {return nil ,_b .Wrap (_eaad ,"\u0073e\u006ce\u0063\u0074\u0042\u0079\u0049\u006e\u0064\u0065\u0078\u0065\u0073","");};_cfcf .AddBitmap (_fcacc );};return _cfcf ,nil ;
};func (_feebc *ClassedPoints )YAtIndex (i int )float32 {return (*_feebc .Points )[_feebc .IntSlice [i ]].Y };func _befc (_baea *Bitmap )(_bgeb *Bitmap ,_adcgb int ,_ccbg error ){const _ebbd ="\u0042i\u0074\u006d\u0061\u0070.\u0077\u006f\u0072\u0064\u004da\u0073k\u0042y\u0044\u0069\u006c\u0061\u0074\u0069\u006fn";
if _baea ==nil {return nil ,0,_b .Errorf (_ebbd ,"\u0027\u0073\u0027\u0020bi\u0074\u006d\u0061\u0070\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006ee\u0064");};var _aafe ,_gbbb *Bitmap ;if _aafe ,_ccbg =_dged (nil ,_baea );_ccbg !=nil {return nil ,0,_b .Wrap (_ccbg ,_ebbd ,"\u0063\u006f\u0070\u0079\u0020\u0027\u0073\u0027");
};var (_feada [13]int ;_bebb ,_fgcc int ;);_fac :=12;_eafa :=_ab .NewNumSlice (_fac +1);_gcba :=_ab .NewNumSlice (_fac +1);var _aef *Boxes ;for _bfd :=0;_bfd <=_fac ;_bfd ++{if _bfd ==0{if _gbbb ,_ccbg =_dged (nil ,_aafe );_ccbg !=nil {return nil ,0,_b .Wrap (_ccbg ,_ebbd ,"\u0066i\u0072\u0073\u0074\u0020\u0062\u006d2");
};}else {if _gbbb ,_ccbg =_aafb (_aafe ,MorphProcess {Operation :MopDilation ,Arguments :[]int {2,1}});_ccbg !=nil {return nil ,0,_b .Wrap (_ccbg ,_ebbd ,"\u0064\u0069\u006ca\u0074\u0069\u006f\u006e\u0020\u0062\u006d\u0032");};};if _aef ,_ccbg =_gbbb .connComponentsBB (4);
_ccbg !=nil {return nil ,0,_b .Wrap (_ccbg ,_ebbd ,"");};_feada [_bfd ]=len (*_aef );_eafa .AddInt (_feada [_bfd ]);switch _bfd {case 0:_bebb =_feada [0];default:_fgcc =_feada [_bfd -1]-_feada [_bfd ];_gcba .AddInt (_fgcc );};_aafe =_gbbb ;};_fdbb :=true ;
_gcf :=2;var _fdbc ,_ddeg int ;for _gbgb :=1;_gbgb < len (*_gcba );_gbgb ++{if _fdbc ,_ccbg =_eafa .GetInt (_gbgb );_ccbg !=nil {return nil ,0,_b .Wrap (_ccbg ,_ebbd ,"\u0043\u0068\u0065\u0063ki\u006e\u0067\u0020\u0062\u0065\u0073\u0074\u0020\u0064\u0069\u006c\u0061\u0074\u0069o\u006e");
};if _fdbb &&_fdbc < int (0.3*float32 (_bebb )){_gcf =_gbgb +1;_fdbb =false ;};if _fgcc ,_ccbg =_gcba .GetInt (_gbgb );_ccbg !=nil {return nil ,0,_b .Wrap (_ccbg ,_ebbd ,"\u0067\u0065\u0074\u0074\u0069\u006e\u0067\u0020\u006ea\u0044\u0069\u0066\u0066");
};if _fgcc > _ddeg {_ddeg =_fgcc ;};};_abc :=_baea .XResolution ;if _abc ==0{_abc =150;};if _abc > 110{_gcf ++;};if _gcf < 2{_ca .Log .Trace ("J\u0042\u0049\u0047\u0032\u0020\u0073\u0065\u0074\u0074\u0069\u006e\u0067\u0020\u0069\u0042\u0065\u0073\u0074 \u0074\u006f\u0020\u006d\u0069\u006e\u0069\u006d\u0075\u006d a\u006c\u006c\u006fw\u0061b\u006c\u0065");
_gcf =2;};_adcgb =_gcf +1;if _bgeb ,_ccbg =_gadc (nil ,_baea ,_gcf +1,1);_ccbg !=nil {return nil ,0,_b .Wrap (_ccbg ,_ebbd ,"\u0067\u0065\u0074\u0074in\u0067\u0020\u006d\u0061\u0073\u006b\u0020\u0066\u0061\u0069\u006c\u0065\u0064");};return _bgeb ,_adcgb ,nil ;
};type Selection struct{Height ,Width int ;Cx ,Cy int ;Name string ;Data [][]SelectionValue ;};type Points []Point ;func TstVSymbol (t *_c .T ,scale ...int )*Bitmap {_dbaf ,_bfgbe :=NewWithData (5,5,[]byte {0x88,0x88,0x88,0x50,0x20});_a .NoError (t ,_bfgbe );
return TstGetScaledSymbol (t ,_dbaf ,scale ...);};func (_egf Points )GetIntY (i int )(int ,error ){if i >=len (_egf ){return 0,_b .Errorf ("\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047\u0065t\u0049\u006e\u0074\u0059","\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};return int (_egf [i ].Y ),nil ;};func (_bcag *Selection )setOrigin (_bcagd ,_acfcfe int ){_bcag .Cy ,_bcag .Cx =_bcagd ,_acfcfe };func _egaf (_fbaef *Bitmap ,_cfce ,_dfda ,_daf ,_gccf int ,_egce RasterOperator ){if _cfce < 0{_daf +=_cfce ;_cfce =0;};
_fgeg :=_cfce +_daf -_fbaef .Width ;if _fgeg > 0{_daf -=_fgeg ;};if _dfda < 0{_gccf +=_dfda ;_dfda =0;};_edcb :=_dfda +_gccf -_fbaef .Height ;if _edcb > 0{_gccf -=_edcb ;};if _daf <=0||_gccf <=0{return ;};if (_cfce &7)==0{_ebdf (_fbaef ,_cfce ,_dfda ,_daf ,_gccf ,_egce );
}else {_ebbe (_fbaef ,_cfce ,_dfda ,_daf ,_gccf ,_egce );};};func DilateBrick (d ,s *Bitmap ,hSize ,vSize int )(*Bitmap ,error ){return _agdbe (d ,s ,hSize ,vSize )};type RasterOperator int ;func _ggfc (_bfgb ...MorphProcess )(_fafab error ){const _gbcd ="v\u0065r\u0069\u0066\u0079\u004d\u006f\u0072\u0070\u0068P\u0072\u006f\u0063\u0065ss\u0065\u0073";
var _fbee ,_gaeg int ;for _fdec ,_fgfa :=range _bfgb {if _fafab =_fgfa .verify (_fdec ,&_fbee ,&_gaeg );_fafab !=nil {return _b .Wrap (_fafab ,_gbcd ,"");};};if _gaeg !=0&&_fbee !=0{return _b .Error (_gbcd ,"\u004d\u006f\u0072\u0070\u0068\u0020\u0073\u0065\u0071\u0075\u0065n\u0063\u0065\u0020\u002d\u0020\u0062\u006f\u0072d\u0065r\u0020\u0061\u0064\u0064\u0065\u0064\u0020\u0062\u0075\u0074\u0020\u006e\u0065\u0074\u0020\u0072\u0065\u0064u\u0063\u0074\u0069\u006f\u006e\u0020\u006e\u006f\u0074\u0020\u0030");
};return nil ;};func (_afc *Bitmap )And (s *Bitmap )(_bbec *Bitmap ,_adcg error ){const _gafa ="\u0042\u0069\u0074\u006d\u0061\u0070\u002e\u0041\u006e\u0064";if _afc ==nil {return nil ,_b .Error (_gafa ,"\u0027b\u0069t\u006d\u0061\u0070\u0020\u0027b\u0027\u0020i\u0073\u0020\u006e\u0069\u006c");
};if s ==nil {return nil ,_b .Error (_gafa ,"\u0062\u0069\u0074\u006d\u0061\u0070\u0020\u0027\u0073\u0027\u0020\u0069s\u0020\u006e\u0069\u006c");};if !_afc .SizesEqual (s ){_ca .Log .Debug ("\u0025\u0073\u0020-\u0020\u0042\u0069\u0074\u006d\u0061\u0070\u0020\u0027\u0073\u0027\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u0065\u0071\u0075\u0061\u006c\u0020\u0073\u0069\u007a\u0065 \u0077\u0069\u0074\u0068\u0020\u0027\u0062\u0027",_gafa );
};if _bbec ,_adcg =_dged (_bbec ,_afc );_adcg !=nil {return nil ,_b .Wrap (_adcg ,_gafa ,"\u0063\u0061\u006e't\u0020\u0063\u0072\u0065\u0061\u0074\u0065\u0020\u0027\u0064\u0027\u0020\u0062\u0069\u0074\u006d\u0061\u0070");};if _adcg =_bbec .RasterOperation (0,0,_bbec .Width ,_bbec .Height ,PixSrcAndDst ,s ,0,0);
_adcg !=nil {return nil ,_b .Wrap (_adcg ,_gafa ,"");};return _bbec ,nil ;};func (_fece *Bitmap )createTemplate ()*Bitmap {return &Bitmap {Width :_fece .Width ,Height :_fece .Height ,RowStride :_fece .RowStride ,Color :_fece .Color ,Text :_fece .Text ,BitmapNumber :_fece .BitmapNumber ,Special :_fece .Special ,Data :make ([]byte ,len (_fece .Data ))};
};func (_bffef *Bitmaps )makeSizeIndicator (_dcbea ,_geffg int ,_ccee LocationFilter ,_bafg SizeComparison )(_fgbff *_ab .NumSlice ,_fade error ){const _gedf ="\u0042i\u0074\u006d\u0061\u0070s\u002e\u006d\u0061\u006b\u0065S\u0069z\u0065I\u006e\u0064\u0069\u0063\u0061\u0074\u006fr";
if _bffef ==nil {return nil ,_b .Error (_gedf ,"\u0062\u0069\u0074ma\u0070\u0073\u0020\u0027\u0062\u0027\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};switch _ccee {case LocSelectWidth ,LocSelectHeight ,LocSelectIfEither ,LocSelectIfBoth :default:return nil ,_b .Errorf (_gedf ,"\u0070\u0072\u006f\u0076\u0069d\u0065\u0064\u0020\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006c\u006fc\u0061\u0074\u0069\u006f\u006e\u0020\u0066\u0069\u006c\u0074\u0065\u0072\u0020\u0074\u0079\u0070\u0065\u003a\u0020\u0025\u0064",_ccee );
};switch _bafg {case SizeSelectIfLT ,SizeSelectIfGT ,SizeSelectIfLTE ,SizeSelectIfGTE ,SizeSelectIfEQ :default:return nil ,_b .Errorf (_gedf ,"\u0069\u006e\u0076\u0061li\u0064\u0020\u0072\u0065\u006c\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0027\u0025d\u0027",_bafg );
};_fgbff =&_ab .NumSlice {};var (_ccgcd ,_dgdg ,_aadb int ;_acbf *Bitmap ;);for _ ,_acbf =range _bffef .Values {_ccgcd =0;_dgdg ,_aadb =_acbf .Width ,_acbf .Height ;switch _ccee {case LocSelectWidth :if (_bafg ==SizeSelectIfLT &&_dgdg < _dcbea )||(_bafg ==SizeSelectIfGT &&_dgdg > _dcbea )||(_bafg ==SizeSelectIfLTE &&_dgdg <=_dcbea )||(_bafg ==SizeSelectIfGTE &&_dgdg >=_dcbea )||(_bafg ==SizeSelectIfEQ &&_dgdg ==_dcbea ){_ccgcd =1;
};case LocSelectHeight :if (_bafg ==SizeSelectIfLT &&_aadb < _geffg )||(_bafg ==SizeSelectIfGT &&_aadb > _geffg )||(_bafg ==SizeSelectIfLTE &&_aadb <=_geffg )||(_bafg ==SizeSelectIfGTE &&_aadb >=_geffg )||(_bafg ==SizeSelectIfEQ &&_aadb ==_geffg ){_ccgcd =1;
};case LocSelectIfEither :if (_bafg ==SizeSelectIfLT &&(_dgdg < _dcbea ||_aadb < _geffg ))||(_bafg ==SizeSelectIfGT &&(_dgdg > _dcbea ||_aadb > _geffg ))||(_bafg ==SizeSelectIfLTE &&(_dgdg <=_dcbea ||_aadb <=_geffg ))||(_bafg ==SizeSelectIfGTE &&(_dgdg >=_dcbea ||_aadb >=_geffg ))||(_bafg ==SizeSelectIfEQ &&(_dgdg ==_dcbea ||_aadb ==_geffg )){_ccgcd =1;
};case LocSelectIfBoth :if (_bafg ==SizeSelectIfLT &&(_dgdg < _dcbea &&_aadb < _geffg ))||(_bafg ==SizeSelectIfGT &&(_dgdg > _dcbea &&_aadb > _geffg ))||(_bafg ==SizeSelectIfLTE &&(_dgdg <=_dcbea &&_aadb <=_geffg ))||(_bafg ==SizeSelectIfGTE &&(_dgdg >=_dcbea &&_aadb >=_geffg ))||(_bafg ==SizeSelectIfEQ &&(_dgdg ==_dcbea &&_aadb ==_geffg )){_ccgcd =1;
};};_fgbff .AddInt (_ccgcd );};return _fgbff ,nil ;};func _eea (_dgf ,_fbe *Bitmap ,_aaaf int ,_abeg []byte ,_bfb int )(_dab error ){const _gdce ="\u0072\u0065\u0064uc\u0065\u0052\u0061\u006e\u006b\u0042\u0069\u006e\u0061\u0072\u0079\u0032\u004c\u0065\u0076\u0065\u006c\u0033";
var (_cdgd ,_gfbe ,_cab ,_gee ,_eee ,_gfcf ,_egd ,_dga int ;_edb ,_fab ,_dea ,_dcga uint32 ;_ddd ,_dcf byte ;_dde uint16 ;);_ccfd :=make ([]byte ,4);_dfc :=make ([]byte ,4);for _cab =0;_cab < _dgf .Height -1;_cab ,_gee =_cab +2,_gee +1{_cdgd =_cab *_dgf .RowStride ;
_gfbe =_gee *_fbe .RowStride ;for _eee ,_gfcf =0,0;_eee < _bfb ;_eee ,_gfcf =_eee +4,_gfcf +1{for _egd =0;_egd < 4;_egd ++{_dga =_cdgd +_eee +_egd ;if _dga <=len (_dgf .Data )-1&&_dga < _cdgd +_dgf .RowStride {_ccfd [_egd ]=_dgf .Data [_dga ];}else {_ccfd [_egd ]=0x00;
};_dga =_cdgd +_dgf .RowStride +_eee +_egd ;if _dga <=len (_dgf .Data )-1&&_dga < _cdgd +(2*_dgf .RowStride ){_dfc [_egd ]=_dgf .Data [_dga ];}else {_dfc [_egd ]=0x00;};};_edb =_fg .BigEndian .Uint32 (_ccfd );_fab =_fg .BigEndian .Uint32 (_dfc );_dea =_edb &_fab ;
_dea |=_dea <<1;_dcga =_edb |_fab ;_dcga &=_dcga <<1;_fab =_dea &_dcga ;_fab &=0xaaaaaaaa;_edb =_fab |(_fab <<7);_ddd =byte (_edb >>24);_dcf =byte ((_edb >>8)&0xff);_dga =_gfbe +_gfcf ;if _dga +1==len (_fbe .Data )-1||_dga +1>=_gfbe +_fbe .RowStride {if _dab =_fbe .SetByte (_dga ,_abeg [_ddd ]);
_dab !=nil {return _b .Wrapf (_dab ,_gdce ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0025d",_dga );};}else {_dde =(uint16 (_abeg [_ddd ])<<8)|uint16 (_abeg [_dcf ]);if _dab =_fbe .setTwoBytes (_dga ,_dde );_dab !=nil {return _b .Wrapf (_dab ,_gdce ,"s\u0065\u0074\u0074\u0069\u006e\u0067 \u0074\u0077\u006f\u0020\u0062\u0079t\u0065\u0073\u0020\u0066\u0061\u0069\u006ce\u0064\u002c\u0020\u0069\u006e\u0064\u0065\u0078\u003a\u0020%\u0064",_dga );
};_gfcf ++;};};};return nil ;};func _aafb (_ebbfe *Bitmap ,_cece ...MorphProcess )(_ebcb *Bitmap ,_dfbe error ){const _dfeba ="\u006d\u006f\u0072\u0070\u0068\u0053\u0065\u0071\u0075\u0065\u006e\u0063\u0065";if _ebbfe ==nil {return nil ,_b .Error (_dfeba ,"\u006d\u006f\u0072\u0070\u0068\u0053\u0065\u0071\u0075\u0065\u006e\u0063\u0065 \u0073\u006f\u0075\u0072\u0063\u0065 \u0062\u0069\u0074\u006d\u0061\u0070\u0020\u006e\u006f\u0074\u0020\u0064\u0065f\u0069\u006e\u0065\u0064");
};if len (_cece )==0{return nil ,_b .Error (_dfeba ,"m\u006f\u0072\u0070\u0068\u0053\u0065q\u0075\u0065\u006e\u0063\u0065\u002c \u0073\u0065\u0071\u0075\u0065\u006e\u0063e\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006ee\u0064");};if _dfbe =_ggfc (_cece ...);
_dfbe !=nil {return nil ,_b .Wrap (_dfbe ,_dfeba ,"");};var _bfbad ,_eaeg ,_dgff int ;_ebcb =_ebbfe .Copy ();for _ ,_bdgfb :=range _cece {switch _bdgfb .Operation {case MopDilation :_bfbad ,_eaeg =_bdgfb .getWidthHeight ();_ebcb ,_dfbe =DilateBrick (nil ,_ebcb ,_bfbad ,_eaeg );
if _dfbe !=nil {return nil ,_b .Wrap (_dfbe ,_dfeba ,"");};case MopErosion :_bfbad ,_eaeg =_bdgfb .getWidthHeight ();_ebcb ,_dfbe =_ecac (nil ,_ebcb ,_bfbad ,_eaeg );if _dfbe !=nil {return nil ,_b .Wrap (_dfbe ,_dfeba ,"");};case MopOpening :_bfbad ,_eaeg =_bdgfb .getWidthHeight ();
_ebcb ,_dfbe =_cafe (nil ,_ebcb ,_bfbad ,_eaeg );if _dfbe !=nil {return nil ,_b .Wrap (_dfbe ,_dfeba ,"");};case MopClosing :_bfbad ,_eaeg =_bdgfb .getWidthHeight ();_ebcb ,_dfbe =_ceab (nil ,_ebcb ,_bfbad ,_eaeg );if _dfbe !=nil {return nil ,_b .Wrap (_dfbe ,_dfeba ,"");
};case MopRankBinaryReduction :_ebcb ,_dfbe =_cdg (_ebcb ,_bdgfb .Arguments ...);if _dfbe !=nil {return nil ,_b .Wrap (_dfbe ,_dfeba ,"");};case MopReplicativeBinaryExpansion :_ebcb ,_dfbe =_fgdg (_ebcb ,_bdgfb .Arguments [0]);if _dfbe !=nil {return nil ,_b .Wrap (_dfbe ,_dfeba ,"");
};case MopAddBorder :_dgff =_bdgfb .Arguments [0];_ebcb ,_dfbe =_ebcb .AddBorder (_dgff ,0);if _dfbe !=nil {return nil ,_b .Wrap (_dfbe ,_dfeba ,"");};default:return nil ,_b .Error (_dfeba ,"i\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006d\u006fr\u0070\u0068\u004f\u0070\u0065\u0072\u0061ti\u006f\u006e\u0020\u0070r\u006f\u0076\u0069\u0064\u0065\u0064\u0020\u0074\u006f t\u0068\u0065 \u0073\u0065\u0071\u0075\u0065\u006e\u0063\u0065");
};};if _dgff > 0{_ebcb ,_dfbe =_ebcb .RemoveBorder (_dgff );if _dfbe !=nil {return nil ,_b .Wrap (_dfbe ,_dfeba ,"\u0062\u006f\u0072\u0064\u0065\u0072\u0020\u003e\u0020\u0030");};};return _ebcb ,nil ;};func (_bgbe *Bitmap )Equals (s *Bitmap )bool {if len (_bgbe .Data )!=len (s .Data )||_bgbe .Width !=s .Width ||_bgbe .Height !=s .Height {return false ;
};for _dfcg :=0;_dfcg < _bgbe .Height ;_dfcg ++{_ada :=_dfcg *_bgbe .RowStride ;for _ebd :=0;_ebd < _bgbe .RowStride ;_ebd ++{if _bgbe .Data [_ada +_ebd ]!=s .Data [_ada +_ebd ]{return false ;};};};return true ;};func Rect (x ,y ,w ,h int )(*_dc .Rectangle ,error ){const _cca ="b\u0069\u0074\u006d\u0061\u0070\u002e\u0052\u0065\u0063\u0074";
if x < 0{w +=x ;x =0;if w <=0{return nil ,_b .Errorf (_cca ,"x\u003a\u0027\u0025\u0064\u0027\u0020<\u0020\u0030\u0020\u0061\u006e\u0064\u0020\u0077\u003a \u0027\u0025\u0064'\u0020<\u003d\u0020\u0030",x ,w );};};if y < 0{h +=y ;y =0;if h <=0{return nil ,_b .Error (_cca ,"\u0079\u0020\u003c 0\u0020\u0061\u006e\u0064\u0020\u0062\u006f\u0078\u0020\u006f\u0066\u0066\u0020\u002b\u0071\u0075\u0061\u0064");
};};_bebf :=_dc .Rect (x ,y ,x +w ,y +h );return &_bebf ,nil ;};func _ceab (_gcdd ,_edfdd *Bitmap ,_geee ,_eecf int )(*Bitmap ,error ){const _bdgf ="\u0063\u006c\u006f\u0073\u0065\u0053\u0061\u0066\u0065B\u0072\u0069\u0063\u006b";if _edfdd ==nil {return nil ,_b .Error (_bdgf ,"\u0073\u006f\u0075\u0072\u0063\u0065\u0020\u0069\u0073\u0020\u006e\u0069\u006c");
};if _geee < 1||_eecf < 1{return nil ,_b .Error (_bdgf ,"\u0068s\u0069\u007a\u0065\u0020\u0061\u006e\u0064\u0020\u0076\u0073\u0069z\u0065\u0020\u006e\u006f\u0074\u0020\u003e\u003d\u0020\u0031");};if _geee ==1&&_eecf ==1{return _dged (_gcdd ,_edfdd );};
if MorphBC ==SymmetricMorphBC {_facb ,_ccdba :=_gadc (_gcdd ,_edfdd ,_geee ,_eecf );if _ccdba !=nil {return nil ,_b .Wrap (_ccdba ,_bdgf ,"\u0053\u0079m\u006d\u0065\u0074r\u0069\u0063\u004d\u006f\u0072\u0070\u0068\u0042\u0043");};return _facb ,nil ;};_fdgd :=_cebc (_geee /2,_eecf /2);
_abcc :=8*((_fdgd +7)/8);_gbdb ,_feaff :=_edfdd .AddBorder (_abcc ,0);if _feaff !=nil {return nil ,_b .Wrapf (_feaff ,_bdgf ,"\u0042\u006f\u0072\u0064\u0065\u0072\u0053\u0069\u007ae\u003a\u0020\u0025\u0064",_abcc );};var _dgbf ,_fbbd *Bitmap ;if _geee ==1||_eecf ==1{_bbee :=SelCreateBrick (_eecf ,_geee ,_eecf /2,_geee /2,SelHit );
_dgbf ,_feaff =_afag (nil ,_gbdb ,_bbee );if _feaff !=nil {return nil ,_b .Wrap (_feaff ,_bdgf ,"\u0068S\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u007c\u007c \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");};}else {_degg :=SelCreateBrick (1,_geee ,0,_geee /2,SelHit );
_dfgcc ,_bege :=_ffdc (nil ,_gbdb ,_degg );if _bege !=nil {return nil ,_b .Wrap (_bege ,_bdgf ,"\u0072\u0065\u0067\u0075la\u0072\u0020\u002d\u0020\u0066\u0069\u0072\u0073\u0074\u0020\u0064\u0069\u006c\u0061t\u0065");};_gbfe :=SelCreateBrick (_eecf ,1,_eecf /2,0,SelHit );
_dgbf ,_bege =_ffdc (nil ,_dfgcc ,_gbfe );if _bege !=nil {return nil ,_b .Wrap (_bege ,_bdgf ,"\u0072\u0065\u0067ul\u0061\u0072\u0020\u002d\u0020\u0073\u0065\u0063\u006f\u006e\u0064\u0020\u0064\u0069\u006c\u0061\u0074\u0065");};if _ ,_bege =_adfbc (_dfgcc ,_dgbf ,_degg );
_bege !=nil {return nil ,_b .Wrap (_bege ,_bdgf ,"r\u0065\u0067\u0075\u006car\u0020-\u0020\u0066\u0069\u0072\u0073t\u0020\u0065\u0072\u006f\u0064\u0065");};if _ ,_bege =_adfbc (_dgbf ,_dfgcc ,_gbfe );_bege !=nil {return nil ,_b .Wrap (_bege ,_bdgf ,"\u0072\u0065\u0067\u0075la\u0072\u0020\u002d\u0020\u0073\u0065\u0063\u006f\u006e\u0064\u0020\u0065\u0072\u006fd\u0065");
};};if _fbbd ,_feaff =_dgbf .RemoveBorder (_abcc );_feaff !=nil {return nil ,_b .Wrap (_feaff ,_bdgf ,"\u0072e\u0067\u0075\u006c\u0061\u0072");};if _gcdd ==nil {return _fbbd ,nil ;};if _ ,_feaff =_dged (_gcdd ,_fbbd );_feaff !=nil {return nil ,_feaff ;
};return _gcdd ,nil ;};var _ _gc .Interface =&ClassedPoints {};func _ffc ()(_dcg [256]uint32 ){for _aaag :=0;_aaag < 256;_aaag ++{if _aaag &0x01!=0{_dcg [_aaag ]|=0xf;};if _aaag &0x02!=0{_dcg [_aaag ]|=0xf0;};if _aaag &0x04!=0{_dcg [_aaag ]|=0xf00;};if _aaag &0x08!=0{_dcg [_aaag ]|=0xf000;
};if _aaag &0x10!=0{_dcg [_aaag ]|=0xf0000;};if _aaag &0x20!=0{_dcg [_aaag ]|=0xf00000;};if _aaag &0x40!=0{_dcg [_aaag ]|=0xf000000;};if _aaag &0x80!=0{_dcg [_aaag ]|=0xf0000000;};};return _dcg ;};const _dbea =5000;func (_abcgd *Bitmaps )GetBox (i int )(*_dc .Rectangle ,error ){const _adcga ="\u0047\u0065\u0074\u0042\u006f\u0078";
if _abcgd ==nil {return nil ,_b .Error (_adcga ,"\u0070\u0072\u006f\u0076id\u0065\u0064\u0020\u006e\u0069\u006c\u0020\u0027\u0042\u0069\u0074\u006d\u0061\u0070s\u0027");};if i > len (_abcgd .Boxes )-1{return nil ,_b .Errorf (_adcga ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};return _abcgd .Boxes [i ],nil ;};func (_bfgee *ClassedPoints )Swap (i ,j int ){_bfgee .IntSlice [i ],_bfgee .IntSlice [j ]=_bfgee .IntSlice [j ],_bfgee .IntSlice [i ];};func (_geb *Boxes )selectWithIndicator (_agc *_ab .NumSlice )(_geac *Boxes ,_aae error ){const _fgac ="\u0042o\u0078\u0065\u0073\u002es\u0065\u006c\u0065\u0063\u0074W\u0069t\u0068I\u006e\u0064\u0069\u0063\u0061\u0074\u006fr";
if _geb ==nil {return nil ,_b .Error (_fgac ,"b\u006f\u0078\u0065\u0073 '\u0062'\u0020\u006e\u006f\u0074\u0020d\u0065\u0066\u0069\u006e\u0065\u0064");};if _agc ==nil {return nil ,_b .Error (_fgac ,"\u0027\u006ea\u0027\u0020\u006eo\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};if len (*_agc )!=len (*_geb ){return nil ,_b .Error (_fgac ,"\u0062\u006f\u0078\u0065\u0073\u0020\u0027\u0062\u0027\u0020\u0068\u0061\u0073\u0020\u0064\u0069\u0066\u0066\u0065\u0072\u0065\u006e\u0074\u0020s\u0069\u007a\u0065\u0020\u0074h\u0061\u006e \u0027\u006e\u0061\u0027");
};var _ffee ,_edaa int ;for _dgedc :=0;_dgedc < len (*_agc );_dgedc ++{if _ffee ,_aae =_agc .GetInt (_dgedc );_aae !=nil {return nil ,_b .Wrap (_aae ,_fgac ,"\u0063\u0068\u0065\u0063\u006b\u0069\u006e\u0067\u0020c\u006f\u0075\u006e\u0074");};if _ffee ==1{_edaa ++;
};};if _edaa ==len (*_geb ){return _geb ,nil ;};_cafa :=Boxes {};for _caa :=0;_caa < len (*_agc );_caa ++{_ffee =int ((*_agc )[_caa ]);if _ffee ==0{continue ;};_cafa =append (_cafa ,(*_geb )[_caa ]);};_geac =&_cafa ;return _geac ,nil ;};func _af (_bc *Bitmap ,_efe *Bitmap ,_dfg int )(_ed error ){const _bfa ="e\u0078\u0070\u0061\u006edB\u0069n\u0061\u0072\u0079\u0050\u006fw\u0065\u0072\u0032\u004c\u006f\u0077";
switch _dfg {case 2:_ed =_gb (_bc ,_efe );case 4:_ed =_dg (_bc ,_efe );case 8:_ed =_cd (_bc ,_efe );default:return _b .Error (_bfa ,"\u0065\u0078p\u0061\u006e\u0073\u0069o\u006e\u0020f\u0061\u0063\u0074\u006f\u0072\u0020\u006e\u006ft\u0020\u0069\u006e\u0020\u007b\u0032\u002c\u0034\u002c\u0038\u007d\u0020r\u0061\u006e\u0067\u0065");
};if _ed !=nil {_ed =_b .Wrap (_ed ,_bfa ,"");};return _ed ;};func (_gcde *Bitmap )setEightFullBytes (_gag int ,_dbcf uint64 )error {if _gag +7> len (_gcde .Data )-1{return _b .Error ("\u0073\u0065\u0074\u0045\u0069\u0067\u0068\u0074\u0042\u0079\u0074\u0065\u0073","\u0069n\u0064e\u0078\u0020\u006f\u0075\u0074 \u006f\u0066 \u0072\u0061\u006e\u0067\u0065");
};_gcde .Data [_gag ]=byte ((_dbcf &0xff00000000000000)>>56);_gcde .Data [_gag +1]=byte ((_dbcf &0xff000000000000)>>48);_gcde .Data [_gag +2]=byte ((_dbcf &0xff0000000000)>>40);_gcde .Data [_gag +3]=byte ((_dbcf &0xff00000000)>>32);_gcde .Data [_gag +4]=byte ((_dbcf &0xff000000)>>24);
_gcde .Data [_gag +5]=byte ((_dbcf &0xff0000)>>16);_gcde .Data [_gag +6]=byte ((_dbcf &0xff00)>>8);_gcde .Data [_gag +7]=byte (_dbcf &0xff);return nil ;};func CorrelationScoreSimple (bm1 ,bm2 *Bitmap ,area1 ,area2 int ,delX ,delY float32 ,maxDiffW ,maxDiffH int ,tab []int )(_ccfde float64 ,_fbfd error ){const _affc ="\u0043\u006f\u0072\u0072el\u0061\u0074\u0069\u006f\u006e\u0053\u0063\u006f\u0072\u0065\u0053\u0069\u006d\u0070l\u0065";
if bm1 ==nil ||bm2 ==nil {return _ccfde ,_b .Error (_affc ,"n\u0069l\u0020\u0062\u0069\u0074\u006d\u0061\u0070\u0073 \u0070\u0072\u006f\u0076id\u0065\u0064");};if tab ==nil {return _ccfde ,_b .Error (_affc ,"\u0074\u0061\u0062\u0020\u0075\u006e\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
};if area1 ==0||area2 ==0{return _ccfde ,_b .Error (_affc ,"\u0070\u0072\u006f\u0076\u0069\u0064\u0065\u0064\u0020\u0061\u0072e\u0061\u0073\u0020\u006d\u0075\u0073\u0074\u0020\u0062\u0065 \u003e\u0020\u0030");};_ead ,_ffaf :=bm1 .Width ,bm1 .Height ;_cda ,_fcbed :=bm2 .Width ,bm2 .Height ;
if _gaag (_ead -_cda )> maxDiffW {return 0,nil ;};if _gaag (_ffaf -_fcbed )> maxDiffH {return 0,nil ;};var _dfeb ,_abad int ;if delX >=0{_dfeb =int (delX +0.5);}else {_dfeb =int (delX -0.5);};if delY >=0{_abad =int (delY +0.5);}else {_abad =int (delY -0.5);
};_ddc :=bm1 .createTemplate ();if _fbfd =_ddc .RasterOperation (_dfeb ,_abad ,_cda ,_fcbed ,PixSrc ,bm2 ,0,0);_fbfd !=nil {return _ccfde ,_b .Wrap (_fbfd ,_affc ,"\u0062m\u0032 \u0074\u006f\u0020\u0054\u0065\u006d\u0070\u006c\u0061\u0074\u0065");};if _fbfd =_ddc .RasterOperation (0,0,_ead ,_ffaf ,PixSrcAndDst ,bm1 ,0,0);
_fbfd !=nil {return _ccfde ,_b .Wrap (_fbfd ,_affc ,"b\u006d\u0031\u0020\u0061\u006e\u0064\u0020\u0062\u006d\u0054");};_afd :=_ddc .countPixels ();_ccfde =float64 (_afd )*float64 (_afd )/(float64 (area1 )*float64 (area2 ));return _ccfde ,nil ;};func (_dcfd *Bitmap )setEightPartlyBytes (_dead ,_dcec int ,_dfbd uint64 )(_eeb error ){var (_adga byte ;
_agda int ;);const _cebf ="\u0073\u0065\u0074\u0045ig\u0068\u0074\u0050\u0061\u0072\u0074\u006c\u0079\u0042\u0079\u0074\u0065\u0073";for _ggda :=1;_ggda <=_dcec ;_ggda ++{_agda =64-_ggda *8;_adga =byte (_dfbd >>uint (_agda )&0xff);_ca .Log .Trace ("\u0074\u0065\u006d\u0070\u003a\u0020\u0025\u0030\u0038\u0062\u002c\u0020\u0069\u006e\u0064\u0065\u0078\u003a %\u0064,\u0020\u0069\u0064\u0078\u003a\u0020\u0025\u0064\u002c\u0020\u0066\u0075l\u006c\u0042\u0079\u0074\u0065\u0073\u004e\u0075\u006d\u0062\u0065\u0072\u003a\u0020\u0025\u0064\u002c \u0073\u0068\u0069\u0066\u0074\u003a\u0020\u0025\u0064",_adga ,_dead ,_dead +_ggda -1,_dcec ,_agda );
if _eeb =_dcfd .SetByte (_dead +_ggda -1,_adga );_eeb !=nil {return _b .Wrap (_eeb ,_cebf ,"\u0066\u0075\u006c\u006c\u0042\u0079\u0074\u0065");};};_gfbeb :=_dcfd .RowStride *8-_dcfd .Width ;if _gfbeb ==0{return nil ;};_agda -=8;_adga =byte (_dfbd >>uint (_agda )&0xff)<<uint (_gfbeb );
if _eeb =_dcfd .SetByte (_dead +_dcec ,_adga );_eeb !=nil {return _b .Wrap (_eeb ,_cebf ,"\u0070\u0061\u0064\u0064\u0065\u0064");};return nil ;};func (_bfeg *Bitmaps )GroupByHeight ()(*BitmapsArray ,error ){const _agca ="\u0047\u0072\u006f\u0075\u0070\u0042\u0079\u0048\u0065\u0069\u0067\u0068\u0074";
if len (_bfeg .Values )==0{return nil ,_b .Error (_agca ,"\u006eo\u0020v\u0061\u006c\u0075\u0065\u0073 \u0070\u0072o\u0076\u0069\u0064\u0065\u0064");};_gcfd :=&BitmapsArray {};_bfeg .SortByHeight ();_ffga :=-1;_fafg :=-1;for _dafg :=0;_dafg < len (_bfeg .Values );
_dafg ++{_efada :=_bfeg .Values [_dafg ].Height ;if _efada > _ffga {_ffga =_efada ;_fafg ++;_gcfd .Values =append (_gcfd .Values ,&Bitmaps {});};_gcfd .Values [_fafg ].AddBitmap (_bfeg .Values [_dafg ]);};return _gcfd ,nil ;};func _fffe (_aabbe ,_fedd ,_ddgd *Bitmap ,_efeg int )(*Bitmap ,error ){const _bfgf ="\u0073\u0065\u0065\u0064\u0046\u0069\u006c\u006c\u0042i\u006e\u0061\u0072\u0079";
if _fedd ==nil {return nil ,_b .Error (_bfgf ,"s\u006fu\u0072\u0063\u0065\u0020\u0062\u0069\u0074\u006da\u0070\u0020\u0069\u0073 n\u0069\u006c");};if _ddgd ==nil {return nil ,_b .Error (_bfgf ,"'\u006da\u0073\u006b\u0027\u0020\u0062\u0069\u0074\u006da\u0070\u0020\u0069\u0073 n\u0069\u006c");
};if _efeg !=4&&_efeg !=8{return nil ,_b .Error (_bfgf ,"\u0063\u006f\u006en\u0065\u0063\u0074\u0069v\u0069\u0074\u0079\u0020\u006e\u006f\u0074 \u0069\u006e\u0020\u0072\u0061\u006e\u0067\u0065\u0020\u007b\u0034\u002c\u0038\u007d");};var _ecec error ;_aabbe ,_ecec =_dged (_aabbe ,_fedd );
if _ecec !=nil {return nil ,_b .Wrap (_ecec ,_bfgf ,"\u0063o\u0070y\u0020\u0073\u006f\u0075\u0072c\u0065\u0020t\u006f\u0020\u0027\u0064\u0027");};_gaage :=_fedd .createTemplate ();_ddgd .setPadBits (0);for _daddf :=0;_daddf < _dbea ;_daddf ++{_gaage ,_ecec =_dged (_gaage ,_aabbe );
if _ecec !=nil {return nil ,_b .Wrapf (_ecec ,_bfgf ,"\u0069\u0074\u0065\u0072\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0025\u0064",_daddf );};if _ecec =_decg (_aabbe ,_ddgd ,_efeg );_ecec !=nil {return nil ,_b .Wrapf (_ecec ,_bfgf ,"\u0069\u0074\u0065\u0072\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0025\u0064",_daddf );
};if _gaage .Equals (_aabbe ){break ;};};return _aabbe ,nil ;};func (_abaa *Bitmap )setTwoBytes (_cddf int ,_dge uint16 )error {if _cddf +1> len (_abaa .Data )-1{return _b .Errorf ("s\u0065\u0074\u0054\u0077\u006f\u0042\u0079\u0074\u0065\u0073","\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",_cddf );
};_abaa .Data [_cddf ]=byte ((_dge &0xff00)>>8);_abaa .Data [_cddf +1]=byte (_dge &0xff);return nil ;};func (_abbd *ClassedPoints )Less (i ,j int )bool {return _abbd ._faffb (i ,j )};const (_eagc shift =iota ;_acace ;);func _dgba (_cdff ,_edgb int ,_cfged string )*Selection {_cefgg :=&Selection {Height :_cdff ,Width :_edgb ,Name :_cfged };
_cefgg .Data =make ([][]SelectionValue ,_cdff );for _dbec :=0;_dbec < _cdff ;_dbec ++{_cefgg .Data [_dbec ]=make ([]SelectionValue ,_edgb );};return _cefgg ;};func (_eba *Bitmap )String ()string {var _cbc ="\u000a";for _fead :=0;_fead < _eba .Height ;_fead ++{var _bff string ;
for _ede :=0;_ede < _eba .Width ;_ede ++{_beaf :=_eba .GetPixel (_ede ,_fead );if _beaf {_bff +="\u0031";}else {_bff +="\u0030";};};_cbc +=_bff +"\u000a";};return _cbc ;};func (_effab *Bitmaps )SortByWidth (){_bbfea :=(*byWidth )(_effab );_gc .Sort (_bbfea )};
func (_ebfga *Bitmaps )AddBitmap (bm *Bitmap ){_ebfga .Values =append (_ebfga .Values ,bm )};func (_dcc *Bitmap )clipRectangle (_aga ,_cdd *_dc .Rectangle )(_dbfa *Bitmap ,_ccbe error ){const _fde ="\u0063\u006c\u0069\u0070\u0052\u0065\u0063\u0074\u0061\u006e\u0067\u006c\u0065";
if _aga ==nil {return nil ,_b .Error (_fde ,"\u0070r\u006fv\u0069\u0064\u0065\u0064\u0020n\u0069\u006c \u0027\u0062\u006f\u0078\u0027");};_ece ,_dbb :=_dcc .Width ,_dcc .Height ;_cce ,_ccbe :=ClipBoxToRectangle (_aga ,_ece ,_dbb );if _ccbe !=nil {_ca .Log .Warning ("\u0027\u0062ox\u0027\u0020\u0064o\u0065\u0073\u006e\u0027t o\u0076er\u006c\u0061\u0070\u0020\u0062\u0069\u0074ma\u0070\u0020\u0027\u0062\u0027\u003a\u0020%\u0076",_ccbe );
return nil ,nil ;};_afgg ,_gceg :=_cce .Min .X ,_cce .Min .Y ;_ccff ,_bfag :=_cce .Max .X -_cce .Min .X ,_cce .Max .Y -_cce .Min .Y ;_dbfa =New (_ccff ,_bfag );_dbfa .Text =_dcc .Text ;if _ccbe =_dbfa .RasterOperation (0,0,_ccff ,_bfag ,PixSrc ,_dcc ,_afgg ,_gceg );
_ccbe !=nil {return nil ,_b .Wrap (_ccbe ,_fde ,"");};if _cdd !=nil {*_cdd =*_cce ;};return _dbfa ,nil ;};func (_gbbcg CombinationOperator )String ()string {var _fdbee string ;switch _gbbcg {case CmbOpOr :_fdbee ="\u004f\u0052";case CmbOpAnd :_fdbee ="\u0041\u004e\u0044";
case CmbOpXor :_fdbee ="\u0058\u004f\u0052";case CmbOpXNor :_fdbee ="\u0058\u004e\u004f\u0052";case CmbOpReplace :_fdbee ="\u0052E\u0050\u004c\u0041\u0043\u0045";case CmbOpNot :_fdbee ="\u004e\u004f\u0054";};return _fdbee ;};func (_fee *Bitmap )addBorderGeneral (_cfe ,_ffa ,_adeg ,_gef int ,_fbba int )(*Bitmap ,error ){const _bcf ="\u0061\u0064d\u0042\u006f\u0072d\u0065\u0072\u0047\u0065\u006e\u0065\u0072\u0061\u006c";
if _cfe < 0||_ffa < 0||_adeg < 0||_gef < 0{return nil ,_b .Error (_bcf ,"n\u0065\u0067\u0061\u0074iv\u0065 \u0062\u006f\u0072\u0064\u0065r\u0020\u0061\u0064\u0064\u0065\u0064");};_fdce ,_fdgc :=_fee .Width ,_fee .Height ;_bdf :=_fdce +_cfe +_ffa ;_edc :=_fdgc +_adeg +_gef ;
_bggb :=New (_bdf ,_edc );_bggb .Color =_fee .Color ;_ebb :=PixClr ;if _fbba > 0{_ebb =PixSet ;};_bgc :=_bggb .RasterOperation (0,0,_cfe ,_edc ,_ebb ,nil ,0,0);if _bgc !=nil {return nil ,_b .Wrap (_bgc ,_bcf ,"\u006c\u0065\u0066\u0074");};_bgc =_bggb .RasterOperation (_bdf -_ffa ,0,_ffa ,_edc ,_ebb ,nil ,0,0);
if _bgc !=nil {return nil ,_b .Wrap (_bgc ,_bcf ,"\u0072\u0069\u0067h\u0074");};_bgc =_bggb .RasterOperation (0,0,_bdf ,_adeg ,_ebb ,nil ,0,0);if _bgc !=nil {return nil ,_b .Wrap (_bgc ,_bcf ,"\u0074\u006f\u0070");};_bgc =_bggb .RasterOperation (0,_edc -_gef ,_bdf ,_gef ,_ebb ,nil ,0,0);
if _bgc !=nil {return nil ,_b .Wrap (_bgc ,_bcf ,"\u0062\u006f\u0074\u0074\u006f\u006d");};_bgc =_bggb .RasterOperation (_cfe ,_adeg ,_fdce ,_fdgc ,PixSrc ,_fee ,0,0);if _bgc !=nil {return nil ,_b .Wrap (_bgc ,_bcf ,"\u0063\u006f\u0070\u0079");};return _bggb ,nil ;
};func (_aacb *ClassedPoints )Len ()int {return _aacb .IntSlice .Size ()};func TstFrameBitmap ()*Bitmap {return _bdfc .Copy ()};type fillSegment struct{_bbccg int ;_fabg int ;_cffc int ;_fbcc int ;};func _ecac (_fbbc ,_fcgdc *Bitmap ,_aafd ,_bgdcf int )(*Bitmap ,error ){const _gcab ="\u0065\u0072\u006f\u0064\u0065\u0042\u0072\u0069\u0063\u006b";
if _fcgdc ==nil {return nil ,_b .Error (_gcab ,"\u0073o\u0075r\u0063\u0065\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");};if _aafd < 1||_bgdcf < 1{return nil ,_b .Error (_gcab ,"\u0068\u0073\u0069\u007a\u0065\u0020\u0061\u006e\u0064\u0020\u0076\u0073\u0069\u007a\u0065\u0020\u0061\u0072e\u0020\u006e\u006f\u0074\u0020\u0067\u0072e\u0061\u0074\u0065\u0072\u0020\u0074\u0068\u0061\u006e\u0020\u006fr\u0020\u0065\u0071\u0075\u0061\u006c\u0020\u0074\u006f\u0020\u0031");
};if _aafd ==1&&_bgdcf ==1{_gbfc ,_eag :=_dged (_fbbc ,_fcgdc );if _eag !=nil {return nil ,_b .Wrap (_eag ,_gcab ,"\u0068S\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u0026\u0026 \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");
};return _gbfc ,nil ;};if _aafd ==1||_bgdcf ==1{_bdgd :=SelCreateBrick (_bgdcf ,_aafd ,_bgdcf /2,_aafd /2,SelHit );_ecag ,_afde :=_adfbc (_fbbc ,_fcgdc ,_bdgd );if _afde !=nil {return nil ,_b .Wrap (_afde ,_gcab ,"\u0068S\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u007c\u007c \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");
};return _ecag ,nil ;};_cfbc :=SelCreateBrick (1,_aafd ,0,_aafd /2,SelHit );_gabg :=SelCreateBrick (_bgdcf ,1,_bgdcf /2,0,SelHit );_gbeg ,_fcda :=_adfbc (nil ,_fcgdc ,_cfbc );if _fcda !=nil {return nil ,_b .Wrap (_fcda ,_gcab ,"\u0031s\u0074\u0020\u0065\u0072\u006f\u0064e");
};_fbbc ,_fcda =_adfbc (_fbbc ,_gbeg ,_gabg );if _fcda !=nil {return nil ,_b .Wrap (_fcda ,_gcab ,"\u0032n\u0064\u0020\u0065\u0072\u006f\u0064e");};return _fbbc ,nil ;};func _cgb (_gga ,_eccc *Bitmap ,_ebab ,_dfga int )(_fcfa error ){const _aggd ="\u0073e\u0065d\u0066\u0069\u006c\u006c\u0042i\u006e\u0061r\u0079\u004c\u006f\u0077\u0038";
var (_cgf ,_cecb ,_gfgc ,_baeb int ;_cade ,_acbbg ,_abdf ,_egbe ,_gfdc ,_bbafc ,_egdf ,_gddaa byte ;);for _cgf =0;_cgf < _ebab ;_cgf ++{_gfgc =_cgf *_gga .RowStride ;_baeb =_cgf *_eccc .RowStride ;for _cecb =0;_cecb < _dfga ;_cecb ++{if _cade ,_fcfa =_gga .GetByte (_gfgc +_cecb );
_fcfa !=nil {return _b .Wrap (_fcfa ,_aggd ,"\u0067e\u0074 \u0073\u006f\u0075\u0072\u0063\u0065\u0020\u0062\u0079\u0074\u0065");};if _acbbg ,_fcfa =_eccc .GetByte (_baeb +_cecb );_fcfa !=nil {return _b .Wrap (_fcfa ,_aggd ,"\u0067\u0065\u0074\u0020\u006d\u0061\u0073\u006b\u0020\u0062\u0079\u0074\u0065");
};if _cgf > 0{if _abdf ,_fcfa =_gga .GetByte (_gfgc -_gga .RowStride +_cecb );_fcfa !=nil {return _b .Wrap (_fcfa ,_aggd ,"\u0069\u0020\u003e\u0020\u0030\u0020\u0062\u0079\u0074\u0065");};_cade |=_abdf |(_abdf <<1)|(_abdf >>1);if _cecb > 0{if _gddaa ,_fcfa =_gga .GetByte (_gfgc -_gga .RowStride +_cecb -1);
_fcfa !=nil {return _b .Wrap (_fcfa ,_aggd ,"\u0069\u0020\u003e\u00200 \u0026\u0026\u0020\u006a\u0020\u003e\u0020\u0030\u0020\u0062\u0079\u0074\u0065");};_cade |=_gddaa <<7;};if _cecb < _dfga -1{if _gddaa ,_fcfa =_gga .GetByte (_gfgc -_gga .RowStride +_cecb +1);
_fcfa !=nil {return _b .Wrap (_fcfa ,_aggd ,"\u006a\u0020<\u0020\u0077\u0070l\u0020\u002d\u0020\u0031\u0020\u0062\u0079\u0074\u0065");};_cade |=_gddaa >>7;};};if _cecb > 0{if _egbe ,_fcfa =_gga .GetByte (_gfgc +_cecb -1);_fcfa !=nil {return _b .Wrap (_fcfa ,_aggd ,"\u006a\u0020\u003e \u0030");
};_cade |=_egbe <<7;};_cade &=_acbbg ;if _cade ==0||^_cade ==0{if _fcfa =_gga .SetByte (_gfgc +_cecb ,_cade );_fcfa !=nil {return _b .Wrap (_fcfa ,_aggd ,"\u0073e\u0074t\u0069\u006e\u0067\u0020\u0065m\u0070\u0074y\u0020\u0062\u0079\u0074\u0065");};};for {_egdf =_cade ;
_cade =(_cade |(_cade >>1)|(_cade <<1))&_acbbg ;if (_cade ^_egdf )==0{if _fcfa =_gga .SetByte (_gfgc +_cecb ,_cade );_fcfa !=nil {return _b .Wrap (_fcfa ,_aggd ,"\u0073\u0065\u0074\u0074\u0069\u006e\u0067\u0020\u0070\u0072\u0065\u0076 \u0062\u0079\u0074\u0065");
};break ;};};};};for _cgf =_ebab -1;_cgf >=0;_cgf --{_gfgc =_cgf *_gga .RowStride ;_baeb =_cgf *_eccc .RowStride ;for _cecb =_dfga -1;_cecb >=0;_cecb --{if _cade ,_fcfa =_gga .GetByte (_gfgc +_cecb );_fcfa !=nil {return _b .Wrap (_fcfa ,_aggd ,"\u0072\u0065\u0076er\u0073\u0065\u0020\u0067\u0065\u0074\u0020\u0073\u006f\u0075\u0072\u0063\u0065\u0020\u0062\u0079\u0074\u0065");
};if _acbbg ,_fcfa =_eccc .GetByte (_baeb +_cecb );_fcfa !=nil {return _b .Wrap (_fcfa ,_aggd ,"r\u0065\u0076\u0065\u0072se\u0020g\u0065\u0074\u0020\u006d\u0061s\u006b\u0020\u0062\u0079\u0074\u0065");};if _cgf < _ebab -1{if _gfdc ,_fcfa =_gga .GetByte (_gfgc +_gga .RowStride +_cecb );
_fcfa !=nil {return _b .Wrap (_fcfa ,_aggd ,"\u0069\u0020\u003c\u0020h\u0020\u002d\u0020\u0031\u0020\u002d\u003e\u0020\u0067\u0065t\u0020s\u006f\u0075\u0072\u0063\u0065\u0020\u0062y\u0074\u0065");};_cade |=_gfdc |(_gfdc <<1)|_gfdc >>1;if _cecb > 0{if _gddaa ,_fcfa =_gga .GetByte (_gfgc +_gga .RowStride +_cecb -1);
_fcfa !=nil {return _b .Wrap (_fcfa ,_aggd ,"\u0069\u0020\u003c h\u002d\u0031\u0020\u0026\u0020\u006a\u0020\u003e\u00200\u0020-\u003e \u0067e\u0074\u0020\u0073\u006f\u0075\u0072\u0063\u0065\u0020\u0062\u0079\u0074\u0065");};_cade |=_gddaa <<7;};if _cecb < _dfga -1{if _gddaa ,_fcfa =_gga .GetByte (_gfgc +_gga .RowStride +_cecb +1);
_fcfa !=nil {return _b .Wrap (_fcfa ,_aggd ,"\u0069\u0020\u003c\u0020\u0068\u002d\u0031\u0020\u0026\u0026\u0020\u006a\u0020\u003c\u0077\u0070\u006c\u002d\u0031\u0020\u002d\u003e\u0020\u0067e\u0074\u0020\u0073\u006f\u0075r\u0063\u0065 \u0062\u0079\u0074\u0065");
};_cade |=_gddaa >>7;};};if _cecb < _dfga -1{if _bbafc ,_fcfa =_gga .GetByte (_gfgc +_cecb +1);_fcfa !=nil {return _b .Wrap (_fcfa ,_aggd ,"\u006a\u0020<\u0020\u0077\u0070\u006c\u0020\u002d\u0031\u0020\u002d\u003e\u0020\u0067\u0065\u0074\u0020\u0073\u006f\u0075\u0072\u0063\u0065\u0020by\u0074\u0065");
};_cade |=_bbafc >>7;};_cade &=_acbbg ;if _cade ==0||(^_cade )==0{if _fcfa =_gga .SetByte (_gfgc +_cecb ,_cade );_fcfa !=nil {return _b .Wrap (_fcfa ,_aggd ,"\u0073e\u0074 \u006d\u0061\u0073\u006b\u0065\u0064\u0020\u0062\u0079\u0074\u0065");};};for {_egdf =_cade ;
_cade =(_cade |(_cade >>1)|(_cade <<1))&_acbbg ;if (_cade ^_egdf )==0{if _fcfa =_gga .SetByte (_gfgc +_cecb ,_cade );_fcfa !=nil {return _b .Wrap (_fcfa ,_aggd ,"r\u0065\u0076\u0065\u0072se\u0020s\u0065\u0074\u0020\u0070\u0072e\u0076\u0020\u0062\u0079\u0074\u0065");
};break ;};};};};return nil ;};func _fcfe (_gcgc *_ab .Stack )(_deed *fillSegment ,_bacad error ){const _bfae ="\u0070\u006f\u0070\u0046\u0069\u006c\u006c\u0053\u0065g\u006d\u0065\u006e\u0074";if _gcgc ==nil {return nil ,_b .Error (_bfae ,"\u006ei\u006c \u0073\u0074\u0061\u0063\u006b \u0070\u0072o\u0076\u0069\u0064\u0065\u0064");
};if _gcgc .Aux ==nil {return nil ,_b .Error (_bfae ,"a\u0075x\u0053\u0074\u0061\u0063\u006b\u0020\u006e\u006ft\u0020\u0064\u0065\u0066in\u0065\u0064");};_gbfb ,_daad :=_gcgc .Pop ();if !_daad {return nil ,nil ;};_aaaa ,_daad :=_gbfb .(*fillSegment );if !_daad {return nil ,_b .Error (_bfae ,"\u0073\u0074\u0061ck\u0020\u0064\u006f\u0065\u0073\u006e\u0027\u0074\u0020c\u006fn\u0074a\u0069n\u0020\u002a\u0066\u0069\u006c\u006c\u0053\u0065\u0067\u006d\u0065\u006e\u0074");
};_deed =&fillSegment {_aaaa ._bbccg ,_aaaa ._fabg ,_aaaa ._cffc +_aaaa ._fbcc ,_aaaa ._fbcc };_gcgc .Aux .Push (_aaaa );return _deed ,nil ;};func (_bbe *Bitmap )AddBorderGeneral (left ,right ,top ,bot int ,val int )(*Bitmap ,error ){return _bbe .addBorderGeneral (left ,right ,top ,bot ,val );
};func _agd (_eef ,_bba *Bitmap ,_ int ,_faac []byte ,_cag int )(_gfag error ){const _ba ="\u0072\u0065\u0064uc\u0065\u0052\u0061\u006e\u006b\u0042\u0069\u006e\u0061\u0072\u0079\u0032\u004c\u0065\u0076\u0065\u006c\u0031";var (_efa ,_cea ,_ac ,_da ,_gbg ,_bfg ,_bggg ,_ebe int ;
_dbf ,_beb uint32 ;_ddb ,_eda byte ;_fbae uint16 ;);_cfdf :=make ([]byte ,4);_dgg :=make ([]byte ,4);for _ac =0;_ac < _eef .Height -1;_ac ,_da =_ac +2,_da +1{_efa =_ac *_eef .RowStride ;_cea =_da *_bba .RowStride ;for _gbg ,_bfg =0,0;_gbg < _cag ;_gbg ,_bfg =_gbg +4,_bfg +1{for _bggg =0;
_bggg < 4;_bggg ++{_ebe =_efa +_gbg +_bggg ;if _ebe <=len (_eef .Data )-1&&_ebe < _efa +_eef .RowStride {_cfdf [_bggg ]=_eef .Data [_ebe ];}else {_cfdf [_bggg ]=0x00;};_ebe =_efa +_eef .RowStride +_gbg +_bggg ;if _ebe <=len (_eef .Data )-1&&_ebe < _efa +(2*_eef .RowStride ){_dgg [_bggg ]=_eef .Data [_ebe ];
}else {_dgg [_bggg ]=0x00;};};_dbf =_fg .BigEndian .Uint32 (_cfdf );_beb =_fg .BigEndian .Uint32 (_dgg );_beb |=_dbf ;_beb |=_beb <<1;_beb &=0xaaaaaaaa;_dbf =_beb |(_beb <<7);_ddb =byte (_dbf >>24);_eda =byte ((_dbf >>8)&0xff);_ebe =_cea +_bfg ;if _ebe +1==len (_bba .Data )-1||_ebe +1>=_cea +_bba .RowStride {_bba .Data [_ebe ]=_faac [_ddb ];
}else {_fbae =(uint16 (_faac [_ddb ])<<8)|uint16 (_faac [_eda ]);if _gfag =_bba .setTwoBytes (_ebe ,_fbae );_gfag !=nil {return _b .Wrapf (_gfag ,_ba ,"s\u0065\u0074\u0074\u0069\u006e\u0067 \u0074\u0077\u006f\u0020\u0062\u0079t\u0065\u0073\u0020\u0066\u0061\u0069\u006ce\u0064\u002c\u0020\u0069\u006e\u0064\u0065\u0078\u003a\u0020%\u0064",_ebe );
};_bfg ++;};};};return nil ;};func _ddde (_bcgbg *Bitmap ,_fgcg *Bitmap ,_bfe *Selection ,_bbbcd **Bitmap )(*Bitmap ,error ){const _gcgb ="\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u004d\u006f\u0072\u0070\u0068A\u0072\u0067\u0073\u0031";if _fgcg ==nil {return nil ,_b .Error (_gcgb ,"\u004d\u006f\u0072\u0070\u0068\u0041\u0072\u0067\u0073\u0031\u0020'\u0073\u0027\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066i\u006e\u0065\u0064");
};if _bfe ==nil {return nil ,_b .Error (_gcgb ,"\u004d\u006f\u0072\u0068p\u0041\u0072\u0067\u0073\u0031\u0020\u0027\u0073\u0065\u006c'\u0020n\u006f\u0074\u0020\u0064\u0065\u0066\u0069n\u0065\u0064");};_fcea ,_dgab :=_bfe .Height ,_bfe .Width ;if _fcea ==0||_dgab ==0{return nil ,_b .Error (_gcgb ,"\u0073\u0065\u006c\u0065ct\u0069\u006f\u006e\u0020\u006f\u0066\u0020\u0073\u0069\u007a\u0065\u0020\u0030");
};if _bcgbg ==nil {_bcgbg =_fgcg .createTemplate ();*_bbbcd =_fgcg ;return _bcgbg ,nil ;};_bcgbg .Width =_fgcg .Width ;_bcgbg .Height =_fgcg .Height ;_bcgbg .RowStride =_fgcg .RowStride ;_bcgbg .Color =_fgcg .Color ;_bcgbg .Data =make ([]byte ,_fgcg .RowStride *_fgcg .Height );
if _bcgbg ==_fgcg {*_bbbcd =_fgcg .Copy ();}else {*_bbbcd =_fgcg ;};return _bcgbg ,nil ;};func NewWithUnpaddedData (width ,height int ,data []byte )(*Bitmap ,error ){const _aacd ="\u004e\u0065\u0077\u0057it\u0068\u0055\u006e\u0070\u0061\u0064\u0064\u0065\u0064\u0044\u0061\u0074\u0061";
_edf :=_gcd (width ,height );_edf .Data =data ;if _bcg :=((width *height )+7)>>3;len (data )< _bcg {return nil ,_b .Errorf (_aacd ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0064a\u0074\u0061\u0020\u006c\u0065\u006e\u0067\u0074\u0068\u003a\u0020\u0027\u0025\u0064\u0027\u002e\u0020\u0054\u0068\u0065\u0020\u0064\u0061t\u0061\u0020s\u0068\u006fu\u006c\u0064\u0020\u0063\u006f\u006e\u0074\u0061\u0069\u006e\u0020\u0061\u0074 l\u0065\u0061\u0073\u0074\u003a\u0020\u0027\u0025\u0064'\u0020\u0062\u0079\u0074\u0065\u0073",len (data ),_bcg );
};if _afe :=_edf .addPadBits ();_afe !=nil {return nil ,_b .Wrap (_afe ,_aacd ,"");};return _edf ,nil ;};func _acaf ()[]int {_fdggg :=make ([]int ,256);for _ddea :=0;_ddea <=0xff;_ddea ++{_ccce :=byte (_ddea );_fdggg [_ccce ]=int (_ccce &0x1)+(int (_ccce >>1)&0x1)+(int (_ccce >>2)&0x1)+(int (_ccce >>3)&0x1)+(int (_ccce >>4)&0x1)+(int (_ccce >>5)&0x1)+(int (_ccce >>6)&0x1)+(int (_ccce >>7)&0x1);
};return _fdggg ;};func _dgd ()(_gad [256]uint16 ){for _fbb :=0;_fbb < 256;_fbb ++{if _fbb &0x01!=0{_gad [_fbb ]|=0x3;};if _fbb &0x02!=0{_gad [_fbb ]|=0xc;};if _fbb &0x04!=0{_gad [_fbb ]|=0x30;};if _fbb &0x08!=0{_gad [_fbb ]|=0xc0;};if _fbb &0x10!=0{_gad [_fbb ]|=0x300;
};if _fbb &0x20!=0{_gad [_fbb ]|=0xc00;};if _fbb &0x40!=0{_gad [_fbb ]|=0x3000;};if _fbb &0x80!=0{_gad [_fbb ]|=0xc000;};};return _gad ;};func (_ceaf *BitmapsArray )GetBox (i int )(*_dc .Rectangle ,error ){const _bade ="\u0042\u0069\u0074\u006dap\u0073\u0041\u0072\u0072\u0061\u0079\u002e\u0047\u0065\u0074\u0042\u006f\u0078";
if _ceaf ==nil {return nil ,_b .Error (_bade ,"p\u0072\u006f\u0076\u0069\u0064\u0065d\u0020\u006e\u0069\u006c\u0020\u0027\u0042\u0069\u0074m\u0061\u0070\u0073A\u0072r\u0061\u0079\u0027");};if i > len (_ceaf .Boxes )-1{return nil ,_b .Errorf (_bade ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};return _ceaf .Boxes [i ],nil ;};func Centroids (bms []*Bitmap )(*Points ,error ){_bgdc :=make ([]Point ,len (bms ));_cccg :=_cbda ();_egea :=_acaf ();var _fddf error ;for _cgeg ,_dedd :=range bms {_bgdc [_cgeg ],_fddf =_dedd .centroid (_cccg ,_egea );
if _fddf !=nil {return nil ,_fddf ;};};_fgaf :=Points (_bgdc );return &_fgaf ,nil ;};func (_gaab *Bitmap )GetComponents (components Component ,maxWidth ,maxHeight int )(_fgbb *Bitmaps ,_feaf *Boxes ,_feec error ){const _aadg ="B\u0069t\u006d\u0061\u0070\u002e\u0047\u0065\u0074\u0043o\u006d\u0070\u006f\u006een\u0074\u0073";
if _gaab ==nil {return nil ,nil ,_b .Error (_aadg ,"\u0073\u006f\u0075\u0072\u0063\u0065\u0020\u0042\u0069\u0074\u006da\u0070\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069n\u0065\u0064\u002e");};switch components {case ComponentConn ,ComponentCharacters ,ComponentWords :default:return nil ,nil ,_b .Error (_aadg ,"\u0069\u006e\u0076\u0061l\u0069\u0064\u0020\u0063\u006f\u006d\u0070\u006f\u006e\u0065n\u0074s\u0020\u0070\u0061\u0072\u0061\u006d\u0065t\u0065\u0072");
};if _gaab .Zero (){_feaf =&Boxes {};_fgbb =&Bitmaps {};return _fgbb ,_feaf ,nil ;};switch components {case ComponentConn :_fgbb =&Bitmaps {};if _feaf ,_feec =_gaab .ConnComponents (_fgbb ,8);_feec !=nil {return nil ,nil ,_b .Wrap (_feec ,_aadg ,"\u006e\u006f \u0070\u0072\u0065p\u0072\u006f\u0063\u0065\u0073\u0073\u0069\u006e\u0067");
};case ComponentCharacters :_faga ,_ffagb :=MorphSequence (_gaab ,MorphProcess {Operation :MopClosing ,Arguments :[]int {1,6}});if _ffagb !=nil {return nil ,nil ,_b .Wrap (_ffagb ,_aadg ,"\u0063h\u0061\u0072\u0061\u0063\u0074\u0065\u0072\u0073\u0020\u0070\u0072e\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u0069\u006e\u0067");
};if _ca .Log .IsLogLevel (_ca .LogLevelTrace ){_ca .Log .Trace ("\u0043o\u006d\u0070o\u006e\u0065\u006e\u0074C\u0068\u0061\u0072a\u0063\u0074\u0065\u0072\u0073\u0020\u0062\u0069\u0074ma\u0070\u0020\u0061f\u0074\u0065r\u0020\u0063\u006c\u006f\u0073\u0069n\u0067\u003a \u0025\u0073",_faga .String ());
};_fcdb :=&Bitmaps {};_feaf ,_ffagb =_faga .ConnComponents (_fcdb ,8);if _ffagb !=nil {return nil ,nil ,_b .Wrap (_ffagb ,_aadg ,"\u0063h\u0061\u0072\u0061\u0063\u0074\u0065\u0072\u0073\u0020\u0070\u0072e\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u0069\u006e\u0067");
};if _ca .Log .IsLogLevel (_ca .LogLevelTrace ){_ca .Log .Trace ("\u0043\u006f\u006d\u0070\u006f\u006ee\u006e\u0074\u0043\u0068\u0061\u0072\u0061\u0063\u0074\u0065\u0072\u0073\u0020\u0062\u0069\u0074\u006d\u0061\u0070\u0020a\u0066\u0074\u0065\u0072\u0020\u0063\u006f\u006e\u006e\u0065\u0063\u0074\u0069\u0076i\u0074y\u003a\u0020\u0025\u0073",_fcdb .String ());
};if _fgbb ,_ffagb =_fcdb .ClipToBitmap (_gaab );_ffagb !=nil {return nil ,nil ,_b .Wrap (_ffagb ,_aadg ,"\u0063h\u0061\u0072\u0061\u0063\u0074\u0065\u0072\u0073\u0020\u0070\u0072e\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u0069\u006e\u0067");};case ComponentWords :_ded :=1;
var _cdc *Bitmap ;switch {case _gaab .XResolution <=200:_cdc =_gaab ;case _gaab .XResolution <=400:_ded =2;_cdc ,_feec =_cdg (_gaab ,1,0,0,0);if _feec !=nil {return nil ,nil ,_b .Wrap (_feec ,_aadg ,"w\u006f\u0072\u0064\u0020\u0070\u0072e\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u0020\u002d \u0078\u0072\u0065s\u003c=\u0034\u0030\u0030");
};default:_ded =4;_cdc ,_feec =_cdg (_gaab ,1,1,0,0);if _feec !=nil {return nil ,nil ,_b .Wrap (_feec ,_aadg ,"\u0077\u006f\u0072\u0064 \u0070\u0072\u0065\u0070\u0072\u006f\u0063\u0065\u0073\u0073 \u002d \u0078\u0072\u0065\u0073\u0020\u003e\u00204\u0030\u0030");
};};_dgbb ,_ ,_gdfc :=_befc (_cdc );if _gdfc !=nil {return nil ,nil ,_b .Wrap (_gdfc ,_aadg ,"\u0077o\u0072d\u0020\u0070\u0072\u0065\u0070\u0072\u006f\u0063\u0065\u0073\u0073");};_dggag ,_gdfc :=_fgdg (_dgbb ,_ded );if _gdfc !=nil {return nil ,nil ,_b .Wrap (_gdfc ,_aadg ,"\u0077o\u0072d\u0020\u0070\u0072\u0065\u0070\u0072\u006f\u0063\u0065\u0073\u0073");
};_fgad :=&Bitmaps {};if _feaf ,_gdfc =_dggag .ConnComponents (_fgad ,4);_gdfc !=nil {return nil ,nil ,_b .Wrap (_gdfc ,_aadg ,"\u0077\u006f\u0072\u0064\u0020\u0070r\u0065\u0070\u0072\u006f\u0063\u0065\u0073\u0073\u002c\u0020\u0063\u006f\u006en\u0065\u0063\u0074\u0020\u0065\u0078\u0070a\u006e\u0064\u0065\u0064");
};if _fgbb ,_gdfc =_fgad .ClipToBitmap (_gaab );_gdfc !=nil {return nil ,nil ,_b .Wrap (_gdfc ,_aadg ,"\u0077o\u0072d\u0020\u0070\u0072\u0065\u0070\u0072\u006f\u0063\u0065\u0073\u0073");};};_fgbb ,_feec =_fgbb .SelectBySize (maxWidth ,maxHeight ,LocSelectIfBoth ,SizeSelectIfLTE );
if _feec !=nil {return nil ,nil ,_b .Wrap (_feec ,_aadg ,"");};_feaf ,_feec =_feaf .SelectBySize (maxWidth ,maxHeight ,LocSelectIfBoth ,SizeSelectIfLTE );if _feec !=nil {return nil ,nil ,_b .Wrap (_feec ,_aadg ,"");};return _fgbb ,_feaf ,nil ;};type byHeight Bitmaps ;
func (_dccc Points )GetIntX (i int )(int ,error ){if i >=len (_dccc ){return 0,_b .Errorf ("\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047\u0065t\u0049\u006e\u0074\u0058","\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};return int (_dccc [i ].X ),nil ;};func TstESymbol (t *_c .T ,scale ...int )*Bitmap {_defd ,_fcff :=NewWithData (4,5,[]byte {0xF0,0x80,0xE0,0x80,0xF0});_a .NoError (t ,_fcff );return TstGetScaledSymbol (t ,_defd ,scale ...);};func _ceac (_baf ,_gdcc *Bitmap ,_dec ,_fdcb ,_dfgb ,_gdef ,_bcec ,_effa ,_cebg ,_efcce int ,_aacef CombinationOperator )error {var _gedc int ;
_egef :=func (){_gedc ++;_dfgb +=_gdcc .RowStride ;_gdef +=_baf .RowStride ;_bcec +=_baf .RowStride };for _gedc =_dec ;_gedc < _fdcb ;_egef (){var _aeef uint16 ;_eac :=_dfgb ;for _febb :=_gdef ;_febb <=_bcec ;_febb ++{_agga ,_bab :=_gdcc .GetByte (_eac );
if _bab !=nil {return _bab ;};_bbcc ,_bab :=_baf .GetByte (_febb );if _bab !=nil {return _bab ;};_aeef =(_aeef |uint16 (_bbcc ))<<uint (_efcce );_bbcc =byte (_aeef >>8);if _febb ==_bcec {_bbcc =_dgce (uint (_effa ),_bbcc );};if _bab =_gdcc .SetByte (_eac ,_ffgc (_agga ,_bbcc ,_aacef ));
_bab !=nil {return _bab ;};_eac ++;_aeef <<=uint (_cebg );};};return nil ;};func (_ged *Bitmap )setBit (_edd int ){_ged .Data [(_edd >>3)]|=0x80>>uint (_edd &7)};const (_ SizeSelection =iota ;SizeSelectByWidth ;SizeSelectByHeight ;SizeSelectByMaxDimension ;
SizeSelectByArea ;SizeSelectByPerimeter ;);func (_dag *Boxes )makeSizeIndicator (_ebgfe ,_bbgg int ,_beed LocationFilter ,_ebddf SizeComparison )*_ab .NumSlice {_eegd :=&_ab .NumSlice {};var _agf ,_bfge ,_ggc int ;for _ ,_beea :=range *_dag {_agf =0;_bfge ,_ggc =_beea .Dx (),_beea .Dy ();
switch _beed {case LocSelectWidth :if (_ebddf ==SizeSelectIfLT &&_bfge < _ebgfe )||(_ebddf ==SizeSelectIfGT &&_bfge > _ebgfe )||(_ebddf ==SizeSelectIfLTE &&_bfge <=_ebgfe )||(_ebddf ==SizeSelectIfGTE &&_bfge >=_ebgfe ){_agf =1;};case LocSelectHeight :if (_ebddf ==SizeSelectIfLT &&_ggc < _bbgg )||(_ebddf ==SizeSelectIfGT &&_ggc > _bbgg )||(_ebddf ==SizeSelectIfLTE &&_ggc <=_bbgg )||(_ebddf ==SizeSelectIfGTE &&_ggc >=_bbgg ){_agf =1;
};case LocSelectIfEither :if (_ebddf ==SizeSelectIfLT &&(_ggc < _bbgg ||_bfge < _ebgfe ))||(_ebddf ==SizeSelectIfGT &&(_ggc > _bbgg ||_bfge > _ebgfe ))||(_ebddf ==SizeSelectIfLTE &&(_ggc <=_bbgg ||_bfge <=_ebgfe ))||(_ebddf ==SizeSelectIfGTE &&(_ggc >=_bbgg ||_bfge >=_ebgfe )){_agf =1;
};case LocSelectIfBoth :if (_ebddf ==SizeSelectIfLT &&(_ggc < _bbgg &&_bfge < _ebgfe ))||(_ebddf ==SizeSelectIfGT &&(_ggc > _bbgg &&_bfge > _ebgfe ))||(_ebddf ==SizeSelectIfLTE &&(_ggc <=_bbgg &&_bfge <=_ebgfe ))||(_ebddf ==SizeSelectIfGTE &&(_ggc >=_bbgg &&_bfge >=_ebgfe )){_agf =1;
};};_eegd .AddInt (_agf );};return _eegd ;};func _ebc ()(_cee []byte ){_cee =make ([]byte ,256);for _gbb :=0;_gbb < 256;_gbb ++{_ccb :=byte (_gbb );_cee [_ccb ]=(_ccb &0x01)|((_ccb &0x04)>>1)|((_ccb &0x10)>>2)|((_ccb &0x40)>>3)|((_ccb &0x02)<<3)|((_ccb &0x08)<<2)|((_ccb &0x20)<<1)|(_ccb &0x80);
};return _cee ;};func MorphSequence (src *Bitmap ,sequence ...MorphProcess )(*Bitmap ,error ){return _aafb (src ,sequence ...);};func (_aegg *ClassedPoints )xSortFunction ()func (_beae int ,_dagbe int )bool {return func (_bded ,_gaae int )bool {return _aegg .XAtIndex (_bded )< _aegg .XAtIndex (_gaae )};
};func TstGetScaledSymbol (t *_c .T ,sm *Bitmap ,scale ...int )*Bitmap {if len (scale )==0{return sm ;};if scale [0]==1{return sm ;};_cadd ,_eabeb :=MorphSequence (sm ,MorphProcess {Operation :MopReplicativeBinaryExpansion ,Arguments :scale });_a .NoError (t ,_eabeb );
return _cadd ;};func TstDSymbol (t *_c .T ,scale ...int )*Bitmap {_dcca ,_ebddfg :=NewWithData (4,5,[]byte {0xf0,0x90,0x90,0x90,0xE0});_a .NoError (t ,_ebddfg );return TstGetScaledSymbol (t ,_dcca ,scale ...);};func TstFrameBitmapData ()[]byte {return _bdfc .Data };
func (_efffd *ClassedPoints )validateIntSlice ()error {const _afdc ="\u0076\u0061l\u0069\u0064\u0061t\u0065\u0049\u006e\u0074\u0053\u006c\u0069\u0063\u0065";for _ ,_fcfg :=range _efffd .IntSlice {if _fcfg >=(_efffd .Points .Size ()){return _b .Errorf (_afdc ,"c\u006c\u0061\u0073\u0073\u0020\u0069\u0064\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u0069\u0073\u0020\u006e\u006f\u0074\u0020\u0061\u0020\u0076\u0061\u006ci\u0064 \u0069\u006e\u0064\u0065x\u0020\u0069n\u0020\u0074\u0068\u0065\u0020\u0070\u006f\u0069\u006e\u0074\u0073\u0020\u006f\u0066\u0020\u0073\u0069\u007a\u0065\u003a\u0020\u0025\u0064",_fcfg ,_efffd .Points .Size ());
};};return nil ;};func (_afdg *BitmapsArray )AddBox (box *_dc .Rectangle ){_afdg .Boxes =append (_afdg .Boxes ,box )};func TstNSymbol (t *_c .T ,scale ...int )*Bitmap {_faedb ,_afagg :=NewWithData (4,5,[]byte {0x90,0xD0,0xB0,0x90,0x90});_a .NoError (t ,_afagg );
return TstGetScaledSymbol (t ,_faedb ,scale ...);};func (_cfeg *Bitmap )nextOnPixelLow (_adg ,_bffg ,_fce ,_ebdd ,_acfa int )(_fff _dc .Point ,_febg bool ,_daee error ){const _ffad ="B\u0069\u0074\u006d\u0061p.\u006ee\u0078\u0074\u004f\u006e\u0050i\u0078\u0065\u006c\u004c\u006f\u0077";
var (_gcdf int ;_acbd byte ;);_bbgd :=_acfa *_fce ;_bgf :=_bbgd +(_ebdd /8);if _acbd ,_daee =_cfeg .GetByte (_bgf );_daee !=nil {return _fff ,false ,_b .Wrap (_daee ,_ffad ,"\u0078\u0053\u0074\u0061\u0072\u0074\u0020\u0061\u006e\u0064 \u0079\u0053\u0074\u0061\u0072\u0074\u0020o\u0075\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065");
};if _acbd !=0{_fbbab :=_ebdd -(_ebdd %8)+7;for _gcdf =_ebdd ;_gcdf <=_fbbab &&_gcdf < _adg ;_gcdf ++{if _cfeg .GetPixel (_gcdf ,_acfa ){_fff .X =_gcdf ;_fff .Y =_acfa ;return _fff ,true ,nil ;};};};_eaag :=(_ebdd /8)+1;_gcdf =8*_eaag ;var _gfde int ;for _bgf =_bbgd +_eaag ;
_gcdf < _adg ;_bgf ,_gcdf =_bgf +1,_gcdf +8{if _acbd ,_daee =_cfeg .GetByte (_bgf );_daee !=nil {return _fff ,false ,_b .Wrap (_daee ,_ffad ,"r\u0065\u0073\u0074\u0020of\u0020t\u0068\u0065\u0020\u006c\u0069n\u0065\u0020\u0062\u0079\u0074\u0065");};if _acbd ==0{continue ;
};for _gfde =0;_gfde < 8&&_gcdf < _adg ;_gfde ,_gcdf =_gfde +1,_gcdf +1{if _cfeg .GetPixel (_gcdf ,_acfa ){_fff .X =_gcdf ;_fff .Y =_acfa ;return _fff ,true ,nil ;};};};for _ecbe :=_acfa +1;_ecbe < _bffg ;_ecbe ++{_bbgd =_ecbe *_fce ;for _bgf ,_gcdf =_bbgd ,0;
_gcdf < _adg ;_bgf ,_gcdf =_bgf +1,_gcdf +8{if _acbd ,_daee =_cfeg .GetByte (_bgf );_daee !=nil {return _fff ,false ,_b .Wrap (_daee ,_ffad ,"\u0066o\u006cl\u006f\u0077\u0069\u006e\u0067\u0020\u006c\u0069\u006e\u0065\u0073");};if _acbd ==0{continue ;};
for _gfde =0;_gfde < 8&&_gcdf < _adg ;_gfde ,_gcdf =_gfde +1,_gcdf +1{if _cfeg .GetPixel (_gcdf ,_ecbe ){_fff .X =_gcdf ;_fff .Y =_ecbe ;return _fff ,true ,nil ;};};};};return _fff ,false ,nil ;};func (_fcca *BitmapsArray )GetBitmaps (i int )(*Bitmaps ,error ){const _caef ="\u0042\u0069\u0074ma\u0070\u0073\u0041\u0072\u0072\u0061\u0079\u002e\u0047\u0065\u0074\u0042\u0069\u0074\u006d\u0061\u0070\u0073";
if _fcca ==nil {return nil ,_b .Error (_caef ,"p\u0072\u006f\u0076\u0069\u0064\u0065d\u0020\u006e\u0069\u006c\u0020\u0027\u0042\u0069\u0074m\u0061\u0070\u0073A\u0072r\u0061\u0079\u0027");};if i > len (_fcca .Values )-1{return nil ,_b .Errorf (_caef ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};return _fcca .Values [i ],nil ;};func Blit (src *Bitmap ,dst *Bitmap ,x ,y int ,op CombinationOperator )error {var _deg ,_daa int ;_aadd :=src .RowStride -1;if x < 0{_daa =-x ;x =0;}else if x +src .Width > dst .Width {_aadd -=src .Width +x -dst .Width ;
};if y < 0{_deg =-y ;y =0;_daa +=src .RowStride ;_aadd +=src .RowStride ;}else if y +src .Height > dst .Height {_deg =src .Height +y -dst .Height ;};var (_afgc int ;_abedf error ;);_acg :=x &0x07;_fegg :=8-_acg ;_gbe :=src .Width &0x07;_aaac :=_fegg -_gbe ;
_ebda :=_fegg &0x07!=0;_cebff :=src .Width <=((_aadd -_daa )<<3)+_fegg ;_bccd :=dst .GetByteIndex (x ,y );_fdda :=_deg +dst .Height ;if src .Height > _fdda {_afgc =_fdda ;}else {_afgc =src .Height ;};switch {case !_ebda :_abedf =_gffc (src ,dst ,_deg ,_afgc ,_bccd ,_daa ,_aadd ,op );
case _cebff :_abedf =_ceac (src ,dst ,_deg ,_afgc ,_bccd ,_daa ,_aadd ,_aaac ,_acg ,_fegg ,op );default:_abedf =_agdc (src ,dst ,_deg ,_afgc ,_bccd ,_daa ,_aadd ,_aaac ,_acg ,_fegg ,op ,_gbe );};return _abedf ;};func (_bcgb *Bitmap )AddBorder (borderSize ,val int )(*Bitmap ,error ){if borderSize ==0{return _bcgb .Copy (),nil ;
};_fdcf ,_daea :=_bcgb .addBorderGeneral (borderSize ,borderSize ,borderSize ,borderSize ,val );if _daea !=nil {return nil ,_b .Wrap (_daea ,"\u0041d\u0064\u0042\u006f\u0072\u0064\u0065r","");};return _fdcf ,nil ;};func TstWSymbol (t *_c .T ,scale ...int )*Bitmap {_aebc ,_cbbc :=NewWithData (5,5,[]byte {0x88,0x88,0xA8,0xD8,0x88});
_a .NoError (t ,_cbbc );return TstGetScaledSymbol (t ,_aebc ,scale ...);};func (_abgg *Bitmaps )GetBitmap (i int )(*Bitmap ,error ){const _ffcc ="\u0047e\u0074\u0042\u0069\u0074\u006d\u0061p";if _abgg ==nil {return nil ,_b .Error (_ffcc ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0042\u0069\u0074ma\u0070\u0073");
};if i > len (_abgg .Values )-1{return nil ,_b .Errorf (_ffcc ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );};return _abgg .Values [i ],nil ;};func _gcdeb (_gadff *Bitmap ,_cgee ,_fcbf ,_ggge ,_gcga int ,_bdda RasterOperator ,_efcga *Bitmap ,_gbed ,_fdcd int )error {var (_adcb bool ;
_cebe bool ;_febbf int ;_dcdd int ;_ecdc int ;_gfef bool ;_cfdb byte ;_gbegc int ;_gega int ;_ceega int ;_cace ,_cfef int ;);_bdbb :=8-(_cgee &7);_dfcd :=_gbdf [_bdbb ];_ecba :=_gadff .RowStride *_fcbf +(_cgee >>3);_dggf :=_efcga .RowStride *_fdcd +(_gbed >>3);
if _ggge < _bdbb {_adcb =true ;_dfcd &=_bgabd [8-_bdbb +_ggge ];};if !_adcb {_febbf =(_ggge -_bdbb )>>3;if _febbf > 0{_cebe =true ;_dcdd =_ecba +1;_ecdc =_dggf +1;};};_gbegc =(_cgee +_ggge )&7;if !_adcb &&_gbegc !=0{_gfef =true ;_cfdb =_bgabd [_gbegc ];
_gega =_ecba +1+_febbf ;_ceega =_dggf +1+_febbf ;};switch _bdda {case PixSrc :for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_ecba ]=_eeaef (_gadff .Data [_ecba ],_efcga .Data [_dggf ],_dfcd );_ecba +=_gadff .RowStride ;_dggf +=_efcga .RowStride ;};
if _cebe {for _cace =0;_cace < _gcga ;_cace ++{for _cfef =0;_cfef < _febbf ;_cfef ++{_gadff .Data [_dcdd +_cfef ]=_efcga .Data [_ecdc +_cfef ];};_dcdd +=_gadff .RowStride ;_ecdc +=_efcga .RowStride ;};};if _gfef {for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_gega ]=_eeaef (_gadff .Data [_gega ],_efcga .Data [_ceega ],_cfdb );
_gega +=_gadff .RowStride ;_ceega +=_efcga .RowStride ;};};case PixNotSrc :for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_ecba ]=_eeaef (_gadff .Data [_ecba ],^_efcga .Data [_dggf ],_dfcd );_ecba +=_gadff .RowStride ;_dggf +=_efcga .RowStride ;};if _cebe {for _cace =0;
_cace < _gcga ;_cace ++{for _cfef =0;_cfef < _febbf ;_cfef ++{_gadff .Data [_dcdd +_cfef ]=^_efcga .Data [_ecdc +_cfef ];};_dcdd +=_gadff .RowStride ;_ecdc +=_efcga .RowStride ;};};if _gfef {for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_gega ]=_eeaef (_gadff .Data [_gega ],^_efcga .Data [_ceega ],_cfdb );
_gega +=_gadff .RowStride ;_ceega +=_efcga .RowStride ;};};case PixSrcOrDst :for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_ecba ]=_eeaef (_gadff .Data [_ecba ],_efcga .Data [_dggf ]|_gadff .Data [_ecba ],_dfcd );_ecba +=_gadff .RowStride ;_dggf +=_efcga .RowStride ;
};if _cebe {for _cace =0;_cace < _gcga ;_cace ++{for _cfef =0;_cfef < _febbf ;_cfef ++{_gadff .Data [_dcdd +_cfef ]|=_efcga .Data [_ecdc +_cfef ];};_dcdd +=_gadff .RowStride ;_ecdc +=_efcga .RowStride ;};};if _gfef {for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_gega ]=_eeaef (_gadff .Data [_gega ],_efcga .Data [_ceega ]|_gadff .Data [_gega ],_cfdb );
_gega +=_gadff .RowStride ;_ceega +=_efcga .RowStride ;};};case PixSrcAndDst :for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_ecba ]=_eeaef (_gadff .Data [_ecba ],_efcga .Data [_dggf ]&_gadff .Data [_ecba ],_dfcd );_ecba +=_gadff .RowStride ;_dggf +=_efcga .RowStride ;
};if _cebe {for _cace =0;_cace < _gcga ;_cace ++{for _cfef =0;_cfef < _febbf ;_cfef ++{_gadff .Data [_dcdd +_cfef ]&=_efcga .Data [_ecdc +_cfef ];};_dcdd +=_gadff .RowStride ;_ecdc +=_efcga .RowStride ;};};if _gfef {for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_gega ]=_eeaef (_gadff .Data [_gega ],_efcga .Data [_ceega ]&_gadff .Data [_gega ],_cfdb );
_gega +=_gadff .RowStride ;_ceega +=_efcga .RowStride ;};};case PixSrcXorDst :for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_ecba ]=_eeaef (_gadff .Data [_ecba ],_efcga .Data [_dggf ]^_gadff .Data [_ecba ],_dfcd );_ecba +=_gadff .RowStride ;_dggf +=_efcga .RowStride ;
};if _cebe {for _cace =0;_cace < _gcga ;_cace ++{for _cfef =0;_cfef < _febbf ;_cfef ++{_gadff .Data [_dcdd +_cfef ]^=_efcga .Data [_ecdc +_cfef ];};_dcdd +=_gadff .RowStride ;_ecdc +=_efcga .RowStride ;};};if _gfef {for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_gega ]=_eeaef (_gadff .Data [_gega ],_efcga .Data [_ceega ]^_gadff .Data [_gega ],_cfdb );
_gega +=_gadff .RowStride ;_ceega +=_efcga .RowStride ;};};case PixNotSrcOrDst :for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_ecba ]=_eeaef (_gadff .Data [_ecba ],^(_efcga .Data [_dggf ])|_gadff .Data [_ecba ],_dfcd );_ecba +=_gadff .RowStride ;_dggf +=_efcga .RowStride ;
};if _cebe {for _cace =0;_cace < _gcga ;_cace ++{for _cfef =0;_cfef < _febbf ;_cfef ++{_gadff .Data [_dcdd +_cfef ]|=^(_efcga .Data [_ecdc +_cfef ]);};_dcdd +=_gadff .RowStride ;_ecdc +=_efcga .RowStride ;};};if _gfef {for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_gega ]=_eeaef (_gadff .Data [_gega ],^(_efcga .Data [_ceega ])|_gadff .Data [_gega ],_cfdb );
_gega +=_gadff .RowStride ;_ceega +=_efcga .RowStride ;};};case PixNotSrcAndDst :for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_ecba ]=_eeaef (_gadff .Data [_ecba ],^(_efcga .Data [_dggf ])&_gadff .Data [_ecba ],_dfcd );_ecba +=_gadff .RowStride ;
_dggf +=_efcga .RowStride ;};if _cebe {for _cace =0;_cace < _gcga ;_cace ++{for _cfef =0;_cfef < _febbf ;_cfef ++{_gadff .Data [_dcdd +_cfef ]&=^_efcga .Data [_ecdc +_cfef ];};_dcdd +=_gadff .RowStride ;_ecdc +=_efcga .RowStride ;};};if _gfef {for _cace =0;
_cace < _gcga ;_cace ++{_gadff .Data [_gega ]=_eeaef (_gadff .Data [_gega ],^(_efcga .Data [_ceega ])&_gadff .Data [_gega ],_cfdb );_gega +=_gadff .RowStride ;_ceega +=_efcga .RowStride ;};};case PixSrcOrNotDst :for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_ecba ]=_eeaef (_gadff .Data [_ecba ],_efcga .Data [_dggf ]|^(_gadff .Data [_ecba ]),_dfcd );
_ecba +=_gadff .RowStride ;_dggf +=_efcga .RowStride ;};if _cebe {for _cace =0;_cace < _gcga ;_cace ++{for _cfef =0;_cfef < _febbf ;_cfef ++{_gadff .Data [_dcdd +_cfef ]=_efcga .Data [_ecdc +_cfef ]|^(_gadff .Data [_dcdd +_cfef ]);};_dcdd +=_gadff .RowStride ;
_ecdc +=_efcga .RowStride ;};};if _gfef {for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_gega ]=_eeaef (_gadff .Data [_gega ],_efcga .Data [_ceega ]|^(_gadff .Data [_gega ]),_cfdb );_gega +=_gadff .RowStride ;_ceega +=_efcga .RowStride ;};};case PixSrcAndNotDst :for _cace =0;
_cace < _gcga ;_cace ++{_gadff .Data [_ecba ]=_eeaef (_gadff .Data [_ecba ],_efcga .Data [_dggf ]&^(_gadff .Data [_ecba ]),_dfcd );_ecba +=_gadff .RowStride ;_dggf +=_efcga .RowStride ;};if _cebe {for _cace =0;_cace < _gcga ;_cace ++{for _cfef =0;_cfef < _febbf ;
_cfef ++{_gadff .Data [_dcdd +_cfef ]=_efcga .Data [_ecdc +_cfef ]&^(_gadff .Data [_dcdd +_cfef ]);};_dcdd +=_gadff .RowStride ;_ecdc +=_efcga .RowStride ;};};if _gfef {for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_gega ]=_eeaef (_gadff .Data [_gega ],_efcga .Data [_ceega ]&^(_gadff .Data [_gega ]),_cfdb );
_gega +=_gadff .RowStride ;_ceega +=_efcga .RowStride ;};};case PixNotPixSrcOrDst :for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_ecba ]=_eeaef (_gadff .Data [_ecba ],^(_efcga .Data [_dggf ]|_gadff .Data [_ecba ]),_dfcd );_ecba +=_gadff .RowStride ;
_dggf +=_efcga .RowStride ;};if _cebe {for _cace =0;_cace < _gcga ;_cace ++{for _cfef =0;_cfef < _febbf ;_cfef ++{_gadff .Data [_dcdd +_cfef ]=^(_efcga .Data [_ecdc +_cfef ]|_gadff .Data [_dcdd +_cfef ]);};_dcdd +=_gadff .RowStride ;_ecdc +=_efcga .RowStride ;
};};if _gfef {for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_gega ]=_eeaef (_gadff .Data [_gega ],^(_efcga .Data [_ceega ]|_gadff .Data [_gega ]),_cfdb );_gega +=_gadff .RowStride ;_ceega +=_efcga .RowStride ;};};case PixNotPixSrcAndDst :for _cace =0;
_cace < _gcga ;_cace ++{_gadff .Data [_ecba ]=_eeaef (_gadff .Data [_ecba ],^(_efcga .Data [_dggf ]&_gadff .Data [_ecba ]),_dfcd );_ecba +=_gadff .RowStride ;_dggf +=_efcga .RowStride ;};if _cebe {for _cace =0;_cace < _gcga ;_cace ++{for _cfef =0;_cfef < _febbf ;
_cfef ++{_gadff .Data [_dcdd +_cfef ]=^(_efcga .Data [_ecdc +_cfef ]&_gadff .Data [_dcdd +_cfef ]);};_dcdd +=_gadff .RowStride ;_ecdc +=_efcga .RowStride ;};};if _gfef {for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_gega ]=_eeaef (_gadff .Data [_gega ],^(_efcga .Data [_ceega ]&_gadff .Data [_gega ]),_cfdb );
_gega +=_gadff .RowStride ;_ceega +=_efcga .RowStride ;};};case PixNotPixSrcXorDst :for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_ecba ]=_eeaef (_gadff .Data [_ecba ],^(_efcga .Data [_dggf ]^_gadff .Data [_ecba ]),_dfcd );_ecba +=_gadff .RowStride ;
_dggf +=_efcga .RowStride ;};if _cebe {for _cace =0;_cace < _gcga ;_cace ++{for _cfef =0;_cfef < _febbf ;_cfef ++{_gadff .Data [_dcdd +_cfef ]=^(_efcga .Data [_ecdc +_cfef ]^_gadff .Data [_dcdd +_cfef ]);};_dcdd +=_gadff .RowStride ;_ecdc +=_efcga .RowStride ;
};};if _gfef {for _cace =0;_cace < _gcga ;_cace ++{_gadff .Data [_gega ]=_eeaef (_gadff .Data [_gega ],^(_efcga .Data [_ceega ]^_gadff .Data [_gega ]),_cfdb );_gega +=_gadff .RowStride ;_ceega +=_efcga .RowStride ;};};default:_ca .Log .Debug ("I\u006e\u0076\u0061\u006c\u0069\u0064 \u0072\u0061\u0073\u0074\u0065\u0072\u0020\u006f\u0070e\u0072\u0061\u0074o\u0072:\u0020\u0025\u0064",_bdda );
return _b .Error ("\u0072\u0061\u0073\u0074er\u004f\u0070\u0056\u0041\u006c\u0069\u0067\u006e\u0065\u0064\u004c\u006f\u0077","\u0069\u006e\u0076al\u0069\u0064\u0020\u0072\u0061\u0073\u0074\u0065\u0072\u0020\u006f\u0070\u0065\u0072\u0061\u0074\u006f\u0072");
};return nil ;};func (_cad *Bitmap )GetPixel (x ,y int )bool {_ebg :=_cad .GetByteIndex (x ,y );_cfc :=_cad .GetBitOffset (x );_edbf :=uint (7-_cfc );if _ebg > len (_cad .Data )-1{_ca .Log .Debug ("\u0054\u0072\u0079\u0069\u006e\u0067\u0020\u0074\u006f\u0020\u0067\u0065\u0074\u0020\u0070\u0069\u0078\u0065\u006c\u0020o\u0075\u0074\u0020\u006f\u0066\u0020\u0074\u0068\u0065\u0020\u0064\u0061\u0074\u0061\u0020\u0072\u0061\u006e\u0067\u0065\u002e \u0078\u003a\u0020\u0027\u0025\u0064\u0027\u002c\u0020\u0079\u003a\u0027\u0025\u0064'\u002c\u0020\u0062m\u003a\u0020\u0027\u0025\u0073\u0027",x ,y ,_cad );
return false ;};if (_cad .Data [_ebg ]>>_edbf )&0x01>=1{return true ;};return false ;};func Centroid (bm *Bitmap ,centTab ,sumTab []int )(Point ,error ){return bm .centroid (centTab ,sumTab )};func (_efc *Bitmap )Zero ()bool {_ade :=_efc .Width /8;_gdbd :=_efc .Width &7;
var _cgab byte ;if _gdbd !=0{_cgab =byte (0xff<<uint (8-_gdbd ));};var _efea ,_efcc ,_bdg int ;for _efcc =0;_efcc < _efc .Height ;_efcc ++{_efea =_efc .RowStride *_efcc ;for _bdg =0;_bdg < _ade ;_bdg ,_efea =_bdg +1,_efea +1{if _efc .Data [_efea ]!=0{return false ;
};};if _gdbd > 0{if _efc .Data [_efea ]&_cgab !=0{return false ;};};};return true ;};func (_egca *Bitmap )CountPixels ()int {return _egca .countPixels ()};func (_ccba *Bitmap )SetPixel (x ,y int ,pixel byte )error {_abb :=_ccba .GetByteIndex (x ,y );if _abb > len (_ccba .Data )-1{return _b .Errorf ("\u0053\u0065\u0074\u0050\u0069\u0078\u0065\u006c","\u0069\u006e\u0064\u0065x \u006f\u0075\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065\u003a\u0020%\u0064",_abb );
};_eaa :=_ccba .GetBitOffset (x );_fea :=uint (7-_eaa );_fgae :=_ccba .Data [_abb ];var _ecf byte ;if pixel ==1{_ecf =_fgae |(pixel &0x01<<_fea );}else {_ecf =_fgae &^(1<<_fea );};_ccba .Data [_abb ]=_ecf ;return nil ;};func (_ffbge *ClassedPoints )ySortFunction ()func (_bcab int ,_fgbc int )bool {return func (_gadf ,_dedc int )bool {return _ffbge .YAtIndex (_gadf )< _ffbge .YAtIndex (_dedc )};
};func (_fdge *Bitmap )ThresholdPixelSum (thresh int ,tab8 []int )(_abdce bool ,_gfd error ){const _bbcb ="\u0042i\u0074\u006d\u0061\u0070\u002e\u0054\u0068\u0072\u0065\u0073\u0068o\u006c\u0064\u0050\u0069\u0078\u0065\u006c\u0053\u0075\u006d";if tab8 ==nil {tab8 =_acaf ();
};_cgc :=_fdge .Width >>3;_dbe :=_fdge .Width &7;_ddg :=byte (0xff<<uint (8-_dbe ));var (_ecgb ,_efae ,_edbc ,_feg int ;_dfd byte ;);for _ecgb =0;_ecgb < _fdge .Height ;_ecgb ++{_edbc =_fdge .RowStride *_ecgb ;for _efae =0;_efae < _cgc ;_efae ++{_dfd ,_gfd =_fdge .GetByte (_edbc +_efae );
if _gfd !=nil {return false ,_b .Wrap (_gfd ,_bbcb ,"\u0066\u0075\u006c\u006c\u0042\u0079\u0074\u0065");};_feg +=tab8 [_dfd ];};if _dbe !=0{_dfd ,_gfd =_fdge .GetByte (_edbc +_efae );if _gfd !=nil {return false ,_b .Wrap (_gfd ,_bbcb ,"p\u0061\u0072\u0074\u0069\u0061\u006c\u0042\u0079\u0074\u0065");
};_dfd &=_ddg ;_feg +=tab8 [_dfd ];};if _feg > thresh {return true ,nil ;};};return _abdce ,nil ;};func (_bfbf *Bitmap )GetUnpaddedData ()([]byte ,error ){_bbc :=uint (_bfbf .Width &0x07);if _bbc ==0{return _bfbf .Data ,nil ;};_abdc :=_bfbf .Width *_bfbf .Height ;
if _abdc %8!=0{_abdc >>=3;_abdc ++;}else {_abdc >>=3;};_fbeg :=make ([]byte ,_abdc );_fdg :=_fd .NewWriterMSB (_fbeg );const _gbga ="\u0047e\u0074U\u006e\u0070\u0061\u0064\u0064\u0065\u0064\u0044\u0061\u0074\u0061";for _ecgd :=0;_ecgd < _bfbf .Height ;
_ecgd ++{for _bea :=0;_bea < _bfbf .RowStride ;_bea ++{_ggd :=_bfbf .Data [_ecgd *_bfbf .RowStride +_bea ];if _bea !=_bfbf .RowStride -1{_adag :=_fdg .WriteByte (_ggd );if _adag !=nil {return nil ,_b .Wrap (_adag ,_gbga ,"");};continue ;};for _dbfe :=uint (0);
_dbfe < _bbc ;_dbfe ++{_ddda :=_fdg .WriteBit (int (_ggd >>(7-_dbfe )&0x01));if _ddda !=nil {return nil ,_b .Wrap (_ddda ,_gbga ,"");};};};};return _fbeg ,nil ;};type Component int ;func _eae (_ffe ,_gba *Bitmap ,_ int ,_ffb []byte ,_gda int )(_ad error ){const _adc ="\u0072\u0065\u0064uc\u0065\u0052\u0061\u006e\u006b\u0042\u0069\u006e\u0061\u0072\u0079\u0032\u004c\u0065\u0076\u0065\u006c\u0032";
var (_aee ,_gca ,_eff ,_edg ,_edac ,_bce ,_de ,_fga int ;_bac ,_gbf ,_bcc ,_dcef uint32 ;_ccc ,_baca byte ;_afg uint16 ;);_ccfe :=make ([]byte ,4);_gfe :=make ([]byte ,4);for _eff =0;_eff < _ffe .Height -1;_eff ,_edg =_eff +2,_edg +1{_aee =_eff *_ffe .RowStride ;
_gca =_edg *_gba .RowStride ;for _edac ,_bce =0,0;_edac < _gda ;_edac ,_bce =_edac +4,_bce +1{for _de =0;_de < 4;_de ++{_fga =_aee +_edac +_de ;if _fga <=len (_ffe .Data )-1&&_fga < _aee +_ffe .RowStride {_ccfe [_de ]=_ffe .Data [_fga ];}else {_ccfe [_de ]=0x00;
};_fga =_aee +_ffe .RowStride +_edac +_de ;if _fga <=len (_ffe .Data )-1&&_fga < _aee +(2*_ffe .RowStride ){_gfe [_de ]=_ffe .Data [_fga ];}else {_gfe [_de ]=0x00;};};_bac =_fg .BigEndian .Uint32 (_ccfe );_gbf =_fg .BigEndian .Uint32 (_gfe );_bcc =_bac &_gbf ;
_bcc |=_bcc <<1;_dcef =_bac |_gbf ;_dcef &=_dcef <<1;_gbf =_bcc |_dcef ;_gbf &=0xaaaaaaaa;_bac =_gbf |(_gbf <<7);_ccc =byte (_bac >>24);_baca =byte ((_bac >>8)&0xff);_fga =_gca +_bce ;if _fga +1==len (_gba .Data )-1||_fga +1>=_gca +_gba .RowStride {if _ad =_gba .SetByte (_fga ,_ffb [_ccc ]);
_ad !=nil {return _b .Wrapf (_ad ,_adc ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0025d",_fga );};}else {_afg =(uint16 (_ffb [_ccc ])<<8)|uint16 (_ffb [_baca ]);if _ad =_gba .setTwoBytes (_fga ,_afg );_ad !=nil {return _b .Wrapf (_ad ,_adc ,"s\u0065\u0074\u0074\u0069\u006e\u0067 \u0074\u0077\u006f\u0020\u0062\u0079t\u0065\u0073\u0020\u0066\u0061\u0069\u006ce\u0064\u002c\u0020\u0069\u006e\u0064\u0065\u0078\u003a\u0020%\u0064",_fga );
};_bce ++;};};};return nil ;};const (SelDontCare SelectionValue =iota ;SelHit ;SelMiss ;);func SelCreateBrick (h ,w int ,cy ,cx int ,tp SelectionValue )*Selection {_abdb :=_dgba (h ,w ,"");_abdb .setOrigin (cy ,cx );var _ddead ,_eaacc int ;for _ddead =0;
_ddead < h ;_ddead ++{for _eaacc =0;_eaacc < w ;_eaacc ++{_abdb .Data [_ddead ][_eaacc ]=tp ;};};return _abdb ;};func _cfb ()(_dfb [256]uint64 ){for _gff :=0;_gff < 256;_gff ++{if _gff &0x01!=0{_dfb [_gff ]|=0xff;};if _gff &0x02!=0{_dfb [_gff ]|=0xff00;
};if _gff &0x04!=0{_dfb [_gff ]|=0xff0000;};if _gff &0x08!=0{_dfb [_gff ]|=0xff000000;};if _gff &0x10!=0{_dfb [_gff ]|=0xff00000000;};if _gff &0x20!=0{_dfb [_gff ]|=0xff0000000000;};if _gff &0x40!=0{_dfb [_gff ]|=0xff000000000000;};if _gff &0x80!=0{_dfb [_gff ]|=0xff00000000000000;
};};return _dfb ;};func _gb (_e ,_ga *Bitmap )(_bb error ){const _ce ="\u0065\u0078\u0070\u0061nd\u0042\u0069\u006e\u0061\u0072\u0079\u0046\u0061\u0063\u0074\u006f\u0072\u0032";_abe :=_ga .RowStride ;_gd :=_e .RowStride ;var (_fdc byte ;_aa uint16 ;_cc ,_aac ,_gdf ,_ee ,_bbf int ;
);for _gdf =0;_gdf < _ga .Height ;_gdf ++{_cc =_gdf *_abe ;_aac =2*_gdf *_gd ;for _ee =0;_ee < _abe ;_ee ++{_fdc =_ga .Data [_cc +_ee ];_aa =_fbce [_fdc ];_bbf =_aac +_ee *2;if _e .RowStride !=_ga .RowStride *2&&(_ee +1)*2> _e .RowStride {_bb =_e .SetByte (_bbf ,byte (_aa >>8));
}else {_bb =_e .setTwoBytes (_bbf ,_aa );};if _bb !=nil {return _b .Wrap (_bb ,_ce ,"");};};for _ee =0;_ee < _gd ;_ee ++{_bbf =_aac +_gd +_ee ;_fdc =_e .Data [_aac +_ee ];if _bb =_e .SetByte (_bbf ,_fdc );_bb !=nil {return _b .Wrapf (_bb ,_ce ,"c\u006f\u0070\u0079\u0020\u0064\u006fu\u0062\u006c\u0065\u0064\u0020\u006ci\u006e\u0065\u003a\u0020\u0027\u0025\u0064'\u002c\u0020\u0042\u0079\u0074\u0065\u003a\u0020\u0027\u0025d\u0027",_aac +_ee ,_aac +_gd +_ee );
};};};return nil ;};func TstWordBitmapWithSpaces (t *_c .T ,scale ...int )*Bitmap {_befcg :=1;if len (scale )> 0{_befcg =scale [0];};_aaab :=3;_aeeb :=9+7+15+2*_aaab +2*_aaab ;_cfbbb :=5+_aaab +5+2*_aaab ;_egdg :=New (_aeeb *_befcg ,_cfbbb *_befcg );_bbge :=&Bitmaps {};
var _cbaa *int ;_aaab *=_befcg ;_gdfbb :=_aaab ;_cbaa =&_gdfbb ;_edbfc :=_aaab ;_gfbdf :=TstDSymbol (t ,scale ...);TstAddSymbol (t ,_bbge ,_gfbdf ,_cbaa ,_edbfc ,1*_befcg );_gfbdf =TstOSymbol (t ,scale ...);TstAddSymbol (t ,_bbge ,_gfbdf ,_cbaa ,_edbfc ,_aaab );
_gfbdf =TstISymbol (t ,scale ...);TstAddSymbol (t ,_bbge ,_gfbdf ,_cbaa ,_edbfc ,1*_befcg );_gfbdf =TstTSymbol (t ,scale ...);TstAddSymbol (t ,_bbge ,_gfbdf ,_cbaa ,_edbfc ,_aaab );_gfbdf =TstNSymbol (t ,scale ...);TstAddSymbol (t ,_bbge ,_gfbdf ,_cbaa ,_edbfc ,1*_befcg );
_gfbdf =TstOSymbol (t ,scale ...);TstAddSymbol (t ,_bbge ,_gfbdf ,_cbaa ,_edbfc ,1*_befcg );_gfbdf =TstWSymbol (t ,scale ...);TstAddSymbol (t ,_bbge ,_gfbdf ,_cbaa ,_edbfc ,0);*_cbaa =_aaab ;_edbfc =5*_befcg +_aaab ;_gfbdf =TstOSymbol (t ,scale ...);TstAddSymbol (t ,_bbge ,_gfbdf ,_cbaa ,_edbfc ,1*_befcg );
_gfbdf =TstRSymbol (t ,scale ...);TstAddSymbol (t ,_bbge ,_gfbdf ,_cbaa ,_edbfc ,_aaab );_gfbdf =TstNSymbol (t ,scale ...);TstAddSymbol (t ,_bbge ,_gfbdf ,_cbaa ,_edbfc ,1*_befcg );_gfbdf =TstESymbol (t ,scale ...);TstAddSymbol (t ,_bbge ,_gfbdf ,_cbaa ,_edbfc ,1*_befcg );
_gfbdf =TstVSymbol (t ,scale ...);TstAddSymbol (t ,_bbge ,_gfbdf ,_cbaa ,_edbfc ,1*_befcg );_gfbdf =TstESymbol (t ,scale ...);TstAddSymbol (t ,_bbge ,_gfbdf ,_cbaa ,_edbfc ,1*_befcg );_gfbdf =TstRSymbol (t ,scale ...);TstAddSymbol (t ,_bbge ,_gfbdf ,_cbaa ,_edbfc ,0);
TstWriteSymbols (t ,_bbge ,_egdg );return _egdg ;};func (_ddfc *Bitmaps )WidthSorter ()func (_dbge ,_bbgdc int )bool {return func (_efgg ,_bffb int )bool {return _ddfc .Values [_efgg ].Width < _ddfc .Values [_bffb ].Width };};var (_bgabd =[]byte {0x00,0x80,0xC0,0xE0,0xF0,0xF8,0xFC,0xFE,0xFF};
_gbdf =[]byte {0x00,0x01,0x03,0x07,0x0F,0x1F,0x3F,0x7F,0xFF};);func (_bccb MorphProcess )verify (_decb int ,_dccf ,_cddb *int )error {const _eedc ="\u004d\u006f\u0072\u0070hP\u0072\u006f\u0063\u0065\u0073\u0073\u002e\u0076\u0065\u0072\u0069\u0066\u0079";
switch _bccb .Operation {case MopDilation ,MopErosion ,MopOpening ,MopClosing :if len (_bccb .Arguments )!=2{return _b .Error (_eedc ,"\u004f\u0070\u0065\u0072\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0027\u0064\u0027\u002c\u0020\u0027\u0065\u0027\u002c \u0027\u006f\u0027\u002c\u0020\u0027\u0063\u0027\u0020\u0072\u0065\u0071\u0075\u0069\u0072\u0065\u0073\u0020\u0061\u0074\u0020\u006c\u0065\u0061\u0073\u0074\u0020\u0032\u0020\u0061r\u0067\u0075\u006d\u0065\u006et\u0073");
};_gefb ,_cabb :=_bccb .getWidthHeight ();if _gefb <=0||_cabb <=0{return _b .Error (_eedc ,"O\u0070er\u0061t\u0069o\u006e\u003a\u0020\u0027\u0064'\u002c\u0020\u0027e\u0027\u002c\u0020\u0027\u006f'\u002c\u0020\u0027c\u0027\u0020\u0020\u0072\u0065\u0071\u0075\u0069\u0072\u0065\u0073 \u0062\u006f\u0074h w\u0069\u0064\u0074\u0068\u0020\u0061n\u0064\u0020\u0068\u0065\u0069\u0067\u0068\u0074\u0020\u0074\u006f\u0020b\u0065 \u003e\u003d\u0020\u0030");
};case MopRankBinaryReduction :_dbfae :=len (_bccb .Arguments );*_dccf +=_dbfae ;if _dbfae < 1||_dbfae > 4{return _b .Error (_eedc ,"\u004f\u0070\u0065\u0072\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0027\u0072\u0027\u0020\u0072\u0065\u0071\u0075\u0069r\u0065\u0073\u0020\u0061\u0074\u0020\u006c\u0065\u0061s\u0074\u0020\u0031\u0020\u0061\u006e\u0064\u0020\u0061\u0074\u0020\u006d\u006fs\u0074\u0020\u0034\u0020\u0061\u0072g\u0075\u006d\u0065n\u0074\u0073");
};for _efeaa :=0;_efeaa < _dbfae ;_efeaa ++{if _bccb .Arguments [_efeaa ]< 1||_bccb .Arguments [_efeaa ]> 4{return _b .Error (_eedc ,"\u0052\u0061\u006e\u006b\u0042\u0069n\u0061\u0072\u0079\u0052\u0065\u0064\u0075\u0063\u0074\u0069\u006f\u006e\u0020\u006c\u0065\u0076\u0065\u006c\u0020\u006du\u0073\u0074\u0020\u0062\u0065\u0020\u0069\u006e\u0020\u0072\u0061\u006e\u0067\u0065 \u00280\u002c\u0020\u0034\u003e");
};};case MopReplicativeBinaryExpansion :if len (_bccb .Arguments )==0{return _b .Error (_eedc ,"\u0052\u0065\u0070\u006c\u0069\u0063\u0061\u0074i\u0076\u0065\u0042in\u0061\u0072\u0079\u0045\u0078\u0070a\u006e\u0073\u0069\u006f\u006e\u0020\u0072\u0065\u0071\u0075\u0069\u0072\u0065\u0073\u0020o\u006e\u0065\u0020\u0061\u0072\u0067\u0075\u006de\u006e\u0074");
};_adgb :=_bccb .Arguments [0];if _adgb !=2&&_adgb !=4&&_adgb !=8{return _b .Error (_eedc ,"R\u0065\u0070\u006c\u0069\u0063\u0061\u0074\u0069\u0076\u0065\u0042\u0069\u006e\u0061\u0072\u0079\u0045\u0078\u0070\u0061\u006e\u0073\u0069\u006f\u006e\u0020m\u0075s\u0074\u0020\u0062\u0065 \u006f\u0066 \u0066\u0061\u0063\u0074\u006f\u0072\u0020\u0069\u006e\u0020\u0072\u0061\u006e\u0067\u0065\u0020\u007b\u0032\u002c\u0034\u002c\u0038\u007d");
};*_dccf -=_eece [_adgb /4];case MopAddBorder :if len (_bccb .Arguments )==0{return _b .Error (_eedc ,"\u0041\u0064\u0064B\u006f\u0072\u0064\u0065r\u0020\u0072\u0065\u0071\u0075\u0069\u0072e\u0073\u0020\u006f\u006e\u0065\u0020\u0061\u0072\u0067\u0075\u006d\u0065\u006e\u0074");
};_ddgca :=_bccb .Arguments [0];if _decb > 0{return _b .Error (_eedc ,"\u0041\u0064\u0064\u0042\u006f\u0072\u0064\u0065\u0072\u0020\u006d\u0075\u0073t\u0020\u0062\u0065\u0020\u0061\u0020f\u0069\u0072\u0073\u0074\u0020\u006d\u006f\u0072\u0070\u0068\u0020\u0070\u0072o\u0063\u0065\u0073\u0073");
};if _ddgca < 1{return _b .Error (_eedc ,"\u0041\u0064\u0064\u0042o\u0072\u0064\u0065\u0072\u0020\u0076\u0061\u006c\u0075\u0065 \u006co\u0077\u0065\u0072\u0020\u0074\u0068\u0061n\u0020\u0030");};*_cddb =_ddgca ;};return nil ;};var _eddd =[]byte {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x3E,0x78,0x27,0xC2,0x27,0x91,0x00,0x22,0x48,0x21,0x03,0x24,0x91,0x00,0x22,0x48,0x21,0x02,0xA4,0x95,0x00,0x22,0x48,0x21,0x02,0x64,0x9B,0x00,0x3C,0x78,0x21,0x02,0x27,0x91,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x7F,0xF8,0x00,0x00,0x00,0x00,0x00,0x7F,0xF8,0x00,0x00,0x00,0x00,0x00,0x63,0x18,0x00,0x00,0x00,0x00,0x00,0x63,0x18,0x00,0x00,0x00,0x00,0x00,0x63,0x18,0x00,0x00,0x00,0x00,0x00,0x7F,0xF8,0x00,0x00,0x00,0x00,0x00,0x15,0x50,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
func (_aaf *Bitmap )ToImage ()_dc .Image {_dbc ,_dgb :=_f .NewImage (_aaf .Width ,_aaf .Height ,1,1,_aaf .Data ,nil ,nil );if _dgb !=nil {_ca .Log .Error ("\u0043\u006f\u006e\u0076\u0065\u0072\u0074\u0069\u006e\u0067\u0020j\u0062\u0069\u0067\u0032\u002e\u0042\u0069\u0074m\u0061p\u0020\u0074\u006f\u0020\u0069\u006d\u0061\u0067\u0065\u0075\u0074\u0069\u006c\u002e\u0049\u006d\u0061\u0067e\u0020\u0066\u0061\u0069\u006c\u0065\u0064\u003a\u0020\u0025\u0076",_dgb );
};return _dbc ;};func (_geba *Bitmaps )SortByHeight (){_aeff :=(*byHeight )(_geba );_gc .Sort (_aeff )};type SizeSelection int ;func _dg (_cae ,_cg *Bitmap )(_cgd error ){const _fa ="\u0065\u0078\u0070\u0061nd\u0042\u0069\u006e\u0061\u0072\u0079\u0046\u0061\u0063\u0074\u006f\u0072\u0034";
_gdc :=_cg .RowStride ;_aed :=_cae .RowStride ;_abed :=_cg .RowStride *4-_cae .RowStride ;var (_df ,_fe byte ;_ef uint32 ;_gf ,_eb ,_fc ,_cf ,_gae ,_gaf ,_fgd int ;);for _fc =0;_fc < _cg .Height ;_fc ++{_gf =_fc *_gdc ;_eb =4*_fc *_aed ;for _cf =0;_cf < _gdc ;
_cf ++{_df =_cg .Data [_gf +_cf ];_ef =_bgfg [_df ];_gaf =_eb +_cf *4;if _abed !=0&&(_cf +1)*4> _cae .RowStride {for _gae =_abed ;_gae > 0;_gae --{_fe =byte ((_ef >>uint (_gae *8))&0xff);_fgd =_gaf +(_abed -_gae );if _cgd =_cae .SetByte (_fgd ,_fe );_cgd !=nil {return _b .Wrapf (_cgd ,_fa ,"D\u0069\u0066\u0066\u0065\u0072\u0065n\u0074\u0020\u0072\u006f\u0077\u0073\u0074\u0072\u0069d\u0065\u0073\u002e \u004b:\u0020\u0025\u0064",_gae );
};};}else if _cgd =_cae .setFourBytes (_gaf ,_ef );_cgd !=nil {return _b .Wrap (_cgd ,_fa ,"");};if _cgd =_cae .setFourBytes (_eb +_cf *4,_bgfg [_cg .Data [_gf +_cf ]]);_cgd !=nil {return _b .Wrap (_cgd ,_fa ,"");};};for _gae =1;_gae < 4;_gae ++{for _cf =0;
_cf < _aed ;_cf ++{if _cgd =_cae .SetByte (_eb +_gae *_aed +_cf ,_cae .Data [_eb +_cf ]);_cgd !=nil {return _b .Wrapf (_cgd ,_fa ,"\u0063\u006f\u0070\u0079\u0020\u0027\u0071\u0075\u0061\u0064\u0072\u0061\u0062l\u0065\u0027\u0020\u006c\u0069\u006ee\u003a\u0020\u0027\u0025\u0064\u0027\u002c\u0020\u0062\u0079\u0074\u0065\u003a \u0027\u0025\u0064\u0027",_gae ,_cf );
};};};};return nil ;};func _beeg (_bdgc *Bitmap ,_cdbad ,_abcg ,_fcc ,_gaee int ,_eccf RasterOperator ,_aagd *Bitmap ,_ebea ,_bbfb int )error {const _fbge ="\u0072a\u0073t\u0065\u0072\u004f\u0070\u0065\u0072\u0061\u0074\u0069\u006f\u006e";if _bdgc ==nil {return _b .Error (_fbge ,"\u006e\u0069\u006c\u0020\u0027\u0064\u0065\u0073\u0074\u0027\u0020\u0042i\u0074\u006d\u0061\u0070");
};if _eccf ==PixDst {return nil ;};switch _eccf {case PixClr ,PixSet ,PixNotDst :_egaf (_bdgc ,_cdbad ,_abcg ,_fcc ,_gaee ,_eccf );return nil ;};if _aagd ==nil {_ca .Log .Debug ("\u0052a\u0073\u0074e\u0072\u004f\u0070\u0065r\u0061\u0074\u0069o\u006e\u0020\u0073\u006f\u0075\u0072\u0063\u0065\u0020bi\u0074\u006d\u0061p\u0020\u0069s\u0020\u006e\u006f\u0074\u0020\u0064e\u0066\u0069n\u0065\u0064");
return _b .Error (_fbge ,"\u006e\u0069l\u0020\u0027\u0073r\u0063\u0027\u0020\u0062\u0069\u0074\u006d\u0061\u0070");};if _ccag :=_gagf (_bdgc ,_cdbad ,_abcg ,_fcc ,_gaee ,_eccf ,_aagd ,_ebea ,_bbfb );_ccag !=nil {return _b .Wrap (_ccag ,_fbge ,"");};return nil ;
};func (_efacf *Bitmaps )Size ()int {return len (_efacf .Values )};func _ceaa (_bfcb *Bitmap ,_ffeef *_ab .Stack ,_ffab ,_fgdd ,_ggfd int )(_fbdd *_dc .Rectangle ,_febc error ){const _eegf ="\u0073e\u0065d\u0046\u0069\u006c\u006c\u0053\u0074\u0061\u0063\u006b\u0042\u0042";
if _bfcb ==nil {return nil ,_b .Error (_eegf ,"\u0070\u0072\u006fvi\u0064\u0065\u0064\u0020\u006e\u0069\u006c\u0020\u0027\u0073\u0027\u0020\u0042\u0069\u0074\u006d\u0061\u0070");};if _ffeef ==nil {return nil ,_b .Error (_eegf ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0027\u0073\u0074ac\u006b\u0027");
};switch _ggfd {case 4:if _fbdd ,_febc =_eddc (_bfcb ,_ffeef ,_ffab ,_fgdd );_febc !=nil {return nil ,_b .Wrap (_febc ,_eegf ,"");};return _fbdd ,nil ;case 8:if _fbdd ,_febc =_dgbea (_bfcb ,_ffeef ,_ffab ,_fgdd );_febc !=nil {return nil ,_b .Wrap (_febc ,_eegf ,"");
};return _fbdd ,nil ;default:return nil ,_b .Errorf (_eegf ,"\u0063\u006f\u006e\u006e\u0065\u0063\u0074\u0069\u0076\u0069\u0074\u0079\u0020\u0069\u0073 \u006eo\u0074\u0020\u0034\u0020\u006f\u0072\u0020\u0038\u003a\u0020\u0027\u0025\u0064\u0027",_ggfd );
};};type MorphProcess struct{Operation MorphOperation ;Arguments []int ;};func (_aaeb *Bitmap )connComponentsBB (_abfge int )(_gagdg *Boxes ,_gbc error ){const _gdfa ="\u0042\u0069\u0074ma\u0070\u002e\u0063\u006f\u006e\u006e\u0043\u006f\u006d\u0070\u006f\u006e\u0065\u006e\u0074\u0073\u0042\u0042";
if _abfge !=4&&_abfge !=8{return nil ,_b .Error (_gdfa ,"\u0063\u006f\u006e\u006e\u0065\u0063t\u0069\u0076\u0069\u0074\u0079\u0020\u006d\u0075\u0073\u0074\u0020\u0062\u0065 \u0061\u0020\u0027\u0034\u0027\u0020\u006fr\u0020\u0027\u0038\u0027");};if _aaeb .Zero (){return &Boxes {},nil ;
};_aaeb .setPadBits (0);_fdfg ,_gbc :=_dged (nil ,_aaeb );if _gbc !=nil {return nil ,_b .Wrap (_gbc ,_gdfa ,"\u0062\u006d\u0031");};_bgaf :=&_ab .Stack {};_bgaf .Aux =&_ab .Stack {};_gagdg =&Boxes {};var (_aead ,_age int ;_fcbe _dc .Point ;_afcc bool ;
_bdab *_dc .Rectangle ;);for {if _fcbe ,_afcc ,_gbc =_fdfg .nextOnPixel (_age ,_aead );_gbc !=nil {return nil ,_b .Wrap (_gbc ,_gdfa ,"");};if !_afcc {break ;};if _bdab ,_gbc =_ceaa (_fdfg ,_bgaf ,_fcbe .X ,_fcbe .Y ,_abfge );_gbc !=nil {return nil ,_b .Wrap (_gbc ,_gdfa ,"");
};if _gbc =_gagdg .Add (_bdab );_gbc !=nil {return nil ,_b .Wrap (_gbc ,_gdfa ,"");};_age =_fcbe .X ;_aead =_fcbe .Y ;};return _gagdg ,nil ;};func (_adbc *Bitmaps )SelectByIndexes (idx []int )(*Bitmaps ,error ){const _gcca ="B\u0069\u0074\u006d\u0061\u0070\u0073.\u0053\u006f\u0072\u0074\u0049\u006e\u0064\u0065\u0078e\u0073\u0042\u0079H\u0065i\u0067\u0068\u0074";
_bdfe ,_baaeb :=_adbc .selectByIndexes (idx );if _baaeb !=nil {return nil ,_b .Wrap (_baaeb ,_gcca ,"");};return _bdfe ,nil ;};func TstWordBitmap (t *_c .T ,scale ...int )*Bitmap {_bcad :=1;if len (scale )> 0{_bcad =scale [0];};_bfbfb :=3;_babf :=9+7+15+2*_bfbfb ;
_gffb :=5+_bfbfb +5;_cegbg :=New (_babf *_bcad ,_gffb *_bcad );_fbcef :=&Bitmaps {};var _bdeg *int ;_bfbfb *=_bcad ;_gaadf :=0;_bdeg =&_gaadf ;_gdcag :=0;_deecf :=TstDSymbol (t ,scale ...);TstAddSymbol (t ,_fbcef ,_deecf ,_bdeg ,_gdcag ,1*_bcad );_deecf =TstOSymbol (t ,scale ...);
TstAddSymbol (t ,_fbcef ,_deecf ,_bdeg ,_gdcag ,_bfbfb );_deecf =TstISymbol (t ,scale ...);TstAddSymbol (t ,_fbcef ,_deecf ,_bdeg ,_gdcag ,1*_bcad );_deecf =TstTSymbol (t ,scale ...);TstAddSymbol (t ,_fbcef ,_deecf ,_bdeg ,_gdcag ,_bfbfb );_deecf =TstNSymbol (t ,scale ...);
TstAddSymbol (t ,_fbcef ,_deecf ,_bdeg ,_gdcag ,1*_bcad );_deecf =TstOSymbol (t ,scale ...);TstAddSymbol (t ,_fbcef ,_deecf ,_bdeg ,_gdcag ,1*_bcad );_deecf =TstWSymbol (t ,scale ...);TstAddSymbol (t ,_fbcef ,_deecf ,_bdeg ,_gdcag ,0);*_bdeg =0;_gdcag =5*_bcad +_bfbfb ;
_deecf =TstOSymbol (t ,scale ...);TstAddSymbol (t ,_fbcef ,_deecf ,_bdeg ,_gdcag ,1*_bcad );_deecf =TstRSymbol (t ,scale ...);TstAddSymbol (t ,_fbcef ,_deecf ,_bdeg ,_gdcag ,_bfbfb );_deecf =TstNSymbol (t ,scale ...);TstAddSymbol (t ,_fbcef ,_deecf ,_bdeg ,_gdcag ,1*_bcad );
_deecf =TstESymbol (t ,scale ...);TstAddSymbol (t ,_fbcef ,_deecf ,_bdeg ,_gdcag ,1*_bcad );_deecf =TstVSymbol (t ,scale ...);TstAddSymbol (t ,_fbcef ,_deecf ,_bdeg ,_gdcag ,1*_bcad );_deecf =TstESymbol (t ,scale ...);TstAddSymbol (t ,_fbcef ,_deecf ,_bdeg ,_gdcag ,1*_bcad );
_deecf =TstRSymbol (t ,scale ...);TstAddSymbol (t ,_fbcef ,_deecf ,_bdeg ,_gdcag ,0);TstWriteSymbols (t ,_fbcef ,_cegbg );return _cegbg ;};const (MopDilation MorphOperation =iota ;MopErosion ;MopOpening ;MopClosing ;MopRankBinaryReduction ;MopReplicativeBinaryExpansion ;
MopAddBorder ;);type Point struct{X ,Y float32 ;};func (_gbbf *Bitmap )Equivalent (s *Bitmap )bool {return _gbbf .equivalent (s )};func (_bgab MorphProcess )getWidthHeight ()(_dbde ,_eabb int ){return _bgab .Arguments [0],_bgab .Arguments [1];};func TstRSymbol (t *_c .T ,scale ...int )*Bitmap {_cgcb ,_eebg :=NewWithData (4,5,[]byte {0xF0,0x90,0xF0,0xA0,0x90});
_a .NoError (t ,_eebg );return TstGetScaledSymbol (t ,_cgcb ,scale ...);};func HausTest (p1 ,p2 ,p3 ,p4 *Bitmap ,delX ,delY float32 ,maxDiffW ,maxDiffH int )(bool ,error ){const _cegb ="\u0048\u0061\u0075\u0073\u0054\u0065\u0073\u0074";_edgf ,_fagb :=p1 .Width ,p1 .Height ;
_acbb ,_adad :=p3 .Width ,p3 .Height ;if _ab .Abs (_edgf -_acbb )> maxDiffW {return false ,nil ;};if _ab .Abs (_fagb -_adad )> maxDiffH {return false ,nil ;};_fdggf :=int (delX +_ab .Sign (delX )*0.5);_febd :=int (delY +_ab .Sign (delY )*0.5);var _fbafd error ;
_bcef :=p1 .CreateTemplate ();if _fbafd =_bcef .RasterOperation (0,0,_edgf ,_fagb ,PixSrc ,p1 ,0,0);_fbafd !=nil {return false ,_b .Wrap (_fbafd ,_cegb ,"p\u0031\u0020\u002d\u0053\u0052\u0043\u002d\u003e\u0020\u0074");};if _fbafd =_bcef .RasterOperation (_fdggf ,_febd ,_edgf ,_fagb ,PixNotSrcAndDst ,p4 ,0,0);
_fbafd !=nil {return false ,_b .Wrap (_fbafd ,_cegb ,"\u0021p\u0034\u0020\u0026\u0020\u0074");};if _bcef .Zero (){return false ,nil ;};if _fbafd =_bcef .RasterOperation (_fdggf ,_febd ,_acbb ,_adad ,PixSrc ,p3 ,0,0);_fbafd !=nil {return false ,_b .Wrap (_fbafd ,_cegb ,"p\u0033\u0020\u002d\u0053\u0052\u0043\u002d\u003e\u0020\u0074");
};if _fbafd =_bcef .RasterOperation (0,0,_acbb ,_adad ,PixNotSrcAndDst ,p2 ,0,0);_fbafd !=nil {return false ,_b .Wrap (_fbafd ,_cegb ,"\u0021p\u0032\u0020\u0026\u0020\u0074");};return _bcef .Zero (),nil ;};func _dgce (_cacf uint ,_agba byte )byte {return _agba >>_cacf <<_cacf };
func _gagf (_bcd *Bitmap ,_bbfe ,_adfg int ,_bgeed ,_aagef int ,_geef RasterOperator ,_dfgf *Bitmap ,_faefb ,_acfee int )error {var _ffdce ,_efffda ,_fage ,_fefgf int ;if _bbfe < 0{_faefb -=_bbfe ;_bgeed +=_bbfe ;_bbfe =0;};if _faefb < 0{_bbfe -=_faefb ;
_bgeed +=_faefb ;_faefb =0;};_ffdce =_bbfe +_bgeed -_bcd .Width ;if _ffdce > 0{_bgeed -=_ffdce ;};_efffda =_faefb +_bgeed -_dfgf .Width ;if _efffda > 0{_bgeed -=_efffda ;};if _adfg < 0{_acfee -=_adfg ;_aagef +=_adfg ;_adfg =0;};if _acfee < 0{_adfg -=_acfee ;
_aagef +=_acfee ;_acfee =0;};_fage =_adfg +_aagef -_bcd .Height ;if _fage > 0{_aagef -=_fage ;};_fefgf =_acfee +_aagef -_dfgf .Height ;if _fefgf > 0{_aagef -=_fefgf ;};if _bgeed <=0||_aagef <=0{return nil ;};var _dabb error ;switch {case _bbfe &7==0&&_faefb &7==0:_dabb =_edagg (_bcd ,_bbfe ,_adfg ,_bgeed ,_aagef ,_geef ,_dfgf ,_faefb ,_acfee );
case _bbfe &7==_faefb &7:_dabb =_gcdeb (_bcd ,_bbfe ,_adfg ,_bgeed ,_aagef ,_geef ,_dfgf ,_faefb ,_acfee );default:_dabb =_bbfeb (_bcd ,_bbfe ,_adfg ,_bgeed ,_aagef ,_geef ,_dfgf ,_faefb ,_acfee );};if _dabb !=nil {return _b .Wrap (_dabb ,"r\u0061\u0073\u0074\u0065\u0072\u004f\u0070\u004c\u006f\u0077","");
};return nil ;};func _cef (_dfaa ,_fca *Bitmap ,_ege int ,_fabd []byte ,_ebeb int )(_cgdf error ){const _cff ="\u0072\u0065\u0064uc\u0065\u0052\u0061\u006e\u006b\u0042\u0069\u006e\u0061\u0072\u0079\u0032\u004c\u0065\u0076\u0065\u006c\u0034";var (_fgc ,_ggf ,_faag ,_eaeb ,_dabf ,_fcb ,_agg ,_agdg int ;
_egc ,_befd uint32 ;_ccg ,_deab byte ;_ffg uint16 ;);_dac :=make ([]byte ,4);_efff :=make ([]byte ,4);for _faag =0;_faag < _dfaa .Height -1;_faag ,_eaeb =_faag +2,_eaeb +1{_fgc =_faag *_dfaa .RowStride ;_ggf =_eaeb *_fca .RowStride ;for _dabf ,_fcb =0,0;
_dabf < _ebeb ;_dabf ,_fcb =_dabf +4,_fcb +1{for _agg =0;_agg < 4;_agg ++{_agdg =_fgc +_dabf +_agg ;if _agdg <=len (_dfaa .Data )-1&&_agdg < _fgc +_dfaa .RowStride {_dac [_agg ]=_dfaa .Data [_agdg ];}else {_dac [_agg ]=0x00;};_agdg =_fgc +_dfaa .RowStride +_dabf +_agg ;
if _agdg <=len (_dfaa .Data )-1&&_agdg < _fgc +(2*_dfaa .RowStride ){_efff [_agg ]=_dfaa .Data [_agdg ];}else {_efff [_agg ]=0x00;};};_egc =_fg .BigEndian .Uint32 (_dac );_befd =_fg .BigEndian .Uint32 (_efff );_befd &=_egc ;_befd &=_befd <<1;_befd &=0xaaaaaaaa;
_egc =_befd |(_befd <<7);_ccg =byte (_egc >>24);_deab =byte ((_egc >>8)&0xff);_agdg =_ggf +_fcb ;if _agdg +1==len (_fca .Data )-1||_agdg +1>=_ggf +_fca .RowStride {_fca .Data [_agdg ]=_fabd [_ccg ];if _cgdf =_fca .SetByte (_agdg ,_fabd [_ccg ]);_cgdf !=nil {return _b .Wrapf (_cgdf ,_cff ,"\u0069n\u0064\u0065\u0078\u003a\u0020\u0025d",_agdg );
};}else {_ffg =(uint16 (_fabd [_ccg ])<<8)|uint16 (_fabd [_deab ]);if _cgdf =_fca .setTwoBytes (_agdg ,_ffg );_cgdf !=nil {return _b .Wrapf (_cgdf ,_cff ,"s\u0065\u0074\u0074\u0069\u006e\u0067 \u0074\u0077\u006f\u0020\u0062\u0079t\u0065\u0073\u0020\u0066\u0061\u0069\u006ce\u0064\u002c\u0020\u0069\u006e\u0064\u0065\u0078\u003a\u0020%\u0064",_agdg );
};_fcb ++;};};};return nil ;};func (_bde *Bitmap )SetPadBits (value int ){_bde .setPadBits (value )};func (_fafd *Bitmap )GetByteIndex (x ,y int )int {return y *_fafd .RowStride +(x >>3)};type MorphOperation int ;func (_bgca *Selection )findMaxTranslations ()(_cagb ,_edceb ,_bdce ,_bffe int ){for _dbfb :=0;
_dbfb < _bgca .Height ;_dbfb ++{for _agdce :=0;_agdce < _bgca .Width ;_agdce ++{if _bgca .Data [_dbfb ][_agdce ]==SelHit {_cagb =_cebc (_cagb ,_bgca .Cx -_agdce );_edceb =_cebc (_edceb ,_bgca .Cy -_dbfb );_bdce =_cebc (_bdce ,_agdce -_bgca .Cx );_bffe =_cebc (_bffe ,_dbfb -_bgca .Cy );
};};};return _cagb ,_edceb ,_bdce ,_bffe ;};type Boxes []*_dc .Rectangle ;func (_adgd *ClassedPoints )XAtIndex (i int )float32 {return (*_adgd .Points )[_adgd .IntSlice [i ]].X };func NewWithData (width ,height int ,data []byte )(*Bitmap ,error ){const _dcgg ="N\u0065\u0077\u0057\u0069\u0074\u0068\u0044\u0061\u0074\u0061";
_acb :=_gcd (width ,height );_acb .Data =data ;if len (data )< height *_acb .RowStride {return nil ,_b .Errorf (_dcgg ,"\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0064\u0061\u0074\u0061\u0020l\u0065\u006e\u0067\u0074\u0068\u003a \u0025\u0064\u0020\u002d\u0020\u0073\u0068\u006f\u0075\u006c\u0064\u0020\u0062e\u003a\u0020\u0025\u0064",len (data ),height *_acb .RowStride );
};return _acb ,nil ;};func (_acdb *Points )Add (pt *Points )error {const _dgbef ="\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0041\u0064\u0064";if _acdb ==nil {return _b .Error (_dgbef ,"\u0070o\u0069n\u0074\u0073\u0020\u006e\u006ft\u0020\u0064e\u0066\u0069\u006e\u0065\u0064");
};if pt ==nil {return _b .Error (_dgbef ,"a\u0072\u0067\u0075\u006d\u0065\u006et\u0020\u0070\u006f\u0069\u006e\u0074\u0073\u0020\u006eo\u0074\u0020\u0064e\u0066i\u006e\u0065\u0064");};*_acdb =append (*_acdb ,*pt ...);return nil ;};func _daabe (_eccd ,_dgfbg *Bitmap ,_caaa ,_dafa int )(_afac error ){const _gfba ="\u0073e\u0065d\u0066\u0069\u006c\u006c\u0042i\u006e\u0061r\u0079\u004c\u006f\u0077\u0034";
var (_afee ,_ccea ,_cfge ,_bgcb int ;_cdce ,_dcfdf ,_bdbba ,_bcfd ,_dgcb ,_dbdd ,_aeba byte ;);for _afee =0;_afee < _caaa ;_afee ++{_cfge =_afee *_eccd .RowStride ;_bgcb =_afee *_dgfbg .RowStride ;for _ccea =0;_ccea < _dafa ;_ccea ++{_cdce ,_afac =_eccd .GetByte (_cfge +_ccea );
if _afac !=nil {return _b .Wrap (_afac ,_gfba ,"\u0066i\u0072\u0073\u0074\u0020\u0067\u0065t");};_dcfdf ,_afac =_dgfbg .GetByte (_bgcb +_ccea );if _afac !=nil {return _b .Wrap (_afac ,_gfba ,"\u0073\u0065\u0063\u006f\u006e\u0064\u0020\u0067\u0065\u0074");
};if _afee > 0{_bdbba ,_afac =_eccd .GetByte (_cfge -_eccd .RowStride +_ccea );if _afac !=nil {return _b .Wrap (_afac ,_gfba ,"\u0069\u0020\u003e \u0030");};_cdce |=_bdbba ;};if _ccea > 0{_bcfd ,_afac =_eccd .GetByte (_cfge +_ccea -1);if _afac !=nil {return _b .Wrap (_afac ,_gfba ,"\u006a\u0020\u003e \u0030");
};_cdce |=_bcfd <<7;};_cdce &=_dcfdf ;if _cdce ==0||(^_cdce )==0{if _afac =_eccd .SetByte (_cfge +_ccea ,_cdce );_afac !=nil {return _b .Wrap (_afac ,_gfba ,"b\u0074\u0020\u003d\u003d 0\u0020|\u007c\u0020\u0028\u005e\u0062t\u0029\u0020\u003d\u003d\u0020\u0030");
};continue ;};for {_aeba =_cdce ;_cdce =(_cdce |(_cdce >>1)|(_cdce <<1))&_dcfdf ;if (_cdce ^_aeba )==0{if _afac =_eccd .SetByte (_cfge +_ccea ,_cdce );_afac !=nil {return _b .Wrap (_afac ,_gfba ,"\u0073\u0065\u0074\u0074\u0069\u006e\u0067\u0020\u0070\u0072\u0065\u0076 \u0062\u0079\u0074\u0065");
};break ;};};};};for _afee =_caaa -1;_afee >=0;_afee --{_cfge =_afee *_eccd .RowStride ;_bgcb =_afee *_dgfbg .RowStride ;for _ccea =_dafa -1;_ccea >=0;_ccea --{if _cdce ,_afac =_eccd .GetByte (_cfge +_ccea );_afac !=nil {return _b .Wrap (_afac ,_gfba ,"\u0072\u0065\u0076\u0065\u0072\u0073\u0065\u0020\u0066\u0069\u0072\u0073t\u0020\u0067\u0065\u0074");
};if _dcfdf ,_afac =_dgfbg .GetByte (_bgcb +_ccea );_afac !=nil {return _b .Wrap (_afac ,_gfba ,"r\u0065\u0076\u0065\u0072se\u0020g\u0065\u0074\u0020\u006d\u0061s\u006b\u0020\u0062\u0079\u0074\u0065");};if _afee < _caaa -1{if _dgcb ,_afac =_eccd .GetByte (_cfge +_eccd .RowStride +_ccea );
_afac !=nil {return _b .Wrap (_afac ,_gfba ,"\u0072\u0065v\u0065\u0072\u0073e\u0020\u0069\u0020\u003c\u0020\u0068\u0020\u002d\u0031");};_cdce |=_dgcb ;};if _ccea < _dafa -1{if _dbdd ,_afac =_eccd .GetByte (_cfge +_ccea +1);_afac !=nil {return _b .Wrap (_afac ,_gfba ,"\u0072\u0065\u0076\u0065rs\u0065\u0020\u006a\u0020\u003c\u0020\u0077\u0070\u006c\u0020\u002d\u0020\u0031");
};_cdce |=_dbdd >>7;};_cdce &=_dcfdf ;if _cdce ==0||(^_cdce )==0{if _afac =_eccd .SetByte (_cfge +_ccea ,_cdce );_afac !=nil {return _b .Wrap (_afac ,_gfba ,"\u0073\u0065\u0074\u0074\u0069\u006e\u0067\u0020\u006d\u0061\u0073k\u0065\u0064\u0020\u0062\u0079\u0074\u0065\u0020\u0066\u0061i\u006c\u0065\u0064");
};continue ;};for {_aeba =_cdce ;_cdce =(_cdce |(_cdce >>1)|(_cdce <<1))&_dcfdf ;if (_cdce ^_aeba )==0{if _afac =_eccd .SetByte (_cfge +_ccea ,_cdce );_afac !=nil {return _b .Wrap (_afac ,_gfba ,"\u0072e\u0076\u0065\u0072\u0073e\u0020\u0073\u0065\u0074\u0074i\u006eg\u0020p\u0072\u0065\u0076\u0020\u0062\u0079\u0074e");
};break ;};};};};return nil ;};func TstOSymbol (t *_c .T ,scale ...int )*Bitmap {_dadca ,_geefd :=NewWithData (4,5,[]byte {0xF0,0x90,0x90,0x90,0xF0});_a .NoError (t ,_geefd );return TstGetScaledSymbol (t ,_dadca ,scale ...);};func (_cdfe *Bitmaps )ClipToBitmap (s *Bitmap )(*Bitmaps ,error ){const _gedbd ="B\u0069t\u006d\u0061\u0070\u0073\u002e\u0043\u006c\u0069p\u0054\u006f\u0042\u0069tm\u0061\u0070";
if _cdfe ==nil {return nil ,_b .Error (_gedbd ,"\u0042\u0069\u0074\u006dap\u0073\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");};if s ==nil {return nil ,_b .Error (_gedbd ,"\u0073o\u0075\u0072\u0063\u0065 \u0062\u0069\u0074\u006d\u0061p\u0020n\u006ft\u0020\u0064\u0065\u0066\u0069\u006e\u0065d");
};_ggbd :=len (_cdfe .Values );_efad :=&Bitmaps {Values :make ([]*Bitmap ,_ggbd ),Boxes :make ([]*_dc .Rectangle ,_ggbd )};var (_cfebe ,_aded *Bitmap ;_dgedd *_dc .Rectangle ;_aaccf error ;);for _afdea :=0;_afdea < _ggbd ;_afdea ++{if _cfebe ,_aaccf =_cdfe .GetBitmap (_afdea );
_aaccf !=nil {return nil ,_b .Wrap (_aaccf ,_gedbd ,"");};if _dgedd ,_aaccf =_cdfe .GetBox (_afdea );_aaccf !=nil {return nil ,_b .Wrap (_aaccf ,_gedbd ,"");};if _aded ,_aaccf =s .clipRectangle (_dgedd ,nil );_aaccf !=nil {return nil ,_b .Wrap (_aaccf ,_gedbd ,"");
};if _aded ,_aaccf =_aded .And (_cfebe );_aaccf !=nil {return nil ,_b .Wrap (_aaccf ,_gedbd ,"");};_efad .Values [_afdea ]=_aded ;_efad .Boxes [_afdea ]=_dgedd ;};return _efad ,nil ;};func _bbfeb (_egeb *Bitmap ,_eeaa ,_bgag ,_eebd ,_ffbec int ,_ebcg RasterOperator ,_dfgcfc *Bitmap ,_egag ,_fdgf int )error {var (_affd bool ;
_fcfd bool ;_dcgf byte ;_fgaef int ;_bcdb int ;_eacb int ;_bbga int ;_edce bool ;_gcgg int ;_aggag int ;_gegb int ;_abaf bool ;_cfedf byte ;_gfbd int ;_ccgb int ;_dadcg int ;_cfccb byte ;_acgf int ;_abge int ;_adgf uint ;_beefc uint ;_edae byte ;_bgbeb shift ;
_fffb bool ;_adgdg bool ;_geab ,_agdbd int ;);if _egag &7!=0{_abge =8-(_egag &7);};if _eeaa &7!=0{_bcdb =8-(_eeaa &7);};if _abge ==0&&_bcdb ==0{_edae =_gbdf [0];}else {if _bcdb > _abge {_adgf =uint (_bcdb -_abge );}else {_adgf =uint (8-(_abge -_bcdb ));
};_beefc =8-_adgf ;_edae =_gbdf [_adgf ];};if (_eeaa &7)!=0{_affd =true ;_fgaef =8-(_eeaa &7);_dcgf =_gbdf [_fgaef ];_eacb =_egeb .RowStride *_bgag +(_eeaa >>3);_bbga =_dfgcfc .RowStride *_fdgf +(_egag >>3);_acgf =8-(_egag &7);if _fgaef > _acgf {_bgbeb =_eagc ;
if _eebd >=_abge {_fffb =true ;};}else {_bgbeb =_acace ;};};if _eebd < _fgaef {_fcfd =true ;_dcgf &=_bgabd [8-_fgaef +_eebd ];};if !_fcfd {_gcgg =(_eebd -_fgaef )>>3;if _gcgg !=0{_edce =true ;_aggag =_egeb .RowStride *_bgag +((_eeaa +_bcdb )>>3);_gegb =_dfgcfc .RowStride *_fdgf +((_egag +_bcdb )>>3);
};};_gfbd =(_eeaa +_eebd )&7;if !_fcfd &&_gfbd !=0{_abaf =true ;_cfedf =_bgabd [_gfbd ];_ccgb =_egeb .RowStride *_bgag +((_eeaa +_bcdb )>>3)+_gcgg ;_dadcg =_dfgcfc .RowStride *_fdgf +((_egag +_bcdb )>>3)+_gcgg ;if _gfbd > int (_beefc ){_adgdg =true ;};
};switch _ebcg {case PixSrc :if _affd {for _geab =0;_geab < _ffbec ;_geab ++{if _bgbeb ==_eagc {_cfccb =_dfgcfc .Data [_bbga ]<<_adgf ;if _fffb {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_bbga +1]>>_beefc ,_edae );};}else {_cfccb =_dfgcfc .Data [_bbga ]>>_beefc ;
};_egeb .Data [_eacb ]=_eeaef (_egeb .Data [_eacb ],_cfccb ,_dcgf );_eacb +=_egeb .RowStride ;_bbga +=_dfgcfc .RowStride ;};};if _edce {for _geab =0;_geab < _ffbec ;_geab ++{for _agdbd =0;_agdbd < _gcgg ;_agdbd ++{_cfccb =_eeaef (_dfgcfc .Data [_gegb +_agdbd ]<<_adgf ,_dfgcfc .Data [_gegb +_agdbd +1]>>_beefc ,_edae );
_egeb .Data [_aggag +_agdbd ]=_cfccb ;};_aggag +=_egeb .RowStride ;_gegb +=_dfgcfc .RowStride ;};};if _abaf {for _geab =0;_geab < _ffbec ;_geab ++{_cfccb =_dfgcfc .Data [_dadcg ]<<_adgf ;if _adgdg {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_dadcg +1]>>_beefc ,_edae );
};_egeb .Data [_ccgb ]=_eeaef (_egeb .Data [_ccgb ],_cfccb ,_cfedf );_ccgb +=_egeb .RowStride ;_dadcg +=_dfgcfc .RowStride ;};};case PixNotSrc :if _affd {for _geab =0;_geab < _ffbec ;_geab ++{if _bgbeb ==_eagc {_cfccb =_dfgcfc .Data [_bbga ]<<_adgf ;if _fffb {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_bbga +1]>>_beefc ,_edae );
};}else {_cfccb =_dfgcfc .Data [_bbga ]>>_beefc ;};_egeb .Data [_eacb ]=_eeaef (_egeb .Data [_eacb ],^_cfccb ,_dcgf );_eacb +=_egeb .RowStride ;_bbga +=_dfgcfc .RowStride ;};};if _edce {for _geab =0;_geab < _ffbec ;_geab ++{for _agdbd =0;_agdbd < _gcgg ;
_agdbd ++{_cfccb =_eeaef (_dfgcfc .Data [_gegb +_agdbd ]<<_adgf ,_dfgcfc .Data [_gegb +_agdbd +1]>>_beefc ,_edae );_egeb .Data [_aggag +_agdbd ]=^_cfccb ;};_aggag +=_egeb .RowStride ;_gegb +=_dfgcfc .RowStride ;};};if _abaf {for _geab =0;_geab < _ffbec ;
_geab ++{_cfccb =_dfgcfc .Data [_dadcg ]<<_adgf ;if _adgdg {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_dadcg +1]>>_beefc ,_edae );};_egeb .Data [_ccgb ]=_eeaef (_egeb .Data [_ccgb ],^_cfccb ,_cfedf );_ccgb +=_egeb .RowStride ;_dadcg +=_dfgcfc .RowStride ;
};};case PixSrcOrDst :if _affd {for _geab =0;_geab < _ffbec ;_geab ++{if _bgbeb ==_eagc {_cfccb =_dfgcfc .Data [_bbga ]<<_adgf ;if _fffb {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_bbga +1]>>_beefc ,_edae );};}else {_cfccb =_dfgcfc .Data [_bbga ]>>_beefc ;
};_egeb .Data [_eacb ]=_eeaef (_egeb .Data [_eacb ],_cfccb |_egeb .Data [_eacb ],_dcgf );_eacb +=_egeb .RowStride ;_bbga +=_dfgcfc .RowStride ;};};if _edce {for _geab =0;_geab < _ffbec ;_geab ++{for _agdbd =0;_agdbd < _gcgg ;_agdbd ++{_cfccb =_eeaef (_dfgcfc .Data [_gegb +_agdbd ]<<_adgf ,_dfgcfc .Data [_gegb +_agdbd +1]>>_beefc ,_edae );
_egeb .Data [_aggag +_agdbd ]|=_cfccb ;};_aggag +=_egeb .RowStride ;_gegb +=_dfgcfc .RowStride ;};};if _abaf {for _geab =0;_geab < _ffbec ;_geab ++{_cfccb =_dfgcfc .Data [_dadcg ]<<_adgf ;if _adgdg {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_dadcg +1]>>_beefc ,_edae );
};_egeb .Data [_ccgb ]=_eeaef (_egeb .Data [_ccgb ],_cfccb |_egeb .Data [_ccgb ],_cfedf );_ccgb +=_egeb .RowStride ;_dadcg +=_dfgcfc .RowStride ;};};case PixSrcAndDst :if _affd {for _geab =0;_geab < _ffbec ;_geab ++{if _bgbeb ==_eagc {_cfccb =_dfgcfc .Data [_bbga ]<<_adgf ;
if _fffb {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_bbga +1]>>_beefc ,_edae );};}else {_cfccb =_dfgcfc .Data [_bbga ]>>_beefc ;};_egeb .Data [_eacb ]=_eeaef (_egeb .Data [_eacb ],_cfccb &_egeb .Data [_eacb ],_dcgf );_eacb +=_egeb .RowStride ;_bbga +=_dfgcfc .RowStride ;
};};if _edce {for _geab =0;_geab < _ffbec ;_geab ++{for _agdbd =0;_agdbd < _gcgg ;_agdbd ++{_cfccb =_eeaef (_dfgcfc .Data [_gegb +_agdbd ]<<_adgf ,_dfgcfc .Data [_gegb +_agdbd +1]>>_beefc ,_edae );_egeb .Data [_aggag +_agdbd ]&=_cfccb ;};_aggag +=_egeb .RowStride ;
_gegb +=_dfgcfc .RowStride ;};};if _abaf {for _geab =0;_geab < _ffbec ;_geab ++{_cfccb =_dfgcfc .Data [_dadcg ]<<_adgf ;if _adgdg {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_dadcg +1]>>_beefc ,_edae );};_egeb .Data [_ccgb ]=_eeaef (_egeb .Data [_ccgb ],_cfccb &_egeb .Data [_ccgb ],_cfedf );
_ccgb +=_egeb .RowStride ;_dadcg +=_dfgcfc .RowStride ;};};case PixSrcXorDst :if _affd {for _geab =0;_geab < _ffbec ;_geab ++{if _bgbeb ==_eagc {_cfccb =_dfgcfc .Data [_bbga ]<<_adgf ;if _fffb {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_bbga +1]>>_beefc ,_edae );
};}else {_cfccb =_dfgcfc .Data [_bbga ]>>_beefc ;};_egeb .Data [_eacb ]=_eeaef (_egeb .Data [_eacb ],_cfccb ^_egeb .Data [_eacb ],_dcgf );_eacb +=_egeb .RowStride ;_bbga +=_dfgcfc .RowStride ;};};if _edce {for _geab =0;_geab < _ffbec ;_geab ++{for _agdbd =0;
_agdbd < _gcgg ;_agdbd ++{_cfccb =_eeaef (_dfgcfc .Data [_gegb +_agdbd ]<<_adgf ,_dfgcfc .Data [_gegb +_agdbd +1]>>_beefc ,_edae );_egeb .Data [_aggag +_agdbd ]^=_cfccb ;};_aggag +=_egeb .RowStride ;_gegb +=_dfgcfc .RowStride ;};};if _abaf {for _geab =0;
_geab < _ffbec ;_geab ++{_cfccb =_dfgcfc .Data [_dadcg ]<<_adgf ;if _adgdg {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_dadcg +1]>>_beefc ,_edae );};_egeb .Data [_ccgb ]=_eeaef (_egeb .Data [_ccgb ],_cfccb ^_egeb .Data [_ccgb ],_cfedf );_ccgb +=_egeb .RowStride ;
_dadcg +=_dfgcfc .RowStride ;};};case PixNotSrcOrDst :if _affd {for _geab =0;_geab < _ffbec ;_geab ++{if _bgbeb ==_eagc {_cfccb =_dfgcfc .Data [_bbga ]<<_adgf ;if _fffb {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_bbga +1]>>_beefc ,_edae );};}else {_cfccb =_dfgcfc .Data [_bbga ]>>_beefc ;
};_egeb .Data [_eacb ]=_eeaef (_egeb .Data [_eacb ],^_cfccb |_egeb .Data [_eacb ],_dcgf );_eacb +=_egeb .RowStride ;_bbga +=_dfgcfc .RowStride ;};};if _edce {for _geab =0;_geab < _ffbec ;_geab ++{for _agdbd =0;_agdbd < _gcgg ;_agdbd ++{_cfccb =_eeaef (_dfgcfc .Data [_gegb +_agdbd ]<<_adgf ,_dfgcfc .Data [_gegb +_agdbd +1]>>_beefc ,_edae );
_egeb .Data [_aggag +_agdbd ]|=^_cfccb ;};_aggag +=_egeb .RowStride ;_gegb +=_dfgcfc .RowStride ;};};if _abaf {for _geab =0;_geab < _ffbec ;_geab ++{_cfccb =_dfgcfc .Data [_dadcg ]<<_adgf ;if _adgdg {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_dadcg +1]>>_beefc ,_edae );
};_egeb .Data [_ccgb ]=_eeaef (_egeb .Data [_ccgb ],^_cfccb |_egeb .Data [_ccgb ],_cfedf );_ccgb +=_egeb .RowStride ;_dadcg +=_dfgcfc .RowStride ;};};case PixNotSrcAndDst :if _affd {for _geab =0;_geab < _ffbec ;_geab ++{if _bgbeb ==_eagc {_cfccb =_dfgcfc .Data [_bbga ]<<_adgf ;
if _fffb {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_bbga +1]>>_beefc ,_edae );};}else {_cfccb =_dfgcfc .Data [_bbga ]>>_beefc ;};_egeb .Data [_eacb ]=_eeaef (_egeb .Data [_eacb ],^_cfccb &_egeb .Data [_eacb ],_dcgf );_eacb +=_egeb .RowStride ;_bbga +=_dfgcfc .RowStride ;
};};if _edce {for _geab =0;_geab < _ffbec ;_geab ++{for _agdbd =0;_agdbd < _gcgg ;_agdbd ++{_cfccb =_eeaef (_dfgcfc .Data [_gegb +_agdbd ]<<_adgf ,_dfgcfc .Data [_gegb +_agdbd +1]>>_beefc ,_edae );_egeb .Data [_aggag +_agdbd ]&=^_cfccb ;};_aggag +=_egeb .RowStride ;
_gegb +=_dfgcfc .RowStride ;};};if _abaf {for _geab =0;_geab < _ffbec ;_geab ++{_cfccb =_dfgcfc .Data [_dadcg ]<<_adgf ;if _adgdg {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_dadcg +1]>>_beefc ,_edae );};_egeb .Data [_ccgb ]=_eeaef (_egeb .Data [_ccgb ],^_cfccb &_egeb .Data [_ccgb ],_cfedf );
_ccgb +=_egeb .RowStride ;_dadcg +=_dfgcfc .RowStride ;};};case PixSrcOrNotDst :if _affd {for _geab =0;_geab < _ffbec ;_geab ++{if _bgbeb ==_eagc {_cfccb =_dfgcfc .Data [_bbga ]<<_adgf ;if _fffb {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_bbga +1]>>_beefc ,_edae );
};}else {_cfccb =_dfgcfc .Data [_bbga ]>>_beefc ;};_egeb .Data [_eacb ]=_eeaef (_egeb .Data [_eacb ],_cfccb |^_egeb .Data [_eacb ],_dcgf );_eacb +=_egeb .RowStride ;_bbga +=_dfgcfc .RowStride ;};};if _edce {for _geab =0;_geab < _ffbec ;_geab ++{for _agdbd =0;
_agdbd < _gcgg ;_agdbd ++{_cfccb =_eeaef (_dfgcfc .Data [_gegb +_agdbd ]<<_adgf ,_dfgcfc .Data [_gegb +_agdbd +1]>>_beefc ,_edae );_egeb .Data [_aggag +_agdbd ]=_cfccb |^_egeb .Data [_aggag +_agdbd ];};_aggag +=_egeb .RowStride ;_gegb +=_dfgcfc .RowStride ;
};};if _abaf {for _geab =0;_geab < _ffbec ;_geab ++{_cfccb =_dfgcfc .Data [_dadcg ]<<_adgf ;if _adgdg {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_dadcg +1]>>_beefc ,_edae );};_egeb .Data [_ccgb ]=_eeaef (_egeb .Data [_ccgb ],_cfccb |^_egeb .Data [_ccgb ],_cfedf );
_ccgb +=_egeb .RowStride ;_dadcg +=_dfgcfc .RowStride ;};};case PixSrcAndNotDst :if _affd {for _geab =0;_geab < _ffbec ;_geab ++{if _bgbeb ==_eagc {_cfccb =_dfgcfc .Data [_bbga ]<<_adgf ;if _fffb {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_bbga +1]>>_beefc ,_edae );
};}else {_cfccb =_dfgcfc .Data [_bbga ]>>_beefc ;};_egeb .Data [_eacb ]=_eeaef (_egeb .Data [_eacb ],_cfccb &^_egeb .Data [_eacb ],_dcgf );_eacb +=_egeb .RowStride ;_bbga +=_dfgcfc .RowStride ;};};if _edce {for _geab =0;_geab < _ffbec ;_geab ++{for _agdbd =0;
_agdbd < _gcgg ;_agdbd ++{_cfccb =_eeaef (_dfgcfc .Data [_gegb +_agdbd ]<<_adgf ,_dfgcfc .Data [_gegb +_agdbd +1]>>_beefc ,_edae );_egeb .Data [_aggag +_agdbd ]=_cfccb &^_egeb .Data [_aggag +_agdbd ];};_aggag +=_egeb .RowStride ;_gegb +=_dfgcfc .RowStride ;
};};if _abaf {for _geab =0;_geab < _ffbec ;_geab ++{_cfccb =_dfgcfc .Data [_dadcg ]<<_adgf ;if _adgdg {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_dadcg +1]>>_beefc ,_edae );};_egeb .Data [_ccgb ]=_eeaef (_egeb .Data [_ccgb ],_cfccb &^_egeb .Data [_ccgb ],_cfedf );
_ccgb +=_egeb .RowStride ;_dadcg +=_dfgcfc .RowStride ;};};case PixNotPixSrcOrDst :if _affd {for _geab =0;_geab < _ffbec ;_geab ++{if _bgbeb ==_eagc {_cfccb =_dfgcfc .Data [_bbga ]<<_adgf ;if _fffb {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_bbga +1]>>_beefc ,_edae );
};}else {_cfccb =_dfgcfc .Data [_bbga ]>>_beefc ;};_egeb .Data [_eacb ]=_eeaef (_egeb .Data [_eacb ],^(_cfccb |_egeb .Data [_eacb ]),_dcgf );_eacb +=_egeb .RowStride ;_bbga +=_dfgcfc .RowStride ;};};if _edce {for _geab =0;_geab < _ffbec ;_geab ++{for _agdbd =0;
_agdbd < _gcgg ;_agdbd ++{_cfccb =_eeaef (_dfgcfc .Data [_gegb +_agdbd ]<<_adgf ,_dfgcfc .Data [_gegb +_agdbd +1]>>_beefc ,_edae );_egeb .Data [_aggag +_agdbd ]=^(_cfccb |_egeb .Data [_aggag +_agdbd ]);};_aggag +=_egeb .RowStride ;_gegb +=_dfgcfc .RowStride ;
};};if _abaf {for _geab =0;_geab < _ffbec ;_geab ++{_cfccb =_dfgcfc .Data [_dadcg ]<<_adgf ;if _adgdg {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_dadcg +1]>>_beefc ,_edae );};_egeb .Data [_ccgb ]=_eeaef (_egeb .Data [_ccgb ],^(_cfccb |_egeb .Data [_ccgb ]),_cfedf );
_ccgb +=_egeb .RowStride ;_dadcg +=_dfgcfc .RowStride ;};};case PixNotPixSrcAndDst :if _affd {for _geab =0;_geab < _ffbec ;_geab ++{if _bgbeb ==_eagc {_cfccb =_dfgcfc .Data [_bbga ]<<_adgf ;if _fffb {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_bbga +1]>>_beefc ,_edae );
};}else {_cfccb =_dfgcfc .Data [_bbga ]>>_beefc ;};_egeb .Data [_eacb ]=_eeaef (_egeb .Data [_eacb ],^(_cfccb &_egeb .Data [_eacb ]),_dcgf );_eacb +=_egeb .RowStride ;_bbga +=_dfgcfc .RowStride ;};};if _edce {for _geab =0;_geab < _ffbec ;_geab ++{for _agdbd =0;
_agdbd < _gcgg ;_agdbd ++{_cfccb =_eeaef (_dfgcfc .Data [_gegb +_agdbd ]<<_adgf ,_dfgcfc .Data [_gegb +_agdbd +1]>>_beefc ,_edae );_egeb .Data [_aggag +_agdbd ]=^(_cfccb &_egeb .Data [_aggag +_agdbd ]);};_aggag +=_egeb .RowStride ;_gegb +=_dfgcfc .RowStride ;
};};if _abaf {for _geab =0;_geab < _ffbec ;_geab ++{_cfccb =_dfgcfc .Data [_dadcg ]<<_adgf ;if _adgdg {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_dadcg +1]>>_beefc ,_edae );};_egeb .Data [_ccgb ]=_eeaef (_egeb .Data [_ccgb ],^(_cfccb &_egeb .Data [_ccgb ]),_cfedf );
_ccgb +=_egeb .RowStride ;_dadcg +=_dfgcfc .RowStride ;};};case PixNotPixSrcXorDst :if _affd {for _geab =0;_geab < _ffbec ;_geab ++{if _bgbeb ==_eagc {_cfccb =_dfgcfc .Data [_bbga ]<<_adgf ;if _fffb {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_bbga +1]>>_beefc ,_edae );
};}else {_cfccb =_dfgcfc .Data [_bbga ]>>_beefc ;};_egeb .Data [_eacb ]=_eeaef (_egeb .Data [_eacb ],^(_cfccb ^_egeb .Data [_eacb ]),_dcgf );_eacb +=_egeb .RowStride ;_bbga +=_dfgcfc .RowStride ;};};if _edce {for _geab =0;_geab < _ffbec ;_geab ++{for _agdbd =0;
_agdbd < _gcgg ;_agdbd ++{_cfccb =_eeaef (_dfgcfc .Data [_gegb +_agdbd ]<<_adgf ,_dfgcfc .Data [_gegb +_agdbd +1]>>_beefc ,_edae );_egeb .Data [_aggag +_agdbd ]=^(_cfccb ^_egeb .Data [_aggag +_agdbd ]);};_aggag +=_egeb .RowStride ;_gegb +=_dfgcfc .RowStride ;
};};if _abaf {for _geab =0;_geab < _ffbec ;_geab ++{_cfccb =_dfgcfc .Data [_dadcg ]<<_adgf ;if _adgdg {_cfccb =_eeaef (_cfccb ,_dfgcfc .Data [_dadcg +1]>>_beefc ,_edae );};_egeb .Data [_ccgb ]=_eeaef (_egeb .Data [_ccgb ],^(_cfccb ^_egeb .Data [_ccgb ]),_cfedf );
_ccgb +=_egeb .RowStride ;_dadcg +=_dfgcfc .RowStride ;};};default:_ca .Log .Debug ("\u004f\u0070e\u0072\u0061\u0074\u0069\u006f\u006e\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006e\u006f\u0074\u0020\u0070\u0065\u0072\u006d\u0069tt\u0065\u0064",_ebcg );
return _b .Error ("\u0072a\u0073t\u0065\u0072\u004f\u0070\u0047e\u006e\u0065r\u0061\u006c\u004c\u006f\u0077","\u0072\u0061\u0073\u0074\u0065\u0072\u0020\u006f\u0070\u0065r\u0061\u0074\u0069\u006f\u006e\u0020\u006eo\u0074\u0020\u0070\u0065\u0072\u006d\u0069\u0074\u0074\u0065\u0064");
};return nil ;};func _ffdc (_fgg *Bitmap ,_ebfd *Bitmap ,_fgaa *Selection )(*Bitmap ,error ){var (_gbggc *Bitmap ;_ceeg error ;);_fgg ,_ceeg =_ddde (_fgg ,_ebfd ,_fgaa ,&_gbggc );if _ceeg !=nil {return nil ,_ceeg ;};if _ceeg =_fgg .clearAll ();_ceeg !=nil {return nil ,_ceeg ;
};var _gcfe SelectionValue ;for _gaed :=0;_gaed < _fgaa .Height ;_gaed ++{for _ecgf :=0;_ecgf < _fgaa .Width ;_ecgf ++{_gcfe =_fgaa .Data [_gaed ][_ecgf ];if _gcfe ==SelHit {if _ceeg =_fgg .RasterOperation (_ecgf -_fgaa .Cx ,_gaed -_fgaa .Cy ,_ebfd .Width ,_ebfd .Height ,PixSrcOrDst ,_gbggc ,0,0);
_ceeg !=nil {return nil ,_ceeg ;};};};};return _fgg ,nil ;};func (_gdec *Bitmap )nextOnPixel (_bfff ,_cefd int )(_effb _dc .Point ,_eab bool ,_ggg error ){const _cgg ="n\u0065\u0078\u0074\u004f\u006e\u0050\u0069\u0078\u0065\u006c";_effb ,_eab ,_ggg =_gdec .nextOnPixelLow (_gdec .Width ,_gdec .Height ,_gdec .RowStride ,_bfff ,_cefd );
if _ggg !=nil {return _effb ,false ,_b .Wrap (_ggg ,_cgg ,"");};return _effb ,_eab ,nil ;};func MakePixelSumTab8 ()[]int {return _acaf ()};func (_cfeb *Bitmap )clearAll ()error {return _cfeb .RasterOperation (0,0,_cfeb .Width ,_cfeb .Height ,PixClr ,nil ,0,0);
};func (_ffd *Bitmap )GetChocolateData ()[]byte {if _ffd .Color ==Vanilla {_ffd .inverseData ();};return _ffd .Data ;};func (_gfae *ClassedPoints )GroupByY ()([]*ClassedPoints ,error ){const _aeceb ="\u0043\u006c\u0061\u0073se\u0064\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047\u0072\u006f\u0075\u0070\u0042y\u0059";
if _eeab :=_gfae .validateIntSlice ();_eeab !=nil {return nil ,_b .Wrap (_eeab ,_aeceb ,"");};if _gfae .IntSlice .Size ()==0{return nil ,_b .Error (_aeceb ,"\u004e\u006f\u0020\u0063la\u0073\u0073\u0065\u0073\u0020\u0070\u0072\u006f\u0076\u0069\u0064\u0065\u0064");
};_gfae .SortByY ();var (_fdfb []*ClassedPoints ;_accgg int ;);_geca :=-1;var _edcfd *ClassedPoints ;for _dcbc :=0;_dcbc < len (_gfae .IntSlice );_dcbc ++{_accgg =int (_gfae .YAtIndex (_dcbc ));if _accgg !=_geca {_edcfd =&ClassedPoints {Points :_gfae .Points };
_geca =_accgg ;_fdfb =append (_fdfb ,_edcfd );};_edcfd .IntSlice =append (_edcfd .IntSlice ,_gfae .IntSlice [_dcbc ]);};for _ ,_eedf :=range _fdfb {_eedf .SortByX ();};return _fdfb ,nil ;};func TstImageBitmapData ()[]byte {return _dcfcf .Data };func (_ecbg *byWidth )Len ()int {return len (_ecbg .Values )};
func _eddc (_aaagc *Bitmap ,_dfde *_ab .Stack ,_cdda ,_fbed int )(_dbfea *_dc .Rectangle ,_aaebb error ){const _cdbd ="\u0073e\u0065d\u0046\u0069\u006c\u006c\u0053\u0074\u0061\u0063\u006b\u0042\u0042";if _aaagc ==nil {return nil ,_b .Error (_cdbd ,"\u0070\u0072\u006fvi\u0064\u0065\u0064\u0020\u006e\u0069\u006c\u0020\u0027\u0073\u0027\u0020\u0042\u0069\u0074\u006d\u0061\u0070");
};if _dfde ==nil {return nil ,_b .Error (_cdbd ,"p\u0072o\u0076\u0069\u0064\u0065\u0064\u0020\u006e\u0069l\u0020\u0027\u0073\u0074ac\u006b\u0027");};_gedg ,_dgcfb :=_aaagc .Width ,_aaagc .Height ;_cdgb :=_gedg -1;_efdcb :=_dgcfb -1;if _cdda < 0||_cdda > _cdgb ||_fbed < 0||_fbed > _efdcb ||!_aaagc .GetPixel (_cdda ,_fbed ){return nil ,nil ;
};var _eaae *_dc .Rectangle ;_eaae ,_aaebb =Rect (100000,100000,0,0);if _aaebb !=nil {return nil ,_b .Wrap (_aaebb ,_cdbd ,"");};if _aaebb =_eaee (_dfde ,_cdda ,_cdda ,_fbed ,1,_efdcb ,_eaae );_aaebb !=nil {return nil ,_b .Wrap (_aaebb ,_cdbd ,"\u0069\u006e\u0069t\u0069\u0061\u006c\u0020\u0070\u0075\u0073\u0068");
};if _aaebb =_eaee (_dfde ,_cdda ,_cdda ,_fbed +1,-1,_efdcb ,_eaae );_aaebb !=nil {return nil ,_b .Wrap (_aaebb ,_cdbd ,"\u0032\u006ed\u0020\u0069\u006ei\u0074\u0069\u0061\u006c\u0020\u0070\u0075\u0073\u0068");};_eaae .Min .X ,_eaae .Max .X =_cdda ,_cdda ;
_eaae .Min .Y ,_eaae .Max .Y =_fbed ,_fbed ;var (_bffge *fillSegment ;_dfebb int ;);for _dfde .Len ()> 0{if _bffge ,_aaebb =_fcfe (_dfde );_aaebb !=nil {return nil ,_b .Wrap (_aaebb ,_cdbd ,"");};_fbed =_bffge ._cffc ;for _cdda =_bffge ._bbccg ;_cdda >=0&&_aaagc .GetPixel (_cdda ,_fbed );
_cdda --{if _aaebb =_aaagc .SetPixel (_cdda ,_fbed ,0);_aaebb !=nil {return nil ,_b .Wrap (_aaebb ,_cdbd ,"");};};if _cdda >=_bffge ._bbccg {for _cdda ++;_cdda <=_bffge ._fabg &&_cdda <=_cdgb &&!_aaagc .GetPixel (_cdda ,_fbed );_cdda ++{};_dfebb =_cdda ;
if _cdda > _bffge ._fabg ||_cdda > _cdgb {continue ;};}else {_dfebb =_cdda +1;if _dfebb < _bffge ._bbccg -1{if _aaebb =_eaee (_dfde ,_dfebb ,_bffge ._bbccg -1,_bffge ._cffc ,-_bffge ._fbcc ,_efdcb ,_eaae );_aaebb !=nil {return nil ,_b .Wrap (_aaebb ,_cdbd ,"\u006c\u0065\u0061\u006b\u0020\u006f\u006e\u0020\u006c\u0065\u0066\u0074 \u0073\u0069\u0064\u0065");
};};_cdda =_bffge ._bbccg +1;};for {for ;_cdda <=_cdgb &&_aaagc .GetPixel (_cdda ,_fbed );_cdda ++{if _aaebb =_aaagc .SetPixel (_cdda ,_fbed ,0);_aaebb !=nil {return nil ,_b .Wrap (_aaebb ,_cdbd ,"\u0032n\u0064\u0020\u0073\u0065\u0074");};};if _aaebb =_eaee (_dfde ,_dfebb ,_cdda -1,_bffge ._cffc ,_bffge ._fbcc ,_efdcb ,_eaae );
_aaebb !=nil {return nil ,_b .Wrap (_aaebb ,_cdbd ,"n\u006f\u0072\u006d\u0061\u006c\u0020\u0070\u0075\u0073\u0068");};if _cdda > _bffge ._fabg +1{if _aaebb =_eaee (_dfde ,_bffge ._fabg +1,_cdda -1,_bffge ._cffc ,-_bffge ._fbcc ,_efdcb ,_eaae );_aaebb !=nil {return nil ,_b .Wrap (_aaebb ,_cdbd ,"\u006ce\u0061k\u0020\u006f\u006e\u0020\u0072i\u0067\u0068t\u0020\u0073\u0069\u0064\u0065");
};};for _cdda ++;_cdda <=_bffge ._fabg &&_cdda <=_cdgb &&!_aaagc .GetPixel (_cdda ,_fbed );_cdda ++{};_dfebb =_cdda ;if _cdda > _bffge ._fabg ||_cdda > _cdgb {break ;};};};_eaae .Max .X ++;_eaae .Max .Y ++;return _eaae ,nil ;};func (_cbbg *byWidth )Less (i ,j int )bool {return _cbbg .Values [i ].Width < _cbbg .Values [j ].Width };
type Color int ;func _beef (_faff ,_agfd *Bitmap ,_dadc CombinationOperator )*Bitmap {_gbaf :=New (_faff .Width ,_faff .Height );for _babe :=0;_babe < len (_gbaf .Data );_babe ++{_gbaf .Data [_babe ]=_ffgc (_faff .Data [_babe ],_agfd .Data [_babe ],_dadc );
};return _gbaf ;};func (_abbfe *Bitmaps )HeightSorter ()func (_eeaea ,_gfab int )bool {return func (_gead ,_ffadd int )bool {_bbbd :=_abbfe .Values [_gead ].Height < _abbfe .Values [_ffadd ].Height ;_ca .Log .Debug ("H\u0065i\u0067\u0068\u0074\u003a\u0020\u0025\u0076\u0020<\u0020\u0025\u0076\u0020= \u0025\u0076",_abbfe .Values [_gead ].Height ,_abbfe .Values [_ffadd ].Height ,_bbbd );
return _bbbd ;};};func RankHausTest (p1 ,p2 ,p3 ,p4 *Bitmap ,delX ,delY float32 ,maxDiffW ,maxDiffH ,area1 ,area3 int ,rank float32 ,tab8 []int )(_deaa bool ,_dgea error ){const _fdcc ="\u0052\u0061\u006ek\u0048\u0061\u0075\u0073\u0054\u0065\u0073\u0074";
_edeg ,_egdc :=p1 .Width ,p1 .Height ;_fbbg ,_cde :=p3 .Width ,p3 .Height ;if _ab .Abs (_edeg -_fbbg )> maxDiffW {return false ,nil ;};if _ab .Abs (_egdc -_cde )> maxDiffH {return false ,nil ;};_eggg :=int (float32 (area1 )*(1.0-rank )+0.5);_faaee :=int (float32 (area3 )*(1.0-rank )+0.5);
var _cdf ,_bebe int ;if delX >=0{_cdf =int (delX +0.5);}else {_cdf =int (delX -0.5);};if delY >=0{_bebe =int (delY +0.5);}else {_bebe =int (delY -0.5);};_efga :=p1 .CreateTemplate ();if _dgea =_efga .RasterOperation (0,0,_edeg ,_egdc ,PixSrc ,p1 ,0,0);
_dgea !=nil {return false ,_b .Wrap (_dgea ,_fdcc ,"p\u0031\u0020\u002d\u0053\u0052\u0043\u002d\u003e\u0020\u0074");};if _dgea =_efga .RasterOperation (_cdf ,_bebe ,_edeg ,_egdc ,PixNotSrcAndDst ,p4 ,0,0);_dgea !=nil {return false ,_b .Wrap (_dgea ,_fdcc ,"\u0074 \u0026\u0020\u0021\u0070\u0034");
};_deaa ,_dgea =_efga .ThresholdPixelSum (_eggg ,tab8 );if _dgea !=nil {return false ,_b .Wrap (_dgea ,_fdcc ,"\u0074\u002d\u003e\u0074\u0068\u0072\u0065\u0073\u0068\u0031");};if _deaa {return false ,nil ;};if _dgea =_efga .RasterOperation (_cdf ,_bebe ,_fbbg ,_cde ,PixSrc ,p3 ,0,0);
_dgea !=nil {return false ,_b .Wrap (_dgea ,_fdcc ,"p\u0033\u0020\u002d\u0053\u0052\u0043\u002d\u003e\u0020\u0074");};if _dgea =_efga .RasterOperation (0,0,_fbbg ,_cde ,PixNotSrcAndDst ,p2 ,0,0);_dgea !=nil {return false ,_b .Wrap (_dgea ,_fdcc ,"\u0074 \u0026\u0020\u0021\u0070\u0032");
};_deaa ,_dgea =_efga .ThresholdPixelSum (_faaee ,tab8 );if _dgea !=nil {return false ,_b .Wrap (_dgea ,_fdcc ,"\u0074\u002d\u003e\u0074\u0068\u0072\u0065\u0073\u0068\u0033");};return !_deaa ,nil ;};func _edagg (_ccfec *Bitmap ,_gedb ,_bddg ,_edbb ,_faed int ,_abg RasterOperator ,_eadd *Bitmap ,_cbdg ,_fbbb int )error {var (_bcge byte ;
_dded int ;_cdeg int ;_dfgcf ,_cggg int ;_gfaa ,_bfffe int ;);_cafd :=_edbb >>3;_fdadd :=_edbb &7;if _fdadd > 0{_bcge =_bgabd [_fdadd ];};_dded =_eadd .RowStride *_fbbb +(_cbdg >>3);_cdeg =_ccfec .RowStride *_bddg +(_gedb >>3);switch _abg {case PixSrc :for _gfaa =0;
_gfaa < _faed ;_gfaa ++{_dfgcf =_dded +_gfaa *_eadd .RowStride ;_cggg =_cdeg +_gfaa *_ccfec .RowStride ;for _bfffe =0;_bfffe < _cafd ;_bfffe ++{_ccfec .Data [_cggg ]=_eadd .Data [_dfgcf ];_cggg ++;_dfgcf ++;};if _fdadd > 0{_ccfec .Data [_cggg ]=_eeaef (_ccfec .Data [_cggg ],_eadd .Data [_dfgcf ],_bcge );
};};case PixNotSrc :for _gfaa =0;_gfaa < _faed ;_gfaa ++{_dfgcf =_dded +_gfaa *_eadd .RowStride ;_cggg =_cdeg +_gfaa *_ccfec .RowStride ;for _bfffe =0;_bfffe < _cafd ;_bfffe ++{_ccfec .Data [_cggg ]=^(_eadd .Data [_dfgcf ]);_cggg ++;_dfgcf ++;};if _fdadd > 0{_ccfec .Data [_cggg ]=_eeaef (_ccfec .Data [_cggg ],^_eadd .Data [_dfgcf ],_bcge );
};};case PixSrcOrDst :for _gfaa =0;_gfaa < _faed ;_gfaa ++{_dfgcf =_dded +_gfaa *_eadd .RowStride ;_cggg =_cdeg +_gfaa *_ccfec .RowStride ;for _bfffe =0;_bfffe < _cafd ;_bfffe ++{_ccfec .Data [_cggg ]|=_eadd .Data [_dfgcf ];_cggg ++;_dfgcf ++;};if _fdadd > 0{_ccfec .Data [_cggg ]=_eeaef (_ccfec .Data [_cggg ],_eadd .Data [_dfgcf ]|_ccfec .Data [_cggg ],_bcge );
};};case PixSrcAndDst :for _gfaa =0;_gfaa < _faed ;_gfaa ++{_dfgcf =_dded +_gfaa *_eadd .RowStride ;_cggg =_cdeg +_gfaa *_ccfec .RowStride ;for _bfffe =0;_bfffe < _cafd ;_bfffe ++{_ccfec .Data [_cggg ]&=_eadd .Data [_dfgcf ];_cggg ++;_dfgcf ++;};if _fdadd > 0{_ccfec .Data [_cggg ]=_eeaef (_ccfec .Data [_cggg ],_eadd .Data [_dfgcf ]&_ccfec .Data [_cggg ],_bcge );
};};case PixSrcXorDst :for _gfaa =0;_gfaa < _faed ;_gfaa ++{_dfgcf =_dded +_gfaa *_eadd .RowStride ;_cggg =_cdeg +_gfaa *_ccfec .RowStride ;for _bfffe =0;_bfffe < _cafd ;_bfffe ++{_ccfec .Data [_cggg ]^=_eadd .Data [_dfgcf ];_cggg ++;_dfgcf ++;};if _fdadd > 0{_ccfec .Data [_cggg ]=_eeaef (_ccfec .Data [_cggg ],_eadd .Data [_dfgcf ]^_ccfec .Data [_cggg ],_bcge );
};};case PixNotSrcOrDst :for _gfaa =0;_gfaa < _faed ;_gfaa ++{_dfgcf =_dded +_gfaa *_eadd .RowStride ;_cggg =_cdeg +_gfaa *_ccfec .RowStride ;for _bfffe =0;_bfffe < _cafd ;_bfffe ++{_ccfec .Data [_cggg ]|=^(_eadd .Data [_dfgcf ]);_cggg ++;_dfgcf ++;};if _fdadd > 0{_ccfec .Data [_cggg ]=_eeaef (_ccfec .Data [_cggg ],^(_eadd .Data [_dfgcf ])|_ccfec .Data [_cggg ],_bcge );
};};case PixNotSrcAndDst :for _gfaa =0;_gfaa < _faed ;_gfaa ++{_dfgcf =_dded +_gfaa *_eadd .RowStride ;_cggg =_cdeg +_gfaa *_ccfec .RowStride ;for _bfffe =0;_bfffe < _cafd ;_bfffe ++{_ccfec .Data [_cggg ]&=^(_eadd .Data [_dfgcf ]);_cggg ++;_dfgcf ++;};
if _fdadd > 0{_ccfec .Data [_cggg ]=_eeaef (_ccfec .Data [_cggg ],^(_eadd .Data [_dfgcf ])&_ccfec .Data [_cggg ],_bcge );};};case PixSrcOrNotDst :for _gfaa =0;_gfaa < _faed ;_gfaa ++{_dfgcf =_dded +_gfaa *_eadd .RowStride ;_cggg =_cdeg +_gfaa *_ccfec .RowStride ;
for _bfffe =0;_bfffe < _cafd ;_bfffe ++{_ccfec .Data [_cggg ]=_eadd .Data [_dfgcf ]|^(_ccfec .Data [_cggg ]);_cggg ++;_dfgcf ++;};if _fdadd > 0{_ccfec .Data [_cggg ]=_eeaef (_ccfec .Data [_cggg ],_eadd .Data [_dfgcf ]|^(_ccfec .Data [_cggg ]),_bcge );};
};case PixSrcAndNotDst :for _gfaa =0;_gfaa < _faed ;_gfaa ++{_dfgcf =_dded +_gfaa *_eadd .RowStride ;_cggg =_cdeg +_gfaa *_ccfec .RowStride ;for _bfffe =0;_bfffe < _cafd ;_bfffe ++{_ccfec .Data [_cggg ]=_eadd .Data [_dfgcf ]&^(_ccfec .Data [_cggg ]);_cggg ++;
_dfgcf ++;};if _fdadd > 0{_ccfec .Data [_cggg ]=_eeaef (_ccfec .Data [_cggg ],_eadd .Data [_dfgcf ]&^(_ccfec .Data [_cggg ]),_bcge );};};case PixNotPixSrcOrDst :for _gfaa =0;_gfaa < _faed ;_gfaa ++{_dfgcf =_dded +_gfaa *_eadd .RowStride ;_cggg =_cdeg +_gfaa *_ccfec .RowStride ;
for _bfffe =0;_bfffe < _cafd ;_bfffe ++{_ccfec .Data [_cggg ]=^(_eadd .Data [_dfgcf ]|_ccfec .Data [_cggg ]);_cggg ++;_dfgcf ++;};if _fdadd > 0{_ccfec .Data [_cggg ]=_eeaef (_ccfec .Data [_cggg ],^(_eadd .Data [_dfgcf ]|_ccfec .Data [_cggg ]),_bcge );};
};case PixNotPixSrcAndDst :for _gfaa =0;_gfaa < _faed ;_gfaa ++{_dfgcf =_dded +_gfaa *_eadd .RowStride ;_cggg =_cdeg +_gfaa *_ccfec .RowStride ;for _bfffe =0;_bfffe < _cafd ;_bfffe ++{_ccfec .Data [_cggg ]=^(_eadd .Data [_dfgcf ]&_ccfec .Data [_cggg ]);
_cggg ++;_dfgcf ++;};if _fdadd > 0{_ccfec .Data [_cggg ]=_eeaef (_ccfec .Data [_cggg ],^(_eadd .Data [_dfgcf ]&_ccfec .Data [_cggg ]),_bcge );};};case PixNotPixSrcXorDst :for _gfaa =0;_gfaa < _faed ;_gfaa ++{_dfgcf =_dded +_gfaa *_eadd .RowStride ;_cggg =_cdeg +_gfaa *_ccfec .RowStride ;
for _bfffe =0;_bfffe < _cafd ;_bfffe ++{_ccfec .Data [_cggg ]=^(_eadd .Data [_dfgcf ]^_ccfec .Data [_cggg ]);_cggg ++;_dfgcf ++;};if _fdadd > 0{_ccfec .Data [_cggg ]=_eeaef (_ccfec .Data [_cggg ],^(_eadd .Data [_dfgcf ]^_ccfec .Data [_cggg ]),_bcge );};
};default:_ca .Log .Debug ("\u0050\u0072ov\u0069\u0064\u0065d\u0020\u0069\u006e\u0076ali\u0064 r\u0061\u0073\u0074\u0065\u0072\u0020\u006fpe\u0072\u0061\u0074\u006f\u0072\u003a\u0020%\u0076",_abg );return _b .Error ("\u0072\u0061\u0073\u0074er\u004f\u0070\u0042\u0079\u0074\u0065\u0041\u006c\u0069\u0067\u006e\u0065\u0064\u004co\u0077","\u0069\u006e\u0076al\u0069\u0064\u0020\u0072\u0061\u0073\u0074\u0065\u0072\u0020\u006f\u0070\u0065\u0072\u0061\u0074\u006f\u0072");
};return nil ;};func TstImageBitmapInverseData ()[]byte {_eaef :=_dcfcf .Copy ();_eaef .InverseData ();return _eaef .Data ;};func init (){const _bed ="\u0062\u0069\u0074\u006dap\u0073\u002e\u0069\u006e\u0069\u0074\u0069\u0061\u006c\u0069\u007a\u0061\u0074\u0069o\u006e";
_bdfc =New (50,40);var _dgbae error ;_bdfc ,_dgbae =_bdfc .AddBorder (2,1);if _dgbae !=nil {panic (_b .Wrap (_dgbae ,_bed ,"f\u0072\u0061\u006d\u0065\u0042\u0069\u0074\u006d\u0061\u0070"));};_dcfcf ,_dgbae =NewWithData (50,22,_eddd );if _dgbae !=nil {panic (_b .Wrap (_dgbae ,_bed ,"i\u006d\u0061\u0067\u0065\u0042\u0069\u0074\u006d\u0061\u0070"));
};};const (_ LocationFilter =iota ;LocSelectWidth ;LocSelectHeight ;LocSelectXVal ;LocSelectYVal ;LocSelectIfEither ;LocSelectIfBoth ;);func (_gdba *Bitmaps )CountPixels ()*_ab .NumSlice {_cdgaa :=&_ab .NumSlice {};for _ ,_egee :=range _gdba .Values {_cdgaa .AddInt (_egee .CountPixels ());
};return _cdgaa ;};func _agdc (_aggf ,_dfgc *Bitmap ,_gagd ,_dba ,_cdga ,_fegd ,_fgf ,_abegd ,_fgfe ,_cfg int ,_bacd CombinationOperator ,_efbg int )error {var _afa int ;_edgeg :=func (){_afa ++;_cdga +=_dfgc .RowStride ;_fegd +=_aggf .RowStride ;_fgf +=_aggf .RowStride };
for _afa =_gagd ;_afa < _dba ;_edgeg (){var _dda uint16 ;_dfbf :=_cdga ;for _ebgf :=_fegd ;_ebgf <=_fgf ;_ebgf ++{_befg ,_efcg :=_dfgc .GetByte (_dfbf );if _efcg !=nil {return _efcg ;};_gcc ,_efcg :=_aggf .GetByte (_ebgf );if _efcg !=nil {return _efcg ;
};_dda =(_dda |(uint16 (_gcc )&0xff))<<uint (_cfg );_gcc =byte (_dda >>8);if _efcg =_dfgc .SetByte (_dfbf ,_ffgc (_befg ,_gcc ,_bacd ));_efcg !=nil {return _efcg ;};_dfbf ++;_dda <<=uint (_fgfe );if _ebgf ==_fgf {_gcc =byte (_dda >>(8-uint8 (_cfg )));if _efbg !=0{_gcc =_dgce (uint (8+_abegd ),_gcc );
};_befg ,_efcg =_dfgc .GetByte (_dfbf );if _efcg !=nil {return _efcg ;};if _efcg =_dfgc .SetByte (_dfbf ,_ffgc (_befg ,_gcc ,_bacd ));_efcg !=nil {return _efcg ;};};};};return nil ;};func TstImageBitmap ()*Bitmap {return _dcfcf .Copy ()};func (_cfbb *Bitmap )setAll ()error {_fcgb :=_beeg (_cfbb ,0,0,_cfbb .Width ,_cfbb .Height ,PixSet ,nil ,0,0);
if _fcgb !=nil {return _b .Wrap (_fcgb ,"\u0073\u0065\u0074\u0041\u006c\u006c","");};return nil ;};func (_ffbgg *byHeight )Swap (i ,j int ){_ffbgg .Values [i ],_ffbgg .Values [j ]=_ffbgg .Values [j ],_ffbgg .Values [i ];if _ffbgg .Boxes !=nil {_ffbgg .Boxes [i ],_ffbgg .Boxes [j ]=_ffbgg .Boxes [j ],_ffbgg .Boxes [i ];
};};func _agdbe (_affe ,_becc *Bitmap ,_bfade ,_adee int )(*Bitmap ,error ){const _ega ="d\u0069\u006c\u0061\u0074\u0065\u0042\u0072\u0069\u0063\u006b";if _becc ==nil {_ca .Log .Debug ("\u0064\u0069\u006c\u0061\u0074\u0065\u0042\u0072\u0069\u0063k\u0020\u0073\u006f\u0075\u0072\u0063\u0065 \u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006e\u0065\u0064");
return nil ,_b .Error (_ega ,"\u0073o\u0075\u0072\u0063\u0065 \u0062\u0069\u0074\u006d\u0061p\u0020n\u006ft\u0020\u0064\u0065\u0066\u0069\u006e\u0065d");};if _bfade < 1||_adee < 1{return nil ,_b .Error (_ega ,"\u0068\u0053\u007a\u0069\u0065 \u0061\u006e\u0064\u0020\u0076\u0053\u0069\u007a\u0065\u0020\u0061\u0072\u0065 \u006e\u006f\u0020\u0067\u0072\u0065\u0061\u0074\u0065\u0072\u0020\u0065\u0071\u0075\u0061\u006c\u0020\u0074\u006f\u0020\u0031");
};if _bfade ==1&&_adee ==1{_aedb ,_bbba :=_dged (_affe ,_becc );if _bbba !=nil {return nil ,_b .Wrap (_bbba ,_ega ,"\u0068S\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u0026\u0026 \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");
};return _aedb ,nil ;};if _bfade ==1||_adee ==1{_fecef :=SelCreateBrick (_adee ,_bfade ,_adee /2,_bfade /2,SelHit );_afec ,_gagb :=_ffdc (_affe ,_becc ,_fecef );if _gagb !=nil {return nil ,_b .Wrap (_gagb ,_ega ,"\u0068s\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u007c\u007c \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");
};return _afec ,nil ;};_ebfgc :=SelCreateBrick (1,_bfade ,0,_bfade /2,SelHit );_bad :=SelCreateBrick (_adee ,1,_adee /2,0,SelHit );_acfcf ,_gceb :=_ffdc (nil ,_becc ,_ebfgc );if _gceb !=nil {return nil ,_b .Wrap (_gceb ,_ega ,"\u0031\u0073\u0074\u0020\u0064\u0069\u006c\u0061\u0074\u0065");
};_affe ,_gceb =_ffdc (_affe ,_acfcf ,_bad );if _gceb !=nil {return nil ,_b .Wrap (_gceb ,_ega ,"\u0032\u006e\u0064\u0020\u0064\u0069\u006c\u0061\u0074\u0065");};return _affe ,nil ;};func (_bdaa Points )GetGeometry (i int )(_ebfda ,_ceace float32 ,_bfga error ){if i > len (_bdaa )-1{return 0,0,_b .Errorf ("\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047\u0065\u0074","\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};_ddgcd :=_bdaa [i ];return _ddgcd .X ,_ddgcd .Y ,nil ;};func (_bccc Points )Get (i int )(Point ,error ){if i > len (_bccc )-1{return Point {},_b .Errorf ("\u0050\u006f\u0069\u006e\u0074\u0073\u002e\u0047\u0065\u0074","\u0069n\u0064\u0065\u0078\u003a\u0020\u0027\u0025\u0064\u0027\u0020\u006fu\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006e\u0067\u0065",i );
};return _bccc [i ],nil ;};func (_cdba *Bitmap )GetByte (index int )(byte ,error ){if index > len (_cdba .Data )-1||index < 0{return 0,_b .Errorf ("\u0047e\u0074\u0042\u0079\u0074\u0065","\u0069\u006e\u0064\u0065x:\u0020\u0025\u0064\u0020\u006f\u0075\u0074\u0020\u006f\u0066\u0020\u0072\u0061\u006eg\u0065",index );
};return _cdba .Data [index ],nil ;};func TstTSymbol (t *_c .T ,scale ...int )*Bitmap {_eacd ,_eagd :=NewWithData (5,5,[]byte {0xF8,0x20,0x20,0x20,0x20});_a .NoError (t ,_eagd );return TstGetScaledSymbol (t ,_eacd ,scale ...);};func (_afgd *Bitmap )GetVanillaData ()[]byte {if _afgd .Color ==Chocolate {_afgd .inverseData ();
};return _afgd .Data ;};func (_aaee *BitmapsArray )AddBitmaps (bm *Bitmaps ){_aaee .Values =append (_aaee .Values ,bm )};type ClassedPoints struct{*Points ;_ab .IntSlice ;_faffb func (_cbae ,_cfddd int )bool ;};func (_ddcc *Bitmaps )String ()string {_gdca :=_d .Builder {};
for _ ,_cbbe :=range _ddcc .Values {_gdca .WriteString (_cbbe .String ());_gdca .WriteRune ('\n');};return _gdca .String ();};func (_fcefe *Bitmaps )GroupByWidth ()(*BitmapsArray ,error ){const _aegd ="\u0047\u0072\u006fu\u0070\u0042\u0079\u0057\u0069\u0064\u0074\u0068";
if len (_fcefe .Values )==0{return nil ,_b .Error (_aegd ,"\u006eo\u0020v\u0061\u006c\u0075\u0065\u0073 \u0070\u0072o\u0076\u0069\u0064\u0065\u0064");};_bbcd :=&BitmapsArray {};_fcefe .SortByWidth ();_gcac :=-1;_deec :=-1;for _ggeb :=0;_ggeb < len (_fcefe .Values );
_ggeb ++{_dgbad :=_fcefe .Values [_ggeb ].Width ;if _dgbad > _gcac {_gcac =_dgbad ;_deec ++;_bbcd .Values =append (_bbcd .Values ,&Bitmaps {});};_bbcd .Values [_deec ].AddBitmap (_fcefe .Values [_ggeb ]);};return _bbcd ,nil ;};func _cafe (_egcd ,_gbcg *Bitmap ,_cdaa ,_ffcg int )(*Bitmap ,error ){const _dgbe ="\u006fp\u0065\u006e\u0042\u0072\u0069\u0063k";
if _gbcg ==nil {return nil ,_b .Error (_dgbe ,"\u0073o\u0075\u0072\u0063\u0065 \u0062\u0069\u0074\u006d\u0061p\u0020n\u006ft\u0020\u0064\u0065\u0066\u0069\u006e\u0065d");};if _cdaa < 1&&_ffcg < 1{return nil ,_b .Error (_dgbe ,"\u0068\u0053\u0069\u007ae \u003c\u0020\u0031\u0020\u0026\u0026\u0020\u0076\u0053\u0069\u007a\u0065\u0020\u003c \u0031");
};if _cdaa ==1&&_ffcg ==1{return _gbcg .Copy (),nil ;};if _cdaa ==1||_ffcg ==1{var _fdbe error ;_ebbg :=SelCreateBrick (_ffcg ,_cdaa ,_ffcg /2,_cdaa /2,SelHit );_egcd ,_fdbe =_fgba (_egcd ,_gbcg ,_ebbg );if _fdbe !=nil {return nil ,_b .Wrap (_fdbe ,_dgbe ,"\u0068S\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031\u0020\u007c\u007c \u0076\u0053\u0069\u007a\u0065\u0020\u003d\u003d\u0020\u0031");
};return _egcd ,nil ;};_bbbc :=SelCreateBrick (1,_cdaa ,0,_cdaa /2,SelHit );_accc :=SelCreateBrick (_ffcg ,1,_ffcg /2,0,SelHit );_fadb ,_ecee :=_adfbc (nil ,_gbcg ,_bbbc );if _ecee !=nil {return nil ,_b .Wrap (_ecee ,_dgbe ,"\u0031s\u0074\u0020\u0065\u0072\u006f\u0064e");
};_egcd ,_ecee =_adfbc (_egcd ,_fadb ,_accc );if _ecee !=nil {return nil ,_b .Wrap (_ecee ,_dgbe ,"\u0032n\u0064\u0020\u0065\u0072\u006f\u0064e");};_ ,_ecee =_ffdc (_fadb ,_egcd ,_bbbc );if _ecee !=nil {return nil ,_b .Wrap (_ecee ,_dgbe ,"\u0031\u0073\u0074\u0020\u0064\u0069\u006c\u0061\u0074\u0065");
};_ ,_ecee =_ffdc (_egcd ,_fadb ,_accc );if _ecee !=nil {return nil ,_b .Wrap (_ecee ,_dgbe ,"\u0032\u006e\u0064\u0020\u0064\u0069\u006c\u0061\u0074\u0065");};return _egcd ,nil ;};func TstPSymbol (t *_c .T )*Bitmap {t .Helper ();_fbcce :=New (5,8);_a .NoError (t ,_fbcce .SetPixel (0,0,1));
_a .NoError (t ,_fbcce .SetPixel (1,0,1));_a .NoError (t ,_fbcce .SetPixel (2,0,1));_a .NoError (t ,_fbcce .SetPixel (3,0,1));_a .NoError (t ,_fbcce .SetPixel (4,1,1));_a .NoError (t ,_fbcce .SetPixel (0,1,1));_a .NoError (t ,_fbcce .SetPixel (4,2,1));
_a .NoError (t ,_fbcce .SetPixel (0,2,1));_a .NoError (t ,_fbcce .SetPixel (4,3,1));_a .NoError (t ,_fbcce .SetPixel (0,3,1));_a .NoError (t ,_fbcce .SetPixel (0,4,1));_a .NoError (t ,_fbcce .SetPixel (1,4,1));_a .NoError (t ,_fbcce .SetPixel (2,4,1));
_a .NoError (t ,_fbcce .SetPixel (3,4,1));_a .NoError (t ,_fbcce .SetPixel (0,5,1));_a .NoError (t ,_fbcce .SetPixel (0,6,1));_a .NoError (t ,_fbcce .SetPixel (0,7,1));return _fbcce ;};func CombineBytes (oldByte ,newByte byte ,op CombinationOperator )byte {return _ffgc (oldByte ,newByte ,op );
};func (_dedda *Bitmaps )AddBox (box *_dc .Rectangle ){_dedda .Boxes =append (_dedda .Boxes ,box )};func CorrelationScoreThresholded (bm1 ,bm2 *Bitmap ,area1 ,area2 int ,delX ,delY float32 ,maxDiffW ,maxDiffH int ,tab ,downcount []int ,scoreThreshold float32 )(bool ,error ){const _aece ="C\u006f\u0072\u0072\u0065\u006c\u0061t\u0069\u006f\u006e\u0053\u0063\u006f\u0072\u0065\u0054h\u0072\u0065\u0073h\u006fl\u0064\u0065\u0064";
if bm1 ==nil {return false ,_b .Error (_aece ,"\u0063\u006f\u0072\u0072\u0065\u006c\u0061\u0074\u0069\u006f\u006e\u0053\u0063\u006f\u0072\u0065\u0054\u0068\u0072\u0065\u0073\u0068\u006f\u006cd\u0065\u0064\u0020\u0062\u006d1\u0020\u0069s\u0020\u006e\u0069\u006c");
};if bm2 ==nil {return false ,_b .Error (_aece ,"\u0063\u006f\u0072\u0072\u0065\u006c\u0061\u0074\u0069\u006f\u006e\u0053\u0063\u006f\u0072\u0065\u0054\u0068\u0072\u0065\u0073\u0068\u006f\u006cd\u0065\u0064\u0020\u0062\u006d2\u0020\u0069s\u0020\u006e\u0069\u006c");
};if area1 <=0||area2 <=0{return false ,_b .Error (_aece ,"c\u006f\u0072\u0072\u0065\u006c\u0061\u0074\u0069\u006fn\u0053\u0063\u006f\u0072\u0065\u0054\u0068re\u0073\u0068\u006f\u006cd\u0065\u0064\u0020\u002d\u0020\u0061\u0072\u0065\u0061s \u006d\u0075s\u0074\u0020\u0062\u0065\u0020\u003e\u0020\u0030");
};if downcount ==nil {return false ,_b .Error (_aece ,"\u0070\u0072\u006fvi\u0064\u0065\u0064\u0020\u006e\u006f\u0020\u0027\u0064\u006f\u0077\u006e\u0063\u006f\u0075\u006e\u0074\u0027");};if tab ==nil {return false ,_b .Error (_aece ,"p\u0072\u006f\u0076\u0069de\u0064 \u006e\u0069\u006c\u0020\u0027s\u0075\u006d\u0074\u0061\u0062\u0027");
};_fafe ,_cedg :=bm1 .Width ,bm1 .Height ;_fedac ,_afcgf :=bm2 .Width ,bm2 .Height ;if _ab .Abs (_fafe -_fedac )> maxDiffW {return false ,nil ;};if _ab .Abs (_cedg -_afcgf )> maxDiffH {return false ,nil ;};_bdb :=int (delX +_ab .Sign (delX )*0.5);_dbbf :=int (delY +_ab .Sign (delY )*0.5);
_aeg :=int (_ae .Ceil (_ae .Sqrt (float64 (scoreThreshold )*float64 (area1 )*float64 (area2 ))));_fdac :=bm2 .RowStride ;_feee :=_cebc (_dbbf ,0);_bcgd :=_deeg (_afcgf +_dbbf ,_cedg );_ebeda :=bm1 .RowStride *_feee ;_dadcb :=bm2 .RowStride *(_feee -_dbbf );
var _bgee int ;if _bcgd <=_cedg {_bgee =downcount [_bcgd -1];};_gge :=_cebc (_bdb ,0);_dedf :=_deeg (_fedac +_bdb ,_fafe );var _cbee ,_eggd int ;if _bdb >=8{_cbee =_bdb >>3;_ebeda +=_cbee ;_gge -=_cbee <<3;_dedf -=_cbee <<3;_bdb &=7;}else if _bdb <=-8{_eggd =-((_bdb +7)>>3);
_dadcb +=_eggd ;_fdac -=_eggd ;_bdb +=_eggd <<3;};var (_acce ,_acba ,_gebdg int ;_ddgc ,_gac ,_ggce byte ;);if _gge >=_dedf ||_feee >=_bcgd {return false ,nil ;};_bacaf :=(_dedf +7)>>3;switch {case _bdb ==0:for _acba =_feee ;_acba < _bcgd ;_acba ,_ebeda ,_dadcb =_acba +1,_ebeda +bm1 .RowStride ,_dadcb +bm2 .RowStride {for _gebdg =0;
_gebdg < _bacaf ;_gebdg ++{_ddgc =bm1 .Data [_ebeda +_gebdg ]&bm2 .Data [_dadcb +_gebdg ];_acce +=tab [_ddgc ];};if _acce >=_aeg {return true ,nil ;};if _efge :=_acce +downcount [_acba ]-_bgee ;_efge < _aeg {return false ,nil ;};};case _bdb > 0&&_fdac < _bacaf :for _acba =_feee ;
_acba < _bcgd ;_acba ,_ebeda ,_dadcb =_acba +1,_ebeda +bm1 .RowStride ,_dadcb +bm2 .RowStride {_gac =bm1 .Data [_ebeda ];_ggce =bm2 .Data [_dadcb ]>>uint (_bdb );_ddgc =_gac &_ggce ;_acce +=tab [_ddgc ];for _gebdg =1;_gebdg < _fdac ;_gebdg ++{_gac =bm1 .Data [_ebeda +_gebdg ];
_ggce =bm2 .Data [_dadcb +_gebdg ]>>uint (_bdb )|bm2 .Data [_dadcb +_gebdg -1]<<uint (8-_bdb );_ddgc =_gac &_ggce ;_acce +=tab [_ddgc ];};_gac =bm1 .Data [_ebeda +_gebdg ];_ggce =bm2 .Data [_dadcb +_gebdg -1]<<uint (8-_bdb );_ddgc =_gac &_ggce ;_acce +=tab [_ddgc ];
if _acce >=_aeg {return true ,nil ;}else if _acce +downcount [_acba ]-_bgee < _aeg {return false ,nil ;};};case _bdb > 0&&_fdac >=_bacaf :for _acba =_feee ;_acba < _bcgd ;_acba ,_ebeda ,_dadcb =_acba +1,_ebeda +bm1 .RowStride ,_dadcb +bm2 .RowStride {_gac =bm1 .Data [_ebeda ];
_ggce =bm2 .Data [_dadcb ]>>uint (_bdb );_ddgc =_gac &_ggce ;_acce +=tab [_ddgc ];for _gebdg =1;_gebdg < _bacaf ;_gebdg ++{_gac =bm1 .Data [_ebeda +_gebdg ];_ggce =bm2 .Data [_dadcb +_gebdg ]>>uint (_bdb );_ggce |=bm2 .Data [_dadcb +_gebdg -1]<<uint (8-_bdb );
_ddgc =_gac &_ggce ;_acce +=tab [_ddgc ];};if _acce >=_aeg {return true ,nil ;}else if _acce +downcount [_acba ]-_bgee < _aeg {return false ,nil ;};};case _bacaf < _fdac :for _acba =_feee ;_acba < _bcgd ;_acba ,_ebeda ,_dadcb =_acba +1,_ebeda +bm1 .RowStride ,_dadcb +bm2 .RowStride {for _gebdg =0;
_gebdg < _bacaf ;_gebdg ++{_gac =bm1 .Data [_ebeda +_gebdg ];_ggce =bm2 .Data [_dadcb +_gebdg ]<<uint (-_bdb );_ggce |=bm2 .Data [_dadcb +_gebdg +1]>>uint (8+_bdb );_ddgc =_gac &_ggce ;_acce +=tab [_ddgc ];};if _acce >=_aeg {return true ,nil ;}else if _bfad :=_acce +downcount [_acba ]-_bgee ;
_bfad < _aeg {return false ,nil ;};};case _fdac >=_bacaf :for _acba =_feee ;_acba < _bcgd ;_acba ,_ebeda ,_dadcb =_acba +1,_ebeda +bm1 .RowStride ,_dadcb +bm2 .RowStride {for _gebdg =0;_gebdg < _bacaf ;_gebdg ++{_gac =bm1 .Data [_ebeda +_gebdg ];_ggce =bm2 .Data [_dadcb +_gebdg ]<<uint (-_bdb );
_ggce |=bm2 .Data [_dadcb +_gebdg +1]>>uint (8+_bdb );_ddgc =_gac &_ggce ;_acce +=tab [_ddgc ];};_gac =bm1 .Data [_ebeda +_gebdg ];_ggce =bm2 .Data [_dadcb +_gebdg ]<<uint (-_bdb );_ddgc =_gac &_ggce ;_acce +=tab [_ddgc ];if _acce >=_aeg {return true ,nil ;
}else if _acce +downcount [_acba ]-_bgee < _aeg {return false ,nil ;};};};_gegc :=float32 (_acce )*float32 (_acce )/(float32 (area1 )*float32 (area2 ));if _gegc >=scoreThreshold {_ca .Log .Trace ("\u0063\u006f\u0075\u006e\u0074\u003a\u0020\u0025\u0064\u0020\u003c\u0020\u0074\u0068\u0072\u0065\u0073\u0068\u006f\u006cd\u0020\u0025\u0064\u0020\u0062\u0075\u0074\u0020\u0073c\u006f\u0072\u0065\u0020\u0025\u0066\u0020\u003e\u003d\u0020\u0073\u0063\u006fr\u0065\u0054\u0068\u0072\u0065\u0073h\u006f\u006c\u0064 \u0025\u0066",_acce ,_aeg ,_gegc ,scoreThreshold );
};return false ,nil ;};func _cebc (_faae ,_gea int )int {if _faae > _gea {return _faae ;};return _gea ;};