//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package context ;import (_fe "errors";_ed "github.com/unidoc/freetype/truetype";_b "github.com/unidoc/unipdf/v4/core";_cg "github.com/unidoc/unipdf/v4/internal/cmap";_eb "github.com/unidoc/unipdf/v4/internal/textencoding";_ae "github.com/unidoc/unipdf/v4/internal/transform";
_ea "github.com/unidoc/unipdf/v4/model";_c "golang.org/x/image/font";_fd "image";_f "image/color";_g "strconv";_a "strings";);func NewTextFont (font *_ea .PdfFont ,size float64 )(*TextFont ,error ){_fdf :=font .FontDescriptor ();if _fdf ==nil {return nil ,_fe .New ("\u0063\u006fu\u006c\u0064\u0020\u006e\u006f\u0074\u0020\u0067\u0065\u0074\u0020\u0066\u006f\u006e\u0074\u0020\u0064\u0065\u0073\u0063\u0072\u0069pt\u006f\u0072");
};_gcc ,_ggda :=_b .GetStream (_fdf .FontFile2 );if !_ggda {return nil ,_fe .New ("\u006di\u0073\u0073\u0069\u006e\u0067\u0020\u0066\u006f\u006e\u0074\u0020f\u0069\u006c\u0065\u0020\u0073\u0074\u0072\u0065\u0061\u006d");};_bdb ,_baf :=_b .DecodeStream (_gcc );
if _baf !=nil {return nil ,_baf ;};_dff ,_baf :=_ed .Parse (_bdb );if _baf !=nil {return nil ,_baf ;};_bce :=font .FontDescriptor ().FontName .String ();_ebg :=len (_bce )> 7&&_bce [6]=='+';if _fdf .Flags !=nil {_ccgf ,_gcd :=_g .Atoi (_fdf .Flags .String ());
if _gcd ==nil &&_ccgf ==32{_ebg =false ;};};if !_dff .HasCmap ()&&(!_a .Contains (font .Encoder ().String (),"\u0049d\u0065\u006e\u0074\u0069\u0074\u0079-")||!_ebg ){return nil ,_fe .New ("\u006e\u006f c\u006d\u0061\u0070 \u0061\u006e\u0064\u0020enc\u006fdi\u006e\u0067\u0020\u0069\u0073\u0020\u006eot\u0020\u0069\u0064\u0065\u006e\u0074\u0069t\u0079");
};return &TextFont {Font :font ,Size :size ,_ggd :_dff },nil ;};const (LineCapRound LineCap =iota ;LineCapButt ;LineCapSquare ;);type Gradient interface{Pattern ;AddColorStop (_feg float64 ,_bff _f .Color );};func (_cae *TextFont )charcodeToRunesSimple (_fc _eb .CharCode )(_eb .CharCode ,[]rune ){_fga :=[]_eb .CharCode {_fc };
if _cae .Font .IsSimple ()&&_cae ._ggd !=nil {if _dbf :=_cae ._ggd .Index (rune (_fc ));_dbf > 0{return _fc ,[]rune {rune (_fc )};};};if _cae ._ggd !=nil &&!_cae ._ggd .HasCmap ()&&_a .Contains (_cae .Font .Encoder ().String (),"\u0049d\u0065\u006e\u0074\u0069\u0074\u0079-"){if _dca :=_cae ._ggd .Index (rune (_fc ));
_dca > 0{return _fc ,[]rune {rune (_fc )};};};return _fc ,_cae .Font .CharcodesToUnicode (_fga );};func NewTextFontFromPath (filePath string ,size float64 )(*TextFont ,error ){_bcc ,_bddb :=_ea .NewPdfFontFromTTFFile (filePath );if _bddb !=nil {return nil ,_bddb ;
};return NewTextFont (_bcc ,size );};type LineJoin int ;func (_de *TextFont )GetCharMetrics (code _eb .CharCode )(float64 ,float64 ,bool ){if _acb ,_fbe :=_de .Font .GetCharMetrics (code );_fbe &&_acb .Wx !=0{return _acb .Wx ,_acb .Wy ,_fbe ;};if _de ._ba ==nil {return 0,0,false ;
};_bdf ,_fegce :=_de ._ba .GetCharMetrics (code );return _bdf .Wx ,_bdf .Wy ,_fegce &&_bdf .Wx !=0;};func (_efb *TextState )ProcTStar (){_efb .ProcTd (0,-_efb .Tl )};func (_ec *TextState )ProcTj (data []byte ,ctx Context ){_aacc :=_ec .Tf .Size ;_ecf :=_ec .Th /100.0;
_deg :=_ec .GlobalScale ;_ebb :=_ae .NewMatrix (_aacc *_ecf ,0,0,_aacc ,0,_ec .Ts );_bfe :=ctx .Matrix ();_dd :=_bfe .Clone ().Mult (_ec .Tm .Clone ().Mult (_ebb )).ScalingFactorY ();_ace :=_ec .Tf .NewFace (_dd );_gfe :=_ec .Tf .BytesToCharcodes (data );
for _ ,_fgd :=range _gfe {_fad ,_ffd :=_ec .Tf .CharcodeToRunes (_fgd );_deb :=string (_ffd );if _deb =="\u0000"{continue ;};_eg :=_bfe .Clone ().Mult (_ec .Tm .Clone ().Mult (_ebb ));_bcb :=_eg .ScalingFactorY ();_eg =_eg .Scale (1/_bcb ,-1/_bcb );if _ec .Tr !=TextRenderingModeInvisible {ctx .SetMatrix (_eg );
ctx .DrawString (_deb ,_ace ,0,0);ctx .SetMatrix (_bfe );};_gdc :=0.0;if _deb =="\u0020"{_gdc =_ec .Tw ;};_dce ,_ ,_ged :=_ec .Tf .GetCharMetrics (_fad );if _ged {_dce =_dce *0.001*_aacc ;}else {_dce ,_ =ctx .MeasureString (_deb ,_ace );_dce =_dce /_deg ;
};_ccf :=(_dce +_ec .Tc +_gdc )*_ecf ;_ec .Tm =_ec .Tm .Mult (_ae .TranslationMatrix (_ccf ,0));};};type FillRule int ;func (_gf *TextFont )BytesToCharcodes (data []byte )[]_eb .CharCode {if _gf ._ba !=nil {return _gf ._ba .BytesToCharcodes (data );};return _gf .Font .BytesToCharcodes (data );
};type TextFont struct{Font *_ea .PdfFont ;Size float64 ;_ggd *_ed .Font ;_ba *_ea .PdfFont ;};func (_bae *TextState )ProcTf (font *TextFont ){_bae .Tf =font };func (_bcd *TextState )ProcTd (tx ,ty float64 ){_bcd .Tlm .Concat (_ae .TranslationMatrix (tx ,ty ));
_bcd .Tm =_bcd .Tlm .Clone ();};const (TextRenderingModeFill TextRenderingMode =iota ;TextRenderingModeStroke ;TextRenderingModeFillStroke ;TextRenderingModeInvisible ;TextRenderingModeFillClip ;TextRenderingModeStrokeClip ;TextRenderingModeFillStrokeClip ;
TextRenderingModeClip ;);func (_abe *TextState )ProcTD (tx ,ty float64 ){_abe .Tl =-ty ;_abe .ProcTd (tx ,ty )};func (_cgd *TextState )Translate (tx ,ty float64 ){_cgd .Tm =_cgd .Tm .Mult (_ae .TranslationMatrix (tx ,ty ));};type TextState struct{Tc float64 ;
Tw float64 ;Th float64 ;Tl float64 ;Tf *TextFont ;Ts float64 ;Tm _ae .Matrix ;Tlm _ae .Matrix ;Tr TextRenderingMode ;GlobalScale float64 ;};func (_eee *TextFont )CharcodeToRunes (charcode _eb .CharCode )(_eb .CharCode ,[]rune ){_cdg :=[]_eb .CharCode {charcode };
if _eee ._ba ==nil ||_eee ._ba ==_eee .Font {return _eee .charcodeToRunesSimple (charcode );};_da :=_eee ._ba .CharcodesToUnicode (_cdg );_gcdg ,_ :=_eee .Font .RunesToCharcodeBytes (_da );_bb :=_eee .Font .BytesToCharcodes (_gcdg );_gdg :=charcode ;if len (_bb )> 0&&_bb [0]!=0{_gdg =_bb [0];
};if string (_da )==string (_cg .MissingCodeRune )&&_eee ._ba .BaseFont ()==_eee .Font .BaseFont (){return _eee .charcodeToRunesSimple (charcode );};return _gdg ,_da ;};const (LineJoinRound LineJoin =iota ;LineJoinBevel ;);const (FillRuleWinding FillRule =iota ;
FillRuleEvenOdd ;);func (_af *TextState )ProcTm (a ,b ,c ,d ,e ,f float64 ){_af .Tm =_ae .NewMatrix (a ,b ,c ,d ,e ,f );_af .Tlm =_af .Tm .Clone ();};type TextRenderingMode int ;func NewTextState ()TextState {return TextState {Th :100,Tm :_ae .IdentityMatrix (),Tlm :_ae .IdentityMatrix ()};
};type LineCap int ;func (_bad *TextState )ProcDQ (data []byte ,aw ,ac float64 ,ctx Context ){_bad .Tw =aw ;_bad .Tc =ac ;_bad .ProcQ (data ,ctx );};type Pattern interface{ColorAt (_ab ,_bf int )_f .Color ;};func (_bddd *TextState )Reset (){_bddd .Tm =_ae .IdentityMatrix ();
_bddd .Tlm =_ae .IdentityMatrix ()};func (_ge *TextFont )NewFace (size float64 )_c .Face {return _ed .NewFace (_ge ._ggd ,&_ed .Options {Size :size });};func (_egc *TextState )ProcQ (data []byte ,ctx Context ){_egc .ProcTStar ();_egc .ProcTj (data ,ctx )};
func (_cea *TextFont )WithSize (size float64 ,originalFont *_ea .PdfFont )*TextFont {return &TextFont {Font :_cea .Font ,Size :size ,_ggd :_cea ._ggd ,_ba :originalFont };};type Context interface{Push ();Pop ();Matrix ()_ae .Matrix ;SetMatrix (_ac _ae .Matrix );
Translate (_aee ,_aeb float64 );Scale (_ag ,_edd float64 );Rotate (_cge float64 );MoveTo (_eaa ,_d float64 );LineTo (_cgb ,_ga float64 );CubicTo (_fegc ,_db ,_fg ,_bc ,_cb ,_be float64 );QuadraticTo (_fdb ,_gg ,_aa ,_aac float64 );NewSubPath ();ClosePath ();
ClearPath ();Clip ();ClipPreserve ();ResetClip ();LineWidth ()float64 ;SetLineWidth (_acf float64 );SetLineCap (_acfg LineCap );SetLineJoin (_ce LineJoin );SetDash (_ced ...float64 );SetDashOffset (_ad float64 );Fill ();FillPreserve ();Stroke ();StrokePreserve ();
SetRGBA (_dbe ,_eddf ,_ggc ,_cbf float64 );SetFillRGBA (_gd ,_aef ,_ff ,_ca float64 );SetFillStyle (_dc Pattern );SetFillRule (_fb FillRule );SetStrokeRGBA (_bd ,_cd ,_ef ,_fa float64 );SetStrokeStyle (_ffg Pattern );FillPattern ()Pattern ;StrokePattern ()Pattern ;
TextState ()*TextState ;DrawString (_dg string ,_bee _c .Face ,_gdf ,_ee float64 );MeasureString (_aag string ,_fda _c .Face )(_bdd ,_eddd float64 );DrawRectangle (_gdd ,_cc ,_fbf ,_fgc float64 );DrawImage (_cdf _fd .Image ,_df ,_agc int );DrawImageAnchored (_eaf _fd .Image ,_aaa ,_dbb int ,_gc ,_ccg float64 );
Height ()int ;Width ()int ;};