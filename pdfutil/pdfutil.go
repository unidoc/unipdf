//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package pdfutil ;import (_a "errors";_fe "fmt";_ff "github.com/unidoc/unipdf/v4/common";_d "github.com/unidoc/unipdf/v4/contentstream";_c "github.com/unidoc/unipdf/v4/contentstream/draw";_ca "github.com/unidoc/unipdf/v4/core";_fg "github.com/unidoc/unipdf/v4/model";
_ffd "github.com/unidoc/unipdf/v4/ps";_fea "os";);func _ed (_ceb string ,_be *_fg .PdfPageResources )([]byte ,error ){_cag :=_d .NewContentStreamParser (_ceb );_ea ,_fdf :=_cag .Parse ();if _fdf !=nil {return nil ,_fdf ;};_ad :=&_d .ContentStreamOperations {};
_cg :=map[_ca .PdfObjectName ]bool {};_gf :=map[_ca .PdfObjectName ]bool {};_cd :=_d .NewContentStreamProcessor (*_ea );_cd .AddHandler (_d .HandlerConditionEnumAllOperands ,"",func (_gce *_d .ContentStreamOperation ,_ab _d .GraphicsState ,_ag *_fg .PdfPageResources )error {_fda :=_gce .Operand ;
switch _fda {case "\u0043\u0053":if _ef (_ab .ColorspaceStroking ){_adb :=_gce .Params [0].(*_ca .PdfObjectName );if *_adb !="\u0050a\u0074\u0074\u0065\u0072\u006e"{_gcc ,_cfe :=_ag .GetColorspaceByName (*_adb );if !_cfe {return _a .New ("\u0063\u006f\u006c\u006frs\u0070\u0061\u0063\u0065\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006ee\u0064");
};_ga ,_cfe :=_gcc .(*_fg .PdfColorspaceSpecialPattern );if !_cfe {return _a .New ("\u0074\u0079\u0070\u0065\u0020\u0065\u0072\u0072\u006f\u0072");};if _ga .UnderlyingCS !=nil {_ga .UnderlyingCS =_fg .NewPdfColorspaceDeviceGray ();};_fdf =_ag .SetColorspaceByName (*_adb ,_ga );
if _fdf !=nil {return _fdf ;};};*_ad =append (*_ad ,_gce );return nil ;};_ec :=_d .ContentStreamOperation {};_ec .Operand =_fda ;_ec .Params =[]_ca .PdfObject {_ca .MakeName ("\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079")};*_ad =append (*_ad ,&_ec );
return nil ;case "\u0063\u0073":if _ef (_ab .ColorspaceNonStroking ){_gad :=_gce .Params [0].(*_ca .PdfObjectName );if *_gad !="\u0050a\u0074\u0074\u0065\u0072\u006e"{_caf ,_dd :=_ag .GetColorspaceByName (*_gad );if !_dd {return _a .New ("\u0063\u006f\u006c\u006frs\u0070\u0061\u0063\u0065\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066\u0069\u006ee\u0064");
};_cc ,_dd :=_caf .(*_fg .PdfColorspaceSpecialPattern );if !_dd {return _a .New ("\u0074\u0079\u0070\u0065\u0020\u0065\u0072\u0072\u006f\u0072");};if _cc .UnderlyingCS !=nil {_cc .UnderlyingCS =_fg .NewPdfColorspaceDeviceGray ();};if _fa :=_ag .SetColorspaceByName (*_gad ,_cc );
_fa !=nil {return _fa ;};};*_ad =append (*_ad ,_gce );return nil ;};_abc :=_d .ContentStreamOperation {};_abc .Operand =_fda ;_abc .Params =[]_ca .PdfObject {_ca .MakeName ("\u0044\u0065\u0076\u0069\u0063\u0065\u0047\u0072\u0061\u0079")};*_ad =append (*_ad ,&_abc );
return nil ;case "\u0053\u0043","\u0053\u0043\u004e":if _ef (_ab .ColorspaceStroking ){_da :=_d .ContentStreamOperation {};_da .Operand =_fda ;_da .Params =[]_ca .PdfObject {};_bd ,_dab :=_ab .ColorStroking .(*_fg .PdfColorPattern );if !_dab {return _a .New ("i\u006e\u0076\u0061\u006c\u0069\u0064 \u0073\u0074\u0072\u006f\u006b\u0069\u006e\u0067\u0020c\u006f\u006c\u006fr\u0020t\u0079\u0070\u0065");
};if _bd .Color !=nil {_eda ,_gg :=_ab .ColorspaceStroking .ColorToRGB (_bd .Color );if _gg !=nil {return _gg ;};_ba :=_eda .(*_fg .PdfColorDeviceRGB );_gdf :=_ba .ToGray ();_da .Params =append (_da .Params ,_ca .MakeFloat (_gdf .Val ()));};if _ ,_cgc :=_cg [_bd .PatternName ];
_cgc {_da .Params =append (_da .Params ,_ca .MakeName (string (_bd .PatternName )));*_ad =append (*_ad ,&_da );return nil ;};_cg [_bd .PatternName ]=true ;_cfg ,_db :=_ag .GetPatternByName (_bd .PatternName );if !_db {return _a .New ("\u0075\u006e\u0064\u0065fi\u006e\u0065\u0064\u0020\u0070\u0061\u0074\u0074\u0065\u0072\u006e\u0020\u006e\u0061m\u0065");
};_baf ,_fab :=_cad (_cfg );if _fab !=nil {return _fab ;};_fab =_ag .SetPatternByName (_bd .PatternName ,_baf .ToPdfObject ());if _fab !=nil {return _fab ;};_da .Params =append (_da .Params ,_ca .MakeName (string (_bd .PatternName )));*_ad =append (*_ad ,&_da );
}else {_ade ,_ebb :=_ab .ColorspaceStroking .ColorToRGB (_ab .ColorStroking );if _ebb !=nil {return _ebb ;};_cef :=_ade .(*_fg .PdfColorDeviceRGB );_daf :=_cef .ToGray ();_fec :=_d .ContentStreamOperation {};_fec .Operand =_fda ;_fec .Params =[]_ca .PdfObject {_ca .MakeFloat (_daf .Val ())};
*_ad =append (*_ad ,&_fec );};return nil ;case "\u0073\u0063","\u0073\u0063\u006e":if _ef (_ab .ColorspaceNonStroking ){_gadg :=_d .ContentStreamOperation {};_gadg .Operand =_fda ;_gadg .Params =[]_ca .PdfObject {};_efb ,_ead :=_ab .ColorNonStroking .(*_fg .PdfColorPattern );
if !_ead {return _a .New ("i\u006e\u0076\u0061\u006c\u0069\u0064 \u0073\u0074\u0072\u006f\u006b\u0069\u006e\u0067\u0020c\u006f\u006c\u006fr\u0020t\u0079\u0070\u0065");};if _efb .Color !=nil {_ggf ,_ggg :=_ab .ColorspaceNonStroking .ColorToRGB (_efb .Color );
if _ggg !=nil {return _ggg ;};_aee :=_ggf .(*_fg .PdfColorDeviceRGB );_ac :=_aee .ToGray ();_gadg .Params =append (_gadg .Params ,_ca .MakeFloat (_ac .Val ()));};if _ ,_df :=_cg [_efb .PatternName ];_df {_gadg .Params =append (_gadg .Params ,_ca .MakeName (string (_efb .PatternName )));
*_ad =append (*_ad ,&_gadg );return nil ;};_cg [_efb .PatternName ]=true ;_bc ,_gfe :=_ag .GetPatternByName (_efb .PatternName );if !_gfe {return _a .New ("\u0075\u006e\u0064\u0065fi\u006e\u0065\u0064\u0020\u0070\u0061\u0074\u0074\u0065\u0072\u006e\u0020\u006e\u0061m\u0065");
};_ee ,_fdc :=_cad (_bc );if _fdc !=nil {return _fdc ;};_fdc =_ag .SetPatternByName (_efb .PatternName ,_ee .ToPdfObject ());if _fdc !=nil {return _fdc ;};_gadg .Params =append (_gadg .Params ,_ca .MakeName (string (_efb .PatternName )));*_ad =append (*_ad ,&_gadg );
}else {_fff ,_af :=_ab .ColorspaceNonStroking .ColorToRGB (_ab .ColorNonStroking );if _af !=nil {return _af ;};_edf :=_fff .(*_fg .PdfColorDeviceRGB );_ddd :=_edf .ToGray ();_bee :=_d .ContentStreamOperation {};_bee .Operand =_fda ;_bee .Params =[]_ca .PdfObject {_ca .MakeFloat (_ddd .Val ())};
*_ad =append (*_ad ,&_bee );};return nil ;case "\u0052\u0047","\u004b":_ebe ,_aaa :=_ab .ColorspaceStroking .ColorToRGB (_ab .ColorStroking );if _aaa !=nil {return _aaa ;};_aad :=_ebe .(*_fg .PdfColorDeviceRGB );_bcc :=_aad .ToGray ();_fag :=_d .ContentStreamOperation {};
_fag .Operand ="\u0047";_fag .Params =[]_ca .PdfObject {_ca .MakeFloat (_bcc .Val ())};*_ad =append (*_ad ,&_fag );return nil ;case "\u0072\u0067","\u006b":_de ,_agg :=_ab .ColorspaceNonStroking .ColorToRGB (_ab .ColorNonStroking );if _agg !=nil {return _agg ;
};_ecf :=_de .(*_fg .PdfColorDeviceRGB );_cce :=_ecf .ToGray ();_bec :=_d .ContentStreamOperation {};_bec .Operand ="\u0067";_bec .Params =[]_ca .PdfObject {_ca .MakeFloat (_cce .Val ())};*_ad =append (*_ad ,&_bec );return nil ;case "\u0073\u0068":if len (_gce .Params )!=1{return _a .New ("\u0070\u0061\u0072\u0061\u006d\u0073 \u0074\u006f\u0020\u0073\u0068\u0020\u006f\u0070\u0065\u0072\u0061\u0074\u006fr\u0020\u0073\u0068\u006f\u0075\u006c\u0064 \u0062\u0065\u0020\u0031");
};_bb ,_fdg :=_gce .Params [0].(*_ca .PdfObjectName );if !_fdg {return _a .New ("\u0073\u0068 \u0070\u0061\u0072\u0061\u006d\u0065\u0074\u0065\u0072\u0020\u0073\u0068\u006f\u0075\u006c\u0064\u0020\u0062\u0065\u0020\u0061\u0020na\u006d\u0065");};if _ ,_gfa :=_gf [*_bb ];
_gfa {*_ad =append (*_ad ,_gce );return nil ;};_gf [*_bb ]=true ;_eag ,_aea :=_ag .GetShadingByName (*_bb );if !_aea {return _a .New ("\u0073\u0068\u0061\u0064\u0069\u006e\u0067\u0020\u006e\u006f\u0074\u0020\u0064\u0065\u0066i\u006ee\u0064\u0020\u0069\u006e\u0020\u0072\u0065\u0073\u006f\u0075\u0072\u0063\u0065\u0073");
};_eee ,_eff :=_fc (_eag );if _eff !=nil {return _eff ;};_eff =_ag .SetShadingByName (*_bb ,_eee .GetContext ().ToPdfObject ());if _eff !=nil {return _eff ;};};*_ad =append (*_ad ,_gce );return nil ;});_cd .AddHandler (_d .HandlerConditionEnumOperand ,"\u0042\u0049",func (_ede *_d .ContentStreamOperation ,_ge _d .GraphicsState ,_dcf *_fg .PdfPageResources )error {if len (_ede .Params )!=1{return _a .New ("\u0069\u006e\u0076\u0061l\u0069\u0064\u0020\u006e\u0075\u006d\u0062\u0065\u0072\u0020o\u0066 \u0070\u0061\u0072\u0061\u006d\u0065\u0074e\u0072\u0073");
};_eaf ,_eca :=_ede .Params [0].(*_d .ContentStreamInlineImage );if !_eca {return _a .New ("\u0069\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u0069\u006el\u0069\u006e\u0065\u0020\u0069\u006d\u0061g\u0065\u0020\u0070\u0061\u0072\u0061\u006d\u0065\u0074\u0065\u0072");
};_gdc ,_dabe :=_eaf .ToImage (_dcf );if _dabe !=nil {return _dabe ;};_baad ,_dabe :=_eaf .GetColorSpace (_dcf );if _dabe !=nil {return _dabe ;};_fdb ,_dabe :=_baad .ImageToRGB (*_gdc );if _dabe !=nil {return _dabe ;};_cfc :=_fg .NewPdfColorspaceDeviceRGB ();
_bg ,_dabe :=_cfc .ImageToGray (_fdb );if _dabe !=nil {return _dabe ;};_abcb ,_dabe :=_eaf .GetEncoder ();if _dabe !=nil {return _dabe ;};if _edd ,_feg :=_abcb .(*_ca .DCTEncoder );_feg {_edd .ColorComponents =1;};_ced ,_dabe :=_d .NewInlineImageFromImage (_bg ,_abcb );
if _dabe !=nil {if _dabe ==_ca .ErrUnsupportedEncodingParameters {_abcb =_ca .NewFlateEncoder ();};_ced ,_dabe =_d .NewInlineImageFromImage (_bg ,_abcb );if _dabe !=nil {return _dabe ;};};_ffc :=_d .ContentStreamOperation {};_ffc .Operand ="\u0042\u0049";
_ffc .Params =[]_ca .PdfObject {_ced };*_ad =append (*_ad ,&_ffc );return nil ;});_aca :=map[string ]bool {};_cd .AddHandler (_d .HandlerConditionEnumOperand ,"\u0044\u006f",func (_bef *_d .ContentStreamOperation ,_ebd _d .GraphicsState ,_fdac *_fg .PdfPageResources )error {if len (_bef .Params )< 1{return _a .New ("\u0045\u0052\u0052\u004f\u0052\u003a\u0020\u0049\u006e\u0076\u0061\u006c\u0069\u0064\u0020\u006e\u0075\u006d\u0062\u0065r\u0020\u006f\u0066\u0020\u0070\u0061\u0072\u0061\u006ds\u0020\u0066\u006f\u0072\u0020\u0044\u006f\u0020\u006f\u0062\u006a\u0065\u0063t\u003a\u0020\u0052\u0061\u006e\u0067e\u0020\u0063\u0068e\u0063\u006b");
};_gadd :=_bef .Params [0].(*_ca .PdfObjectName );_ ,_gb :=_aca [string (*_gadd )];if _gb {return nil ;};_aca [string (*_gadd )]=true ;_ ,_bfa :=_fdac .GetXObjectByName (*_gadd );if _bfa ==_fg .XObjectTypeImage {_cbg ,_ffcb :=_fdac .GetXObjectImageByName (*_gadd );
if _ffcb !=nil {return _ffcb ;};_dfc ,_ffcb :=_cbg .ToImage ();if _ffcb !=nil {return _ffcb ;};_cfgb ,_ffcb :=_cbg .ColorSpace .ImageToRGB (*_dfc );if _ffcb !=nil {return _ffcb ;};_gccg :=_fg .NewPdfColorspaceDeviceRGB ();_beca ,_ffcb :=_gccg .ImageToGray (_cfgb );
if _ffcb !=nil {return _ffcb ;};_gbe :=_cbg .Filter ;if _dbe ,_ecg :=_gbe .(*_ca .DCTEncoder );_ecg {_dbe .ColorComponents =1;};_gbb ,_ffcb :=_fg .NewXObjectImageFromImage (&_beca ,nil ,_gbe );if _ffcb !=nil {if _ffcb ==_ca .ErrUnsupportedEncodingParameters {_gbe =_ca .NewFlateEncoder ();
};_gbb ,_ffcb =_fg .NewXObjectImageFromImage (&_beca ,nil ,_gbe );if _ffcb !=nil {return _ffcb ;};};_ffcb =_fdac .SetXObjectImageByName (*_gadd ,_gbb );if _ffcb !=nil {return _ffcb ;};}else if _bfa ==_fg .XObjectTypeForm {_aed ,_cgce :=_fdac .GetXObjectFormByName (*_gadd );
if _cgce !=nil {return _cgce ;};_feaf ,_cgce :=_aed .GetContentStream ();if _cgce !=nil {return _cgce ;};_ebc :=_aed .Resources ;if _ebc ==nil {_ebc =_fdac ;};_eage ,_cgce :=_ed (string (_feaf ),_ebc );if _cgce !=nil {return _cgce ;};_cgce =_aed .SetContentStream (_eage ,nil );
if _cgce !=nil {return _cgce ;};_cgce =_fdac .SetXObjectFormByName (*_gadd ,_aed );if _cgce !=nil {return _cgce ;};};return nil ;});_fdf =_cd .Process (_be );if _fdf !=nil {return nil ,_fdf ;};return _ad .Bytes (),nil ;};

// ConvertPageToGrayscale() replaces color objects on the page with grayscale ones.  Also references XObject Images and Forms
// to convert those to grayscale.
func ConvertPageToGrayscale (page *_fg .PdfPage )error {_cb ,_bf :=page .GetAllContentStreams ();if _bf !=nil {return _bf ;};_ce ,_bf :=_ed (_cb ,page .Resources );if _bf !=nil {return _bf ;};_bf =page .SetContentStreams ([]string {string (_ce )},_ca .NewFlateEncoder ());
if _bf !=nil {return _bf ;};return nil ;};func _dfe (_gac ,_cadg *_fg .PdfPageResources )(*_fg .PdfPageResources ,error ){if _gac .XObject ==nil {_gac .XObject =_cadg .XObject ;}else {_gegb ,_ :=_ca .GetDict (_gac .XObject );if _cadg .XObject !=nil {_gff ,_ :=_ca .GetDict (_cadg .XObject );
for _ ,_fcf :=range _gff .Keys (){_dcd :=_gff .Get (_fcf );_gegb .Set (_fcf ,_dcd );};};};_abf ,_ebg :=_gac .GetColorspaces ();if _ebg !=nil {return nil ,_ebg ;};_effb ,_ebg :=_cadg .GetColorspaces ();if _ebg !=nil {return nil ,_ebg ;};if _abf ==nil {_gac .SetColorSpace (_effb );
}else {if _effb !=nil {for _fega ,_gca :=range _effb .Colorspaces {if _ ,_cdd :=_abf .Colorspaces [_fega ];!_cdd {_abf .Names =append (_abf .Names ,_fega );};_gac .SetColorspaceByName (_ca .PdfObjectName (_fega ),_gca );};};};if _gac .ExtGState ==nil {_gac .ExtGState =_cadg .ExtGState ;
}else {_fb ,_ :=_ca .GetDict (_gac .ExtGState );if _cadg .ExtGState !=nil {_fffd ,_ :=_ca .GetDict (_cadg .ExtGState );for _ ,_dfa :=range _fffd .Keys (){_fcb :=_fffd .Get (_dfa );_fb .Set (_dfa ,_fcb );};};};if _gac .Shading ==nil {_gac .Shading =_cadg .Shading ;
}else {_cca ,_ :=_ca .GetDict (_gac .Shading );if _cadg .Shading !=nil {_bde ,_ :=_ca .GetDict (_cadg .Shading );for _ ,_abg :=range _bde .Keys (){_efd :=_bde .Get (_abg );_cca .Set (_abg ,_efd );};};};if _gac .Pattern ==nil {_gac .Pattern =_cadg .Pattern ;
}else {_eg ,_ :=_ca .GetDict (_gac .Pattern );if _cadg .Pattern !=nil {_bbd ,_ :=_ca .GetDict (_cadg .Pattern );for _ ,_add :=range _bbd .Keys (){_effbf :=_bbd .Get (_add );_eg .Set (_add ,_effbf );};};};if _gac .Font ==nil {_gac .Font =_cadg .Font ;}else {_egf ,_ :=_ca .GetDict (_gac .Font );
if _cadg .Font !=nil {_faa ,_ :=_ca .GetDict (_cadg .Font );for _ ,_bcec :=range _faa .Keys (){_affe :=_faa .Get (_bcec );_egf .Set (_bcec ,_affe );};};};if _gac .ProcSet ==nil {_gac .ProcSet =_cadg .ProcSet ;}else {_cab ,_ :=_ca .GetDict (_gac .ProcSet );
if _cadg .ProcSet !=nil {_dea ,_ :=_ca .GetDict (_cadg .ProcSet );for _ ,_cfee :=range _dea .Keys (){_cdb :=_dea .Get (_cfee );_cab .Set (_cfee ,_cdb );};};};if _gac .Properties ==nil {_gac .Properties =_cadg .Properties ;}else {_ffag ,_ :=_ca .GetDict (_gac .Properties );
if _cadg .Properties !=nil {_dae ,_ :=_ca .GetDict (_cadg .Properties );for _ ,_gdcg :=range _dae .Keys (){_ebcc :=_dae .Get (_gdcg );_ffag .Set (_gdcg ,_ebcc );};};};return _gac ,nil ;};

// NormalizePage performs the following operations on the passed in page:
//   - Normalize the page rotation.
//     Rotates the contents of the page according to the Rotate entry, thus
//     flattening the rotation. The Rotate entry of the page is set to nil.
//   - Normalize the media box.
//     If the media box of the page is offsetted (Llx != 0 or Lly != 0),
//     the contents of the page are translated to (-Llx, -Lly). After
//     normalization, the media box is updated (Llx and Lly are set to 0 and
//     Urx and Ury are updated accordingly).
//   - Normalize the crop box.
//     The crop box of the page is updated based on the previous operations.
//
// After normalization, the page should look the same if openend using a
// PDF viewer.
// NOTE: This function does not normalize annotations, outlines other parts
// that are not part of the basic geometry and page content streams.
func NormalizePage (page *_fg .PdfPage )error {_beag ,_cfeb :=page .GetMediaBox ();if _cfeb !=nil {return _cfeb ;};_beef ,_cfeb :=page .GetRotate ();if _cfeb !=nil {_ff .Log .Debug ("\u0045\u0052R\u004f\u0052\u003a\u0020\u0025\u0073\u0020\u002d\u0020\u0069\u0067\u006e\u006f\u0072\u0069\u006e\u0067\u0020\u0061\u006e\u0064\u0020\u0061\u0073\u0073\u0075\u006d\u0069\u006e\u0067\u0020\u006e\u006f\u0020\u0072\u006f\u0074\u0061\u0074\u0069\u006f\u006e\u000a",_cfeb .Error ());
};_fge :=_beef %360!=0&&_beef %90==0;_beag .Normalize ();_cdc ,_adf ,_eefd ,_eab :=_beag .Llx ,_beag .Lly ,_beag .Width (),_beag .Height ();_gea :=_cdc !=0||_adf !=0;if !_fge &&!_gea {return nil ;};_efdc :=func (_cedb ,_fdae ,_agb float64 )_c .BoundingBox {return _c .Path {Points :[]_c .Point {_c .NewPoint (0,0).Rotate (_agb ),_c .NewPoint (_cedb ,0).Rotate (_agb ),_c .NewPoint (0,_fdae ).Rotate (_agb ),_c .NewPoint (_cedb ,_fdae ).Rotate (_agb )}}.GetBoundingBox ();
};_aec :=_d .NewContentCreator ();var _eaa float64 ;if _fge {_eaa =-float64 (_beef );_cfa :=_efdc (_eefd ,_eab ,_eaa );_aec .Translate ((_cfa .Width -_eefd )/2+_eefd /2,(_cfa .Height -_eab )/2+_eab /2);_aec .RotateDeg (_eaa );_aec .Translate (-_eefd /2,-_eab /2);
_eefd ,_eab =_cfa .Width ,_cfa .Height ;};if _gea {_aec .Translate (-_cdc ,-_adf );};_baag :=_aec .Operations ();_aeac ,_cfeb :=_ca .MakeStream (_baag .Bytes (),_ca .NewFlateEncoder ());if _cfeb !=nil {return _cfeb ;};_fgf :=_ca .MakeArray (_aeac );_fgf .Append (page .GetContentStreamObjs ()...);
*_beag =_fg .PdfRectangle {Urx :_eefd ,Ury :_eab };if _aebe :=page .CropBox ;_aebe !=nil {_aebe .Normalize ();_cee ,_bad ,_bab ,_becae :=_aebe .Llx -_cdc ,_aebe .Lly -_adf ,_aebe .Width (),_aebe .Height ();if _fge {_fgb :=_efdc (_bab ,_becae ,_eaa );_bab ,_becae =_fgb .Width ,_fgb .Height ;
};*_aebe =_fg .PdfRectangle {Llx :_cee ,Lly :_bad ,Urx :_cee +_bab ,Ury :_bad +_becae };};_ff .Log .Debug ("\u0052\u006f\u0074\u0061\u0074\u0065\u003d\u0025\u0066\u00b0\u0020\u004f\u0070\u0073\u003d%\u0071 \u004d\u0065\u0064\u0069\u0061\u0042\u006f\u0078\u003d\u0025\u002e\u0032\u0066",_eaa ,_baag ,_beag );
page .Contents =_fgf ;page .Rotate =nil ;return nil ;};func _ef (_eb _fg .PdfColorspace )bool {_ ,_gcg :=_eb .(*_fg .PdfColorspaceSpecialPattern );return _gcg };func _cad (_aff *_fg .PdfPattern )(*_fg .PdfPattern ,error ){if _aff .IsTiling (){_cde :=_aff .GetAsTilingPattern ();
if _cde .IsColored (){_geb ,_bcab :=_cde .GetContentStream ();if _bcab !=nil {return nil ,_bcab ;};_ccg ,_bcab :=_ed (string (_geb ),_cde .Resources );if _bcab !=nil {return nil ,_bcab ;};_bcab =_cde .SetContentStream (_ccg ,nil );if _bcab !=nil {return nil ,_bcab ;
};_ =_cde .ToPdfObject ();};}else if _aff .IsShading (){_dde :=_aff .GetAsShadingPattern ();_dbed ,_fdcf :=_fc (_dde .Shading );if _fdcf !=nil {return nil ,_fdcf ;};_dde .Shading =_dbed ;_ =_dde .ToPdfObject ();};return _aff ,nil ;};func _eef (_aedf ,_cec *_fg .PdfAcroForm ,_dad int )(*_fg .PdfAcroForm ,error ){if _aedf .NeedAppearances ==nil {_aedf .NeedAppearances =_cec .NeedAppearances ;
};if _aedf .SigFlags ==nil {_aedf .SigFlags =_cec .SigFlags ;};if _aedf .CO ==nil {_aedf .CO =_cec .CO ;};if _aedf .DR ==nil {_aedf .DR =_cec .DR ;}else if _cec .DR !=nil {_dfb ,_bdd :=_dfe (_aedf .DR ,_cec .DR );if _bdd !=nil {return nil ,_bdd ;};_aedf .DR =_dfb ;
};if _aedf .DA ==nil {_aedf .DA =_cec .DA ;};if _aedf .Q ==nil {_aedf .Q =_cec .Q ;};if _aedf .XFA ==nil {_aedf .XFA =_cec .XFA ;}else {if _cec .XFA !=nil {_ff .Log .Debug ("TO\u0044\u004f\u003a\u0020\u0048\u0061\u006edl\u0065\u0020\u0058\u0046\u0041\u0020\u006d\u0065\u0072\u0067\u0069\u006e\u0067\u0020\u002d \u0043\u0075\u0072\u0072\u0065\u006e\u0074\u006c\u0079\u0020\u006a\u0075\u0073\u0074\u0020\u0075\u0073\u0069\u006e\u0067 \u0066\u0069\u0072\u0073\u0074\u0020o\u006e\u0065\u0020\u0074\u0068\u0061\u0074\u0020\u0069s\u0020e\u006e\u0063\u006f\u0075\u006e\u0074\u0065\u0072\u0065\u0064");
};};if _aedf .Fields ==nil {_aedf .Fields =_cec .Fields ;}else {_ffcg :=_fg .NewPdfField ();_ffcg .T =_ca .MakeString (_fe .Sprintf ("\u0064\u006f\u0063%\u0064",_dad ));_ffcg .Kids =[]*_fg .PdfField {};if _cec .Fields !=nil {for _ ,_fagd :=range *_cec .Fields {_fagd .Parent =_ffcg ;
_ffcg .Kids =append (_ffcg .Kids ,_fagd );};};*_aedf .Fields =append (*_aedf .Fields ,_ffcg );};return _aedf ,nil ;};

// ExtractPageRange extracts a range of pages from inputPath PDF file and saves it as outputPath PDF file.
// keepOptionalContent controls if we need to process OC properties (rarely needed).
func ExtractPageRange (inputPath string ,outputPath string ,pageFrom int ,pageTo int ,keepOptionalContent bool )error {_feb :=_fg .NewPdfWriter ();_aa ,_g ,_e :=_fg .NewPdfReaderFromFile (inputPath ,nil );if _e !=nil {return _e ;};defer _g .Close ();_dc ,_e :=_aa .GetNumPages ();
if _e !=nil {return _e ;};if _dc < pageTo {return _fe .Errorf ("n\u0075\u006d\u0050\u0061\u0067\u0065s\u0020\u0028\u0025\u0064\u0029\u0020\u003c\u0020\u0070a\u0067\u0065\u0054o\u0020(\u0025\u0064\u0029",_dc ,pageTo );};if keepOptionalContent {_dg ,_fd :=_aa .GetOCProperties ();
if _fd !=nil {return _fd ;};_feb .SetOCProperties (_dg );};for _dcg :=pageFrom ;_dcg <=pageTo ;_dcg ++{_gd :=_dcg ;_b ,_ae :=_aa .GetPage (_gd );if _ae !=nil {return _ae ;};_ae =_feb .AddPage (_b );if _ae !=nil {return _ae ;};};_gc ,_e :=_fea .Create (outputPath );
if _e !=nil {return _e ;};defer _gc .Close ();_e =_feb .Write (_gc );if _e !=nil {return _e ;};return nil ;};func _fc (_gfd *_fg .PdfShading )(*_fg .PdfShading ,error ){_cbgg :=_gfd .ColorSpace ;if _cbgg .GetNumComponents ()==1{return _gfd ,nil ;}else if _cbgg .GetNumComponents ()==3{_adc :=&_fg .PdfFunctionType4 {};
_adc .Domain =[]float64 {0,1,0,1,0,1};_adc .Range =[]float64 {0,1};_cgd :=_ffd .NewPSProgram ();_cgd .Append (_ffd .MakeReal (0.11));_cgd .Append (_ffd .MakeOperand ("\u006d\u0075\u006c"));_cgd .Append (_ffd .MakeOperand ("\u0065\u0078\u0063\u0068"));_cgd .Append (_ffd .MakeReal (0.59));
_cgd .Append (_ffd .MakeOperand ("\u006d\u0075\u006c"));_cgd .Append (_ffd .MakeOperand ("\u0061\u0064\u0064"));_cgd .Append (_ffd .MakeOperand ("\u0065\u0078\u0063\u0068"));_cgd .Append (_ffd .MakeReal (0.3));_cgd .Append (_ffd .MakeOperand ("\u006d\u0075\u006c"));
_cgd .Append (_ffd .MakeOperand ("\u0061\u0064\u0064"));_adc .Program =_cgd ;_abb :=_fg .NewPdfColorspaceDeviceN ();_abb .AlternateSpace =_fg .NewPdfColorspaceDeviceGray ();_abb .ColorantNames =_ca .MakeArray (_ca .MakeName ("\u0052"),_ca .MakeName ("\u0047"),_ca .MakeName ("\u0042"));
_abb .TintTransform =_adc ;_gfd .ColorSpace =_abb ;return _gfd ,nil ;}else if _cbgg .GetNumComponents ()==4{_cfd :=&_fg .PdfFunctionType4 {};_cfd .Domain =[]float64 {0,1,0,1,0,1,0,1};_cfd .Range =[]float64 {0,1};_fga :=_ffd .NewPSProgram ();_fga .Append (_ffd .MakeOperand ("\u0065\u0078\u0063\u0068"));
_fga .Append (_ffd .MakeReal (0.11));_fga .Append (_ffd .MakeOperand ("\u006d\u0075\u006c"));_fga .Append (_ffd .MakeOperand ("\u0061\u0064\u0064"));_fga .Append (_ffd .MakeOperand ("\u0065\u0078\u0063\u0068"));_fga .Append (_ffd .MakeReal (0.59));_fga .Append (_ffd .MakeOperand ("\u006d\u0075\u006c"));
_fga .Append (_ffd .MakeOperand ("\u0061\u0064\u0064"));_fga .Append (_ffd .MakeOperand ("\u0065\u0078\u0063\u0068"));_fga .Append (_ffd .MakeReal (0.30));_fga .Append (_ffd .MakeOperand ("\u006d\u0075\u006c"));_fga .Append (_ffd .MakeOperand ("\u0061\u0064\u0064"));
_fga .Append (_ffd .MakeOperand ("\u0064\u0075\u0070"));_fga .Append (_ffd .MakeReal (1.0));_fga .Append (_ffd .MakeOperand ("\u0067\u0065"));_bfe :=_ffd .NewPSProgram ();_bfe .Append (_ffd .MakeOperand ("\u0070\u006f\u0070"));_bfe .Append (_ffd .MakeReal (1.0));
_fga .Append (_bfe );_fga .Append (_ffd .MakeOperand ("\u0069\u0066"));_cfd .Program =_fga ;_agd :=_fg .NewPdfColorspaceDeviceN ();_agd .AlternateSpace =_fg .NewPdfColorspaceDeviceGray ();_agd .ColorantNames =_ca .MakeArray (_ca .MakeName ("\u0043"),_ca .MakeName ("\u004d"),_ca .MakeName ("\u0059"),_ca .MakeName ("\u004b"));
_agd .TintTransform =_cfd ;_gfd .ColorSpace =_agd ;return _gfd ,nil ;}else {return nil ,_a .New ("\u0075\u006e\u0073\u0075\u0070\u0070\u006fr\u0074\u0065\u0064 \u0070\u0061\u0074t\u0065\u0072n\u0020\u0063\u006f\u006c\u006f\u0072s\u0070ac\u0065\u0020\u0066\u006f\u0072\u0020\u0067\u0072\u0061\u0079\u0073\u0063\u0061\u006c\u0065\u0020\u0063\u006f\u006e\u0076\u0065\u0072\u0073\u0069\u006f\u006e");
};};

// MergePdf merges several PDF files passed as inputPaths to one PDF file, outputPath.
// isMergingForms controls if it is necessary to merge AcroForms from input files.
// If you are not sure, you can always set isMergingForms to true.
func MergePdf (inputPaths []string ,outputPath string ,isMergingForms bool )error {_bfae :=_fg .NewPdfWriter ();var _dee *_fg .PdfAcroForm ;for _bge ,_bcb :=range inputPaths {_bcad ,_beg ,_ffe :=_fg .NewPdfReaderFromFile (_bcb ,nil );if _ffe !=nil {return _ffe ;
};defer _beg .Close ();_efbg ,_ffe :=_bcad .GetNumPages ();if _ffe !=nil {return _ffe ;};for _cgg :=range _efbg {_caa :=_cgg +1;_aeg ,_eddb :=_bcad .GetPage (_caa );if _eddb !=nil {return _eddb ;};_eddb =_bfae .AddPage (_aeg );if _eddb !=nil {return _eddb ;
};};if isMergingForms &&_bcad .AcroForm !=nil {if _dee ==nil {_dee =_bcad .AcroForm ;}else {_dee ,_ffe =_eef (_dee ,_bcad .AcroForm ,_bge +1);if _ffe !=nil {return _ffe ;};};};};_ecb ,_gdd :=_fea .Create (outputPath );if _gdd !=nil {return _gdd ;};defer _ecb .Close ();
if _dee !=nil {_bfae .SetForms (_dee );};_gdd =_bfae .Write (_ecb );if _gdd !=nil {return _gdd ;};return nil ;};