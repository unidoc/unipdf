//
// Copyright 2020 FoxyUtils ehf. All rights reserved.
//
// This is a commercial product and requires a license to operate.
// A trial license can be obtained at https://unidoc.io
//
// DO NOT EDIT: generated by unitwist Go source code obfuscator.
//
// Use of this source code is governed by the UniDoc End User License Agreement
// terms that can be accessed at https://unidoc.io/eula/

package sanitize ;import (_f "github.com/unidoc/unipdf/v4/common";_e "github.com/unidoc/unipdf/v4/core";);

// New returns a new sanitizer object.
func New (opts SanitizationOpts )*Sanitizer {return &Sanitizer {_g :opts }};func (_bbd *Sanitizer )analyze (_dbd []_e .PdfObject ){_eae :=map[string ]int {};for _ ,_accg :=range _dbd {switch _eba :=_accg .(type ){case *_e .PdfIndirectObject :_fdd ,_aaag :=_e .GetDict (_eba .PdfObject );
if _aaag {if _bcc ,_dcca :=_e .GetName (_fdd .Get ("\u0054\u0079\u0070\u0065"));_dcca &&*_bcc =="\u0043a\u0074\u0061\u006c\u006f\u0067"{if _ ,_ccb :=_e .GetIndirect (_fdd .Get ("\u004f\u0070\u0065\u006e\u0041\u0063\u0074\u0069\u006f\u006e"));_ccb {_eae ["\u004f\u0070\u0065\u006e\u0041\u0063\u0074\u0069\u006f\u006e"]++;
};}else if _cfg ,_be :=_e .GetName (_fdd .Get ("\u0053"));_be {_ec :=_cfg .String ();if _ec =="\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074"||_ec =="\u0055\u0052\u0049"||_ec =="\u0047\u006f\u0054\u006f"||_ec =="\u0047\u006f\u0054o\u0052"||_ec =="\u004c\u0061\u0075\u006e\u0063\u0068"{_eae [_ec ]++;
}else if _ec =="\u0052e\u006e\u0064\u0069\u0074\u0069\u006fn"{if _ ,_bf :=_e .GetStream (_fdd .Get ("\u004a\u0053"));_bf {_eae [_ec ]++;};};}else if _cbd :=_fdd .Get ("\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074");_cbd !=nil {_eae ["\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074"]++;
}else if _dd ,_cbf :=_e .GetIndirect (_fdd .Get ("\u0050\u0061\u0072\u0065\u006e\u0074"));_cbf {if _fcc ,_fdg :=_e .GetDict (_dd .PdfObject );_fdg {if _afd ,_ef :=_e .GetDict (_fcc .Get ("\u0041\u0041"));_ef {_ede :=_afd .Get ("\u004b");_gb ,_cbc :=_e .GetIndirect (_ede );
if _cbc {if _fgf ,_cac :=_e .GetDict (_gb .PdfObject );_cac {if _ddf ,_gg :=_e .GetName (_fgf .Get ("\u0053"));_gg &&*_ddf =="\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074"{_eae ["\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074"]++;
}else if _ ,_ba :=_e .GetString (_fgf .Get ("\u004a\u0053"));_ba {_eae ["\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074"]++;}else {_fge :=_afd .Get ("\u0046");if _fge !=nil {_fgd ,_cd :=_e .GetIndirect (_fge );if _cd {if _dac ,_bgb :=_e .GetDict (_fgd .PdfObject );
_bgb {if _ad ,_ege :=_e .GetName (_dac .Get ("\u0053"));_ege {_ccc :=_ad .String ();_eae [_ccc ]++;};};};};};};};};};};};};};_bbd ._aa =_eae ;};

// Optimize optimizes `objects` and returns updated list of objects.
func (_d *Sanitizer )Optimize (objects []_e .PdfObject )([]_e .PdfObject ,error ){return _d .processObjects (objects );};

// Sanitizer represents a sanitizer object.
// It implements the Optimizer interface to access the objects field from the writer.
type Sanitizer struct{_g SanitizationOpts ;_aa map[string ]int ;};func (_c *Sanitizer )processObjects (_cc []_e .PdfObject )([]_e .PdfObject ,error ){_ca :=[]_e .PdfObject {};_ccf :=_c ._g ;for _ ,_b :=range _cc {switch _bg :=_b .(type ){case *_e .PdfIndirectObject :_dg ,_eg :=_e .GetDict (_bg );
if _eg {if _fa ,_gd :=_e .GetName (_dg .Get ("\u0054\u0079\u0070\u0065"));_gd &&*_fa =="\u0043a\u0074\u0061\u006c\u006f\u0067"{if _ ,_de :=_e .GetIndirect (_dg .Get ("\u004f\u0070\u0065\u006e\u0041\u0063\u0074\u0069\u006f\u006e"));_de &&_ccf .OpenAction {_dg .Remove ("\u004f\u0070\u0065\u006e\u0041\u0063\u0074\u0069\u006f\u006e");
};}else if _fc ,_bb :=_e .GetName (_dg .Get ("\u0053"));_bb {switch *_fc {case "\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074":if _ccf .JavaScript {if _acf ,_gf :=_e .GetStream (_dg .Get ("\u004a\u0053"));_gf {_cb :=[]byte {};_ab ,_bbe :=_e .MakeStream (_cb ,nil );
if _bbe ==nil {*_acf =*_ab ;};};_f .Log .Debug ("\u004a\u0061\u0076\u0061\u0073\u0063\u0072\u0069\u0070\u0074\u0020a\u0063\u0074\u0069\u006f\u006e\u0020\u0073\u006b\u0069\u0070p\u0065\u0064\u002e");continue ;};case "\u0055\u0052\u0049":if _ccf .URI {_f .Log .Debug ("\u0055\u0052\u0049\u0020ac\u0074\u0069\u006f\u006e\u0020\u0073\u006b\u0069\u0070\u0070\u0065\u0064\u002e");
continue ;};case "\u0047\u006f\u0054\u006f":if _ccf .GoTo {_f .Log .Debug ("G\u004fT\u004f\u0020\u0061\u0063\u0074\u0069\u006f\u006e \u0073\u006b\u0069\u0070pe\u0064\u002e");continue ;};case "\u0047\u006f\u0054o\u0052":if _ccf .GoToR {_f .Log .Debug ("R\u0065\u006d\u006f\u0074\u0065\u0020G\u006f\u0054\u004f\u0020\u0061\u0063\u0074\u0069\u006fn\u0020\u0073\u006bi\u0070p\u0065\u0064\u002e");
continue ;};case "\u004c\u0061\u0075\u006e\u0063\u0068":if _ccf .Launch {_f .Log .Debug ("\u004a\u0061\u0076\u0061\u0073\u0063\u0072\u0069\u0070\u0074\u0020a\u0063\u0074\u0069\u006f\u006e\u0020\u0073\u006b\u0069\u0070p\u0065\u0064\u002e");continue ;};case "\u0052e\u006e\u0064\u0069\u0074\u0069\u006fn":if _cf ,_acc :=_e .GetStream (_dg .Get ("\u004a\u0053"));
_acc {_ed :=[]byte {};_aaa ,_da :=_e .MakeStream (_ed ,nil );if _da ==nil {*_cf =*_aaa ;};};};}else if _db :=_dg .Get ("\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074");_db !=nil &&_ccf .JavaScript {continue ;}else if _dba ,_gc :=_e .GetName (_dg .Get ("\u0054\u0079\u0070\u0065"));
_gc &&*_dba =="\u0041\u006e\u006eo\u0074"&&_ccf .JavaScript {if _bbb ,_gfc :=_e .GetIndirect (_dg .Get ("\u0050\u0061\u0072\u0065\u006e\u0074"));_gfc {if _ce ,_gdg :=_e .GetDict (_bbb .PdfObject );_gdg {if _bc ,_eb :=_e .GetDict (_ce .Get ("\u0041\u0041"));
_eb {_fb ,_fe :=_e .GetIndirect (_bc .Get ("\u004b"));if _fe {if _dgd ,_ea :=_e .GetDict (_fb .PdfObject );_ea {if _af ,_df :=_e .GetName (_dgd .Get ("\u0053"));_df &&*_af =="\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074"{_dgd .Clear ();
}else if _fg :=_bc .Get ("\u0046");_fg !=nil {if _ga ,_gfe :=_e .GetIndirect (_fg );_gfe {if _ced ,_ded :=_e .GetDict (_ga .PdfObject );_ded {if _dc ,_dcc :=_e .GetName (_ced .Get ("\u0053"));_dcc &&*_dc =="\u004a\u0061\u0076\u0061\u0053\u0063\u0072\u0069\u0070\u0074"{_ced .Clear ();
};};};};};};};};};};};case *_e .PdfObjectStream :_f .Log .Debug ("\u0070d\u0066\u0020\u006f\u0062j\u0065\u0063\u0074\u0020\u0073t\u0072e\u0061m\u0020\u0074\u0079\u0070\u0065\u0020\u0025T",_bg );case *_e .PdfObjectStreams :_f .Log .Debug ("\u0070\u0064\u0066\u0020\u006f\u0062\u006a\u0065\u0063\u0074\u0020s\u0074\u0072\u0065\u0061\u006d\u0073\u0020\u0074\u0079\u0070e\u0020\u0025\u0054",_bg );
default:_f .Log .Debug ("u\u006e\u006b\u006e\u006fwn\u0020p\u0064\u0066\u0020\u006f\u0062j\u0065\u0063\u0074\u0020\u0025\u0054",_bg );};_ca =append (_ca ,_b );};_c .analyze (_ca );return _ca ,nil ;};

// SanitizationOpts specifies the objects to be removed during sanitization.
type SanitizationOpts struct{

// JavaScript specifies wether JavaScript action should be removed. JavaScript Actions, section 12.6.4.16 of PDF32000_2008
JavaScript bool ;

// URI specifies if URI actions should be removed. 12.6.4.7 URI Actions, PDF32000_2008.
URI bool ;

// GoToR removes remote GoTo actions. 12.6.4.3 Remote Go-To Actions, PDF32000_2008.
GoToR bool ;

// GoTo specifies wether GoTo actions should be removed. 12.6.4.2 Go-To Actions, PDF32000_2008.
GoTo bool ;

// RenditionJS enables removing of `JS` entry from a Rendition Action.
// The `JS` entry has a value of text string or stream containing a JavaScript script that shall be executed when the action is triggered.
// 12.6.4.13 Rendition Actions Table 214, PDF32000_2008.
RenditionJS bool ;

// OpenAction removes OpenAction entry from the document catalog.
OpenAction bool ;

// Launch specifies wether Launch Action should be removed.
// A launch action launches an application or opens or prints a document.
// 12.6.4.5 Launch Actions, PDF32000_2008.
Launch bool ;};

// GetSuspiciousObjects returns a count of each detected suspicious object.
func (_ceg *Sanitizer )GetSuspiciousObjects ()map[string ]int {return _ceg ._aa };